{
  "id": 3326,
  "origin_website": "Cell",
  "title": "Protocol for geometric transformation of cognitive maps for generalization across hippocampal-prefrontal circuits",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nConstruct W-mazes, linear track, sleep box, and reward wells\nTiming: 1–2 weeks\nThese steps describe how to fabricate necessary behavioral apparatuses for the experiments outlined in this protocol. There are multiple ways to approach this step – apparatuses may be fabricated in-house or can be outsourced to external companies. Design files can be found on our lab GitHub (http://github.com/JadhavLab/GeometricTransformationProtocol[href=http://github.com/JadhavLab/GeometricTransformationProtocol]).\nSleep box fabrication.\nUsing the appropriate number of sheets of 0.65 cm thick black Delrin, cut four pieces with the dimensions 30 × 40 cm (sides) and one piece with the dimensions 34 × 34 cm (bottom) (Figure 1[href=https://www.wicell.org#fig1]A).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2913-Fig1.jpg\nFigure 1. Fabrication of behavioral apparatuses\n(A) Dimensions of the sleep box.\n(B) Dimensions of the linear and W-Track.\n(C) Instructions for assembly of 3D printed reward well. Reward wells are connected to 60 mL syringes via polyurethane tubing, and precise reward amounts are delivered through programmed pumps. Connections between components can be made with appropriate Luer lock fittings.\nCut 0.65 cm width shallow grooves around the perimeter of the bottom piece, approximately 1 cm inward from the edges. These grooves will hold the side pieces in place, with exception of the front panel, which will be movable.\nAlign the three side panels with the grooves in the bottom panel and attach panels using 3 screws per side panel from the bottom.\nTo further stabilize side panels, attach corner braces at four points to the side and back panels.\nAttach the front panel using 5 cm hinges to one of the side panels.\nAttach the hinged metal strap to the opposite side panel and the looped staple to the front panel.\nSmooth out any sharp edges to prevent injury.\nNote: Be sure to use correct length screws that do not protrude in any location.",
    "Linear and W-Track fabrication.\nFor each track component, cut 0.3 cm thick aluminum sheets with the track dimensions illustrated in Figure 1[href=https://www.wicell.org#fig1]B.\nNote: You will need materials for two W-Tracks, one each for the novel and familiar components of the experiment.\nDrill two appropriately sized and spaced holes at the end of each track arm to secure reward wells.\nIn a well-ventilated area, spray paint the track components matte black to reduce light reflection, which will help with downstream position tracking.\nNote: Due to the heavy machinery required to fabricate these maze parts from 0.3 cm thick aluminum, using an external company or campus machine shop that specializes in machining may be required. Xometry (www.xometry.com[href=http://www.xometry.com/]) has been previously used to manufacture custom maze parts for adaptable mazes that are currently used in the laboratory.3[href=https://www.wicell.org#bib3]\nNote: Instructions for the fabrication of track bases are not covered in this protocol, as appropriate track height may differ between laboratory setups based on the height of various recording equipment.\nReward well fabrication and assembly.\n3D print 6 reward wells using the Form 3 printer or an external company (e.g., Stratasys, Shapeways, etc.). The reward well pictured was printed using the Form 3 (Material, Grey Pro).\nGet printed circuit boards (PCBs) fabricated.\nSolder surface mount resistors (Figure 1[href=https://www.wicell.org#fig1]C, R1-220 Ω, R2-10 kΩ, R3-0 Ω (jumper)), an IR emitter and receiver, and an RJ45 Ethernet port onto designated regions of the PCB. Note that the IR emitter/receiver and RJ45 plug are soldered on the opposite side of the resistors (Figure 1[href=https://www.wicell.org#fig1]C).\nNote: Make sure the legs of the emitter/receiver extend far enough out from the PCB to allow the lens of the LEDs to fit into the sides of the reward well when bent inward.\nCover all soldered components with liquid electric tape.",
    "Critical: Not thoroughly covering electrical components at this step may lead to downstream noise issues, such as amplified lick artifacts.\nInsert the PCB into the back of the reward well, slide on the 3D printed back cover, and secure the cover by inserting screws into the side holes.\nOnce all components have been constructed, the mazes can be set up for automated reward delivery via pumps, tubing, and an environmental control unit (ECU, SpikeGadgets).\nDrive fabrication\nTiming: 5–10 days\nThese steps describe the protocols for fabrication of 32 and 64-tetrode microdrive arrays for use in chronic in vivo electrophysiology experiments. Although the instructions here will focus on targeting the prefrontal cortex and the dorsal CA1 layer of the hippocampus in the rat, these methods can be extended to record from many other regions in the brain. The drive weight should ideally be <10% of body weight of animals; therefore, larger rats with weights >=400 g at the time of implant are usually required.\nFabrication of custom drive components.\nDrive bodies can be 3D printed using Form 3 or can be outsourced. The drive body pictured in Figure 2[href=https://www.wicell.org#fig2]A was printed using PolyJet technology through Stratasys (Material, VeroBlue).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2913-Fig2.jpg\nFigure 2. Microdrive fabrication\n(A) Consumables required for microdrive fabrication.\n(B) Instructions for assembly of shuttles and turn tools.\n(C) Steps for microdrive assembly.\n(D) Gold plating with the NanoZ electroplater.\n(E) Fabrication of the ground screw.\n(F) Circuit diagram for a SpikeGadgets compatible LED array.\nCustom metal components (brass nut pieces, molds, and M1.2 screws) were ordered through eMachineShop.\nNote: The 32 tetrode microdrive body only has 30 shuttle lanes. To maximize the number of tetrodes, some shuttles can be double loaded.",
    "Note: The length of the custom M1.2 screws for the 64-tetrode drive will determine how far electrodes can penetrate the brain. If targeting deeper structures, it may be necessary to lengthen the custom screws.\nPreparation of materials and drive body.\nUsing a 23 Ga needle, ream out excess 3D printing material from the drive body.\nNote: Blockage of these holes will result in a failure to mobilize shuttles.\nFor the 32-tetrode drive, ream out the inner and outermost holes.\nFor the 64-tetrode drive, ream out the inner hole.\nNote: When reaming the inner hole, stop a few millimeters before penetrating the drive through the bottom. This will simplify the future step of loading 30 Ga tubes into the drive body.\nTap each larger hole with the appropriately sized tap (0–80 or M1.2 tap for 32 or 64 tetrode drive, respectively).\nCritical: While tapping holes, make sure not to apply excess lateral pressure. This will cause the tap to break off in the drive body, effectively rendering that shuttle lane inoperable.\nPreparation of microdrive components.\nWith a diamond cutting wheel, cut appropriate number of 30 Ga steel tubing and 0.0055″ medical mandrel wire (5.5 m wire from now on) measured out to 6 and 8 cm, respectively.\nSharpen 5.5 m wires by briefly grinding the ends on the face of the diamond cutting wheel at around 45 degrees. Multiple wires can be sharpened simultaneously.\nBriefly grind down the ends of the 30 Ga tubes to clear off any debris or sharp points from cutting.\nReam a 5.5 m wire through each 30 Ga tube multiple times until the wire passes through smoothly.",
    "Note: If it is difficult to pass a 5.5 m wire through, an end of the 30 Ga tube may be welded shut. Remember to only briefly grind down the ends.\nInsert the reamed 30 Ga tubes into the inner holes of the drive body.\nCut 2 lengths of 14 Ga tubing (cannulae) measuring ∼1.5–1.75 cm and scuff the sides of one end.\nNote: Scuffing the ends will help dental cement adhere to the tubes.\nMake a targeting block.\nCut a piece of 2 cm thick Delrin into a 4 cm × 4 cm square.\nMark out the coordinates dorsal CA1 (−3.6 AP, 2.2 ML) and PFC (3 AP, 0.7–1.0 ML).\nDrill 1 cm deep holes with an appropriately sized drill bit at the marked sites.\nNote: Depending on the number of tetrodes per region, the size of the guide cannula will have to change (i.e., 14 Ga to 15 Ga for fewer tetrodes).\nInsert the 14 Ga cannulae into the targeting block, scuffed side up.\nCarefully start feeding in the appropriate number of 30 Ga tubes into each 14 Ga cannula and make sure each 30 Ga tube contacts the bottom of the targeting block.\nAfter inserting all tubes, recheck that all 30 Ga tubes are at their bottom most position in the block.\nCritical: If tubes are not at the bottom, some may be recessed after dental cementing, which may cause tetrode instability due to insufficient contact with the brain.\nGently push the drive body downward to reduce the height of the drive but take care not to kink any of the 30 Ga tubes.\nNote: Test whether the 5.5 m wires within the 30 Ga tubes are still mobile to determine if the bend is too extreme.",
    "Apply a thin layer of mineral oil on the surface of the Delrin block with a cotton-tipped applicator.\nDental cement the drive body, 30 Ga tubes, and 14 Ga cannulae together.\nLet fully harden then remove from block.\nNote: All 30 Ga tubes should be flush with the bottom of the 14 Ga cannulae (or slightly protruding).\nExtend all 5.5 m wires out ∼2 cm out from the bottom.\nWith the sharp diamond cutting wheel, cut each 30 Ga tube at the top of the drive body such that ∼2 mm protrudes.\nUsing pliers or serrated forceps (Fine Science Tools, Cat#91100-12), push each 5.5 m wire from the bottom through the freshly cut 30 Ga tubes at the top.\nNote: There will be some resistance so take care not to bend any 5.5 m wires.\nWith all the 5.5 m wires now protruding out the top of the drive, cut the two 14 Ga cannulae to a desired length (typically 0.5–0.75 cm) with a thick diamond wheel.\nNote: Using the thin diamond wheel can cause warping of the wheel.\nUsing pliers, push each 5.5 m wire from the top through the freshly cut 30 Ga tubes at the bottom, and ensure the 5.5 m wire passes smoothly through each 30 Ga tube.\nRemove 5.5 m wires and sand the excess dental cement around the cannulae into a rectangular shape.\nNote: The dental cemented portion should clamp securely in a Panavise.\nTake an image of the bottom of the cannulae and map out the location of each 30 Ga tube from the top of the drive using a 5.5 m wire.\nAttach a 128 or 256 channel electrode interface board (EIB) to the drive body using screws.",
    "Solder a ground wire to the ground pin hole on the EIB and route the wire to the back of the drive body.\nSolder a female 4 pin Mill-Max connector to the wire.\nDental cement the ground wire to the drive body at multiple points, taking care not to get cement into the holes.\nAssembling turn tools (Figure 2[href=https://www.wicell.org#fig2]B).\n32 tetrode drive turn tool for threaded rods (Tool A) – Using a pin vice, a 7.5 cm piece of 14 Ga stainless steel tubing, and a 5 cm piece of 0–80 threaded rod, assemble a turn tool.\nAt one end of the threaded rod, cut a 0.5 cm long half-moon, similar to the top of the custom M1.2 screw.\nSecure the 14 Ga tube in the pin vice and dental cement to lock in place.\nInsert the threaded rod into the 14 Ga tube until the half-moon end is flush with the end of the 14 Ga tube.\nUsing pliers, clamp the 14 Ga tube to the inserted threaded rod.\n32 tetrode drive turn tool for nut pieces (Tool B) – Using a pin vice, and a 7.5 cm piece of 14 Ga stainless steel tubing, assemble a turn tool.\nSecure the 14 Ga tube in the pin vice and dental cement to lock in place.\nUsing a Dremel, shave down opposite sides of the 14 Ga tip to securely mate with the grooves in the custom brass nut piece.\n64 tetrode drive turn tool – Using a pin vice, a 7.5 cm piece of 16 Ga stainless steel tubing, and a custom M1.2 screw, assemble a turn tool.\nSecure the 16 Ga tube in the pin vice with dental cement, insert the M1.2 screw into the top, and clamp (similar to Tool A above).",
    "Note: The 32-tetrode drive requires two tools, one to screw the threaded rods into the drive body (Tool A), and the other to move shuttles up and down the threaded rod (Tool B).\nAssembling shuttles for the 32-tetrode drive (Figure 2[href=https://www.wicell.org#fig2]B).\nInsert 23 Ga tubes into the base of the shuttle mold.\nThread custom nut pieces onto cut pieces of 0–80 threaded rod and screw into the mold until the bottom of the nut piece comes in contact with the mold.\nLightly coat the surface of the mold, nut pieces, and 23 Ga tubes with mineral oil.\nWrap a piece of Scotch tape around the perimeter of the mold.\nPour dental cement into the mold, making sure not to fill the notches of the brass nut pieces.\nNote: The cement should sit right below the notches of the nut pieces.\nAs the dental cement begins to harden, turn the nut pieces counterclockwise ¼ of a turn and then clockwise ¼ of a turn. This will allow the nut piece to move freely within the dental cement.\nNote: Do not turn counterclockwise too far or the nut piece will wiggle in the dental cement after hardening.\nRepeat step f above until the dental cement has fully hardened.\nRemove the tape, 23 Ga tubes, and the threaded rods.\nSnap off the dental cement from the mold and shave down the shuttles with a Dremel.\nNote: The shuttles should be shaved down as thin as possible without compromising the strength of the dental cement. Thick shuttles will clash when loaded into the microdrive.\nCut 40 pieces of 0–80 threaded rod (2.5 cm long).\nCut a half-moon shape on one end and bevel the other end with a Dremel.\nNote: The beveling makes threading into the nut piece easier.",
    "Cut 40 pieces of 23 Ga tubing (2.5 cm long). These will be supporting pieces.\nCut 40 pieces of 23 Ga tubing (1.5 cm long). These will mate with the 30 Ga tubes in the drive body and house the tetrodes.\nCut 40 pieces of polyimide tubing (2 cm long).\nAssemble the 32 tetrode drive shuttles.\nThread the 0–80 rods into the nut pieces.\nInsert the support 23 Ga tubes.\nInsert the shorter 23 Ga tubes halfway into the shuttle.\nLightly coat the top half of the short 23 Ga tubes with super glue and advance into the shuttle such that ∼2 mm sticks out from the top.\nApply a small amount of super glue to the 23 Ga and dental cement to secure.\nCritical: Do not get super glue into the 23 Ga tubes or in between the dental cement and the nut pieces.\nInsert the polyimide tubes and secure to the top of the 23 Ga tubes with super glue. 1–2 mm of polyimide should be protruding from the top.\nNote: Once the polyimide tubes are in, super glue can enter the 23 Ga tubes.\nNote: If double loading the shuttles to maximize recording channel count for the 32-tetrode drive (design provided only has 30 lanes), do not load polyimide tubes in two shuttles. These will be double loaded.\nCut the excess polyimide from the bottom so 1–2 mm protrudes.\nCritical: Do not crimp the polyimide at any stage or it will have to be replaced.\nCritical: Do not use too much super glue or it will flow to the bottom of the tubes, which will impede loading of the shuttles into the drive body.\nAssemble the 64 tetrode drive shuttles (Figure 2[href=https://www.wicell.org#fig2]B).\n3D print the components for the 64 tetrode drive shuttle (80 each).",
    "Note: These 3D printed pieces are prone to breakage, so printing an ample supply is advantageous.\nCut 70 pieces of 23 Ga tubing (1.5 cm long).\nCut 70 pieces of polyimide tubing (2 cm long).\nMate the U-shaped piece with the groove on the M1.2 screws and slide in the second piece.\nApply liquid super glue to the seams on both sides where the two pieces meet. It should flow between the two pieces.\nMake a batch of Metabond in a chilled ceramic mixing container and keep on ice to increase working time.\nApply a thin layer of Metabond around the entire shuttle. This significantly strengthens the shuttles and decreases attrition.\nInsert the polyimide tubes and secure to the top of the 23 Ga tubes with super glue. 1–2 mm of polyimide should be protruding from the top.\nCut the excess polyimide from the bottom so 1–2 mm protrudes.\nLoading shuttles.\nUnder a microscope, carefully load each shuttle into the drive body.\nAlign the polyimide tube in the shuttle with the 30 Ga tube in the drive body and insert it until the 23 Ga tube mates with the 30 Ga tube.\nWith forceps or pliers, grab the bottom of the 0–80 threaded rod and advance to the surface of the drive body.\nScrew in the threaded rod with Tool A until secure.\nGuide the support 23 Ga tube into the support hole.\nUsing Tool B, advance the shuttle to the bottom position (∼4 mm from the drive body).\nNote: Steps are the same for the 64 tetrode drive shuttles except that there are no support pieces.\nNote: The shuttles in the 64-tetrode drive are moved by direct movement of the M1.2 screw in the drive body.\nTetrode fabrication.",
    "Measure out 70 cm of NiCr wire (Alleima, 0.0127 mm, polyimide coated).\nNote: If longer tetrodes are required, 80–90 cm of wire can be used. Note that the number of turns must be adjusted accordingly. Consult the Neuralynx tetrode assembly station user manual for detailed instructions (https://neuralynx.com/documents/TAS_Manual.pdf[href=https://neuralynx.com/documents/TAS_Manual.pdf]).\nLoop the wire and drape over the bar of the tetrode assembly station (Neuralynx).\nClamp the 4 wires at the bottom with an alligator clip and position the clip in the spinning unit.\nNote: Make sure the alligator clip is wrapped with heat shrink tubing. In addition to the heat shrink, wrapping the clips with Parafilm can improve gripping of tetrode wires prior to spinning.\nNote: Do not let the clip contact the magnet in the spinning unit. This can cause the electrodes to snap.\nSpin the tetrode 90× clockwise and 30× counterclockwise.\nUsing a heat gun, anneal the tetrode wire evenly from three sides approximately 2 cm away. It should take ∼5 s from top to bottom.\nNote: To avoid misshapen tetrodes and electrode bridges, do not heat excessively. For polyimide coated wire, the annealing temperature should be ∼500°C.\nLift the bar, releasing the alligator clip from the spinning unit and allow it to spin until it stops.\nNote: Skipping this step can result in tangled leads at the top due to build up tension.\nAnneal the newly spun portion from three sides using the heat gun.\nLift the alligator clip to relieve tension and cut ∼1 cm above the clip.\nRemove the tetrode and cut the two loops formed at the top.\nStore in a dust free container until use.\nLoading tetrodes.",
    "Grab a tetrode with clean fingers or ceramic tipped forceps and, under a stereoscope, carefully load it into polyimide tube (MicroLumen, Cat#039-I, inner diameter: 0.0039″) until slight resistance is met.\nUsing ceramic tipped forceps (Fisher Scientific, Cat#501927539, tip width: 0.4 mm), gently grab the tetrode near the point of entry and advance the tetrode into the drive gently until 1–2 cm of the annealed portion of the tetrode is left at the top.\nThread each electrode lead into the pin holes in the EIB and adjust the slack such that the tetrode bends away from the shuttle.\nPin the electrodes to the EIB with gold pins.\nNote the electrode group on the EIB the tetrode is pinned to.\nNote: Using the electrode group ID along with the microdrive mapping information will allow for matching of neural signals to tetrode spatial location, which is useful if precise targeting is required.\nAfter all shuttles have been loaded, cut the tetrodes protruding from the bottom on the cannulae to an even length, keeping them much longer than what is needed to reach the brain areas of interest.\nTest connectivity of each electrode using a saline bath the NanoZ (detailed instructions in Gold Plating section).\nReplace any tetrodes with bad connectivity.\nAfter connectivity is confirmed, super glue each tetrode to the polyimide tube at the top of the shuttle.\nNote: Gel super glue works best for this step. If liquid super glue is used, it is critical to only apply a small amount to prevent glue from invading the polyimide tube.\nPause point: Loaded drives can be stored at this point for later use.\nGold plating and final steps (Figure 2[href=https://www.wicell.org#fig2]D).\nPlace the drive in a UV box (Grainger, Cat#18AX46, output: 52.5 W UVC radiation) and sterilize for 15 min.",
    "Under a stereoscope, cut the tetrodes to their final length using sharp surgical scissors.\nCritical: Do not UV sterilize after the final cut. We’ve experienced inconsistent impedance values if sterilization takes place after the final cuts.\nConnect the drive to the NanoZ via an adapter (custom or SpikeGadgets).\nFill one plating well with gold solution and connect to the NanoZ via a wire.\nFill the other well with distilled water.\nRinse tetrodes in distilled water for 1–2 min.\nMove tetrodes to the gold solution.\nCritical: Only the tetrode tips should be in the gold solution. Do not allow solution to enter the metal cannulae. This will cause crystallization in the tubes and impede tetrode movement.\nTest connectivity and impedance.\nSetting – Test Impedances.\nNote: Baseline impedance for un-plated electrodes should be around 5–6 MOhms. Much higher impedances may indicate faulty channels and/or connections.\nBurn the electrode tips.\nSetting – DC electroplate.\nMode set to fixed plating time.\nPlating current set to +1 μA.\nInterval set to 2 s.\nAutoplate.\nNote: Impedances should drop down to around 2–3 MOhms\nGold plate the electrodes.\nSet interval to 2 s and number of runs to 5.\nRound 1 – Current set to −0.5 μA; target set to 500 kOhms.\nRound 2 – Current set to −0.3 μA; target set to 400 kOhms.\nRound 3 – Current set to −0.1 μA; target set to 300 kOhms.\nRound 4 – Current set to −0.05 μA; target set to 250 kOhms.\nAfter each round, rinse in distilled water for 5 min.\nCritical: Over plating will cause bridges (shorts) between channels. The above settings are provided as a general guide. Adjust current to lower values for each round if necessary.\nNote: Gold plating can take place over the course of a few days.",
    "Note: Electrode impedances should be ∼250 kOhms at the end of gold plating.\nUnder a stereoscope, retract all tetrodes slightly past the end of the 30 Ga tubes at the bottom of the drive.\nNote: Record the number of turns required to retract each tetrode to approximate the maximum travel distance.\nSecure the 3D printed cone to the drive with dental cement.\nGround screw fabrication (Figure 2[href=https://www.wicell.org#fig2]E).\nCut 2–3 pieces of insulated copper wire (∼5 cm long).\nStrip 0.5 cm of insulation off both ends.\nTwist the wires together and solder one end to a 4 pin male Mill-Max connector.\nWrap the opposite stripped end around a skull screw at the base of the head.\nApply a small amount of flux and solder.\nCritical: Do not apply too much solder. If excess solder invades the threads of the ground screw, it will not properly secure within the skull.\nTest connectivity between the base of the screw and the pins of the Mill-Max connector with a multimeter.\nLED array fabrication (Figure 2[href=https://www.wicell.org#fig2]F).\nConstruct a red-green LED array using surface mount resistors and LEDs according to the circuit diagram in Figure 2[href=https://www.wicell.org#fig2]F.\nNote: Two LEDs are used for tracking to extract head direction during behavior.\nAnimal pre-training\nTiming: 2–5 days\nThese pre-training steps are performed to habituate the animal to running on elevated mazes for reward.\nNote: All behavioral experiments were performed between ZT0 (zeitgeber time) and ZT12.\nOnce an animal has been sufficiently handled and has reached a protocol approved weight (e.g., 300–400 g), food restriction can begin.",
    "Note: The growth chart of the animal should be taken into consideration before beginning food deprivation. For example, if a male rat weighs ∼350 g at 11 week (typical) and food deprivation begins, the weight of the animal should not cross 85% (or approved food restriction limit) of the projected weight at the corresponding age. Food deprivation should be monitored carefully to adhere to this. Check your supplier’s animal documentation for more information, and be sure to check your lab’s protocol for instructions on proper food restriction/deprivation.\nStart habituating the animal to the reward that will be used during experiments. In our case, evaporated milk was used.\nNote: Evaporated milk reward can also be mixed with sugar (20 g sugar per 350 mL of milk) or blended with Reese’s Pieces (20 g per 350 mL). If blending with Reese’s Pieces, use a strainer to get rid of chunks.\nHabituate animal to the sleep box for ∼20 min per day for 3 days.\nWhen the animal has been sufficiently food restricted (e.g., reaches 85% of baseline weight), begin linear track pretraining.\nRun 2–3 15–20-min linear track sessions daily until good performance has been reached.\nAnimals should be able to reach a reward receipt rate of at least 4 per minute for 2 consecutive days before proceeding to drive implantation.\nIf acceptable performance is not reached within a week, do not use animal for downstream experiments.\nAlternatively, it may be helpful to change the reward type to get the animal to an acceptable performance level.\nNote: Due to the rigorous behavioral protocol of the single day experiment, if animals did not reach criterion (∼60–80 rewards in 15–20 min for two consecutive days), they did not proceed to subsequent steps.",
    "Note: It’s advantageous to run a few animals in parallel, in case of issues with behavioral performance, etc.\nAfter training, take the animal off food restriction and let the animal reach an appropriate weight before proceeding to drive implantation.\nImplant surgery\nTiming: 4–6 h\nThis section provides detailed, step-by-step instructions for drive implantation.\nPreparing the animal for implantation (Figure 3[href=https://www.wicell.org#fig3]B).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2913-Fig3.jpg\nFigure 3. Surgery preparation and microdrive implantation\n(A) Surgical materials to prepare for implantation of microdrive array.\n(B) Surgical procedures for microdrive implantation.\nPlace a 7 L induction box on a heating pad to keep the floor of the box warm.\nPlace the animal in the induction box and flow in 5% isoflurane at an airflow rate of 2 L/min (Anesthesia system, Colonial Medical Supply, Cat#901822).\nCritical: Limit the animals’ exposure to 5% isoflurane to <5 min. Prolonged exposure to high isoflurane concentrations will harm the animal.\nOnce the breath rate of the animal has reached 60 breaths/min, set the isoflurane to 0%, purge the chamber with oxygen, and quickly remove the animal from the chamber.\nInject a solution of ketamine (50 mg/kg), xylazine (6 mg/kg), and atropine (0.1 mg/kg) intraperitonially, and return to the induction box for at least 5 min at 1% isoflurane.\nOnce the animal is sufficiently anesthetized, purge the chamber, remove the animal, and shave the animal’s head using clippers (WAHL, Cat#09861-900).\nNote: Keep the animal on a heating pad while shaving. Shaving should take ∼30 s.\nSwitch the airflow from the induction box to the stereotaxic nose cone and set the isoflurane to an initial concentration of 0.25%–0.5%.",
    "Critical: At the beginning of surgery, it is important to find the proper anesthetic depth by adjusting the isoflurane concentration. Too much isoflurane in combination with initial KXA induction may lead to complications, such as very low breath rate or loss of the animal.\nPlace the animal in the stereotax (Kopf, Model 942) on top of the heating pad.\nConnect the foot clip of the MouseOx (Starr Life Sciences, MouseOx Plus) to the animal’s hind paw, and make sure accurate vital readings are obtained. Please refer to the MouseOx user manual for proper positioning of the sensor.\nUsing petroleum jelly, coat the rectal temperature probe, insert, and tape to the base of the tail. Check that there is no obstruction prior to insertion.\nCoat a sterile cotton-tipped applicator with eye lubrication and apply generously to eyes.\nNote: During this step, check for a blink reflex. Wait for the reflex to diminish before proceeding to the next step.\nCritical: It is imperative to administer ringers’ solution every hour (at least ∼5 mL/hr) to prevent dehydration during long surgeries.\nStabilize the animal’s head using non-rupturing ear bars (Kopf, Model 955) and align with the center of the nose cone.\nInject dexamethasone (1–2 mg/kg) and meloxicam (2 mg/kg) subcutaneously at a site in the back.\nClean the scalp with an alcohol prep pad followed by an iodine pad. Start at the center and move outwards in circular motion on the scalp with q tips.\nInject the incision site with 0.2 mL of undiluted 2% lidocaine HCl at multiple points along the midline.\nUsing a scalpel, make a 2.5–3 cm incision in the scalp, starting from the midpoint between the eyes.\nUsing bulldog sereffine clamps (Fine Science Tools, Cat#18050-35), clip the subcutaneous tissue at four points to expose the skull.",
    "Scrape away underlying periosteum completely using a freer elevator (Roboz, Cat#RS-8820) while wiping away blood with cotton-tipped applicators. Make sure to detach the tissue at the lateral ends of the lamboid sutures on the skull.\nNote: Completely detaching this connection reduces the chances that tissue will regrow under the implant.\nStop any excessive bleeding from the skull and/or tissue with the cauterizer.\nNote: Minor bleeding can be stopped by positioning the cautery slightly above (not touching) the tissue or skull. The heat given off the tip often stops bleeding without causing excessive damage.\nUsing the freer elevator, push the tissue overlying the lateral ridge upward and cut along the ridge from posterior to anterior on both sides with surgical scissors (Figure 3[href=https://www.wicell.org#fig3]B, white dotted line).\nNote: Initial displacement of the overlying tissue may take moderate pressure. Removing this tissue will prevent sharp edges from forming during later steps where dental cement is applied to the skull.\nMake shallow cuts in the skull in a crosshatch pattern with a scalpel to allow robust adhesion of the implant.\nAfter sufficiently cleaning the skull, level the head with the rat skull alignment tool.\nSlide an 18 Ga needle into the stereotactic holder to target bregma.\nFind bregma and mark the locations of the craniotomies with crosshairs.\nUsing an LA2 drill bit, drill holes for stabilizing screws on the contralateral side of the craniotomies.\nNote: Skull screw placement for bilateral implants will need to be more carefully planned out to ensure the screws do not occlude the craniotomy sites.\nDrill a hole above the cerebellum on the ipsilateral side of the craniotomies for the ground screw.",
    "Critical: Avoid drilling at sites above the sinus and take care to not break through the skull aggressively for any of the skull screws, as this may cause brain damage and excessive bleeding.\nNote: If desired, an additional ground screw can be used as a backup.\nUsing a small Phillips screwdriver, insert the skull screws about halfway.\nNote: The pitch (distance between threads) of the 0–80 skull screws used here is ∼0.3 mm. To avoid pressing down on the brain, the skull screws should be adjusted ∼0.75 mm into the skull (2–3 turns).\nFor the ground screw, make sure the wire is facing toward the back of the animal.\nMake a batch of Metabond and lay down a base layer over the skull screws.\nCritical: It is imperative that the skull is completely dry before applying Metabond.\nThe Metabond should not cross over to the sites of the craniotomies or be applied to the tissue overlying the ridge.\nNote: Applying Metabond often causes minor bleeding from surrounding tissue. Wick away any blood during this process to ensure no moisture gets under the base layer of cement.\nLeave the ground screw partially exposed to check ground connection after drive implantation.\nCritical: Let the Metabond set in place undisturbed. If cement is accidentally applied to tissue, let dry and drill the excess away. Disrupting the setting process of the cement may cause drive instability.\nAfter Metabond has set sufficiently, drill the craniotomies.\nStart by outlining the perimeter of the craniotomies with an LA2 drill bit.\nCritical: The craniotomies should be significantly larger than the diameter of the drive cannula to ensure residual bone and dura at the edges do not occlude the tetrodes from entering the brain.\nDrill evenly around the perimeter until ¾ of the way through the skull.",
    "Switch to an LA1/4 drill bit and continue drilling around the outer edge of the craniotomy until the skull piece is loose enough to pluck off with a pair of forceps.\nNote: After switching to the LA1/4 drill bit, keep the craniotomy well irrigated with cold, sterile saline. Repeated wicking away of moisture may cause excess drying if there is premature breakthrough/rupture of the underlying dura. This may cause dura to adhere to the brain, making resection difficult.\nCritical: Take care not to tear the underlying dura or damage the brain while drilling. This will cause bleeding and subsequent clotting, which could impede visibility and the removal of dura.\nCover the craniotomy site with a small, saline moistened piece of cotton from the tip of a cotton-tipped applicator.\nRepeat the above steps for all implant sites.\nResect the dura mater.\nBend the 1–2 mm of the tip of a sterile 27 Ga needle into a 45- or 90-degree angle and gently make an incision in the dura at a location close to the edge of the craniotomy. Avoid large vessels.\nNote: Further bending the angled needle tip into a tiny hook can help with gripping and incising the dura.\nNote: Alternatively, a von Graefe knife can be used to make the initial incision.\nInsert the tip of the needle under the dura flap, gently lift, and start cutting toward the opposite side of the initial incision.\nNote: A pair of sharp forceps can also be used to cut dura.\nRepeat this cutting procedure orthogonal to the first incision and push dura toward the edges of the craniotomy.\nExcess dura can be resected using sharp forceps.\nEnsure that the area of the exposed brain will be able to accommodate the size of your implant cannula.",
    "After dura has been resected from all craniotomies, gently rinse the skull with saline to get rid of any debris.\nDry the exposed skull completely but keep the surface of the brain hydrated with sterile saline until implant.\nDrive implantation (Figure 3[href=https://www.wicell.org#fig3]B).\nMount the drive onto a stereotaxic holder with an EIB connector.\nPosition the drive such that the targeting cannulae are above the implant sites.\nPosition the microscope so the cannulae can be visualized contacting the brain surface.\nUsing a rolled piece of a Kimwipe, wick away excess moisture in the craniotomies.\nSlowly lower the drive until contact with the surface of the brain and advance until the brain slightly dimples at all implant locations.\nFill the craniotomies with a small amount of Kwik-Cast and let set.\nCritical: Do not allow any Kwik-Cast flow under the implant cannulae.\nMix a batch of Metabond, and when it is moderately thick, apply it to the exposed skull. This ensures a strong bond to the skull on the ipsilateral side of the implant.\nUsing regular dental cement, bond the drive to the base Metabond layer. This will most likely take a few batches of cement, as the cement tends to dry quickly.\nShape the dental cement to match the margins of the incision as accurately as possible.\nDrill away any sharp cement edges with the dental drill to prevent irritation.\nOnce the dental cement has set, plug in the ground screw wire to the drive and test connectivity between the exposed ground screw and the ground pin on the EIB with a multimeter.\nConfirm connectivity and thoroughly dental cement the ground wire and connector in place.\nFinishing steps.\nAfter the drive has been implanted, remove the bulldog sereffines and carefully cut off any dead tissue caused by the clamps.",
    "Rinse the tissue around the drive with sterile saline to clear out any debris.\nInject 0.2 mL of lidocaine at multiple sites in the tissue surrounding the implant.\nGenerously apply antibiotic ointment to exposed tissue.\nIf necessary, suture up the skin both anterior and posterior to the implant.\nNote: Make sure the skin is not too tight around the implant after suturing. This may cause irritation. The skin should sit loosely around the implant but should be snug enough, so no underlying tissue is exposed (Figure 3[href=https://www.wicell.org#fig3]B).\nApply a small amount of vetbond to the sutured areas.\nNote: Vetbond has a low viscosity so it may flow out of the tube quickly. Take care not to apply too much to prevent irritation.\nInitial tetrode adjustments.\nUsing the appropriate turn tool, advance each tetrode down ∼1 mm into the brain while the animal is still under isoflurane.\nNote: If surgery takes over 6 h, it may be safer to perform initial adjustments after the animal has woken up from anesthesia. Extended periods on isoflurane may lead to negative post-surgery outcomes.\nAttach the headstage (optional) and cap for the drive cone and remove animal from the stereotax.\nAdd a couple drops of otic solution (Patterson Veterinary, Cat# 07-869-0640) to each ear to help with inflammation from the ear bars.\nWhen the animal starts waking up, give a subcutaneous injection of buprenorphine ER (1.2 mg/kg) for analgesia and monitor for a couple hours.\nFollow any approved post-operative procedures.\nNote: If approved, post-operative medication (e.g., Baytril, penicillin, topical lidocaine, etc.) may be helpful during recovery.\nAnimal recovery, tetrode adjustments, and re-training\nTiming: 2–3 weeks\nThese post-surgery steps describe the procedures for animal monitoring during recovery, tetrode advancement to regions of interest, and re-training prior to experiments.\nMonitor the animal’s health after surgery.",
    "Note: The first few days of recovery post-surgery are the most important.\nClosely monitor the amount of water consumed on the days following surgery. The implant may impede the animal’s ability to access water, so adjustment to the location of the water spout may have to be made.\nNote: Animals will likely have difficulty lifting their head after surgery, so it may be necessary to drill holes in the cage to provide access to a lower, angled water spout.\nIf the animal is showing signs of dehydration, (i.e., blood in the urine and decrease in skin turgor), give 5–10 mL of ringers solution subcutaneously as needed.\nMonitor the animal’s weight and food intake daily.\nNote: It is expected that the animal will lose weight after any major surgical procedure. To encourage the animals to eat, it may be necessary to break up food pellets and/or treats into more manageable pieces. The animal’s weight should stabilize 7–10 days post-surgery.\nTetrode adjustments (Figure 4[href=https://www.wicell.org#fig4]).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2913-Fig4.jpg\nFigure 4. Electrophysiological signatures of dorsal CA1\n(A) Example coronal brain slice illustrating the regions of dorsal CA1. Note that the overlying “cortex” label is not the recording location for the PFC traces shown in B and C (PFC recording location not shown. See Figure 6[href=https://www.wicell.org#fig6]B for example recording locations).\n(B) Example LFP traces during immobility showing the range of ripple magnitudes as well as differences in the sharp-wave polarity across dorsal CA1 layers for an example ripple event (CC – corpus callosum, SO – stratum oriens, SP – stratum pyramidale, SR – stratum radiatum).\n(C) Example LFP traces during active behavior. Note the prominent theta band activity (8–12 Hz fluctuations) on the CA1 electrodes.",
    "Tetrode adjustments should be made every day to keep tetrodes mobile, but in our experience, electrodes can be advanced every other day, if desired, without issue.\nPFC adjustments.\nPFC is targeted primarily based on depth (∼3.5–4.5 mm from brain surface).\nNote: To our knowledge, there are no audiovisual detectable electrophysiological markers that delineate regions of PFC (Figures 4[href=https://www.wicell.org#fig4]B and 4C, blue traces).\nDaily adjustments can range from 50–500 μM, depending on distance from desired recoding location and cell quality.\nPick a tetrode to use as a reference and pull it back ∼500 μM relative to the others.\nDorsal CA1 adjustments.\nDuring the first week post-surgery, adjust tetrodes down ∼300 μM every other day (or ∼150 μM daily).\nNote: Depending on the quality of the implant site (i.e., bleeding, swelling, etc.), there may be residual swelling that could cause significant electrode drift during the first week post-surgery. Do not advance tetrodes too aggressively.\nAt the beginning of week 2, slowly take down a tetrode that will be used as a reference to gauge the depth of the CA1 layer.\nOnce the layer has been reached, record the depth, and pull the tetrode back ∼500 μM into corpus callosum to use as a reference electrode.\nNote: Incremental advancement toward the pyramidal cell layer of CA1 can be estimated by the magnitude of ripple oscillations and theta modulation, as well as the polarity of sharp-waves in the hippocampal local field potential4[href=https://www.wicell.org#bib4] (Figures 4[href=https://www.wicell.org#fig4]B and 4C).\nNote: Ripple magnitude and theta modulation can be estimated using a studio monitor.\nNote: Referencing other electrodes to the electrode in corpus callosum will exclude high frequency noise due to animal movements, which allows for more accurate estimation of ripple magnitude while advancing tetrodes.",
    "Leading up to the experiment, slowly (∼50–100 μM/day) advance tetrodes and listen for the physiological markers mentioned above (Figures 4[href=https://www.wicell.org#fig4]B and 4C).\nWhen large amplitude ripples and near spiking activity is observed on your tetrodes, micro-adjust tetrodes (∼10–50 μM/day) until clusters can be resolved.\nWhen the regions of interest have been reached and recordings are deemed acceptable, the experiment can begin.\nNote: Ideally, the majority of CA1 tetrodes will land in the pyramidal cell layer (SP, Figure 4[href=https://www.wicell.org#fig4]A).\nLinear track re-training.\nLinear track re-training is a necessary step prior to the single day W-Track and novel-familiar experiments and should be started ∼2 weeks post-surgery.\nNote: Linear track re-training should take place concurrently with tetrode adjustments.\nAfter the animal’s weight has stabilized, food restrict the animal according to an approved protocol.\nAfter ∼1 week of food restriction, reintroduce the animal to the linear track in the same room as initial linear track training. This room will be used as the familiar environment for downstream experiments.\nTrain the animal (20-min sessions) until a reward receipt rate of 3 rewards per minute is reached.\nNote: Retraining may take a few days as the animal adjusts to running with the implanted microdrive. If retraining exceeds one week, it may be necessary to begin the experiments due to eventual deterioration of recording quality and implant stability.\nNote: Performing tetrode adjustments after daily re-training sessions may be advantageous, since the animal is not as active after running.\nOnce acceptable performance has been reached, the following experiments can begin.\nNote: At this point, both recording quality and behavior should be satisfactory.\nSingle day W-Track learning\nTiming: 6–8 h",
    "This step explains the procedures for performing the single day W-Track learning experiment, allowing for longitudinal recording of CA1 and PFC ensembles over the course of learning a novel spatial learning task.2[href=https://www.wicell.org#bib2]\nCheck the quality of the recordings (i.e., unit yield) to determine whether to begin experiment.\nNote: If additional adjustments must be made, wait ∼6 h for tetrodes to stabilize before starting the single day experiment. Alternatively, the experiment can be postponed to a subsequent day.\nSetup the W-Track in the familiar room where linear track pre-training took place.\nRun eight W-Track sessions, interleaved with 9 sleep sessions (Figure 5[href=https://www.wicell.org#fig5]A).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2913-Fig5.jpg\nFigure 5. Single day and novel-familiar experimental setup\n(A) Behavioral paradigm for the single day W-Track experiment (de novo learning).\n(B) Behavioral paradigm for the novel-familiar experiment.\n(C) Room layout for novel and familiar environments. Note the visible cue cards on the walls to maximally differentiate the novel and familiar environments.\nNote: Sleep sessions may be extended if the animals’ behavior on the track deteriorates (i.e., immobile for minutes at a time). Generally, the session duration can be doubled, but avoid sessions >60 min. Keep in mind that longer sessions may increase the magnitude of electrode drift, which will affect the ability to track units over behavioral sessions.\nCritical: Do not change reward type or amount in the middle of the experiment. Changes in reward alters neural activity, which may affect interpretation of downstream results.5[href=https://www.wicell.org#bib5]\nNovel-familiar-novel experiment\nTiming: 1–2 days\nThis step explains the procedures for performing the novel-familiar experiment, allowing for characterization of CA1 and PFC ensembles across separate experiences.1[href=https://www.wicell.org#bib1]\nCheck recordings and make tetrode adjustments if necessary.\nSetup the second W-Track in a different experimental room (novel, Figure 5[href=https://www.wicell.org#fig5]C).",
    "Note: The sleep box and reward wells were kept consistent throughout both the single day and novel-familiar experiments.\nCover any empty wall space with black kraft paper and decorate with salient distal cues (i.e., shapes made with colored tape, etc.).\nPerform the novel-familiar experiment as laid out in Figure 5[href=https://www.wicell.org#fig5]B.\nNote: Quickly transfer the animal between rooms to preserve recording continuity.\nDrive recovery and histology\nTiming: 1 week\nThis section explains the procedures for drive recovery and histological verification of electrode placement after all experiments have been completed.\nElectrolytic lesions and perfusion.\nPut the animal in a warmed 7 L induction chamber and flow in 5% isoflurane at 2 L/min.\nAfter a breath rate of 60 bpm is reached, transfer the animal to the stereotactic nose cone and set the isoflurane to 2%.\nConnect the black terminal of the current generator to the Gnd pin on the EIB.\nConnect the red terminal to a wire with a pin soldered at the end.\nSet the output on the current generator to red.\nSet the current to 30 μA.\nTouch each gold pin on the EIB for ∼1–2 s to lesion each site.\nCritical: Do not send too much current down any electrode. This may cause overlapping of lesions, which can be problematic if precise reconstruction of electrode tip locations is required.\nAfter ∼24 h, place the animal in a 7 L induction box at 5% isoflurane.\nWhen a breath rate of 60 bpm is reached, inject an appropriate dose of Beuthanasia-D (Patterson Veterinary, Cat#:07-807-3963) intraperitonially.\nOnce deeply anesthetized, intracardially perfuse with 0.9% saline followed by 3.7% formaldehyde.\nRemove the head with the drive still attached and strip away all tissue, leaving only the skull.\nSubmerge the entire skull in 3.7% formaldehyde overnight.",
    "Note: Letting the skull sit in formaldehyde overnight helps with downstream tetrode track visualization.\nIn a hood, dry off the skull and retract all tetrodes to their top positions.\nExtract the brain from the skull (Figure 6[href=https://www.wicell.org#fig6]A) and store in a 30% sucrose and 3.7% formaldehyde solution in the fridge.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2913-Fig6.jpg\nFigure 6. Drive recovery and histological verification of electrode tips\n(A) Rat skull attached to a microdrive after tetrode retraction, brain extraction, and cleaning in Metrizyme.\n(B) Examples of Nissl stained CA1 and PFC slices. Note the lesions indicated by the red arrows.\nSubmerge the recovered drive in a Metrizyme solution (VWR, Cat#89132-869) for 24–48 h to clean.\nCritical: Submerging immediately in a Metrizyme solution prevents clogging of 30 Ga tubes and makes clearing debris out much easier.\nRecover shuttles and clean 23 Ga tubes and threaded rods in acetone for 24 h.\nNote: Shuttles for the 32-tetrode drive can be reused if the dental cement is intact.\nNote: Carefully unscrew the threaded rods from the drive to retain the threads in the body.\nReam out 30 Ga tubes in the drive body with 5.5 m wire.\nRemove the residual skull, EIB, and ground wire.\nShave down excess dental cement.\nNote: As long as the dental cement is intact and the 30 Ga tubes are not bent or clogged, drive bodies can be expected to be reused ∼5–6 times.\nNote: The drive body can now be reloaded with shuttles and tetrodes for a subsequent experiment.\nNote: The shuttles of the 64-tetrode drive will have to be remade due to their fragility.\nBrain slicing and Nissl staining.\nUsing a microtome, collect 50 μM thick slices around the regions of interest and store in 1× PBS filled 48 well plates.",
    "Note: If using a freezing microtome, cover brain in OCT and let it freeze sufficiently before slicing.\nMount slices on gelatin coated slides and thoroughly dry in a hood for 2–3 days.\nCritical: Insufficient drying may cause slices to fall off the slides during staining.\nNissl stain the slices in a hood using the following protocol:\nXylene – 5 min.\n100% ethanol – 3 min.\n70% ethanol – 3 min.\n50% ethanol – 3 min.\nd2H2O – 1 min.\nCresyl violet (CV6[href=https://www.wicell.org#bib6]) – 3.5 min.\nNote: Recipe for cresyl violet solution can be found in reference above.\nd2H2O – Quick rinse.\nCV differentiator – 45 s.\nNote: CV differentiator can be made by mixing 5 mL of glacial acetic acid in 500 mL of 70% ethanol.\nd2H2O – Quick rinse followed by 1 min.\n50% ethanol – 1 min.\n70% ethanol – 2 min.\n95% ethanol – 1 min.\n100% ethanol – 1 min.\nXylene – 5 min.\nNote: The above is a general protocol that may have to be altered based on individual needs. Example stained slices using this protocol can be seen in previous publications.1[href=https://www.wicell.org#bib1],2[href=https://www.wicell.org#bib2],7[href=https://www.wicell.org#bib7]\nNote: Keep in mind that slices will continue to lighten during the dehydration steps (x–xiv) after the CV differentiator wash.\nMount a coverslip with Permount or DPX mounting media directly from the xylene wash.\nCritical: Do not allow slices to dry out in between the xylene wash and mounting. This will cause significant cracking and result in poor visualization of electrolytic sites.\nAfter mounting media sufficiently dries, seal the edges of the coverslip with nail polish to prevent bubbles from forming.\nImage slices using a brightfield microscope at 4 or 10× and stitch together to generate a composite for each slice.\nReconstruct electrode positions using composite images (Figure 6[href=https://www.wicell.org#fig6]B).",
    "Data processing, spike clustering, and single-trial linearized firing rates\nTiming: 1–2 weeks\nThis section provides a general overview of the steps required to pre-process the acquired data in preparation for manifold visualization.\nPosition tracking the animals’ behavior.\nNote: Here, position was semi-manually tracked using the cameraModule software (SpikeGadgets).\nAfter position tracking in 2D, generate linearized position for each of the 4 trajectories (Figure 7[href=https://www.wicell.org#fig7]C).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2913-Fig7.jpg\nFigure 7. Spike sorting, position linearization, and pseudo-population matrices\n(A) Example spike clusters in CA1 across novel and familiar environments. Note the purple cell that is only active in the familiar environment.\n(B) Same is in (A) but for PFC.\n(C) Linearization of animals’ position into 4 separate trajectories.\n(D) Example linearized firing fields for CA1 (top) and PFC (bottom).\n(E) Schematic showing the construction of the n-dimensional pseudo-population matrix and trajectory labels. Note that the example compiled matrix only shows three trials of one trajectory type.\nNote: Track linearization can be accomplished using publicly available code. (https://github.com/LorenFrankLab/track_linearization[href=https://github.com/LorenFrankLab/track_linearization]).\nSpike sorting.\nNote: Here, all single units were manually clustered using matclust (Figure 7[href=https://www.wicell.org#fig7]A). (https://bitbucket.org/mkarlsso/matclust/src/master/[href=https://bitbucket.org/mkarlsso/matclust/src/master/]).\nFor both experimental paradigms, track as many cells throughout the entire duration of the experiment.\nNote: Tracking across the single day experiment allows for characterization of defined hippocampal-prefrontal populations over the course of learning.\nNote: Clustering CA1 neurons over the novel-familiar experiment will result in different cells being active across experiences (ex. purple cell in Figure 7[href=https://www.wicell.org#fig7]A), which is expected due to remapping.8[href=https://www.wicell.org#bib8],9[href=https://www.wicell.org#bib9],10[href=https://www.wicell.org#bib10]\nGenerate linearized place fields (Figure 7[href=https://www.wicell.org#fig7]D).\nFor each cell, generate occupancy normalized firing fields on a trial-by-trial basis for each trajectory at 1 cm spatial resolution.\nCompile CA1 and PFC pseudo-population matrices for all trajectories and epochs as well as trajectory labels at each position (Figure 7[href=https://www.wicell.org#fig7]E).",
    "Note: Example code for steps 37 and 38 can be found at http://github.com/JadhavLab/GeometricTransformationProtocol[href=http://github.com/JadhavLab/GeometricTransformationProtocol] in the “ExampleCode” folder.\nNote: The trajectory label example in Figure 7[href=https://www.wicell.org#fig7]E is a schematic and only displays labels for one trajectory.\nNote: The length of the trajectory label column vector should match the number of rows in the pseudo-population spike matrix.\nGeometric transformation of cognitive maps\nTiming: 1–2 h\nThis step takes the pseudo-population activity matrices generated above and plots the low dimensional embeddings for each trajectory using UMAP.11[href=https://www.wicell.org#bib11]\nDownload the MATLAB UMAP toolbox and add to path. (https://www.mathworks.com/matlabcentral/fileexchange/71902-uniform-manifold-approximation-and-projection-umap[href=https://www.mathworks.com/matlabcentral/fileexchange/71902-uniform-manifold-approximation-and-projection-umap]).\nRun the following code snippet to obtain low dimensional embeddings of either CA1 or PFC populations for all trajectories from a novel epoch. This code will also save a “template file” that is used to project population activity from the familiar environment using the novel environment embeddings (Figure 8[href=https://www.wicell.org#fig8], left).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2913-Fig8.jpg\nFigure 8. Geometric transformation of cognitive maps\n(A) Low dimensional representation of CA1 activity during the second exposure to the novel environment (left). Familiar environment activity projected into the latent space constructed based on novel environment activity (right).\n(B) Same as in (A) but for PFC.\n>spike_umap = run_umap(spike_matrix_novel, 'min_dist', 0.6, 'n_neighbors', 50, 'metric', 'cosine', 'n_components', 3, 'save_template_file', 'all_umap_trials_novel.mat')\nNote: The ‘spike_umap’ output file will have the same number of rows as the input ‘spike_matrix’ file.\nNote: The hyperparameters used here are similar to previous studies.12[href=https://www.wicell.org#bib12],13[href=https://www.wicell.org#bib13]\nUsing the saved “template file”, which contains the novel UMAP object, project familiar environment population activity to visualize transformation of CA1 or PFC maps across the novel and familiar experiences (Figure 8[href=https://www.wicell.org#fig8], right).\n>spike_umap = run_umap(spike_matrix_familiar, 'min_dist', 0.6, 'n_neighbors', 50, 'metric', 'cosine', 'n_components', 3, 'template_file', 'all_umap_trials_novel.mat')\nTo plot, assign colormaps to the different trajectories and align trajectories from start to end.\n>traj1 = inferno(length(pos_interp))\n>traj2 = parula(length(pos_interp))\n>traj3 = viridis(length(pos_interp))",
    ">traj4 = plasma(length(pos_interp))\n>traj_colormap = [traj1;traj2(end:-1:1,:);traj3;traj4(end:-1:1,:)]\nPlot the data in ‘spike_umap’ in 3D and assign temporary colors using the trajectory label information in ‘spike_matrix_label’.\nLastly, color data points according to trajectory and position using the compiled colormap.\n>scatter3(spike_umap(:,1),spike_umap(:,2),spike_umap(:,3),30∗ones(size(spike_matrix_label)),spike_matrix_label,'filled')\n>colormap(traj_colormap)\nNote: Detailed code for additional analyses can be found on GitHub (http://github.com/JadhavLab/GeometricTransformation[href=http://github.com/JadhavLab/GeometricTransformation])."
  ],
  "subjectAreas": [
    "Neuroscience",
    "Behavior",
    "Cognitive Neuroscience"
  ],
  "bigAreas": [
    "Biomedical & Clinical Research",
    "Ecology & Environmental Biology"
  ]
}