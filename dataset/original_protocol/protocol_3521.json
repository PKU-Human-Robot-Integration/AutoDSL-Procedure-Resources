{
  "id": 3723,
  "origin_website": "Cell",
  "title": "Protocol for hit-to-lead optimization of compounds by auto in silico ligand directing evolution (AILDE) approach",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nA fragment library construction\nTiming: ∼3 h\nCreate the three-dimensional structures of all fragments by Chimera software (Figure 3[href=https://www.wicell.org#fig3]). The fragments are used to link with the hit compound to generate the hit analogs (Hoffer et al., 2018[href=https://www.wicell.org#bib3]). All the hydrogen atoms should be deleted in the fragment molecules, except the hydrogen atoms located at the linking point.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/443-Fig3.jpg\nFigure 3. Construction of stereoscopic conformation of a fragment molecule\nThe Build Structure module in Chimera provides several ways to manipulate a molecular structure. This snapshot shows the procedure for building a benzene molecule.\nDue to the fixed format of a PDB file, it is easy to do these by the scripts in batch mode. We can delete all the hydrogen atoms in a PDB file except the linking point of a hydrogen atom (serial number: id) by a line of bash command:\nawk '{if ($NF == \"H\" && $2 != id) {} else {print}}' fragment_H.pdb > fragment_noH.pdb\nwhere id is the serial number of a hydrogen atom as the linking point, fragment_H.pdb is the pdb file of a fragment molecule with all hydrogen atoms, fragment_noH.pdb is the fragment molecule with only a hydrogen atom.\nFor a large number of fragments, we just need to use the loop function to deal with each individual repeatedly:\nfor i in $(ls ∗.pdb)\ndo\nfragname=$(basename ${i} .pdb)\nfor j in $( awk '{if ($NF == \"H\") {print $2}}' ${i})\ndo\nawk '{if ($NF == \"H\" && $2 != “‘${j}’”) {} else {print}}' ${i} > ${fragname}_${j}.pdb\ndone\ndone\nWe can save the above bash codes in a text file (for example: a file named del_H.sh) in the same directory as the fragment PDB files. And run the scripts by type the following in the command line:\nbash del_H.sh",
    "The processed PDB files of fragments are generated in the directory.\nPerform the conformational optimization on the fragment molecules by Chimera software.\nSave the structure files of those processed fragment molecules in PDB format.\nNote: The fragment molecules can be download from public fragment databases (Irwin and Shoichet, 2005[href=https://www.wicell.org#bib4]; Visini et al., 2017[href=https://www.wicell.org#bib9]; Yang et al., 2018[href=https://www.wicell.org#bib12]). The related website links are available in the key resources table[href=https://www.wicell.org#key-resources-table].\nPreparing input parameter data\nTiming: ∼5 min\nPrepare an input parameter file, in which all the parameters for AILDE calculation are contained.\nCreate a parameter file which contains all the necessary parameters for AILDE protocol (Figure 4[href=https://www.wicell.org#fig4]). Mandatory parameters are “step,” “complex,” “ligand_name,” “ligand_charge,” “parallel,” “MDstart,” “MDend,” “mm_pbsa,” “md_request,” and “entropy.” Each parameter has a default value.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/443-Fig4.jpg\nFigure 4. Preparing the input parameter file\n(A) The snapshot of webpage for downloading the example parameter file at https://github.com/fwangccnu/AILDE[href=https://github.com/fwangccnu/AILDE].\n(B) The content in the example parameter file.\nAn example parameter file is provided in the AILDE source code (Figure 4[href=https://www.wicell.org#fig4]). A standard format must be followed to define the parameters. Among those parameters, the following three parameters should be adjusted according to actual situation:\ncomplex: define the structure file name of the protein complex with hit ligand.\nligand_name: define the name of the hit ligand in the complex structure file.\nmd_request: define whether structural relaxation is performed on the newly obtained hit analogs-protein complex by molecular dynamics (MD) simulation.\nOther parameters can be maintained as default value and the detail descriptions about these parameters are recorded in the template parameter file (Troubleshooting 1[href=https://www.wicell.org#sec6.1]).\nCritical: The parameters should be accordant with the actual situations and abide by the format in the example parameter file.\nMolecular dynamics simulation of the protein-hit complex\nTiming: ∼3 h",
    "In this stage, conformational sampling on the protein complex with hit ligand is conducted by molecular dynamics simulation (Maximova et al., 2016[href=https://www.wicell.org#bib5]).\nThe topology and coordinate file for the solvated protein-hit complex is generated by tleap module in Amber program. Protein was parameterized by Amber ff14SB force filed and the hit compound molecule by the general Amber force field (GAFF). AM1-BCC charge was assigned for the hit compound by antechamber module in Amber. The complex system was then solvated in the cube box of the TIP3P water model with a distance of 10 Å between the solute and box. The counter-ions (Cl− or Na+) were then added to neutralize the solvated protein-hit system.\nThree cycles of energy minimization are performed on the system by sander module in Amber program. Each cycle includes 5,000 steps of steepest descent, followed by 5,000 steps of conjugated gradient minimization with a final convergence criterion of 0.2 kcal∙mol−1. The following shows a brief description about three cycles of energy minimization:\nCycle 1: the heavy atoms in protein and hit compound are restrained with an elastic constant of 50 kcal∙mol−1∙Å−2. The water molecules, ions, and hydrogen atoms are allowed to move for relaxation.\nCycle 2: protein side-chains are also allowed to relax in this step. Only the heavy atoms in the backbone of the protein are restrained with an elastic constant of 50 kcal∙mol−1∙Å−2.\nCycle 3: the whole system is minimized.\nMolecular dynamics simulation is then performed on the protein-hit complex with the periodic boundary condition in the NPT ensemble. The detail steps are described as the following:\nThe solvated system is heated gradually from 0 to 298 K in the NVT ensemble during a period of 500 ps.\nThe heated system is equilibrated in the NPT ensemble during a period of 1 ns.",
    "Production simulation at the temperature of 298 K and the pressure of 1 atm. The SHAKE algorithm is used to constrain all covalent bonds involving hydrogens. The particle mesh Ewald (PME) algorithm is used to calculate long-range electrostatic interactions and the short-range van der Waals (vdW) interactions is handled with a cutoff distance of 10 Å. The integration of the equations of motion is conducted at a time step of 2 fs. Finally, 1 ns production simulation is performed and the structure snapshots are collected every 1 ps (Troubleshooting 2[href=https://www.wicell.org#sec6.3]).\nThe fluctuations of the protein and hit compound are measured by root-mean-square deviations (RMSD) against their initial structures. The stability of the MD simulation is reflected by their RMSD values, which reveal the conformational changes during the time period of MD simulation. A plateau RMSD value means that the protein-hit complex is in the equilibration state, and that the simulation moves toward the stability status.\nCollecting the conformational ensemble of protein-hit complex\nTiming: ∼10 min\nAfter the molecular dynamics simulation, we collected the representative conformations from the equilibrated simulation trajectories. Consideration of structural flexibility has an effect on the accuracy of binding free energy calculation. Predicting free energy changes using structural ensembles has better performance than that using static structures (Benedix et al., 2009[href=https://www.wicell.org#bib1]).\n50 snapshots are extracted from the last 1 ns simulation trajectory by the cpptraj module in Amber program.\nFragment growing to generate the hit analogs\nTiming: ∼1 h\nIn this stage, AILDE generates hit analogs by linking the fragment molecules with the hit ligand in the initial protein complex (Figure 5[href=https://www.wicell.org#fig5]).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/443-Fig5.jpg\nFigure 5. Lead compounds generation by fragment growing strategy\nThis illustrates the process of converting a hit compound to a lead compound by fragment linking with the former.",
    "All fragment molecules in our fragment library are linked with the hit ligand by AutoGrow software.\nThe generated compounds with the protein are saved as protein-analogs complexes. The complex structures are relaxed by energy minimization via one of the following two strategies:\nWhen the parameter “md_request” is set to “NO,” structural relaxation without molecular dynamics simulation will be performed. First, all the backbone atoms of protein and the ligand are restrained with an elastic constant of 50 kcal∙mol−1∙Å−2. Then the whole system is minimized. Each of the two minimization steps includes 5,000 cycles of steepest descent and 5,000 cycles of conjugated gradient optimization with a convergence criterion of 0.2 kcal∙mol−1.\nWhen the parameter “md_request” is set to “YES,” structural relaxation with molecular dynamics simulation will be performed. The above two cycles of energy minimizations is performed. Then a short period of MD simulation is performed to relax the side-chain atoms.\nAll the structure snapshots of protein-hit complex are relaxed by the same strategy as mentioned above (Troubleshooting 3[href=https://www.wicell.org#sec6.5]).\nNote: In our previous study (Wu et al., 2020[href=https://www.wicell.org#bib11]), structural relaxation with molecular dynamics simulation may provide more accurate binding free energy results, but at the cost of more computing resources.\nPredicting free energy changes for binding affinities\nTiming: ∼2 h\nIn this stage, we calculate the binding affinity (ΔGbind) of protein-hit and protein-analogs complexes, then compare the differences of binding free energy change (ΔΔG) between protein-hit and protein-analogs complexes.",
    "The binding affinity ΔGbind can be decomposed into three main energy terms, including the molecular mechanical gas-phase interaction energy (ΔEMM), desolvation energy (ΔGsol) and the change of conformational entropy (–TΔS). ΔEMM and ΔGsol are calculated by the MMPBSA module in Amber program. –TΔS is calculated using our in-house scripts. The entropy contribution is temperature-dependent and can be divided to two contributions: solvation entropy (ΔSsolv) and conformational entropy (ΔSconf). The solvation entropy consists of the apolar and polar solvation entropy, which is typically given by an empirical formula that is proportional to the apolar and polar solvent accessible surface area differences. We use the molsurf and surf modules in Amber program to calculate the solvent accessible surface area. The conformational entropy is related to the change of the number of rotatable bonds during the binding process. The change of the conformational entropy is proportional to the number of the lost rotatable bonds during the binding process. The conf module in Amber is used to calculate the number of the rotatable bonds. More details can be found in the previous work (Pan et al., 2008[href=https://www.wicell.org#bib7]). The binding affinity ΔGbind for a complex is the average value of 50 structural snapshots.\nThe binding affinity differences ΔΔG between the protein-hit and protein-analogs complexes are then obtained as ΔΔG = ΔGbind (Analogs) – ΔGbind (Hit)."
  ],
  "subjectAreas": [
    "Structural Biology",
    "Protein Biochemistry",
    "Bioinformatics"
  ],
  "bigAreas": [
    "Molecular Biology & Genetics",
    "Bioinformatics & Computational Biology"
  ]
}