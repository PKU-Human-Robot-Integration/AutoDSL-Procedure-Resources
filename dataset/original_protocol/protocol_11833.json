{
  "id": 13233,
  "origin_website": "Jove",
  "title": "Combining Multiple Data Acquisition Systems to Study Corticospinal Output and Multi-segment Biomechanics",
  "procedures": [
    "NOTE: The following protocol can be applied to a variety of experiments. Below are details regarding an experiment that involves a visually guided arm reaching task to one of six spatial targets displayed on a computer monitor. TMS, to probe corticospinal excitability, is triggered by either analog signals emerging from the movement (i.e., EMG or electrogoniometer input) or digital signals generated from the sweep-based data acquisition software. This study was approved by the McMaster Research Ethics Board in accordance with the Declaration of Helsinki. A sample dataset is provided.\n1. Hardware/software Requirements\nNOTE: Figure 1 displays a schematic of the hardware requirements to integrate TMS and motion capture systems in the context of a computer-controlled visuo-motor experiment.\nEquip two desktop computers with serial and parallel ports (if not already available). Equip PC 1 (Figure 1) with sweep-based data acquisition software, and PC 2 with a visual stimulus delivery software program.\nSoftware Operations\nInternal Analog/Digital Box (A/D box) Operations\n\t\tNOTE: The following operations provide information to readers if they would like to create a similar software program themselves. These steps are not essential to performing the experiment, as the experiment can simply use the software provided by the authors, but guidelines are provided to allow users to create their own software.\n\t\t\nCreate a sequencer file within the sweep-based data acquisition software (see 'sequencer file' example (in Supplementary Information 2) to be executed on PC 1.\n\t\t\tNOTE: An example of the operations to create a sequencer file using the sweep-based data acquisition software in this experiment can be found at http://ced.co.uk/products/signal#script.",
    "NOTE: This file acts to provide all of the precise timing required as the sequence executes in parallel with the actual data acquisition and allows flexibility along with synchronous timing of external triggers. Changes in external trigger criteria can be performed in the configuration dialog box that is brought up when running the script (see \"Experimental trials\" section for more details and \"Sequencer File\" screen shot).\nCreate separate subroutines within the sequencer file to control the auditory cue generation and the TMS trigger criteria. Have one subroutine control the auditory cue based on inputs from the visual stimulus display software. Also, have one subroutine control the TMS triggering based on inputs from an analog input to the A/D box.\n\t\t\tNOTE: An example of how separate subroutines are contained within a sequencer file is provided in the Supplementary Information (script and sequencer file). Refer to 1.2.1.1 for additional website support specific to the software system used in this demonstration. This set-up allows auditory cue generation to occur in parallel with testing for the TMS trigger criteria.\nCreate lines of code in the sequencer file that calls the subroutines (described in 1.2.1.2). Have each subroutine function such that it wait for the arrival of inputs from their sources (i.e., visual stimulus display software for auditory cue and analog input for TMS trigger).\nConnection and communication between the electromagnetic motion capture system to sweep-based data acquisition software",
    "To get the electromagnetic motion capture system to continuously generate data, generate lines of code in the script file of the sweep-based data acquisition software to output a number of commands to the electromagnetic motion capture via the serial connection (these commands should be found in the electromagnetic motion capture system's manual). These commands are found in the downloadable script file (script_file.sgs, see lines 88 to 114 and 635 to 650).\nCreate lines of code to have the script file add the motion capture data to each trial sweep. Next, have the script pass the motion capture data via a serial connection from PC 1 to the visual stimulus delivery software (PC 2) to control the crosshair cursor position on the monitor of PC 2.\n\t\t\tNOTE: This sequence of events allows for the electromagnetic motion capture to generate ASCII data continuously, and the data are then read from the serial line.\nAt the end of an experiment, create lines of code to have the script file send commands to turn off the electromagnetic motion capture system data output. To do so, have the sweep-based data acquisition software send out lines of text holding a sensor number followed by six co-ordinate values (see script_file.sgs for the command codes used for this demonstration, specifically lines 88 to 114 and 653 to 658).\n\t\t\tNOTE: Further information about these commands are also found on the electromagnetic motion capture system website (section 1.2.1.1).\n\t\t\tNOTE: Before extracting the numerical values, have the string \"sanitized\" because if the coordinate was negative, it might not be separated from the previous number by any space characters.\nSweep-based data acquisition software to visual stimulus delivery software communication\nSet-up three separate channels of communication between the sweep-based data acquisition software and the visual stimulus delivery software.",
    "Set-up two serial lines used to carry text data in both directions between PC 1 and PC 2. To do so, connect a serial cable between PC 1 and PC 2 (each serial line being unidirectional between each PC, Figure 1).\nConnect PC 2 to the A/D box. To do so, create, or purchase, a cable that has an LPT port on one end and a male BNC connection on the other end. Connect the LPT port to PC 2 and connect the BNC connection to the trigger input on the A/D box.\n\t\t\tNOTE: This connection allows the line to carry a pulse generated by the LPT1 port on the visual stimulus delivery software system (i.e., PC 2, Figure 1) to the A/D box trigger input.\n\t\t\tNOTE: The TTL signal ensures precise timing of the start of the data acquisition sweep in synchrony with the visual stimulus delivery software operations, while the serial lines transferred for all other information.\n\t\t\tNOTE: Make sure to use actual PCI-Express LPT and COM port cards installed on the PC with the visual stimulus delivery software. This set-up allows the software to work successfully and it is strongly recommended. The visual stimulus delivery software communications, being carried out at a low level to avoid any delays, do not generally work reliably over the simulated LPT and COM port hardware provided by USB dongles.\nSet the trial duration values to 20 ms in the visual stimulus delivery software file, as values much shorter or longer than 20 ms causes problems. Resources on how to complete this process can be found at the following website: https://www.neurobs.com/menu_support/menu_help_resources/overview.  See lines 39 to 46 in the scenario file provided in the Supplementary documents (Presentation scenario file).",
    "NOTE: Since the visual stimulus delivery software operations are very closely tied to the picture generation, and in our experience the serial communications did not behave as expected, unless the trial duration set in the trial function was suitable (i.e., 20 ms).\nCreate communication protocols to pass information between the sweep-based data acquisition software and the visual stimulus delivery software.\n\t\t\tNOTE: Sections 1.2.3.7 to 1.2.3.11 describe how this is completed. See the provided resources in step 1.2.1.1 and 1.2.3.5 for further support for the sweep-based data acquisition software and the visual stimulus delivery software, respectively.\nFor the sweep-based data acquisition software to the visual stimulus delivery software direction, create lines of code in the sweep-based data acquisition software to send two forms of information; trial numbers to start and stop a trial, and crosshair cursor positions. Have the sweep-based data acquisition software send all information as lines of text terminated by a line feed. See lines 700 to 708 in the Signal script file of how this was completed.\nFor the visual stimulus delivery software to distinguish two types of information, set the initial character to be a 0 or a 1 followed by one or two numbers according to the type of information, with all values being separated by spaces. The visual stimulus delivery software will have no difficulty in dealing with this information. See lines 89 to 153 of the scenario file to see how this operation was completed within the visual stimulus delivery software.",
    "In the visual stimulus delivery software to sweep-based data acquisition software direction, create lines of code from the visual stimulus delivery software that outputs single integer values, from 0 to 9, to be sent to the sweep-based data acquisition software as single ASCII characters '0' to '9' followed by a line feed. See lines 82 to 87 of the scenario file to determine how this operation is completed.\nCreate lines of code within the visual stimulus delivery software to send out values of 0 and 1 to return information to the sweep-based data acquisition system regarding whether or not the participant had hit the target position. See lines 72 to 80 and 154 to 220 in the scenario file to determine how this operation is completed.\nCreate lines of code in the visual stimulus delivery software to send information regarding the end-of-trial message (i.e., whether the target was \"hit\" or not) to the sweep-based data acquisition software.See the same lines of code in the scenario file provided in step 1.2.3.10.\nSequence of Operations within a trial\nSet-up the sequence of a trial such that the execution of a trial is shared between the sweep-based data acquisition software and the visual stimulus delivery software, with the sweep-based data acquisition software being 'in charge' of the overall sequencing.\nPut the sweep-based data acquisition software in control of experiment sequencing because the sweep-based data acquisition software generates the actual data file that needs to be annotated with trial details and, therefore, less communication is required.",
    "Set-up the script such that the sequence of operations begins with the sweep-based data acquisition software selecting the next trial settings (target position & TMS trigger type). See lines 335 to 345, and corresponding loops described within these lines, in the script file to understand how to complete these operations.\n\t\t\tNOTE: The loops are also contained within the script file.\nNext, have the sweep-based data acquisition software set parameters in the A/D box controlling the TMS trigger type and other aspects of the trial. To do so, have the sweep-based data acquisition software initiate data collection such that the A/D box is waiting for a sweep trigger from the visual stimulus delivery software, and notifies the visual stimulus delivery software over the serial line of the target number (1 to 7) used, which causes the visual stimulus delivery software to start a trial (i.e., via the TTL pulse). See lines 180 to 303 of the signal script to understand how to complete this operation.\nAfter completing the aforementioned step, have the sweep-based data acquisition software wait for completion of the collection of a sweep of data by the A/D box, and append any position data it receives from the electromagnetic motion capture system to the sampled data. See lines 117 to 178 and 661 to 697 of the script file for information on how to complete this operation.\nSet-up the visual stimulus delivery software to monitor the subject-controlled crosshair cursor position. Set-up the visual stimulus delivery software to move the target to the specified position and generate a TTL pulse on LPT1 port after the cursor is within the home position for a specified period of time (defined in the visual stimulus delivery software). See lines 89 to 232 in the scenario file of how to complete this step.",
    "Create lines of code that makes the visual stimulus delivery software send a TTL pulse to trigger the A/D box data acquisition and, thereby, start the trial timing inside the A/D box. See lines 222 to 232 of the scenario file on how to complete this step.\nAt the same time, have the visual stimulus delivery software scenario file begin a delay after which it will move the target to the specified position and begin monitoring the crosshair cursor to watch for it 'hitting' the target (i.e., remaining on target for a specified period). Set-up the visual stimulus delivery software such that it continues this monitoring of crosshair cursor position until the sweep-based data acquisition software informs the visual stimulus delivery software of trial completion.\n\t\t\tNOTE: These operations are on the same line of code in the scenario file provided in steps 1.2.4.6 and 1.2.4.7.\nInside the A/D box, create a time delay. For a specified period, running up to the end of the delay, have the software monitor two EMG signals (NOTE: could be any analog signals) to check that they are of low amplitude (this amplitude value is user-defined). The authors recommend a EMG amplitude of +/- 100 µV or ~1% of a participants' maximum voluntary activation. See lines 45 to 75 in the sequencer file to complete this operation.",
    "Create lines of code that makes the start of this quiet EMG monitoring period marked by a A/D box-generated digital marker with code 1. Also, if a 'non-quiet' EMG signal is detected, do not allow any further A/D box outputs (e.g., beep or TMS trigger) be generated during the trial. Set up a command in the software such that if there is a 'non-quiet' EMG signal, the trial is repeated. See the lines mentioned in step 1.2.4.9 plus lines 118 to 124 of the sequencer file and lines 347 to 420 of the script file for these operations.\nAt the end of the delay, and after recording quiet EMG signals, have the A/D box generate a DAC 0 output pulse (in this set-up, the DAC output causes an audible 'beep'). Have a A/D box -generated digital data point mark the start time of the 'beep' with 'code 2' See lines 126 to 138 of the sequencer file to understand how to complete this operation.\nSet-up the script in the sweep-based data acquisition software to have the A/D box monitor the sweep time and incoming signals, and generate a TMS trigger based on the appropriate criteria. Create lines of code such that a digital 'code 3' data point marks the time of this TMS trigger (if it occurs). See lines 77 to 116 of the sequencer file to understand how to complete this operation.\nHave the wait period, for suitable trigger conditions, continue until a set period before the end of the sweep.\n\t\t\tNOTE: This prevents the trial from occurring infinitely if a criterion is not met. See lines 65 to 76 and 118 to 138 in the sequencer file to understand how to complete this operation.",
    "Set-up the sweep-based data acquisition software to detect the completion of the A/D box data collection and notify the visual stimulus delivery software that the trial is over. See lines 180 to 303 of the script file to understand how to complete this step.\nWhen the visual stimulus delivery software is notified that the trial is over, have the visual stimulus delivery software return the target to the home position and send information to the sweep-based data acquisition software regarding whether the participant 'hit' the target. Have the sweep-based data acquisition software \"tag\" the newly-sampled frame of data if the participant did not 'hit' the target,. See lines 89 to 221 of the scenario file of how to complete this operation.\nSet-up the script in the sweep-based data acquisition software to wait for a post-trial delay and at the end of this delay, have the process return to step 1 and discard the sampled data and repeating the last trial if the sweep-based data acquisition software did not trigger TMS, or move onto the next trial if all was 'OK'. See lines 180 to 303 and corresponding loops in the script file for understanding how to complete this operation.\n\t\t\tNOTE: The sweep-based data acquisition software and the visual stimulus delivery software used state machines to control the necessary sequence of operations because it allowed for easy adjustment of the experimental behaviour, as needed.",
    "Place the sensors on bony landmarks to acquire motion capture data. To collect data relating to arm posture, place sensors on the trunk (suprasternal notch), shoulder (acromion), elbow (8 mm superior to the lateral epicondyle), and wrist (between the lunate and capitate bones on the dorsum of the hand and in line with the 3rd digit), as per recommendations to track joint centers of rotation with minimal sensors.10\nimgsrc://cloudfront.jove.com/files/ftp_upload/53492/53492fig1.jpg\nFigure 1. Hardware Set-up. To allow for the electromagnetic motion capture data to be sent to the sweep-based data acquisition software and the visual stimulus delivery software, first assemble the 4 electromagnetic sensors with the system's console. Connect the system's console to the PC 1 with a 9 pin serial cable. Connect the PC 1 to the PC 2 with a 9 pin serial cable. To allow for TMS delivery, connect the PC 1 with the A/D box with a USB cable and connect a BNC cable between the A/D box and the TMS unit. To allow for EMG recording, connect the EMG leads to the EMG amp and connect the EMG amp to A/D box via BNC cables. Connect the electrogoniometer (Elgon) to the A/D box via a BNC cable to record joint angle changes online. To allow the visual stimulus delivery software to trigger the trial start, connect the PC 2 to the A/D box trigger input via an LPT port to BNC cable. Please click here to view a larger version of this figure.[href=https://www.jove.com/files/ftp_upload/53492/53492fig1large.jpg]\nHardware connectivity during the experiment (Figure 1)\nConnect the electromagnetic motion capture system to the PC running the sweep-based data acquisition software with a 9 pin serial cables.",
    "Have the data acquisition box coordinate the TMS delivery and recording of motion capture data etc. This is done by all the aforementioned operation contained in the script and sequencer files. Connect A/D box using a USB cable to PC 1 and a BNC to parallel cable from the A/D box trigger input to PC 2.\nPlug the EMG leads in to the EMG filter (band-pass set to 20 and 2,500 Hz) and amplifier (gain x1,000) for collection of EMG activity and corticospinal output measured as motor evoked potentials (MEPs).\nConnect the Monophasic Transcranial Magnetic Stimulator to the appropriate data acquisition box digital outputs (Digital output '0' in this experiment) to allow the sweep-based data acquisition software on PC1 to trigger the TMS pulses during the experiment.\nConnect an electrogoniometer to the data acquisition box on analog channel 2. This connection allows for the sweep-based data acquisition software to trigger TMS based on shoulder angle using the software provided by the authors.\nBuild or purchase an arm bracing device that supports the arm against gravity. This device allows for planar movements in the horizontal plane (see Figure 2). If building the device, an example drawing is available upon request from the corresponding author. Figure 2 displays a photo of the device used in the demonstration.\nimgsrc://cloudfront.jove.com/files/ftp_upload/53492/53492fig2.jpg\nFigure 2. Arm bracing device. Depicted is a participant placed in the arm bracing device, while a TMS coil is placed on the participant's scalp. Please click here to view a larger version of this figure.[href=https://www.jove.com/files/ftp_upload/53492/53492fig2large.jpg]\n2. Experiment Set-up\nAnthropometric Measures\nRecord the total body mass of the participant using a scale.",
    "Measure the length of all segments for the kinematic and kinetic analysis. For example, in this application with the arm, measure the length of the hand, forearm, and upper arm with a measuring tape.\nCalculate anthropometric measures, such as segment center of mass, segment center of mass location, and radius of gyration using equations from research literature. 9,12,13 (See Supplementary Information 1).\nEMG set-up\nPrepare the skin over the muscle(s) of interest with a light abrasive gel and wipe clean with alcohol. Check the impedance with an impedance meter. Ensure that the skin-electrode impedance is below 10 kΩ to enhance EMG signal acquisition.\nPlace two electrodes over the muscle belly of the muscles of interest in a bipolar montage. The authors direct the reader to resources to assist with EMG placement.2 For this experiment, place electrodes over the biceps brachii, triceps brachii, pectoralis major, posterior deltoid, and brachioradialis.\nUsing BNC cables, connect the outputs from the EMG amplifier to the analog channels 0, 1, 3, 4, and 5 (for this specific experiment, those channels related to those used in the downloadable scripts) on the A/D box.\nTMS\nCalibrate the TMS coil to the participant using a neuro-navigation software program, as described the in software's manual.\n\t\tNOTE: Other methods can be used to calibrate coil position to the person's scalp, but it is recommended to use a neuro-navigation software program.\nLocate motor hotspot. As a starting location, place the coil on the contralateral hemisphere of the arm/hand being studied and 5 cm lateral to the vertex to give an approximate location of the hand/arm area of the primary motor cortex. Locate the vertex using the International 10-20 electroencephalography electrode placement system.",
    "Place the TMS coil flat on the participant's head and orient the coil such that it is 45° in relation to the sagittal plane. This positioning will induce a latero-posterior to medio-anterior monophasic current in the cortex.\nBeginning at ~30% of the maximum stimulator output (MSO) deliver TMS pulses with an inter-stimulus interval of 6 sec or greater, as described in the sweep-based data acquisition software.\nMove the TMS coil to slightly different locations with small changes in the orientation until a MEP is observed in the muscle of interest.\nDetermine the MSO that yields MEPs of ~ 1 mV in the target muscle. Use the neuronavigation software to digitally register this location. Repeat this procedure for each muscle for which a motor hotspot is required for the experiment.\nDetermine the resting motor threshold (RMT) by starting at the intensity that produces the most reliable ~1 mV MEP in the muscle of interest, delivering single TMS pulses and recording the MEP peak to peak amplitude online.\nDetermine the MSO whereby the peak-to-peak amplitude of the MEP is ≥ 50 µV in 5 out 10 consecutive trials.3,11\n\t\tNOTE: To be consistent with previous literature,1,3 ensure that the MEP is recorded from a monopolar EMG montage.\nExperimental trials\nStart the experiment by running the visual stimulus delivery software program first (i.e., scenario file). Starting the visual stimulus delivery software program first allows for the software to start reading in the electromagnetic motion capture data and allow one motion capture sensor to control a cursor on the screen.\nRun the 'script file' for the experimental trials within the sweep-based data acquisition software. This script file reads in the 'sequencer file' that delivers external triggers based on the trial type.",
    "Input desired information in the configuration dialog box that opens. Steps, 2.4.4 to 2.4.11 all pertain to the configuration dialog box.\nEnter value \"1\" in the \"stimulus sets in randomisation block\" box. This value controls the number of times a trial type is performed in a block.\nEnter value \"20\" in the \"randomisation blocks in experiment\" box. This value controls the number of blocks that will be performed in an experiment.\nEnter value \"20\" in the \"beep pulse duration\" box. This value controls the length of time of the DAC output and therefore, how long the beep pulse is \"on\".\n\t\tNOTE: Modify this value to increase the length the auditory tone is present.\nEnter value \"5\" in the \"beep pulse amplitude\" box. This value controls the amplitude in volts of the DAC output and therefore, the \"volume\" of the beep pulse.\nEnter value \"100\" in the \"timed trigger post beep delay\" box. This value determines the interval in ms between the auditory \"go\" cue and the digital output (i.e., TMS trigger 1).\nEnter value \"0.1\" in the \"EMG trigger threshold level\" box. This value determines the amplitude of EMG in volts required to trigger the digital output (i.e., TMS trigger 2). These measures were taken on non-rectified EMG signals.\nEnter value \"0.242\" in the \"Angle trigger threshold level\" box. This value determines the threshold value in volts read from the electrogoniometer to trigger the digital output (i.e., TMS trigger 3).\n\t\tNOTE: This value depends on the calibration of the electrogoniometer. The user should input that voltage value that corresponds to a joint angle threshold that will elicit a TMS pulse.\nEnter value \"1\" (i.e., 1 sec) in the \"post-trial delay\" box. This value determines the inter trial interval.",
    "NOTE: More information about each function can be found in the script or by request from the authors.\nStart the script once everything is ready with regard to the participant, TMS, and visual stimulus display program.\nAfter this step, observe the software run on its own without any/or with minimal user input.\n\t\tNOTE: An example trial starts with the participant placing the cursor in the home position target. The new visual target position appears and participant moves to this target, once an auditory 'go' cue is delivered via a digital to analog output on the data acquisition box.\nAfter delivering the cue, ask the participants to move the cursor to the target. After reaching the target position using the cursor, observe the home position and begin the next trial by placing the cursor back in the home position.\n\t\tNOTE: Here is the example of TMS being triggered by the script. Ensure the individual is in their home position. Observe the visual target position and instruct the participant to move the cursor to this target. Trigger the TMS to occur at 100 ms following the auditory 'go' cue. The individual keeps the curser at the target position for 1 sec. The individual then returns to the home position awaiting the next trial.\nEnsure that the cursor is in the home position. Observe the visual target position and instruct the participant to move the cursor to the target position. Trigger the TMS to occur at 100 ms following the auditory 'go' cue. Instruct the individual to keep the cursor at the target position for 1 sec. Ask the individual to return the cursor to the home position awaiting the next trial.",
    "NOTE: In this example, the analog signal triggers the TMS. Specifically, in this example, the EMG triggers the TMS pulse. The experiment has 21 conditions: 7 target conditions x 3 different time points at which a TMS pulse is triggered (i.e., trigger 1, trigger 2, trigger 3). In this example, TMS pulses are triggered based on digital events, or external analog trigger events such as EMG or electrogoniometer input. These digital or analog events can be modified by the user by changing the sequences and script files. The approximate total duration of the experiment is 3 to 4 hr.\nSubscription Required. Please recommend JoVE to your librarian."
  ],
  "subjectAreas": [
    "Behavior"
  ],
  "bigAreas": [
    "Ecology & Environmental Biology"
  ]
}