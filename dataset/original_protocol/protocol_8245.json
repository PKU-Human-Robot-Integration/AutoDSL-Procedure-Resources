{
  "id": 8656,
  "origin_website": "Jove",
  "title": "Dynamic Inter-subject Functional Connectivity Reveals Moment-to-Moment Brain Network Configurations Driven by Continuous or Communication Paradigms",
  "procedures": [
    "The following protocol has been approved by the local ethics committee (Biomedical Inserm 365 protocol C08-39).\n1. Pre-imaging\nEnroll a study population of subjects, obtaining written, informed consent for all of them. Seek approval from the local ethics committee.\nSelect a paradigm to investigate that can be applied to all subjects in time-locked manner.\nNOTE: Here, we used an audio-visual scientific documentary for youngsters (https://miplab.epfl.ch/index.php/miplife/research/supplement-asd-study).\n2. Imaging\nFor each subject to consider in the analyses, perform at least one functional imaging session in which the scanned volunteer is subjected to the time-locked paradigm of interest.\nUse a 3 Tesla MRI scanner to acquire transverse slices through an echoplanar imaging sequence.\nEmploy the following imaging parameters: voxel size = 3 mm x 3 mm x 3 mm, repetition time (TR) = 2 s, echo time = 50 ms, field of view = 192, 40 slices.\nNOTE: Faster TR values are encouraged within the scope of feasibility. The protocol can also be applied with a more restricted field of view (e.g., for analyses restricted to a specific brain sub-structure), which would enable either a better temporal resolution (lower TR), or a spatially more precise analysis.\nLeave a few seconds of recording (≥ 2 TR) before and after the presentation of the stimulus.\nPerform at least one separate functional imaging session in which the scanned volunteer lies at rest in the scanner, eyes closed and instructed not to fall asleep.",
    "NOTE: Separate stimulus-related and resting-state acquisitions prevent otherwise possible interplays between the conditions (e.g., having watched the movie beforehand may leave a lasting trace to a subsequently acquired resting-state recording)27. If it is not desired to go through the aforementioned additional resting-state acquisition, an alternative (albeit more prone to the detection of false positives; see Discussion) computational option in the pipeline replaces this data by surrogate time courses computed from the paradigm-related signals (see step 5.1.2).\nPerform structural imaging.\nUse a 3 Tesla MRI scanner and a T1-weighted magnetization-prepared rapid acquisition gradient echo sequence.\nEmploy the following imaging parameters: voxel size = 1 mm x 1 mm x 1 mm, field of view = 256, 176 slices.\n3. Data and Software Preparation\nFor each session to analyze, ensure the existence of the following data files:\nA set of functional MRI volumes, present as separate 3D NIFTI or HDR/IMG files, with a consistent numbering scheme (e.g., \"fMRI_0001\", \"fMRI_0002\", etc.).\nA T1 structural MRI image, in NIFTI or HDR/IMG format.\nAn atlas of interest in Montreal Neurological Institute (MNI) space, in NIFTI format.\n\t\tNOTE: An example of required input files is provided for a representative subject (\"S17\"), along with the full pipeline code, at https://c4science.ch/source/Intersubj_pipeline.git \nDownload the latest version of the publically available Freesurfer software28 (https://surfer.nmr.mgh.harvard.edu/fswiki/DownloadAndInstall).\nDownload the latest version of the publically available Statistical Parametric Mapping (SPM) MATLAB toolbox from https://www.fil.ion.ucl.ac.uk/spm/software/spm12/.\nOpen MATLAB (version 2017a or more recent) and locate the newly downloaded \"freesurfer\" and \"spm12\" folders. For each, right click on it and select the Add to Path > Selected Folders and Subfolders option.\n4. Data Preprocessing",
    "In the MATLAB terminal, type spm to launch the SPM12 main menu, and click on the fMRI button to access the preprocessing options devoted to fMRI data. Perform the following steps separately for each fMRI session to preprocess.\nClick on Realign (Est & Res), and in the newly open Batch Editor window, double click on Data > Session. In the newly open Session window, select all functional images to process. Then, click on the Done button, and afterwards, on the Run Batch icon from the Batch Editor window (green triangle). Wait until the realignment step finishes, as indicated in the MATLAB terminal window.\nClick on Coregister (Est & Res), and in the newly open Batch Editor window, double click on Reference image. In the newly open Reference Image window, select the average functional volume created in the following step, prefixed with \"mean\", and click on the Done button. Then, double click on Source image, and in the newly open Source Image window, select the T1 image. Click on the Done button, and afterwards, on the Run Batch icon from the Batch Editor window (green triangle). Wait until the coregistration step finishes, as indicated in the MATLAB terminal window.\n\t\tNOTE: The T1 image is overwritten at this step, so that the updated one lies in the same space as the functional volumes.\nClick on Segment, and in the newly open Batch Editor window, double click on Volumes. In the newly open Volumes window, select the T1 image, and click on the Done button. Then, in the Batch Editor window, double click on Deformation Fields and select the Inverse option. Click on the Run Batch icon (green triangle), and wait until the segmentation step finishes, as indicated in the MATLAB terminal window.",
    "Type JOVE_GUI1 in the MATLAB terminal to open the first preprocessing graphical user interface window. Perform the following steps for each fMRI session to analyze.\nClick on Enter fMRI data, and select all realigned functional volumes created in step 4.1.1 (prefixed with \"r\"). For IMG/HDR files, select both the IMG and HDR volumes.\nEnter the TR of the data (in seconds) in the dedicated editable text window.\nClick on Enter T1 data and select the three probabilistic tissue type volumes created in step 4.1.3 (prefixed with \"c1\", \"c2\" and \"c3\").\nClick on Enter motion file, and select the text file containing motion parameters from the session of interest, created in step 4.1.1 and prefixed with \"rp\".\nSelect the desired type of preprocessing, that is, whether the data should be detrended or not (respectively setting the dedicated radio button on or off), and what covariates should be regressed out (by selecting the appropriate option from the dedicated list).\nNOTE: The regression step is inspired from a function originating from the DPARSF toolbox29. The white matter and cerebrospinal fluid signals from individual subjects are averaged over the voxels for which the respective template DPARSF probabilistic tissue map showed a signal larger than 0.99. In our analyses, we detrended the data, and regressed out white matter/cerebrospinal fluid time courses as well as constant, linear and quadratic trends.\nTo preprocess the data, click on Preprocess, and wait for the display to appear in the window. The data can be re-preprocessed differently by modifying the options, and clicking again on the Preprocess button.\nNOTE: The gray matter plot is inspired from the representation suggested by Power et al.30.\nTo save the output for following steps, click on the Save button. To clear the content of the window, click on the Clear button.\nimgsrc://cloudfront.jove.com/files/ftp_upload/59083/59083sfig1.jpg",
    "Supplementary Figure 1: Example screenshot from the first preprocessing graphical user interface window. Voxel-wise time courses of gray matter voxels following the selected preprocessing options (top right plot), and covariates that may be used in the preprocessing (from top to bottom: cerebrospinal fluid/white matter average time courses, translational motion parameters, and rotational motion parameters. Please click here to view a larger version of this figure.[href=https://www.jove.com/files/ftp_upload/59083/59083sfig1large.jpg]\nType JOVE_GUI2 in the MATLAB terminal to open the second preprocessing graphical user interface window. Perform the following steps for each fMRI session to analyze.\nClick on Select data, and select the data file saved in step 4.2.7 (named \"ISFC_VX.mat\").\nClick on Select motion, and select the text file containing motion parameters from the session of interest, created in step 4.1.1 and prefixed with \"rp\".\nClick on Select atlas, and select the NIFTI file representing the atlas to use for parcellation.\nClick on Select inverse warp, and select the NIFTI file representing the deformation field from MNI to native space, created in step 4.1.3 and prefixed with \"iy\".\nClick on Select fMRI volume, and select any of the fMRI data volumes.\nNOTE: This step enables to access the header information of the functional data, hence why the actual chosen volume is not important.\nEnter the TR of the data (in seconds) in the dedicated editable text window.\nEnter scrubbing-related information: the type of scrubbing to perform (i.e., how many frames to scrub out before and after the tagged ones) in the \"Scrubbing type\" list, and the framewise displacement threshold value (Power's criterion31) above which an fMRI volume should be scrubbed in the \"Scrubbing threshold\" editable text window (in mm).",
    "NOTE: Cubic spline interpolation is performed on the scrubbed data points to replace them with estimated values from neighboring samples. In our analyses, we scrubbed one frame after the tagged volumes, and used a 0.5 mm threshold for scrubbing.\nEnter the size of the sliding-window W to use for ISFC computations (see step 5), in TRs.\nNOTE: This piece of information will enable filtering of the time courses through a function originating from the DPARSF toolbox29, at f = 1/W Hz32. In our analyses, we used W = 10 TR as a trade-off value to capture dynamic fluctuations while conserving enough samples for robust estimations.\nClick on the Plot button to display indicative atlased time courses before (top plot) and after (bottom plot) the scrubbing and filtering steps. Verify, by visual inspection, that following the selected preprocessing steps, those output signals do not incorporate salient artifactual components.\nTo save the outputs for following steps, enter a save name in the dedicated editable text window, and click on the Save button. To clear the content of the window, click on the Clear button.\nimgsrc://cloudfront.jove.com/files/ftp_upload/59083/59083sfig2.jpg\nSupplementary Figure 2: Example screenshot from the second preprocessing graphical user interface window. Regional time courses following atlasing, before (top plot) and after (bottom plot) scrubbing and filtering according to selected parameters. Each curve depicts one regional time course randomly selected amongst all the available ones. Please click here to view a larger version of this figure.[href=https://www.jove.com/files/ftp_upload/59083/59083sfig2large.jpg]\n5. Sliding-window ISFC Computations\nType JOVE_GUI3 in the MATLAB terminal to open the first ISFC-related graphical user interface window. Perform the following steps separately for each type of acquired fMRI session segment (stimulus-related segments, resting-state segments of stimulus-related sessions, and purely resting-state segments).\nClick on Load data, and select all the appropriate data files created through step 4.3.",
    "Select whether the selected session segments should undergo phase randomization.\nNOTE: Phase randomization can be used as an alternative option for the generation of null data from stimulus-related signals, if no resting-state recordings are available.\nEnter the TR of the data (in seconds) in the dedicated editable text window.\nEnter sliding-window parameters to use for the analysis in the dedicated editable text windows: window size (in TRs) over which connectivity measurements should be computed, and step size (in TRs) by which successive windows should be shifted.\nNOTE: In our analyses, we used a window size of 10 TR and a step size of 1 TR.\nModify the \"Session types\" table to specify which of the loaded session segments were acquired upon the same experimental condition. Use increasing integer numbers from 1 onwards to tag different types of segments (e.g., if the stimulus was displayed for the first or for the second time in a given recording). Leave the table untouched if only one type of session segment was acquired.\nNOTE: A session in the present work may refer either to a combined movie/resting-state recording (termed RUN1 and RUN2 in Figure 1A), or to a purely resting-state recording (RUN3). A session segment refers to a sub-portion of a session recording, either when the movie was watched, or when the subjects lied at rest. The above information is used in the subsequently described ISFC computations (see step 5.1.8) to limit the confounding influence of different session segment types.\nEnter bootstrapping-related parameters in the dedicated editable text windows: the number of bootstrapping folds over which to perform ISFC computations, and the number of subjects that should constitute the reference group for each fold of ISFC computations.\nNOTE: In our analyses, we used 250 bootstrapping folds, and 6 subjects into the reference group.",
    "Enter specifications about which sub-portion of time courses should be analyzed in the Timing parameters section, in the dedicated editable text windows. A start index and an end index (in TRs) should be provided. To analyze the whole recording duration, use 1 as start index and the number of samples as end index.\nClick on the Plot button to perform ISFC computations. Displays are gradually updated over time, along with the amount of elapsed bootstrapping folds. For a region pair (i,j) and a sliding window index τ, ISFC is computed as the average of cross-correlations between session segment s and all session segments from the reference group, within a sliding-window of length W; denote this reference group by Ψ, its number of subjects by NΨ, and let xi[s](t) the time course of region i for session segment s at time t; an ISFC estimate is then given by:\nimgsrc://cloudfront.jove.com/files/ftp_upload/59083/59083eq2.jpg\n\t\tISFC measurements are computed over the specified amount of bootstrapping folds, and with the selected number of session segments used as a reference group at each fold (see step 5.1.6). If several session segment subtypes are included, a mixture of subtype samples always composes the reference group. The final output for each session segment is the average ISFC across all folds in which it was not included as a reference measurement.",
    "​NOTE: The reference group is the set of session segments to which the functional time courses of session segment s are compared at each fold of the bootstrapping process. For the results to be more robust to outlier data points, ISFC is computed multiple times on a different reference group (that is, a different subset of session segments). Importantly, the acquisition time t does not match the sliding window index τ, as the latter is computed over a set of W data points, and relies on the window step size for successive estimates. The bootstrapping process was inspired from a former study by Byrge et al.33.\nTo save the outputs for following steps, enter a save name in the dedicated editable text window, and click on the Save button. To clear the content of the window, click on the Clear button.\nimgsrc://cloudfront.jove.com/files/ftp_upload/59083/59083sfig3.jpg\nSupplementary Figure 3: Example screenshot from the first ISFC-related graphical user interface window. (Top plot) Schematic representation of how often each considered session has its ISFC measurements computed (i.e., is not selected within the reference group). (Bottom plot) On an indicative subject, ISFC time courses computed for fifty example connections, selected as the ones exhibiting the largest summed absolute ISFC values across time. Please click here to view a larger version of this figure.[href=https://www.jove.com/files/ftp_upload/59083/59083sfig3large.jpg]\nType JOVE_GUI4 in the MATLAB terminal to open the second ISFC-related graphical user interface window.\nClick on Load ISFC data and select the stimulus-related ISFC output file(s) created in step 5.1.\nClick on Load null data and select, depending on the used null data generation scheme, either the resting-state ISFC, or the phase randomized stimulus-related ISFC output file(s) created in step 5.1.\nClick on Load codebook and select the codebook file created in step 4.3.",
    "Enter the TR of the data (in seconds) in the dedicated editable text window.\nEnter the sliding-window parameters used in the computations of step 5.1 (window size and step size, in TRs) in the dedicated editable text windows.\nEnter (in percent) the α-value at which the ISFC time courses should be thresholded to highlight significant changes in the dedicated editable text window.\nNOTE: Here and elsewhere, when referring to an α-value of 2.5%, it means that significance is achieved when a value is lower than the 2.5th percentile, or larger than the 97.5th percentile, of the null data. In our analyses, we had 5,762 resting-state data points to our disposal, and selected an α-value of 10-4. This means that we wanted 0.01% of data samples to be larger or equal to the selected thresholds past which an ISFC excursion would be deemed significant. For comparison purposes, the α-level demanded by Bonferroni correction would be 0.05/44,551 = 1.12 x 10-6, and the most stringent possible α-level enabled with our amount of data (n samples) would be imgsrc://cloudfront.jove.com/files/ftp_upload/59083/59083eq3.jpg.\nClick on the Plot button to perform the ISFC thresholding process, in which all available null ISFC measurements are aggregated, for a given connection, to construct a null distribution, following which stimulus-related ISFC measurements are thresholded according to the selected α-value. Time points at which a stimulus-related ISFC value statistically significantly exceeds the null distribution are tagged as -1/+1 for significant ISFC decreases and increases, respectively.\nNOTE: The thresholding process draws inspiration from the resting-state dynamic FC work of Betzel et al.23.\nTo visualize the ISFC spatial patterns at different time points, drag the slider below the ISFC excursion plot.\nimgsrc://cloudfront.jove.com/files/ftp_upload/59083/59083sfig4.jpg",
    "Supplementary Figure 4: Example screenshot from the second ISFC-related graphical user interface window. (Top left plot) On an indicative subject, ISFC time courses computed for three example connections, selected as the ones exhibiting the largest amount of significant ISFC excursions and displayed with their associated computed significance thresholds (horizontal lines). (Bottom left plot) For the same connections, associated excursion time courses averaged across subjects, with two-tailed 95% confidence intervals displayed as error measure. (Right plot) Spatial ISFC pattern (averaged ISFC excursions across subjects) for a selected time point indicated by a vertical black line on the ISFC and excursion plots. Positive ISFC excursions are shown in yellow, and negative ones in pink. The size and color code of the nodes are proportional to their degree. Please click here to view a larger version of this figure.[href=https://www.jove.com/files/ftp_upload/59083/59083sfig4large.jpg]"
  ],
  "subjectAreas": [
    "Neuroscience"
  ],
  "bigAreas": [
    "Biomedical & Clinical Research"
  ]
}