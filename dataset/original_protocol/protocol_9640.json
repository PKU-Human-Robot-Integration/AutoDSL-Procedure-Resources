{
  "id": 10051,
  "origin_website": "Jove",
  "title": "Automation of the Micronucleus Assay Using Imaging Flow Cytometry and Artificial Intelligence",
  "procedures": [
    "1. Data acquisition using imaging flow cytometry\nNOTE: Refer to Rodrigues et al.16 with the following modifications, noting that the acquisition regions using IFC may need to be modified for optimal image capture:\nFor the non-Cyt-B method, perform a cell count using a commercially available cell counter following the manufacturer's instructions (see Table of Materials) on each culture immediately before culture and immediately after the recovery period.\nIf running samples on a single camera imaging flow cytometer, place the Brightfield (BF) in Channel 4. Replace M01 with M04, and M07 with M01.\n\tNOTE: \"M\" refers to the camera channel on the IFC.\nUse the 40x magnification during acquisition.\nOn the BF area versus BF aspect ratio plot during acquisition, use the following region coordinates:\n\tX-coordinates: 100 and 900; Y-coordinates: 0.7 and 1 (Cyt-B method)\n\tX-coordinates: 100 and 600; Y-coordinates: 0.7 and 1\nOn the Hoechst intensity plot, use the following region coordinates:\n\tX-coordinates: 55 and 75; Y-coordinates: 9.5 and 15 (Cyt-B method)\n\tX-coordinates: 55 and 75; Y-coordinates: 13 and 21 (non-Cyt-B method)\nTo remove images of apoptotic and necrotic objects from the data, launch the IDEAS 6.3 software package (henceforth referred to as the \"image analysis software\"; see Table of Materials).\n\t​NOTE: The AI software has been designed to work with .daf files that have been processed using the latest version of the image analysis software. Ensure that the image analysis software is up to date.\nSave this work as a template (.ast) file.\n2. Creating .daf files for all .rif files\nThe AI software only permits importing .daf files. Create .daf files for all .rif files in the experiment through batch processing.\nUnder the Tools menu, click on Batch Data Files and then click on Add Batch.",
    "In the new window, select Add Files and select the .rif files to be added to the batch. Under the Select a Template or Data Analysis File (.ast, .daf) option, select the .ast file that was created previously.\nAssign a batch name if needed and click on OK to create .daf files for all loaded .rif files.\n3. Creating an experiment in the AI software\nRefer to the flow chart in Figure 1 that describes the process of creating a deep learning model using the AI software.\nLaunch the AI software and ensure the most recent version is installed by clicking on About in the bottom left corner of the window. If the most recent version is not installed, contact support@luminexcorp.com to obtain it.\nThe default screen in the software is the New Experiment screen. Use the Folder icon to choose where to save the experiment, and type a name for the experiment (e.g., \"MN model\").\nUnder Experiment Type, click the radio button beside Train to start a training experiment to begin building the CNN model. Click on Next.\n\t\nOptional: if a model has been previously trained, it can be used as a template for a new AI model, and can be selected as a template for creation of a new model from the Select Template Model screen. If no template model exists simply skip this step by clicking Next.\nThe next screen is the Define New Model screen. Under Model, the name that was given to the model in step 3.3 will be automatically populated.\n\t\nUnder Description, type a description for the model (optional) and leave the maximum image size at 150 pixels.",
    "Under Channels, click on Add BF to add a brightfield channel to the list. Under Name, double-click on Brightfield and rename this channel to BF. Click on Add FL to add a fluorescent channel to the list. Under Name, double-click on Fluorescent and rename this channel to DNA.\nUnder Class Names, click on Add. In the pop-up window, type Mononucleated and click on OK. This adds the mononucleated class to the list of class names. Repeat this process to ensure the following six classes are defined in the list:\nMononucleated\nMononucleated with MN\nBinucleated\nBinucleated with MN\nPolynucleated\nIrregular morphology\n\t\t​Click on Next.\n\t\tNOTE: These six ground truth model classes will represent the key events to be scored, as well as images with morphology that differs from the accepted scoring criteria5.\n\t\t\nOptional: If desired, the analysis template from 1.7 can be included to use features from the image analysis software. If you would like to include these features in the AI model, browse for the .ast file, then from the channel specific dropdowns, choose the feature subsets you would like to include.\nUnder Select Files, click on Add Files and browse for the desired files to be added to the AI software to build the ground truth data. Click on Next.\n\t\tNOTE: It is important to add multiple data files (e.g., positive and negative control data) that contain a sufficient number of all key events.\nNext, on the Select Base Populations screen, locate the Non-Apoptotic population from the population hierarchy. Right-click on the Non-Apoptotic population and select Select All Matching Populations. Click on Next.\n\tNOTE: It is important to exclude any populations that should not be classified (e.g., beads, debris, doublets, etc.)\nThis screen is the Select Truth Populations screen.",
    "If tagged truth populations of the key events have not been created in the image analysis software, then click on Next.\nIf tagged truth populations have been created in the image analysis software, assign them to the appropriate model class.\nTo assign a tagged truth population of MONO cells with MN, click on the Mononucleated with MN class under Model Classes on the left. Then click on the appropriate tagged truth population on the right that contains these events.\nIf the tagged truth populations have been created in more than one data file, right-click on one of the truth populations and select Select All Matching Populations to add tagged populations from multiple files to the appropriate class.\nOnce all appropriate truth populations have been assigned, click on Next.\nOn the Select Channels screen, choose the appropriate channels for the experiment. Here, set BF to channel 1 and Hoechst to channel 7. Right-click on a channel and select Apply to All. Click on Next.\nFinally, on the Confirmation screen, click on Create Experiment.\nThe AI software loads images from the data files and creates the model classes defined in step 3.5.3 with the ground truth imagery that was assigned in step 3.7. Click on Finish.\nOnce the experiment is created, five options are presented:\nExperiment: provides details of the experiment, including data files loaded, channels chosen, and defined ground truth model classes.\nTagging: launches the tagging tool through which users can populate ground truth data.\nTraining: trains a model based on the ground truth data.\nClassify: uses trained models to classify data.\n\t​Results: provides results from both a training experiment and a classify experiment.\n4. Populating the ground truth data using AI-assisted tagging tools\nClick on Tagging to launch the tagging tool interface.",
    "Click on the zoom tools (magnifying glass icons) to crop the images for easier viewing.\nClick on the slider bar to adjust the image size to change how many images are shown in the gallery.\nClick on the Display Setting option, and choose Min-Max, which provides the best contrast image for identifying all key events.\nClick on Setup Gallery Display to change the color of the DNA image to yellow or white, which will improve the visualization of small objects (e.g., MN).\nClick on Cluster to run the algorithm to group objects with similar morphology together. Once clustering is complete, the individual clusters with the number of objects per cluster are shown in a list under Unknown Populations. Select the individual clusters to view the objects within the cluster and assign these objects to their appropriate model classes.\nAfter a minimum of 25 objects have been assigned to each model class, the Predict algorithm becomes available. Click on Predict.\n\tNOTE: Objects that don't fit well into any population remain classified as Unknown. As more objects are added to the truth populations, the prediction accuracy improves.\nContinue to populate the ground truth model classes with appropriate imagery until a sufficient number of objects in each class is reached.\nOnce a minimum of 100 objects have been assigned to each model class, click on the Training tab at the top of the screen. Click on the Train button to create a model using the Random Forest and CNN algorithms. \n\tNOTE: The AI software creates models using both the Random Forest and CNN algorithms, the checkboxes permit creation of models using Random Forest of CNN algorithms only.\n5. Assessing model accuracy\nOnce model training is complete, click on View Results.",
    "Use the results screen to assess model accuracy. Use the pulldown menu to switch between Random Forest and CNN. \n\tNOTE: The truth populations can be updated, and the model can be re-trained or used as-is to classify additional data.\n\t\nTo update the truth populations, click on Tagging at the top and follow section 4.\n6. Classifying data using the model\nLaunch the AI software. The default screen is the New Experiment screen. Use the Folder icon to choose where to save the experiment and type a name for the experiment.\nUnder Experiment Type, click the radio button beside Classify to start a classification experiment. Click on Next.\nClick on the model to be used for classification, then click on Next.\nOn the Select Files screen, click on Add Files and browse for the files to be classified by the CNN model. Click on Next.\nNext, on the Select Base Populations screen, click on the checkbox next to the Non-Apoptotic population in one of the loaded files. Right-click on the Non-Apoptotic population and click on Select All Matching Populations to select this population from all loaded files. Click on Next.\nOptional: if the data to be classified contains truth populations, they can be assigned to the appropriate model classes on the Select Truth Populations screen. Otherwise, click Next to skip this step.\nOn the Select Channels screen, choose Channel 1 for brightfield and Channel 7 for the DNA stain. Right-click on a channel and click on Apply to All. Then click on Next.\nFinally, on the Confirmation screen, click on Create Experiment. The AI software loads the selected model and all images from the chosen data files. Click on Finish.",
    "Click on Classify to launch the classification screen. Click on the Classify button. This begins the process of using the RF and CNN model to classify additional data and identify all objects that belong in the specified model classes.\n\tNOTE: The checkboxes can be used to select the RF model and/or the CNN model.\nOnce the classification is complete, click on View Results.\nClick the Update DAFs button to bring up the Update DAFs with Classification Results window. Click on OK to update the .daf files.\n7. Generating a report of the classification results\nOn the Results screen, click on Generate Report. Select the checkbox beside Create Report for Each Input DAF if an individual report for each input daf is required. Click on OK.\nOnce completed, open the folder where the report files have been saved. Within the folder, there is an experiment .pdf report and a Resources folder.\nOpen the .pdf to view the report. The report contains model and experiment information, the list of input .daf files, the class counts and class percentages in tabular and histogram format, and a confusion matrix summarizing the median prediction probability across all input .daf files.\nOpen the Resources folder and then the CNN folder. Within this folder are .png files of the class count and percentage bar graphs, as well as the confusion matrix. Additionally, there are .csv files containing the class counts and percentages for each input file.\n8. Determining MN frequency and cytotoxicity\nCalculating MN frequency\n\t\nNon Cyt-B method: To determine MN frequency, open the class_count.csv file from step 7.4. For each input file, divide the counts in the \"Mononucleated with MN\" population by the counts in the \"Mononucleated\" population and multiply by 100:\nimgsrc://cloudfront.jove.com/files/ftp_upload/64549/64549eq01.jpg",
    "Cyt-B method: To determine MN frequency, open the class_count.csv file from step 7.4. For each input file, divide the counts in the \"Binucleated with MN\" population by the counts in the \"Binucleated\" population and multiply by 100:\nimgsrc://cloudfront.jove.com/files/ftp_upload/64549/64549eq02.jpg\nCalculating cytotoxicity\n\t\nNon Cyt-B method:\n\t\t\nUsing the initial cell counts and the post-treatment cell counts, first calculate the population doubling (PD) for each sample2:\nimgsrc://cloudfront.jove.com/files/ftp_upload/64549/64549eq03.jpg\nNext, calculate the relative population doubling2:\nimgsrc://cloudfront.jove.com/files/ftp_upload/64549/64549eq04.jpg\nFinally, calculate the cytotoxicity2 for each sample:\nimgsrc://cloudfront.jove.com/files/ftp_upload/64549/64549eq05.jpg\nCyt-B method:\n\t\t\nTo calculate Cytokinesis-Block Proliferation Index (CBPI)2, use the counts in the mononucleated, binucleated, and polynucleated classes for each sample from the class_count.csv file:\nimgsrc://cloudfront.jove.com/files/ftp_upload/64549/64549eq06v2.jpg\nTo calculate cytotoxicity2, use the CBPI from the control cultures (C) and exposed cultures (T):\nimgsrc://cloudfront.jove.com/files/ftp_upload/64549/64549eq07.jpg\nSubscription Required. Please recommend JoVE to your librarian."
  ],
  "subjectAreas": [
    "Bioengineering"
  ],
  "bigAreas": [
    "Bioengineering & Technology"
  ]
}