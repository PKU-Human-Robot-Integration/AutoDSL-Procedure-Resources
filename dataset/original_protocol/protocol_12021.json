{
  "id": 13421,
  "origin_website": "Jove",
  "title": "Multifunctional Setup for Studying Human Motor Control Using Transcranial Magnetic Stimulation, Electromyography, Motion Capture, and Virtual Reality",
  "procedures": [
    "All participants involved in experimentation undergo informed consent procedures approved by the West Virginia University Institutional Review Board (IRB).\n1. Overall System Characteristics, Design, and General Experimental Task\nNote: The complete setup is comprised of the following major components: EMG equipment and associated digital acquisition (DAQ) equipment; a motion capture system (this protocol incorporates an active LED system); a TMS unit with a figure-of-eight coil and stereotaxic localization equipment; a VR headset and associated computer and software; and a custom synchronization circuit. Figure 1 schematically outlines the connectivity between the protocol components.\nConnection of System Components\n\t\nConnect EMG pre-amplifier to main amplifier.\nConnect output of EMG amplifier to DAQ recording equipment input block using BNC or similar connections.\nConnect DAQ recording equipment to dedicated computer that will execute a data acquisition script (supplementary file).\nConnect VR control computer parallel output to custom circuit unit (see next section for details).\nConnect synchronization and motion capture triggering outputs from custom circuit to DAQ recording block alongside EMG signal connections.\nSplit motion capture trigger and connect it to the “Analog Input Start” port on the EMG DAQ equipment as well as the trigger connection on the computer that controls motion capture equipment.\n\t\tNote: The temporal difference between the beginnings of the respective data acquisition streams for the described equipment (motion capture and EMG) can range from 160-190 msec. This temporal difference motivated the design of the synchronization circuit described in this protocol and is likely caused by the software and hardware differences between these two systems.\nConnect TMS trigger port on custom circuit unit to BNC input trigger on the TMS control unit.\nEstablish network connectivity between the VR and motion capture computers using vendor-provided software and physical network connections.",
    "Connect VR headset to VR computer and ensure operability with any scripts/programs that display virtual environments to participants.\nimgsrc://cloudfront.jove.com/files/ftp_upload/52906/52906fig1.jpg\nFigure 1: Connectivity of entire setup. This layout describes the general connectivity between the elements of our system. The synchronization circuit is described elsewhere in the text in more detail. The blue trace corresponds to the signal that starts both motion capture and EMG data streams. This event is the source of the temporal delay of up to 190 msec using the equipment described in this protocol. The red trace corresponds to the VR-initiated synchronization event that is concomitantly recorded by the motion capture and EMG systems and subsequently used for temporal alignment of the respective data streams. Please click here to view a larger version of this figure.[href=https://www.jove.com/files/ftp_upload/52906/52906fig1large.jpg]\n2. General Details of System Integration and Synchronization\nNote: Synchronization of the separate data acquisition systems in this protocol (motion capture and EMG) is accomplished through the use of an event signal that is common to all recording streams. Using a common event, all of the signals can be temporally realigned after data collection to minimize real-time recording discrepancies (upwards of 190 msec using the equipment in this protocol). In this protocol, the common signal originates from the VR system as a parallel port signal. The common signal is routed to a circuit that permits synchronization of the separate data streams through direct recording with EMG signals and by simultaneously turning off a motion capture LED. The circuit is constructed using basic tools and techniques for building electronic components, similar to circuits described elsewhere9.\nDesign, Layout, and Construction of Synchronization Circuit",
    "Identify any analog TTL-based triggering mechanisms on equipment control units (e.g. TMS, motion capture) and become familiar with triggering requirements such as TTL pulse direction (positive/negative) and amplitude. Analog triggering mechanisms often possess common “BNC” coaxial connectors that make connecting components simple.\nAdd an additional LED to the motion capture system to be used for signal synchronization; route the LED’s wires through the synchronization circuit (Figure 3).\nDetermine the electrical component parameters (i.e. resistance, capacitance) needed to turn off the synchronizing LED for a specific amount of time. Find the amount of time that the circuit’s syncing LED is turned off by the equation: t = 1.1*R1*C1. This time is suggested to be less than the average duration of an experimental movement. For example, the currently described experiment required a resistor and capacitor rated at approximately one megaohm and one microfarad, respectively.\nUse a soldering iron to adhere electrical components to a printed “protoyping” or “project” circuit board following the schematic shown in Figure 3. Enclose this circuit in a commonly available plastic “project” box; it will likely be necessary to drill holes in this box for the BNC connectors. The circuit can readily be powered by 5 V USB power from a desktop computer; it will be necessary to deconstruct a USB cable to isolate the power and ground wires. Bypass capacitors may also be needed to regulate the power to the 555 chip (not shown in Figure 3).\nInspect the circuit board for any unintended solder bridges between electrical components. If found, remove solder with a suction tool or heat the solder and mechanically remove the bridging connection.\nimgsrc://cloudfront.jove.com/files/ftp_upload/52906/52906fig2.jpg",
    "Figure 2: Trial flowchart. This flowchart outlines the stimulus and signal events that occur during a typical experimental trial that includes TMS stimulation. Parallel port codes that occur throughout a trial are shown in the DB25 schematic symbols (light blue).\nSynchronization Details\n\t\nUsing a flowchart similar to Figure 2, determine when individual pieces of equipment should be triggered during the course of an experimental movement. For example, some equipment may be individually triggered, while others may be simultaneously triggered.\nAt time points that require triggering or signaling (e.g. blue parallel port symbols in Figure 2), determine which parallel ports signal lines to use and incorporate them into the VR system. This is accomplished by sending numerical values to the parallel port at the specified times during movements, each line representing a binary digit. For more details about parallel port based signaling, please refer to the Discussion.\nimgsrc://cloudfront.jove.com/files/ftp_upload/52906/52906fig3.jpg",
    "Figure 3: Synchronization Circuit. This schematic displays the layout of our custom synchronization circuit. The default output of the NAND gate is a high voltage state; this voltage output is sent to the gate of a transistor through which the sync LED’s circuit is routed. This default state renders the circuit closed, which maintains the LED in a lighted state. Upon receiving a sync trigger parallel port signal (red trace in inset), an internal state of the 555 device is flipped rendering the output into a high state, shutting off the LED (blue trace). When this occurs, the voltage on C1 (green trace) builds up to a voltage that resets the internal state of the 555, reactivating the LED. The parallel port sync trigger signal is also directly routed to a BNC connector that is connected to the TMS input trigger port. Note: The direction of this trigger signal may have to be reversed (from positive- to negative-going or vice-versa) depending on an investigator’s specific equipment requirements. The addition of an “inverter” chip on this trigger output would easily accomplish this task. Please click here to view a larger version of this figure.[href=https://www.jove.com/files/ftp_upload/52906/52906fig3large.jpg]\n3. Experimental Procedures\nSafety Procedures and Informed Consent\n\t\nEnsure that all experimental procedures are approved by an Institutional Review Board (IRB). Explain all procedures to participants and acquire informed consent with IRB approved documentation.\nAfter acquiring informed consent, conduct a basic TMS safety screening with participants to ensure they do not have tinnitus, a family history of epilepsy or seizures, or other conditions with elevated risks of seizure.\nDuring TMS stimulation, strictly require the use of protective earplugs to prevent hearing damage.\nElectromyography Collection",
    "Depending on the scientific goals of a reader’s study, determine from which arm muscles to record EMG signals. For the study described in this protocol,  torques generated at the shoulder and elbow during movement were investigated. Thus, EMG signals recorded were from the major superficial muscles that act on these two joints, such as the deltoid, pectoralis, biceps, triceps, and brachioradialis.\nMake all necessary electrical connections between various EMG equipment including amplifiers, preamplifiers, sensor wires, and sensor pads according to the manufacturer’s specifications by connecting matching connectors.\nPrepare each electrode site by lightly cleaning it with an alcohol swab, removing any excessive hair with a razor, and by applying a mild abrasive gel. Proper site preparation will ensure consistent and low electrode-to-skin impedance values (<10 kOhms) and high signal-to-noise ratio of recorded EMG signals.\nHave subjects perform isometric contractions designed to isolate individual muscles of interest based upon accepted anatomical and biomechanical descriptions10. For example, to isolate the biceps, ask the participant to resist an imposed extension of the elbow.\nAfter having subjects perform muscle-isolating contractions, affix differential bipolar EMG electrodes over the thickest, central portion, or “belly”, of each muscle at accepted locations11. This ensures coverage of a maximal number of muscle fibers and minimizes “crosstalk” between neighboring muscles. Be sure to align the bipolar electrodes’ longest axes along the muscles, parallel to the fibers.\nAffix the EMG ground electrode according to equipment specifications (e.g. the skin over the C7 vertebra).\nRecord amplified EMG signals through DAQ equipment controlled by a custom computer script. The script used in the current protocol is attached as a supplementary file.",
    "Adjust gains applied to recorded signals to desired level by moving dials on the EMG preamplifier. Avoid gain values that cause recorded signals to exceed the input range of the recording equipment (typically 5V). Common EMG gain values are between 1,000-4,000.\nPerform similar isometric contractions to those performed in step 3.2.4 and visually inspect EMG signals to ensure that they are of high quality (i.e. high signal-to-noise ratio). Reposition electrodes and change the signal gain if necessary.\nMotion Capture System Preparation\n\t\nCalibrate motion tracking cameras using vendor-supplied instructions and equipment according to manufacturer’s instructions.\nUsing tape and other wrapping materials, attach active LED sensors to bony landmarks near the joints of the arm and other anatomical points of interest used in the construction of biomechanical models: the distal phalanx of the index finger, radial and ulnar styloid processes at the wrist, olecranon process at the elbow, coracoid and acromion processes of the shoulder, sternoclavicular notch, xiphoid process, and spinous process of C7. Attach another LED to the VR headset to set the view point in the virtual environment.\nConnect each LED to a wiring harness that is attached to the wireless driver unit. Turn on driver unit and ensure proper illumination of all LEDs.\nPosition the synchronization LED in a convenient location away from the subject, but within clear view of the cameras.\nTranscranial Magnetic Stimulation Stereotaxic Localization\n\t\nCalibrate hardware and software designed for TMS registration12, to allow for accurate coil placement. This generally involves co-registering TMS coils with anatomical landmarks such as the nasion, preauricular points, and nose tip. Stereotaxic registration between a participant and the stimulation coil is integral to consistent stimulation localization.\nMEP Hot-spot Localization and MEP Threshold Pprocedures",
    "Perform so-called “hot-spot” techniques to locate TMS-sensitive regions of cortex that produce the greatest amplitude MEPs with the lowest threshold upon stimulation8,13,14. Transcranial magnetic stimulation for studying motor systems typically involves stimulating a cortical area that controls movement in a specific body part (e.g. the arm and hand)15.\nRecord the location of any ideal stimulation sites on the participants scalp with the calibrated stereotaxic registration equipment and associated software. After each location is recorded with the software, ensure its accuracy by relocating the spot and stimulating again, looking for similar MEP responses.\nBehavioral Task in Virtual Reality\n\t\nDesign the parameters of the behavioral task (e.g. reaching movements) to be used in the experiment. In the current study, the task is to reach to virtual targets placed sequentially in different spatial locations. The size of the targets defines the accuracy with which the participants move. Design the movements such that varying directions and magnitudes of joint torques are evoked as participants reach for targets.\nSetup the VR environment that guides subjects through the behavioral task using commercial VR software that is compatible with the headset and motion tracking system according to the manufacturer’s protocol. Become familiar with the software package’s required computational resources and programming language requirements. Common VR software packages have the ability to be programmed with languages including Python, C++, C#, and others. Additionally, program analog outputs through the parallel port for synchronization and marking of specific events of interest (Figure 2). In the current experiment, the VR software outputs events at the start of each repetition of the task and at times of desired TMS stimulation.\nConnect the VR output to the synchronization circuit (Figure 3) and/or the other equipment to be synchronized using cables with matching connectors.",
    "Instruct subjects to perform the VR behavioral task. In the current study, the VR environment was presented using a head-mounted display in which participants viewed arrays of spherical targets. Using the VR software, program specific movement sequences by altering the appearance of targets (color, location, etc.) and familiarize participants with these actions. Additionally inform participants of any other desired movement constraints. For example, participants in the current study were asked to keep all arm segments within a vertical plane of movement while reaching for targets.\nOnce participants are accustomed to the experimental movements, record EMG and motion capture data, and synchronizing signals using custom scripts or vendor-supplied software packages. Adjust the sampling rate of each data acquisition system to desired values; additionally become familiar with and adjust any manufacturer-specific parameters such as motion-tracking LED intensity.\nSubscription Required. Please recommend JoVE to your librarian."
  ],
  "subjectAreas": [
    "Behavior"
  ],
  "bigAreas": [
    "Ecology & Environmental Biology"
  ]
}