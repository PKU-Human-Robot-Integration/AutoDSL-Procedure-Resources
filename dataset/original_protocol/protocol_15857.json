{
  "id": 19683,
  "origin_website": "Wiley",
  "title": "Using ConSurf to Detect Functionally Important Regions in RNA",
  "procedures": [
    "This protocol provides guidance on using the ConSurf server to analyze the evolutionary conservation profile of an RNA query, given its 3D structure or nucleotide sequence.\nNecessary Resources\nHardware\nComputer with Internet connection, under Windows, Mac, or Linux\nSoftware (recommended)\nThe PyMOL (Schrödinger, 2021[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-bib-0028]), Chimera (Pettersen et al., 2004[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-bib-0024]), or RasMol (Sayle & Milner-White, 1995[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-bib-0027]) molecular visualizer\n1. Upload RNA query.\nEnter the ConSurf server web page (https://consurf.tau.ac.il/[href=https://consurf.tau.ac.il/]) and select the Nucleotides option. You will be redirected to a page asking if your query has a known structure. Selecting ‘YES’ will allow you to enter the PDB ID of the molecule (Fig. 2[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-fig-0002]); press “Next” and indicate the chain of interest if needed (Fig. 3[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-fig-0003]). Alternatively, you may upload the coordinate file, in PDB format. If ‘NO’ is selected the server will proceed to ask for an MSA. Selecting ‘NO’ again will allow you to enter the query sequence, in FASTA format (Fig. 4[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-fig-0004]).\n<p>imgsrc:https://currentprotocols.onlinelibrary.wiley.com/cms/asset/bd33e601-1d47-4c28-94f3-f0c114632d41/cpz1270-fig-0002-m.jpg</p>\nFigure 2\nEntering the PDB ID of the structure of the RNA query.\n<p>imgsrc:https://currentprotocols.onlinelibrary.wiley.com/cms/asset/5feaa14d-7754-4230-adc8-a9e99c68daed/cpz1270-fig-0003-m.jpg</p>\nFigure 3\nSelecting the query RNA chain.\n<p>imgsrc:https://currentprotocols.onlinelibrary.wiley.com/cms/asset/de45d122-94c0-467d-b668-f4e4ba1b6288/cpz1270-fig-0004-m.jpg</p>\nFigure 4\nEntering the query sequence in FASTA format.\n2. Select setting for the construction of a multiple sequence alignment (MSA). See Figure 5[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-fig-0005].\nThe server will ask if you wish to upload an MSA. Select NO, at which point ConSurf will allow you to select the homology search method and nucleotide database, as well as other parameters for generating an MSA:\n<p>imgsrc:https://currentprotocols.onlinelibrary.wiley.com/cms/asset/1844e8e4-3f05-41b1-913b-4b80e5190b16/cpz1270-fig-0005-m.jpg</p>\nFigure 5\nAn analysis page of an RNA query of known structure ready to be submitted. Default settings are used in all fields, and job title and e-mail address are added, as recommended.\nHomolog search algorithm–A choice between nBLAST (default) (Altschul, Gish, Miller, Myers, & Lipman, 1990[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-bib-0001]; https://blast.ncbi.nlm.nih.gov/Blast.cgi[href=https://blast.ncbi.nlm.nih.gov/Blast.cgi]) and nHMMER (Eddy, 2009[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-bib-0007]; http://hmmer.org/[href=http://hmmer.org/]).",
    "Nucleotides Database–Currently there is only one nucleotide database that can be searched, nr NCBI Nucleotide Home page; see Internet Resources).\nBLAST E-value Cutoff–This value is set at 0.001 by default and can be increased up to <1. Increasing the value may help in finding more homologs (but also potentially non-homologs).\nSelect homologs for ConSurf analyses–There are two options to choose from, “automatically” or “manually.” Selecting “manually” will eventually require the user to mark sequences from the hits list, which could be valuable for users who are very familiar with their query. We highly recommend selecting “automatically.”\n“automatically”: The user is asked to indicate the maximum number of homologs (150 is the default; selecting more than 300 would significantly slow the calculation), as well as the maximum and minimum sequence ID percentages (95 and 60 by default). In ConSurf, the hits (coming from the nBLAST or nHMMER search) are sorted by their E-values in an ascending order, based on the principle that the lower the E-value, the more likely the hit is to be a true homolog. When selecting “automatically,” a predetermined number of hits are sampled evenly from the sorted list to create the final list of homologs of the query protein. The user is also asked to choose between three methods for multiply align the selected homologs: MAFFT-L-INS-i (default), PRANK, or CLUSTALW.\n3. Selecting analysis methods (Fig. 5[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-fig-0005])\nThe Calculation Method can be Bayesian (Default) or Maximum Likelihood. For the Evolutionary Substitution Model there is a choice between “T92 model (Tamura, 1992[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-bib-0029]),” “GTR: General Time Reversible,” “JC69 model (Juke & Cantor, 1969[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-bib-0015]),” “HKY85 model (Hasegawa, Kishino, & Yano, 1985[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-bib-0010]),” and “Best model” (default).\nWe recommend using the default settings.\n4. Run job entry (Fig. 5[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-fig-0005]).",
    "There is an option to give a job title as well as an e-mail address. The latter is particularly convenient because, if used, an e-mail will be sent with a link to the results once the run has finished. Each job is given a number, regardless of whether a job title was entered, and the results are kept on the server for up to 3 months.",
    "This protocol will provide guidance to using the ConSurf server to analyze the evolutionary conservation profile of an RNA query, given its 3D structure or nucleotide sequence, using an externally provided MSA. Two Support Protocols for constructing MSA for the query are provided further below.\nNecessary Resources\nHardware\nComputer with Internet connection, under Windows, Mac, or Linux.\nSoftware (recommended)\nThe PyMOL, Chimera or RasMol molecular visualizers\n1. Upload RNA query.\nEnter the ConSurf server web page (https://consurf.tau.ac.il/[href=https://consurf.tau.ac.il/]) and select the Nucleotides option. You will be redirected to a page asking if your query has a known structure. Selecting ‘YES’ will allow you to enter the PDB ID of the molecule (Fig. 2[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-fig-0002]); press “Next” and indicate the chain of interest (Fig. 3[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-fig-0003]). Alternatively, you may upload the coordinate file, in PDB format. If ‘NOTE’ is selected, the server will proceed to ask for MSA.\n2. Upload a multiple sequence alignment (MSA).\nThe server will ask if you wish to upload an MSA. Select YES and choose the MSA file from your computer. Once uploaded, choose your query sequence from the “Indicate the Query Sequence Name” menu and click on “update selection” to continue (Fig. 6[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-fig-0006]).\nMake sure that the format is one supported by ConSurf: NBRF/PIR, EMBL/SwissProt, Pearson (FASTA), GDE, Clustal, GCG/MSF, and RSF format. Additionally, in all the sequences, U must be replaced with T for compatibility with the server. Also, the name of the file uploaded must only contain dashes and underscores as gap symbols, no whitespaces.\nIn the Support Protocols provided, you will find two different ways of constructing an MSA for an RNA query which can then be uploaded to ConSurf.\n<p>imgsrc:https://currentprotocols.onlinelibrary.wiley.com/cms/asset/8fec7a5e-ce01-414f-9c57-73a2a18cd6de/cpz1270-fig-0006-m.jpg</p>\nFigure 6\nUploading an external MSA to an RNA query of known structure.\n3. Tree upload and analysis methods.",
    "Select NO when asked for a tree upload, at which point the server will provide the options to select the parameters for the evolutionary analysis (Fig. 7[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-fig-0007]).\nThe Calculation Method can be Bayesian (Default) or Maximum Likelihood (Pupko, Bell, Mayrose, Glaser, & Ben-Tal, 2002[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-bib-0025]). For the Evolutionary Substitution Model, there is a choice between T92 model (Tamura, 1992[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-bib-0029]), GTR: General Time Reversible (Tavare, 1986[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-bib-0030]), JC69 model (Jukes & Cantor, 1969[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-bib-0015]), HKY85 model (Hasegawa et al., 1985[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-bib-0010]), and “Best model” (default).\nWe recommend using the default settings.\n<p>imgsrc:https://currentprotocols.onlinelibrary.wiley.com/cms/asset/bab15029-825f-4464-b1b8-8895bfb923b8/cpz1270-fig-0007-m.jpg</p>\nFigure 7\nAn analysis page with an external MSA ready to be submitted. Default settings are used in all fields, and job title and E-mail address are added, as recommended.\n4. Run job entry.\nThere is an option to give a job title as well as an e-mail address (Fig. 7[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-fig-0007]). The latter is particularly convenient because, if used, an e-mail will be sent with a link to the results once the run has finished. Each job is given a number, regardless of whether or not a job title was entered, and the results are kept on the server for up to 3 months.",
    "Starting from a nucleotide query, ConSurf currently provides only searches in the NCBI NT database (marked as nr for non-redundant; NCBI Resource Coordinators, 2018[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-bib-0023]). Unfortunately, this limited search often does not yield a large enough set of effective homologs. To overcome this obstacle, it is recommended to provide an external MSA for your RNA query. The following is a description of a protocol to construct a ConSurf-compatible MSA.\nNecessary Resources\nHardware\nComputer with Internet connection, under Windows, Mac, or Linux\nSoftware\nNotepad++ or any other similar text editor\n1. Enter RNACentral (https://rnacentral.org/[href=https://rnacentral.org/]), select the “Sequence search” option, enter your RNA query sequence into the search box, and hit the Search button (Fig. 8[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-fig-0008]).\nThe RNACentral search engine utilizes nHMMER to search a much larger database than the one ConSurf searches (RNAcentral Consortium, 2021[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-bib-0026]; Wheeler & Eddy, 2013[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-bib-0033]).\nThe results, up to one thousand hits that are the most similar to your query, can be downloaded from the server.\n<p>imgsrc:https://currentprotocols.onlinelibrary.wiley.com/cms/asset/7ff120b4-b905-4915-9141-322717c74d4d/cpz1270-fig-0008-m.jpg</p>\nFigure 8\nThe sequence search page of RNACentral, with the top of the results for FMN riboswitch (PDB ID 6BFB, chain y). The search box with a query sequence is highlighted in green (appears the same before and after search). The download button for the results is highlighted in orange.\n2. Download the results from RNACentral by pressing the “Download” button at the top of the search results.\nA zip folder will be downloaded to your computer. When opened, there will be a folder titled “sequences” which contains three files. One of the files is a FASTA file of all the similar sequences in FASTA format, called similar-sequences.fasta. Extract this file to a path of your choosing.\n3. Adjust the sequences for compatibility with ConSurf.",
    "ConSurf can only work with DNA nucleobases, i.e., A, C, G, and T. When constructing an RNA MSA, ConSurf replaces all U characters in the sequences with the character T, but when constructing an MSA externally, this adjustment needs to be done manually. To do so, open the FASTA file you downloaded from RNACentral using Notepad++ (or a similar text editor), replace all U's with T's, and save the changes.\n4. Cluster the sequences using cd-hit-est (http://weizhong-lab.ucsd.edu/cdhit-web-server/cgi-bin/index.cgi?cmd=cd-hit-est[href=http://weizhong-lab.ucsd.edu/cdhit-web-server/cgi-bin/index.cgi?cmd=cd-hit-est]); see Fig. 9[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-fig-0009].\ncd-hit-est is a tool that clusters nucleotide sequences based on a sequence identity threshold set by the user (Fu, Niu, Zhu, Wu, & Li, 2012[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-bib-0008]; Huang, Niu, Gao, Fu, & Li, 2010[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-bib-0011]; Li & Godzik, 2006[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-bib-0018]). The idea is to reduce the number of homologs in the dataset while keeping the integrity of the sequence diversity in the dataset, i.e., to produce a list of “effective” homologs.\nIncreasing the threshold increases the number of representatives. We recommend setting the sequence identity threshold between 0.95 and 0.8. For the best results, aim for the highest threshold that generates at most 300 effective homologs. ConSurf needs at least 5 homologs, and when the number of homologs exceeds 300, the run time significantly increases.\nUpload the homologs file produced in the previous step and leave “Incorporate annotations info at header line” unchecked. Change the “Sequence identity cut-off” if needed (default is 0.9), enter an e-mail address (optional but highly recommended), and submit the job, leaving the rest of the parameters on the default settings.\n<p>imgsrc:https://currentprotocols.onlinelibrary.wiley.com/cms/asset/ec48033f-1fbd-4403-aff6-f261caee3ac1/cpz1270-fig-0009-m.jpg</p>\nFigure 9\nCD-HIT run page with sequence identity cut-off set at 0.9 (90%) and default settings left in all other fields.\n5. Check the resulting representative sequences for your query.",
    "In the results page, open the FASTA file for representative sequences at X% identity (X being the percentage you entered in the search) and check for your query sequence. If included, the query should appear at the top of the list, but it might be excluded from the list of effective homologs. Select all the sequences and copy them.\n6. Align the sequence dataset using MAFFT (https://mafft.cbrc.jp/alignment/server/[href=https://mafft.cbrc.jp/alignment/server/]).\nOpen the MAFFT alignment server (Katoh, Rozewicki, & Yamada, 2017[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-bib-0016]) and paste the sequences copied from the CD-HIT results. The headers of the sequences will be edited by MAFFT, leaving only the number code at the beginning of the header. It is therefore recommended to change the header of the query sequence to a short name that you would easily recognize, e.g., myquery. If the query was excluded from the list, add it manually to the top of the list (again, making sure to replace all Us with Ts) with a header you will recognize.\nEnter a job title and an e-mail address (optional but highly recommended) and submit the job, leaving the rest of the parameters on the default settings.\n7. Download MSA in Clustal format.\nAt the top of the results page of the MAFFT alignment, there is a “Clustal format” link. Press it to download a file of the alignment in Clustal format.",
    "The RNACentral search engine for detecting RNA homologs follows a single rigid pipeline. Alternatively, for more flexible and comprehensive homology search it is possible to install and use nHMMER locally. This advanced option is meant for experts.\nNecessary Resources\nHardware\nComputer with Internet connection, under Windows, Mac, or Linux\nSoftware\nHMMER, can be downloaded from the HMMER site (http://hmmer.org/[href=http://hmmer.org/]) and run on a Linux-based platform\nNotepad++, or any other similar text editor\nFiles\nRNA database in FASTA format downloaded from RNAcentral (http://ftp.ebi.ac.uk/pub/databases/RNAcentral/current_release/sequences/rnacentral_active.fasta.gz[href=http://ftp.ebi.ac.uk/pub/databases/RNAcentral/current_release/sequences/rnacentral_active.fasta.gz])\nA file of the query sequence in FASTA format\n1. HMMER installation.\nIf you do not have HMMER on your computer, download it from the HMMER web page (http://hmmer.org/[href=http://hmmer.org/]). Mac and Linux users can install it following the instructions in the “User Guide,” which is included in the download folder. For Windows users, a Linux subsystem for windows (LSW) is required. Cygwin is one such LSW that you can install by following the instructional video at https://www.youtube.com/watch?v=MBtbgZ7OmNM&ab_channel=ebioinformaticsYoutubeChannel[href=https://www.youtube.com/watch?v=MBtbgZ7OmNM&ab_channel=ebioinformaticsYoutubeChannel] (this guide is applicable for windows 10 as well as Windows 7). Once installed, follow the instructions in the “User Guide” to install HMMER on the LSW.\n2. Search for homologs using nHMMER locally.\nRun the query sequence against an RNA database using the following Synopsis:\nnhmmer --rna -E <x> --incE <x’> -A <f> queryfile seqdb\n--rna asserts that the sequences are RNA.\n-E <x> Target sequences with an E-value of\n<= <x> will be reported; the default is 10.0.\n--incE <x’> Use an E-value of\n<= <x’> as the inclusion threshold, the default being 0.01.\n-A <f> Save a multiple alignment of all hits that satisfy the inclusion thresholds to the file\n<f>.\nQueryfile is the file with the query sequence, including the path if needed.\nSeqdb is the database of sequences from RNACentral, including the path if needed.",
    "3. Convert the alignment file from Stockholm to FASTA format.\nUsing the HMMER miniapp esl-reformat, the aligned output can be converted to a dataset in FASTA format, which is required for the next steps.\nSynopsis:\nesl-reformat\n-o <f> fasta seqfile\n-o <f> saves the output to file\n<f>.\nSeqfile is the aligned output file from the previous step.\n4. Adjust the sequences for compatibility with ConSurf.\nConSurf can only work with DNA nucleobases, i.e., A, C, G, and T. When constructing an RNA MSA, ConSurf replaces all U characters in the sequences with the character T, but when constructing an MSA externally, this adjustment needs to be done manually. To do so, open the FASTA file <f> using Notepad++ (or a similar text editor), replace all U's with T's, and save the changes.\n5. Cluster the sequences using cd-hit-est (http://weizhong-lab.ucsd.edu/cdhit-web-server/cgi-bin/index.cgi?cmd=h-cd-hit[href=http://weizhong-lab.ucsd.edu/cdhit-web-server/cgi-bin/index.cgi?cmd=h-cd-hit]; see Fig. 9[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.270#cpz1270-fig-0009]).\ncd-hit-est is a tool that clusters nucleotide sequences based on a sequence identity threshold set by the user. The idea is to reduce the number of homologs in the dataset while keeping the integrity of the sequence diversity in the dataset, i.e., to produce a list of “effective” homologs.\nIncreasing the threshold increases the number of representatives. We recommend setting the sequence identity threshold between 0.95 and 0.8. For the best results, aim for the highest threshold that generates at most 300 effective homologs. ConSurf needs at least 5 homologs, and when the number of homologs exceeds 300, the run time significantly increases.\nUpload the homologs file produced in the previous step and leave “Incorporate annotations info at header line” unchecked. Change the “Sequence identity cut-off” if needed (default is 0.9), enter an e-mail address (optional but highly recommended), and submit the job, leaving the rest of the parameters on the default settings.",
    "6. Check the resulting representative sequences for your query.\nIn the results page, open the FASTA file for representative sequences at X% identity (X being the percentage you entered in the search) and check for your query sequence. If included, the query should appear at the top of the list, but it might be excluded from the list of effective homologs. Select all the sequences and copy them.\n7. Align the sequence dataset using MAFFT (https://mafft.cbrc.jp/alignment/server/[href=https://mafft.cbrc.jp/alignment/server/]).\nOpen the MAFFT alignment server and paste the sequences copied from the CD-HIT results. The headers of the sequences will be edited by MAFFT, leaving only the number code at the beginning of the header. It is therefore recommended to change the header of the query sequence to a short name that you would easily recognize. If the query was excluded from the list, add it manually to the top of the list (again, making sure to replace all U with T) with a header you will recognize.\nEnter a job title and an e-mail address (optional but highly recommended) and submit the job, leaving the rest of the parameters on the default settings.\n8. Download MSA in Clustal format.\nAt the top of the results page of the MAFFT alignment, there is a “Clustal format” link. Press it to download a file of the alignment in clustal format."
  ],
  "subjectAreas": [
    "Bioinformatics"
  ],
  "bigAreas": [
    "Bioinformatics & Computational Biology"
  ]
}