{
  "id": 3706,
  "origin_website": "Cell",
  "title": "PhenoMapping: a protocol to map cellular phenotypes to metabolic bottlenecks, identify conditional essentiality, and curate metabolic models",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nTo enable identification of cellular processes underlying phenotypes, PhenoMapping leverages all available biochemical information of an organism as integrated into a GEM, as well as omics (e.g., metabolomic, transcriptomic) and phenotypic data in one or more conditions or life stages. These measurements are used along with the metabolic model of the organism of interest to study context-specific metabolic function and essentiality, identify sets of conditions that explain phenotypes, and if necessary further curate the GEM. Comparison between essentiality predictions and phenotypic data allows to assess accuracy of the GEM. Some of the steps have been extensively described previously, and some were recently first introduced (Chiappino-Pepe et al., 2017[href=https://www.wicell.org#bib11]; Stanway et al., 2019[href=https://www.wicell.org#bib52]). Here, we present a comprehensive protocol describing the proper and practical integration of all relevant PhenoMapping steps, as well as advice on checks and troubleshooting, to allow efficient and accurate analysis of origin of phenotypes and curation of GEMs (Figure 2[href=https://www.wicell.org#fig2]). We define both setup and analysis steps. In a setup step, we conceptualize a study or perform changes in the GEM that do not involve any analysis. These steps are GEM- and case-specific and require mental or manual work. In an analysis step, we perform actual analysis on the GEM. All analysis steps are automatized within PhenoMapping. We emphasize the applications of this protocol to study eukaryotic pathogens like malaria (Plasmodium) and toxoplasma (Toxoplasma) parasites for which there is a higher uncertainty in the metabolism and growing conditions. This protocol can be easily adjusted for other complex eukaryotic organisms like human cells and also prokaryotic systems.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/425-Fig2.jpg\nFigure 2. The PhenoMapping workflow showing steps (colored boxes) and input data (boxes marked with databases)",
    "A GEM is a necessary input (solid arrow) to the workflow and phenotypic and omics data are optional inputs (dashed arrows). When phenotypic data are not available a purely in silico analysis of predicted phenotypes and bottlenecks will be performed. The PhenoMapping workflow involves five steps to map phenotypes to bottlenecks: PhenoMapping study design (blue), metabolic model contextualization (lila), essentiality prediction (pink), accuracy assessment (red), and bottleneck identification (green). An additional step can be added to curate the metabolic model if needed (yellow). The PhenoMapping workflow is often iterative (feedback loop). We include an approximate assessment of the timing each step takes.\nPhenoMapping study design\nTiming: 1–30 min\nThe PhenoMapping workflow is summarized in Figure 2[href=https://www.wicell.org#fig2]. The first step is a setup step and involves the design of a PhenoMapping analysis. PhenoMapping classifies the information included in a GEM in two classes: organism-specific and context-specific information. Each class has also its layers of information that correspond to constraints in a GEM with different types of physico-chemical meaning and hierarchy (Figure 3[href=https://www.wicell.org#fig3]). In the PhenoMapping study design, we use the knowledge of these layers to select pieces of information and data (among all datasets collected in the Before you begin[href=https://www.wicell.org#before-you-begin] section) to integrate into a GEM for the next analyses.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/425-Fig3.jpg\nFigure 3. Layers of information or physico-chemical constraint types in a GEM and their hierarchy as suggested within PhenoMapping",
    "Note: the hierarchy of the organism-specific layers in PhenoMapping makes it possible to distinguish between two classes of incorrect essentiality predictions or false negatives: those arising due to a lack of information in the model, like missing genome annotations, and those arising due to an incorrectly defined pre-assumed transport/reaction directionality or enzymatic irreversibility (ad hoc constraints). PhenoMapping suggests adding first all possible missing gene annotations and metabolite transports, and later introducing ad hoc irreversibility constraints when needed. The hierarchy of the context-specific layers in PhenoMapping is suggested based on the uncertainty of the data and methodology to integrate such data into the GEM. For example, data on media composition tend to be more reliable than measures of RNA levels. In addition, simulating the effect of a lack of substrate in the medium is more straightforward than simulating the effect of an RNA level on the cellular physiology using a GEM.\nSelect the type of PhenoMapping analysis to perform:\nOrganism-specific PhenoMapping analysis to identify unconditionally essential genes and curate a generic GEM. This analysis also maps phenotypes to the following layers of information: (1) metabolic functions annotated to the genome, (2) enzyme localization, (3) transportability of metabolites between intracellular compartments, (4) enzymatic irreversibility, and (5) a set of metabolic tasks related to biomass production (Figure 3[href=https://www.wicell.org#fig3]).\nContext-specific PhenoMapping analysis to study conditional essentiality and generate a context-specific GEM. This analysis also maps phenotypes to the following layers of information: the (6) media composition or uptakes, (7) thermodynamic feasibility at some given intracellular conditions including metabolite concentrations, (8) gene expression, and (9) transcriptional regulation or regulation of expression between isoenzymes (Figure 3[href=https://www.wicell.org#fig3]).\nWithin an organism-specific or context-specific analysis, select the layer(s) of information to keep within the GEM:",
    "Biochemistry layer. Analysis of the biochemistry layer serves to identify essential genes as defined uniquely by the genome annotation and metabolic capabilities included in the GEM. This analysis will not account for any physiological constraint in cellular metabolism and hence allows to identify metabolic gaps purely due to missing functional annotations.\nLocalization layer (in eukaryotes). A comparative analysis between the biochemistry and localization layer will identify genes that become essential due to compartmentalization of enzymes and metabolic pathways. The localization layer includes (on the top of the biochemistry layer) localization of enzymes and metabolites, and allows transport of all metabolites without a phosphate, acyl-carrier protein (ACP), and CoA moiety between cytosol and other compartments. If there is experimental evidence that there exists a transporter for a metabolite with a phosphate, acyl-carrier protein, and CoA moiety, this should be allowed.\nNote: there exists arguably some uncertainty in transport mechanisms and annotated transporters in cells and cellular organisms. In PhenoMapping, as done before (Chiappino-Pepe et al., 2017[href=https://www.wicell.org#bib11]; Krishnan et al., 2020[href=https://www.wicell.org#bib28]; Stanway et al., 2019[href=https://www.wicell.org#bib52]; Tymoshenko et al., 2015[href=https://www.wicell.org#bib56]), we assume that any metabolite that contains a phosphate, acyl-carrier protein (ACP), and CoA moiety might not easily diffuse (by simple diffusion) through lipid bilayer membranes and requires a specialized transporter or transport mechanism. The exception is free phosphate that cells normally take up.\nIntracellular transportability layer (in eukaryotes). A comparative analysis between the localization and intracellular transportability layers will highlight genes that become essential when there exist constraints on intracellular transportability. Beside the localization information, this analysis will integrate ad hoc directionalities for transporters or blocked transports.",
    "Enzymatic irreversibility layer. Analysis of the enzymatic irreversibility layer can be compared to the biochemistry (in prokaryotes) or intracellular transportability (in eukaryotes). Such comparison suggests genes that become essential due to irreversible biotransformations (Ataman and Hatzimanikatis, 2015[href=https://www.wicell.org#bib2]). This layer includes ad hoc and pre-assigned reaction directionalities that should be applicable in every growing context and life-stage.\nNote: many GEMs tend to include pre-assumed reaction directionalities as ad hoc reaction bounds. While this approach might increase the prediction accuracy at a specific growth condition, it can also limit the usage of such GEMs in a different scenario and the identification of actual bottlenecks responsible for a phenotype. For example, there might be a set of metabolites whose concentrations are responsible for those reaction directionalities (see Metabolomics layer); we would not identify these bottleneck metabolites when the source of the reaction directionality is not TFA but ad hoc reaction bounds. We recommend defining generic GEMs with the minimum information on a context such that they serve as platforms for integration of media composition and omics data and generation of context-specific GEMs. Such strategy was followed before (Krishnan et al., 2020[href=https://www.wicell.org#bib28]; Stanway et al., 2019[href=https://www.wicell.org#bib52]) with the generation of generic GEMs like iPbe and iTgo and context-specific GEMs like iPbe-blood, iPbe-liver, and iTgo-tachy.",
    "Metabolic tasks. Metabolic tasks serve to evaluate in a modular way how metabolism works, as described before (Agren et al., 2013[href=https://www.wicell.org#bib1]; Carey et al., 2017[href=https://www.wicell.org#bib7]; Chiappino-Pepe et al., 2017[href=https://www.wicell.org#bib11]; Richelle et al., 2019[href=https://www.wicell.org#bib44]; Tymoshenko et al., 2015[href=https://www.wicell.org#bib56]; Wang et al., 2018[href=https://www.wicell.org#bib59]). In an analysis of metabolic tasks, we define a set of input molecules (extracellular nutrients or intracellular precursors) and expected output molecules (biomass precursors or expected end products of a metabolic pathway). Next, we evaluate whether the task is feasible. A task is feasible when it is possible to produce all output molecules using the input molecules. We next evaluate what metabolic pathway was used and which genes are essential to fulfill a task.\nMedia layer. Analysis of in silico minimal media allows to study nutritional requirements, evaluate substrate substitutability, and identify genes that become essential upon substrate inaccessibility. The minimum sets of substrates that rescue essentiality when added to an in silico minimal medium are bottleneck substrates (Stanway et al., 2019[href=https://www.wicell.org#bib52]). The media layer study comprises a systematic analysis of in silico minimal media, essentiality at each minimal medium, and identification of bottleneck substrates.\nNote: media analysis with PhenoMapping is especially useful in organisms for which the growing conditions (media composition) and nutritional requirements is uncertain. This is the case in intracellular parasites (Chiappino-Pepe et al., 2017[href=https://www.wicell.org#bib11]; Krishnan et al., 2020[href=https://www.wicell.org#bib28]; Stanway et al., 2019[href=https://www.wicell.org#bib52]; Tymoshenko et al., 2015[href=https://www.wicell.org#bib56]).",
    "Metabolomics layer. Thermodynamics-based flux analysis will pinpoint genes that become essential due to a set of reaction directionalities imposed by thermodynamic constraints. It is possible to identify sets of metabolites whose concentration ranges determine such reaction directionalities and these are called bottleneck metabolites (Chiappino-Pepe et al., 2017[href=https://www.wicell.org#bib11]). The metabolomics layer study involves a systematic integration of metabolomics data within the TFA framework (Salvy et al., 2018[href=https://www.wicell.org#bib46]), thermodynamically consistent essentiality analysis with or without metabolomics, and identification of bottleneck metabolites.\nTranscriptomics layer. Integrative analysis of RNA-seq data helps to identify genes that become essential due to gene expression constraints. TEX-FBA (Pandey et al., 2019[href=https://www.wicell.org#bib42]) will try to maximize consistency between RNA levels and metabolic reaction fluxes. There will be three classes of genes: highly, medium, and lowly expressed (defined by TEX-FBA parameters; Troubleshooting 8[href=https://www.wicell.org#troubleshooting]). For reactions linked to highly expressed genes, TEX-FBA tries to increase metabolic flux. For reactions uniquely linked to lowly expressed genes, TEX-FBA tries to minimize metabolic flux. The maximum number of such type of agreements counts for a consistency score. Reaction fluxes linked to genes with medium expression are free to vary. PhenoMapping uses TEX-FBA to integrate RNA-seq data and calculate a maximum consistency score. It next performs essentiality analysis at the maximum consistency score and identifies the metabolic fluxes that are responsible for a gene essentiality, also called bottleneck reactions (Stanway et al., 2019[href=https://www.wicell.org#bib52]).\nRegulation layer. Transcriptomics data analysis also allows identifying isoenzymes that become essential due to lack of transcriptional regulation of counterpart isoenzymes or bottleneck isoenzymes. PhenoMapping regulation analysis include a systematic integration of transcriptomics data within the TEX-FBA framework (Pandey et al., 2019[href=https://www.wicell.org#bib42]), essentiality analysis with transcriptomics considering lack of regulation between isoenzymes, and identification of bottleneck isoenzymes.\nMetabolic model contextualization\nTiming: 10–30 min",
    "The second step in the PhenoMapping workflow (Figure 2[href=https://www.wicell.org#fig2]) is a setup step and involves the contextualization of the GEM as designed in the first step. Predictions from a GEM are the consequence of the biochemical information and physico-chemical constraints integrated into the GEM (Figure 3[href=https://www.wicell.org#fig3]). Here, we define the protocol to define each layer of information in the GEM. We assume that the initial GEM already includes all the corresponding organism-specific information and putatively context-specific information like a medium composition.\nSelect one step between the followings to perform a PhenoMapping analysis at each iteration.\nGenerate a GEM with the ground biochemistry layer.\nRemove all constraints related to omics data integrated into the GEM.\nDefine a rich medium and allow uptake and secretion of all metabolites in the medium.\nRemove ad hoc reaction (intracellular reactions and transports) directionalities in the GEM.\nIf applicable (eukaryotic organism), remove compartmentalization. This is done by defining all reactions in the cytosol or by allowing all metabolites to be transported and present in all intracellular compartments.\nGenerate a GEM with localization layer (in eukaryotes).\nRemove all constraints related to omics data integrated into the GEM.\nDefine a rich medium and allow uptake and secretion of all metabolites in the medium.\nRemove ad hoc reaction (intracellular reactions and transports) directionalities in the GEM.\nIf applicable (eukaryotic organism), allow all metabolites without a phosphate, acyl-carrier protein (ACP), and CoA moiety to be transported between cytosol and other compartments. If there is experimental evidence about a transporter for a metabolite with a phosphate, acyl-carrier protein, and CoA moiety, this should be allowed.\nGenerate a GEM with intracellular transportability layer (in eukaryotes).\nRemove all constraints related to omics data integrated into the GEM.\nDefine a rich medium and allow uptake and secretion of all metabolites in the medium.",
    "Remove ad hoc directionalities only for intracellular reactions in the GEM.\nNote: do not modify the directionalities of intracellular metabolite transportability from the initial GEM.\nGenerate a GEM with enzymatic irreversibility layer.\nRemove all constraints related to omics data integrated into the GEM.\nDefine a rich medium and allow uptake and secretion of all metabolites in the medium.\nPrepare a GEM for metabolic tasks analysis.\nDecide whether an analysis with or without thermodynamic constraints should be performed.\nSelect the sets of metabolites whose production you want to test. By default, this will be all biomass building blocks.\nDefine an essentiality threshold (see section Essentiality definition[href=https://www.wicell.org#sec4.13]).\nGenerate a thermodynamically curated GEM for subsequent context-specific PhenoMapping analysis.\nRemove all constraints related to omics data integrated into the GEM.\nDefine a rich medium and allow uptake and secretion of all metabolites in the medium.\nDefine thermodynamically relevant information for each intracellular compartment: pH, generic metabolite concentrations (minimum and maximum allowed values), generic ionic strength (unique value), membrane potential.\nCurate the GEM thermodynamically within the TFA framework.\nGenerate a GEM for a media analysis.\nSelect whether analysis of uptakes or secretions should be performed.\nSelect the sets of transports of extracellular metabolites among which the minimal uptake or secretion analysis will be performed; Troubleshooting 4[href=https://www.wicell.org#troubleshooting]. By default, all substrates in the media will be selected. We indicate below two types of analysis (targeted or untargeted) that one can perform depending on the substrates made available and the uptakes selected for media analysis.",
    "Critical: it is important to note that the algorithm will not unblock uptakes or secretions in the GEM. If uptakes and secretions were blocked in the GEM input to the PhenoMapping media analysis, they will remain blocked in the media analysis. Hence, it is important to properly define a media composition before one begins the PhenoMapping analysis (see section Medium definition[href=https://www.wicell.org#sec4.11]).\nRecommended: For an untargeted analysis of in silico minimal media, one should have defined a rich medium in the GEM (see the Medium definition[href=https://www.wicell.org#sec4.11] section; Troubleshooting 4[href=https://www.wicell.org#sec7]). At this stage, all uptakes should be selected for the media analysis. Following this setup, one will identify all alternative minimal sets of molecules required for in silico growth in the correct combination. It was shown before (Chiappino-Pepe et al., 2017[href=https://www.wicell.org#bib11]) that such an analysis provides further understanding of the molecular substructures or backbone moieties that a cell needs to scavenge. The requirement to scavenge such moieties occurs when the biochemical information and further physio-chemical constraints defined in the GEM (that probably represent the metabolic function of the organism) do not allow the biosynthesis of such backbone moieties.\nAlternatives: For a targeted analysis of in silico minimal media, one should have defined a specific medium in the GEM before beginning the PhenoMapping analysis. In this medium the GEM should be feasible. At this stage, one defines the subset of substrates of interest for the media analysis. This analysis identifies within the subset of substrates, the minimum number of substrates required to achieve a minimum value of the objective (e.g., growth).\nPerform the in silico minimal medium analysis.\nDefine in the GEM a combined minimal medium comprising all substrates identified across all alternative in silico minimal media. We use minimal media alternatives that contain the same number of substrates.",
    "Critical: defining here a combined minimal medium simplifies the process to infer the medium of a context-specific GEM. Check the section Quantification and statistical analysis[href=https://www.wicell.org#quantification-and-statistical-analysis] (Results of a PhenoMapping analysis of bottleneck substrates[href=https://www.wicell.org#sec4.15]) for more details on the importance of this last step to optimally guide the definition of the media in the context-specific GEM.\nGenerate a GEM for a metabolomics analysis.\nIntegrate the metabolomics dataset into the GEM.\nVerify that the GEM is feasible within TFA when metabolomics data are integrated; Troubleshooting 9[href=https://www.wicell.org#troubleshooting].\nGenerate a GEM for a transcriptomics and regulation analysis.\nDecide whether or not to plot the distribution of gene expression values.\nSelect the TEX-FBA parameters defining the percentile of lowly and highly expressed genes in the distribution of gene expression values; Troubleshooting 8[href=https://www.wicell.org#troubleshooting].\nSelect the TEX-FBA parameters defining the bounds assigned to lowly and highly expressed reactions; Troubleshooting 8[href=https://www.wicell.org#troubleshooting].\nSelect the reactions for which gene expression constraints should not be defined\nDecide which transcriptomics profile an output GEM should include.\nNote: upon integration of transcriptomics data, TEX-FBA will identify all alternative transcriptomic profiles that render a maximum consistency score between gene and reaction levels. One can select one specific transcriptomic profile for the subsequent analysis. Alternatively, one can also select a combined expression profile, which will account uniquely for the expression constraints common to all transcriptomic profiles.\nIntegrate the transcriptomics dataset into the GEM.\nDefine the following inputs common to any context-specific PhenoMapping analysis.\nRemove all constraints related to omics data integrated into the GEM. This is not necessary if one uses a generic GEM.\nDefine the expected value of the selected objective function (normally growth) at the conditions to study.\nDefine the selected essentiality threshold (see section Genetic background and essentiality definition[href=https://www.wicell.org#sec4.13]).",
    "Note: a value of the selected objective function and essentiality threshold will be used to identify a minimum required objective value. For example, in the media analysis, we first identify the in silico minimal media or the minimum number of substrates required to achieve at least a required value of the objective. Such value is given by the input values of the objective function and essentiality threshold.\nSelect a time limit (in seconds) for the CPLEX solver. By default, none.\nDefine whether one wants to identify uniquely alternatives for the optimal value of the objective function (preferred). Alternatively, one can look for suboptimal solutions. For example, one can find an in silico minimal media with 19 substrates and identify all alternative combinations of 19 substrates that allow growth. One can also identify alternative combinations with 20 or more substrates.\nSelect a maximum number of alternative solutions to obtain. This is applicable every time a mixed integer formulation is defined. For example, for the identification of alternative in silico minimal media and alternative bottleneck substrates.\nNote: it is preferred to select a high number of alternatives like 5,000; check Troubleshooting 10[href=https://www.wicell.org#troubleshooting] for suggestions when the optimization crashes or the number of alternatives selected was not enough.\nEssentiality prediction\nTiming: 1–10 min",
    "The third step in an analysis step and involves a prediction of gene essentiality with the contextualized GEM. If one performs a context-specific PhenoMapping analysis, the set of essential genes will be compared with the unconditionally essential genes or genes predicted as essential with the general GEM input to the PhenoMapping workflow. If one performs an organism-specific PhenoMapping analysis, one might compare the set of essential genes with the ones obtained in the immediate previous layer of information. Predictions of gene essentiality are expected to vary between the contextualized GEMs. Here, we define the suggested steps to identify essential genes in any GEM within PhenoMapping.\nNote: check Troubleshooting 11[href=https://www.wicell.org#troubleshooting] if infeasibilities arise when calculating essentialities.",
    "Optional: In a transcriptomic analysis, one can perform two types of essentiality analysis consistent with transcriptomics: (a) fix a unique transcriptomic profile; this is done by fixing the integer variables linked to all up and down reaction levels; (b) fix an assembly of transcriptomic profiles that satisfy a maximum consistency score. The maximum consistency score is a variable within TEX-FBA and defines the number of reactions that can carry low or high fluxes and are consistent with the classification of lowly and highly expressed genes, respectively. There may exist multiple alternative transcriptomic profiles that share the same maximum consistency score. These alternatives are an assembly of transcriptomic profiles. To fix such an assembly, we define the lower bound of the maximum consistency score with a value that is some decimals below the optimal objective value. This is to avoid problems with the precision of the solver; Troubleshooting 12[href=https://www.wicell.org#troubleshooting]. To provide some flexibility around the transcriptomic profiles, one can further relax the lower bound of the maximum consistency score by some integers. This option-b only differs from option-a if there is more than one alternative transcriptomic profile for the maximum consistency score within TEX-FBA.\nDefine the objective function chosen for the GEM; Troubleshooting 5[href=https://www.wicell.org#troubleshooting].\nDouble check that the contextualized GEM is feasible; Troubleshooting 6[href=https://www.wicell.org#troubleshooting].\nPerform the in silico essentiality study.\nOptional: An essentiality analysis per growth associated metabolic task can be performed. This will identify which biomass building block is responsible for the observed essentiality (Chiappino-Pepe et al., 2017[href=https://www.wicell.org#bib11]) (Figure 4[href=https://www.wicell.org#fig4]).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/425-Fig4.jpg\nFigure 4. Schema of growth simulation using a GEM",
    "(A)The GEM uses a set of substrates or nutrients to produce molecules required for growth or biomass building blocks in the stoichiometrically required amounts (ηi). Biomass building blocks are monomers of macromolecules required for the cellular function. The stoichiometric coefficients of the biomass building blocks satisfy the concentration of macromolecules in the cell (v, w, x, y, z).\n(B) Predicted growth upon single knockout of each gene in the blood-stage-specific P. berghei GEM (iPbe-blood). We classify genes based on the essentiality threshold (dashed line bottom) and growth reduction threshold (dashed line top) into essential, growth reducing, and dispensable. The essentiality threshold (here 10%) and growth reducing threshold (here 90%) define which genes are essential and growth reducing, respectively, based on the predicted growth upon knockout (KO growth) compared to the predicted wild-type growth (WT growth). iPbe-blood predicts 146 essential genes, 9 growth reducing genes, and 273 dispensable genes (with solver version CPLEX 12.8.1 or above). Acronyms: AAs, amino acids; PG, phosphatidylglycerol; PE, phosphatidylethanolamine; PS, phosphatidylserine; PC, phosphatidylcholine; free FA, free fatty acids; TAG, triacylglycerol; DAG, diacylglycerol.\nSelect an output to identify essential genes:\nRatio of optimal value of the objective function between the input (normally wild-type) GEM and the single gene knockout GEM.\nAbsolute value of the objective function in the single gene knockout GEM.\nNote: both approaches if compared with the corresponding reference values (as described in the next point) ultimately result in the same set of essential genes. However, selecting the absolute value of the objective function to identify essential genes allows to define an arbitrary value of the objective function as reference. This latter option might be more appropriate in a situation of high uptake rates (very unconstrained model) and high growth.\nIdentify all knockouts rendering a value below the essentiality threshold chosen (Figure 4[href=https://www.wicell.org#fig4])",
    "If the ratio is below the essentiality threshold the gene is considered as essential.\nIf the predicted value of the objective function is below the product of the essentiality threshold and the initial value of the objective function the gene is considered as essential.\nNote: by default, in PhenoMapping all infeasible solutions (NaN) upon a gene knockout consider the gene essential. However, a lack of convergence in the optimization and problems with the solver might also render infeasible solutions; Troubleshooting 12[href=https://www.wicell.org#troubleshooting].\nAccuracy assessment\nTiming: 1–5 min\nThe fourth step is an analysis step and involves an accuracy assessment of the gene essentiality prediction with the contextualized GEM. This step is possible when there are phenotypic data available in the PhenoMapping workflow (Figure 2[href=https://www.wicell.org#fig2]). In this step, a contingency matrix is generated (Figure 5[href=https://www.wicell.org#fig5]) and the set of correct and incorrect predictions is identified.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/425-Fig5.jpg\nFigure 5. Contingency matrix for the blood-stage-specific P. berghei GEM (iPbe-blood) compared to the blood-stage-specific PlasmoGEM phenotypes\nThe accuracy values for this contingency matrix are: MCC = 0.63, overall accuracy = 0.79, NPR = 0.96, PPR = 0.67, sensitivity = 0.96, and specificity = 0.67.\nCompare the list of in silico essential and non-essential genes with the experimentally observed (in vivo) phenotypes.\nClassify all compared genes in the GEM in four groups: TPs, TNs, FPs, and FNs.",
    "Note: if “slow” phenotypes are available, one should decide how to treat them, i.e., as essential, or dispensable. This decision might be determined by the layer of information analyzed within PhenoMapping. For example, during a PhenoMapping analysis of the biochemistry layer, slow phenotypes might be better considered as dispensable. This is because one expects that slow phenotypes arise due to the presence of a redundant and non-optimal function that can partially compensate for the loss of the slow-phenotype gene. However, during a PhenoMapping analysis of the transcriptomics layer, slow phenotypes might be well considered as essential. This is because a GEM with transcriptomics data integrated identifies genes that are essential to maintain the defined (optimal) transcriptomic state. Hence, knocking out such a gene might render a transition to a different (suboptimal) transcriptomic or physiological state.\nOptional: one can also add a classification for genes without data, blocked, or with slow phenotypes (Figure 5[href=https://www.wicell.org#fig5]). The genes classified as blocked and without data are not considered for the computation of the accuracy. The treatment of the slow phenotypes may vary depending on the context of the GEM.\nNote: Blocked genes are genes linked to reactions that cannot carry any flux in the reference conditions, also called blocked reactions. This occurs when any of the metabolites participating in the linked reactions cannot be mass balanced. Blocked reactions are identified with a flux variability analysis (Mahadevan and Schilling, 2003[href=https://www.wicell.org#bib37]). We recommend performing a flux variability analysis in the generic GEM (in a rich medium and without any data integrated) and without any growth requirement. That way, there are no conditional or context-specific constraints leading to the non-function of the gene.\nGenerate a contingency matrix by defining the number of TPs, TNs, FPs, and FNs.",
    "Compute the selected metric to assess the accuracy using the numbers defined in the contingency matrix.",
    "Note: there might be situations in which the number of available in vivo phenotypes is very low compared to the number of genes in the GEM or with in silico phenotypes. Such cases decrease the confidence on the accuracy of the model. Although there is little that a user can do to improve such a situation regarding the availability of phenotypes, the user can choose how to evaluate the FPs and FNs to better assess the accuracy of the GEM’s predictions. FNs arise when the model misses biochemical information or gene annotations or has incorrectly defined constraints. FPs arise when the model misses the definition of a context or constraints. As previously mentioned in this protocol, one can argue that (if the data are fully trustable) having more FNs than FPs in a GEM is worse than having more FPs than FNs. This is because one does not want to include false constraints into the GEM. In many situations a single constraint in the GEM (as identified with PhenoMapping) can be responsible for the essentiality of a FN and a TN. In such a case, we recommend not blindly integrating such constraint to increase the TNs (since that will also increase the FNs). We recommend first adding missing information into the GEM like new biochemistry or gene annotations such that later the named constraint becomes responsible uniquely for the essentiality of the TN. This means we recommend focusing first on correcting or reducing FNs (increasing TPs) and then on reducing FPs (increasing TNs) using PhenoMapping. See the follow-up discussion in the section Quantification and statistical analysis[href=https://www.wicell.org#quantification-and-statistical-analysis]. The fact that PhenoMapping maps phenotypes to constraints may also increase the confidence on the prediction of genes without phenotype.",
    "If a constraint is responsible for one or more TNs and a gene for which no in vivo phenotype is available, we might feel more confident on the essentiality of the gene – primarily if the TNs and the gene without phenotype share metabolic pathways or tasks.",
    "Bottleneck identification\nTiming: 5–60 min\nThe fifth and last step of the PhenoMapping workflow is an analysis step and involves the mapping of bottlenecks to phenotypes. After new genes are identified as essential in the contextualized GEM, PhenoMapping will identify the bottlenecks or underlying cellular processes responsible for that essentiality. This is done by performing one-by-one a knockout of the essential genes in the contextualized GEM and identifying the conditions that rescue growth (Figure 6[href=https://www.wicell.org#fig6]). Here, we define the steps to identify bottlenecks as followed within the systematic bottleneck analysis of each layer of information.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/425-Fig6.jpg\nFigure 6. Representation of bottlenecks studies in PhenoMapping\n(A–C) (A) Bottleneck substrates, (B) bottleneck metabolites, and (C) bottleneck reaction levels. PhenoMapping first simulates with the GEM some conditions (here: (A) in silico minimal media, (B) metabolomics data integrated, and (C) transcriptomics data integrated) and identifies in silico a phenotype (here single gene essentiality for growth). Next, PhenoMapping looks for the bottlenecks responsible for the predicted phenotype (here: (A) missing substrates in the media, (B) sets of metabolite concentration ranges, and (C) sets of levels of reaction fluxes and their corresponding RNA levels). The color code is consistent with the related step in the main PhenoMapping workflow (Figure 2[href=https://www.wicell.org#fig2]).\nKnockout the essential gene in the contextualized GEM.\nIdentify all alternative bottlenecks or the minimum set of information (e.g., substrates, metabolite concentrations, reaction levels) that should be relaxed to rescue the gene knockout (Figure 6[href=https://www.wicell.org#fig6]).",
    "Note: bottleneck substrates are those that can rescue essentiality of the gene when added to the in silico minimal medium. Bottleneck metabolites are those whose concentrations ranges should be relaxed (with respect to the experimentally measured concentration ranges) to rescue essentiality of the gene. Bottleneck reactions are those whose levels (considered to be high or low within the feasible flux range) should be relaxed to rescue essentiality of the gene.\nMetabolic model curation\nTiming: 1–60 days\nNote: the timing to curate a GEM varies radically depending on the available GEM and data and the experience and endurance of the user. Many aspects of the GEM can require curation. The problems in a GEM can range from being badly elementally balanced to missing a considerable amount of gene annotations and associated reactions; see Troubleshooting 2[href=https://www.wicell.org#troubleshooting] to identify all elements that an ideal GEM may include. This section aims to define a pipeline to spot and solve those problems faster.\nThis is a step that combines both setup and analysis steps. We curate a metabolic model when we change the biological and biochemical information it contains. Such information involves genes, gene functions, protein associations (protein complexes or isoenzymes), biochemical reactions, transporters, and biomass building blocks. Since GEMs are normally constructed following a bottom-up approach, it is more likely that a metabolic model curation involves adding missing information. However, curation of a GEM might also involve removing incorrectly defined ad hoc constraints.\nThe curation of the GEM is an optional step in the iterative PhenoMapping workflow (Figure 2[href=https://www.wicell.org#fig2]). The information achieved by mapping in silico bottlenecks to phenotypes facilitates and accelerates the identification of missing biological and biochemical information in the GEM, as well as incorrectly defined ad hoc constraints.",
    "A suggested workflow to curate the GEM using PhenoMapping is defined in Figure 7[href=https://www.wicell.org#fig7]. This workflow is primarily manual. Here, we suggest conceptually how to perform a GEM curation in combination with the main PhenoMapping workflow (Figure 2[href=https://www.wicell.org#fig2]). We propose analyzing one-by-one the incorrect gene predictions: first the FNs and then the FPs. One may follow the steps below in the order defined and select the steps depending on the type of inconsistency (FN or FP) for the gene of study. If the GEM is modified, one may perform a new essentiality analysis and accuracy assessment to evaluate the impact of the curation on the GEM performance.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/425-Fig7.jpg\nFigure 7. Suggested workflow to curate a metabolic model in combination with the PhenoMapping workflow\nThis workflow identifies missing biological and biochemical information in a GEM.\n(A) The workflow to curate false negatives (FNs) involves four steps.\n(B) The workflow to curate false positives (FPs) includes three steps. The curation of a GEM requires collecting and using different types of datasets. The color code is consistent with the related step in the main PhenoMapping workflow (Figure 2[href=https://www.wicell.org#fig2]).",
    "Note: Adding information around true predictions may prevent mismatches in a more constrained scenario. For instance, one needs to identify isoenzymes linked to a reaction (even if the reaction is true positive) to prevent it from being false negative in a constrained scenario. When one supposedly has all information mapped to the GEM, we may wait until a false prediction arises to introduce corrective measures. False predictions arise normally in the PhenoMapping analysis with layers of information that are hierarchically higher. Alternatively, we may perform an unbiased integration of alternative information around true predictions and screen the performance of the model in a more constrained scenario for selection of the best corrective measure. This later option is not discussed here.\nIn this section, we do not consider the integration of context-specific information (like definition of uptake rates and integration of metabolomics and transcriptomics data) as part of the metabolic model curation. We consider that the integration of context-specific information is part of the metabolic model contextualization. The section Quantification and statistical analysis[href=https://www.wicell.org#quantification-and-statistical-analysis] explains how to contextualize a GEM based on the bottleneck information from a context-specific PhenoMapping analysis.\nNote: curating a metabolic model can be a daunting and time-consuming task. Be patient, do sports, eat healthy, and talk with friends and family to remain mentally ok.\n(FN) Perform an essentiality analysis per metabolic task.\nIf there is a metabolic task uniquely responsible for a set of FNs and no true prediction, remove the biomass building block from the biomass reaction.\nIf a biomass building block was removed, update the stoichiometric coefficients of the remaining biomass building blocks accordingly (Chan et al., 2017[href=https://www.wicell.org#bib10]).",
    "(FN) Perform a reannotation of the genome defining more relaxed parameters, e.g., E-values, or look in databases for genes with the same function that are not part of the GEM.\nIf there exists a potential gene with the same function, add the gene to the GEM with an OR relation in the gene-protein-reaction association.\n(FN) Perform a gap-filling with the gene knocked out to identify missing alternative biochemistry in the GEM.\nSelect a proper database to look for alternative biochemistry. We distinguish three classes of databases: (1) GEMs of closely related organisms, which can be found in databases for GEMs like BiGG (King et al., 2015[href=https://www.wicell.org#bib26]), modelSEED (Devoid et al., 2013[href=https://www.wicell.org#bib12]), KBase (US Department of Energy Systems Biology Knowledgebase, http://kbase.us[href=http://kbase.us]), publications, etc.; (2) databases of biological reactions like KEGG (Kyoto University, 1995[href=https://www.wicell.org#bib30]), MetaCyc (Caspi et al., 2018[href=https://www.wicell.org#bib9]), BRENDA (Jeske et al., 2019[href=https://www.wicell.org#bib25]), etc.; (3) the upper bound of biochemistry with hypothetical biochemical reactions between known compounds based on known enzyme reaction rules, i.e., the ATLAS of Biochemistry (Hadadi et al., 2016[href=https://www.wicell.org#bib15]; Hafner et al., 2020[href=https://www.wicell.org#bib17]).\nCritical: the compatibility of metabolite identifiers between the GEM and the database plays a critical role in the selection of the database. Metabolite identifiers need to match to assure the proper connectivity of the metabolic networks of the GEM and database. It is also important to consider which version of the database to use. We would recommend working with the latest version, but that might create conflicts with metabolite identifiers or other identifiers like genes. For this reason, the user might consider working with an earlier version.\nIdentify a gap-filler that suits the GEM, database, computational power available, and desired gap-filling strategy.",
    "There exist multiple examples of gap-fillers, as summarized before (Pan and Reed, 2018[href=https://www.wicell.org#bib41]). Some recent examples are: gapseq (Zimmermann et al., 2020[href=https://www.wicell.org#bib60]) or OptFill (Schroeder and Saha, 2020[href=https://www.wicell.org#bib49]).\nIf there exists an alternative biochemistry that rescues the knockout, integrate it into the GEM.\n(FN) Investigate the possibility of a metabolite in the GEM being scavenged to rescue the KO.\nIf there is evidence that the metabolite selected might be available at the cellular state studied, and the transport of such metabolite is possible (by any transport mechanism), define the transport in the GEM.\n(FP) Search for a missing metabolic task downstream of the FP gene.\nIf there is a downstream product that could be a biomass precursor and its definition as a metabolic task does not create inconsistencies, add it to the biomass reaction.\nIf a biomass building block was added, update the stoichiometric coefficients of the remaining biomass building blocks accordingly (Chan et al., 2017[href=https://www.wicell.org#bib10]).\n(FP) Perform a flux variability analysis with a non-zero lower bound for the objective function.\nIf the reactions linked to the gene cannot carry flux, perform a gap-filling (next step).\n(FP) Perform a gap-filling with the objective function redefined to require flux through the FP gene.\nSelect a proper database to search for missing biochemistry.\nIdentify a gap-filler that suits the GEM, database, computational power available, and desired gap-filling strategy.\nThere exist multiple examples of gap-fillers, as summarized before (Pan and Reed, 2018[href=https://www.wicell.org#bib41]). Some recent examples are: gapseq (Chan et al., 2017[href=https://www.wicell.org#bib10]) or OptFill (Schroeder and Saha, 2020[href=https://www.wicell.org#bib49]).\nIf there exist biochemical steps that can connect the metabolic network defined in the GEM with the FP gene, define it.",
    "Note: The order in which these steps are applied affects the definition of the GEM and later the identification of bottlenecks. We recommend following the order of steps defined in this section. The steps to curate FNs and FPs are defined in this order to identify first issues on which the user has more confidence. For example, to curate FNs we first check if there is an error in the objective function (a fact). Then we evaluate whether a gene is missing from the GEM (an E-value defines the confidence of the annotation). If no gene is found, we perform a gap-filling (a hypothetical non-annotated biochemical function). If no gap-filling reaction is found, we allow uptake of a metabolite (GEMs show the highest uncertainty in the definition of metabolite transports).\nThe PhenoMapping workflow is often iterative\nTiming: variable\nOne would perform as many passages through the PhenoMapping workflow as layers of information one desires to analyze (feedback in Figure 2[href=https://www.wicell.org#fig2]). The layers of information can be analyzed independently or in a cumulative fashion. An independent analysis is recommended for the first PhenoMapping iterations and in a generic GEM. A cumulative analysis is recommended after an independent analysis and in a context-specific GEM. The order of the analysis would be hierarchical as suggested in Figure 3[href=https://www.wicell.org#fig3] and argued in the section PhenoMapping study design[href=https://www.wicell.org#sec3.1]. In addition, more iterations through the PhenoMapping workflow might be required when a curation of the GEM is selected.\nPerform an independent, individual, and separate analysis of each layer of context-specific information to identify individual bottlenecks responsible for phenotypes. In an independent analysis of constraint types, a generic GEM is used to integrate each dataset independently, identify new essential genes, and map gene essentiality to bottlenecks.",
    "Perform also a cumulative and hierarchical integration of constraint types (Figure 3[href=https://www.wicell.org#fig3]). In such a cumulative analysis, new essentialities might be identified at each integration step and can be mapped to sets of constraints within the last layer of information considered. The independent analysis of constraint types may limit the set of predicted phenotypes. A cellular phenotype is the product of a cumulative rather than individual effect of physico-chemical constraints. Hence, a cumulative analysis is recommended to analyze a context-specific GEM."
  ],
  "subjectAreas": [
    "Metabolism",
    "Bioinformatics",
    "Systems Biology"
  ],
  "bigAreas": [
    "Molecular Biology & Genetics",
    "Bioinformatics & Computational Biology"
  ]
}