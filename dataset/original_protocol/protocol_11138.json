{
  "id": 11916,
  "origin_website": "Jove",
  "title": "Forecasting Hepatocellular Carcinoma Mortality using a Weighted Regression Model to Estimate Cohort Effects in Taiwan",
  "procedures": [
    "1. Data sources\nTo demonstrate the calculations, we used annual data on HCC mortality from 1976 to 2015 for men and women in Taiwan. Statistical package for social sciences (SPSS) version 24.0 for Windows and Microsoft Excel were used to execute the protocols for this study.\nHave the HCC physician classify the patients' clinical symptoms, laboratory tests and medical imaging results to give a diagnosis code according to the International Classification of Disease (ICD) Code, ICD 150.\nEnsure that the data file (saved as a CSV) contains the year (i.e., period), age, cohort, death number, mid-year population number, and mortality as columns.\n\t\nClick File | Import Data | CSV data | Open. Make sure there is a check in the box next to Read variable names from the first row of the data and click OK. Ensure that the data file is imported into SPSS.\nConstruct contingency table data crossed by age-period groups through SPSS. In general, we defined row variables as age and column variables as period. If the data featured single period year (or single age year) data, it was necessary to integrate them into a period group (or age group). Then, we cross-tabulated the attitudes to an age group across the survey years.\n\t\nClick Analyze | Descriptive Statistics | Crosstabs and select the age variable in the box next to row(s) and period variable in the box next to column(s). Click Cells and make sure that there is a check in the box next to Observed. A contingency table of death number (or mid-year population number, or mortality) can be performed in SPSS by the above steps.",
    "Export the contingency table data that were entered in CSV format for analysis through other software. Click File | Export Data | Ensure Desired Data Format as CSV | Location. This non editable field displays the safe location for the exported file.\nFile name: Click Select to change the file name.\nExport as type: Select a CSV file type from the drop-down menu. Click variables to display the available variables and to select the variable tables. By default, all variables from the source data set are retained for the exported file. Researchers can use the tables to specify which source variables to include in the exported file. Click Export.\n2. Model setting\nNOTE: The multistage method was proposed by Keys and Li 8 with graphical investigation. A median polish analysis was performed to eliminate the cumulative effects of age and period; finally, these residuals from the median polish phase in the cohort category in the linear regression model were regressed, and cohort effects using data in the contingency table were evaluated.\nGraphical representation as the first phase\n\t\nCreate a line plot of age groups and period groups. To inspect birth cohorts across age groups or birth cohorts, draw even birth cohorts across ages or cycles in the line charts.\nImport a CSV file with contingency table mortality data. Click File | Open | Browse to select a CSV file from a folder. Remember to choose All Files in the drop-down list next to File name box.\nClick Open to open the CSV file. Highlight the rows and columns of the mortality contingency data and click Insert | Charts | Line Graph.\nMedian polish analysis as the second phase",
    "Iteratively subtract the median from each row and each column to eliminate the cumulative effect of age and period. After the median polishing phase, keep the residuals for the regression procedure to evaluate the cohort effects.\nCompute the overall median and residual table. Import a CSV file with contingency table mortality data (refer to 2.1.1.2).\nLN was used for each cell of the contingency table mortality data. Click Formulas | Mathematical & Trigonometry Function and select LN.\nNumber: Enter the location label for each cell. Ensure each cell of the contingency table mortality data took LN. Click Formulas | More Functions | Statistics and select MEDIAN.\nNumber1: Enter the first cell location label.\nNumber2: Enter the last cell location label. Ensure that the resulting median value is stored in the upper left-hand margin of the contingency table. Ensure a residual table is created by taking the difference between the original value (i.e., the LN mortality data) and the overall median.\nCompute the row medians (i.e., the medians of each age group) and ensure it computed the row median values for the response age group. Click Formulas | More Functions | Statistics | Select MEDIAN.\n\t\t\nNumber 1: Enter the first cell location label of the raw sample.\nNumber 2: Enter the last cell location label of the raw material. Ensure the resulting row median values are stored in the left-hand margin of the contingency table.\nCreate a new residual table after subtracting from the row medians. Ensure a new set of residual values is created from the row medians where each cell takes on the value of the subtraction of the row median from each response variable in that row. Click = and ensure each row's overall cell location label has subtracted the label of the left-hand margin median.",
    "Compute the column medians (i.e., the medians of each period group) and ensure it computes the column median values for the response period group. Click Formulas | More Functions | Statistics | Select MEDIAN.\n\t\t\nNumber 1: Enter the first cell location label of the column. Number 2: Enter the last cell location label of the column. Ensure the resulting column median values are stored in the upper margin of the contingency table.\nCreate a new residual table after subtracting from the column medians. Ensure a new set of residual values is created from the column medians where each cell takes on the value of the subtraction of the column median from each response variable in that column. Click = and ensure each column overall cell location label has subtracted the label of the upper margin median.\nRepeat Steps 2.1.2.7 to 2.1.2.10 until the row and column medians approximate zero. Click Formulas | More Functions | Statistics | Select MEDIAN. Make sure the row and column medians are approximately zero. Save the final residual table in CSV format.\nRegression procedure with weight as the third phase\n\tNOTE: We calculated the dependent variable as residuals for each cohort with death number as the weight. Next, we ran linear regressions to calculate the cohort effects.\n\t\nEnsure Kutools for Excel was installed and use its Transpose Table Dimensions tool to quickly convert cross tables to flat lists. Import a CSV file with contingency table residual data (refer to 2.1.2.11).\nSelect the table to be converted to a list. Click the Kutools | Modify | Transpose Table Dimension. In the Transpose Table Dimensions dialog box, make sure there is a check in the box next to the Cross table to list, and select the Results range to store the residuals in list format.",
    "Column insert in the initial data file (refer to 1.2) with the residual list format data (refer to 2.1.3.1). Ensure it inserted a supporting column in the residual list format data (refer to 2.1.3.1). Click = age & period variables and click Enter. Use a supporting column to look up the age and period group labels of the residual list format data to insert a response residual column in the initial data file (refer to 1.2).\nClick Formulas | Lookup & Reference | Select VLOOKUP. Set VLOOKUP (cell location label of age & cell location label of the period, first cell location label of the supporting column: the last cell location label of the residual column, 4, 0). Make sure the select range includes supporting, age, period, and residual columns (i.e., the 4th column as the residual list).\nEnsure that the residuals are inserted in the initial data file (refer to 1.2) look up for the residual list format data (refer to 2.1.3.1) for the next step. Fit the regression model by unweighted least squares and analyze the residuals.\nClick Analyze | Regression | Linear. Transfer the independent variable, cohort category (i.e., 17 birth cohorts), into the Independent(s), box and the dependent variable, Residuals, into the Dependent: box. Click OK. Ensure generate the results of the unweighted cohort effects.\nEnsure that the residuals are inserted in the initial Excel data file (refer to 1.2) look up for the residual list format data (refer to 2.1.3.1) for the next step. Fit the regression model by weighted least squares and analyze the residuals. Click Analyze | Regression | Linear.",
    "Transfer the independent variable and cohort category (i.e., 17 birth cohorts) into the independent(s) box and the dependent variable and residuals into the dependent: box. Transfer the death number into the WLS weight box. Click OK. Ensure it generates the results of the weighted average of the cohort effect.\nSubscription Required. Please recommend JoVE to your librarian."
  ],
  "subjectAreas": [
    "Cancer Research"
  ],
  "bigAreas": [
    "Biomedical & Clinical Research"
  ]
}