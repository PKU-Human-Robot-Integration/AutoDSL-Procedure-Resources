{
  "id": 10319,
  "origin_website": "Jove",
  "title": "Substructure Analyzer: A User-Friendly Workflow for Rapid Exploration and Accurate Analysis of Cellular Bodies in Fluorescence Microscopy Images",
  "procedures": [
    "NOTE: User-friendly tutorials are available on Icy’s website http://icy.bioimageanalysis.org.\n1. Download Icy and the Substructure Analyzer protocol\nDownload Icy from the Icy website (http://icy.bioimageanalysis.org/download) and download the Substructure Analyzer protocol: http://icy.bioimageanalysis.org/protocols?sort=latest.\n\tNOTE: If using a 64-bit OS, be sure to use the 64-bit version of Java. This version allows for increasing the memory allocated to Icy (Preferences | General | Max memory).\n2. Opening the protocol\nOpen Icy and click on Tools in the Ribbon menu.\nClick on Protocols to open the Protocols Editor interface.\nClick on Load and open the protocol Substructure Analyzer. Protocol loading can take a few seconds. Be sure that the opening of the protocol is complete before using it.\n\tNOTE: The workflow is composed of 13 general blocks presented in Figure 2a. Each block works as a pipeline composed of several boxes performing specific subtasks.\n3. Interacting with the workflow on Icy\nNOTE: Each block or box is numbered and has a specific rank within the workflow (Figure 2b). By clicking on this number, the closest possible position to the first is assigned to the selected block/box then the position of the other blocks/boxes is re-organized. Respect the right order of the blocks when preparing the workflow. For example, Spot Detector block needs pre-defined ROIs so that Segmentation blocks have to run before Spot Detector blocks. Do not modify the position of boxes. Do not use “.” in the image’s name.\nBy clicking on the upper left corner icon, collapse, expand, enlarge, narrow, or remove the block (Figure 2b).\nEach pipeline of the workflow is characterized by a network of boxes connected via their input and output (Figure 2b). To create a connection, click on Output and maintain until the cursor attains an input. Connections can be removed by clicking on the Output tag.",
    "4. Merging of the channels of an image\nUse the block Merge Channels to generate merged images. If necessary, rename the files so that sequences to be merged have the same name’s prefix followed by a distinct separator. For example, sequences of individual channels from an Image A are named: ImageA_red, ImageA_blue.\n\tNOTE: For the separator, do not use characters already present in the image’s name.\nIn the same folder, create one new folder per channel to merge. For example, to merge red, green, and blue channels, create 3 folders, and store the corresponding sequences in these folders.\nOnly use the block Merge Channels, remove the other blocks, and save the protocol as Merge Channels.\n\t\nAccess the boxes to set parameters. For each channel, fill the boxes Channel number X (boxes 1, 5 or 9), Folder channel number X (boxes 2, 6 or 10), Separator channel number X (boxes 3, 7 or 11) and Colormap channel nb X (boxes 4, 8 and 12) respectively.\n\t\tNOTE: These boxes are horizontally grouped by four, each line corresponding to the same channel. In each line, a display is also available (boxes 23, 24, or 25) to directly visualize the sequence of the corresponding channel.\n\t\t\nIn the box Channel number X, choose which channel to extract (in classical RGB images, 0=Red, 1=Green, 2=Blue). The user quickly accesses the different channels of an image within the Inspector window of Icy, in the Sequence tab. Write the smallest channel’s value in the upper line and the highest one in the bottom line.\nIn the box Folder channel number X, write the \\Name of the folder containing images of channel X.\nIn the box Separator channel number X, write the separator used for the image’s name (in the previous example: “_red”, “_green” and “_blue”).",
    "In the box Colormap channel nb X, indicate with a number which colormap model to use to visualize the corresponding channel in Icy. The available colormaps are visible in the Sequence tab of the Inspector window.\nIn the box Format of merged images (box 28), write the extension to save merged images: .tif, .gif, .jpg, .bmp or .png.\n\t\t\tNOTE: To merge only 2 channels, do not fill the four boxes corresponding to the third channel.\nOn the upper left corner of the Merge Channels block, click on the link directly to the right of Folder. In the Open dialog box which appears, double-click on the folder containing sequences of the first channel that has been defined in the box Folder channel number 1 (box 2). Then, click on Open.\nRun the protocol by clicking on the black arrow in the upper left corner of the Merge Channels block (see part 7 for more details). Merged images are saved in a Merge folder in the same directory as the folders of individual channels.\n5. Segmentation of the regions of interest\nNOTE: Substructure Analyzer integrates both simple and more sophisticated algorithms to propose different alternatives adapted to image complexity and user needs.\nSelect the adapted block.\n\t\nIf objects do not touch each other, or the user does not need to differentiate clustered objects individually, use the block Segmentation A: Non clustered objects.\nWhen objects do not touch each other, but some of them are close, use the block Segmentation B: Poorly clustered objects.\nFor objects with a high clustering level and a convex shape, use the block Segmentation C: Clustered objects with convex shapes.\nIf objects present a high clustering level and have irregular shapes, use the block Segmentation D: Clustered objects with irregular shapes.",
    "Use the block Segmentation E: Clustered cytoplasm to segment touching cytoplasms individually using segmented nuclei as markers. This block imperatively needs segmented nuclei to process.\n\t\tNOTE: Blocks adapted for primary object segmentation process independently so that several blocks can be used in the same run to compare their efficiency for a particular substructure or to segment different types of substructures. If the clustering level is heterogeneous within the same set of images, then process small and highly clustered objects separately in the adapted blocks.\nLink the output0 (File) of the block Select Folder to the folder input of the chosen segmentation block.\nSet parameters of the chosen segmentation block.\n\t\nSegmentation A: Non clustered objects and Segmentation C: Clustered objects with convex shapes\n\t\t\nIn box Channel signal (box 1), set the channel of the objects to segment.\nAs an option, in box Gaussian filter (box 2), increase the X and Y sigma values if the signal inside objects is heterogeneous. The Gaussian filter smooths out textures to obtain more uniform regions and increases the speed and efficiency of nuclei segmentation. The smaller the objects, the lower the sigma value is. Avoid high sigma values. Set default values to 0.\nIn box HK-Means (box 3), set the Intensity classes parameter and the approximate minimum and maximum sizes (in pixels) of objects to be detected.",
    "NOTE: For intensity classes, a value of 2 classifies pixels in 2 classes: background and foreground. It is thus adapted when the contrast between the objects and the background is high. If foreground objects have different intensities or if the contrast with the background is low, increase the number of classes. The default setting is 2. Object size can be quickly evaluated by drawing a ROI manually around the object of interest. Size of the ROI (Interior in pixels) appears directly on the image when pointing it with the cursor or can be accessed in the ROI statistics window (open it from the search bar). Optimal parameters detect each foreground object in a single ROI. They can be manually defined in Icy (Detection and Tracking | HK-Means).\nIn the box Active Contours (box 4), optimize the detection of object borders. Exhaustive documentation for this plugin is available online: http://icy.bioimageanalysis.org/plugin/Active_Contours. Correct parameters can also be manually defined in Icy (Detection and Tracking | Active Contours).\nDuring the process, a folder is automatically created to save images of segmented objects. In the box Text (box 6), name this folder (ex: Segmented nuclei). To set the format for saving images of segmented objects (Tiff, Gif, Jpeg, BMP, PNG), fill the box format of images of segmented objects. The folder is created in the folder containing merged images.\nRun the workflow (for details, see part 7).\nSegmentation B: Poorly clustered objects\n\t\t\nFollow the same steps as in 5.3.1 to set parameters of boxes Channel signal, HK-Means, Active Contours, Extension to save segmented objects and Text (Boxes ranks are not the same as in step 5.3.1).",
    "In the box Call IJ plugin (box 4), set the Rolling parameter to control background subtraction. Set this parameter to at least the size of the largest object that is not part of the background. Decreasing this value increases background removal but can also induce loss of foreground signal.\nIn the box Adaptive histogram equalization (box 6), improve the contrasts between the foreground objects and the background. Increasing the slope gives more contrasted sequences.\nRun the workflow (for details, see part 7).\nSegmentation D: Clustered objects with irregular shapes\n\t\tNOTE: Three different methods of segmentation apply to each image: firstly, HK-means clustering combined with the Active Contours method is applied. Then, the classical watershed algorithm (using the Euclidian distance map) is applied to previously mis-segmented objects. Finally, a marker-based watershed algorithm is used. Only HK-means and marker-based watershed methods need user intervention. For both methods, the same parameters can be applied for all images (fully automated version) or be changed for each image (semi-automated version). If the user is not trained in these segmentation methods, the semi-automated processing is highly recommended. During the processing of this block, manual intervention is needed. When a segmentation method is finished, the user must manually remove mis-segmented objects before the beginning of the next segmentation method. Successfully segmented objects are saved and not considered in the next step(s). This block has to be connected with the block Clustered/heterogeneous shapes primary objects segmentation Dialog Box to work correctly.\n\t\t\nDownload the ImageJ collection MorphoLibJ on https://github.com/ijpb/MorphoLibJ/releases. The MorphoLibJ 1.4.0 version is used in this protocol. Place the file MorphoLibJ_-1.4.0.jar in the folder icy/ij/plugins. More information about the content of this collection is available on https://imagej.net/MorphoLibJ.",
    "Follow the same steps as in step 5.3.1 to set parameters of boxes Channel signal, Gaussian filter, Active Contours, Extension to save segmented objects and Text. Boxes ranks are not the same as in step 5.3.1.\nSet parameters of the box Adaptive histogram equalization (see step 5.3.2.3).\nTo activate Subtract Background, write yes in Apply Subtract Background? (box 5). Else, write No. If the plugin is activated, set the rolling parameter (see step 5.3.2), in the box Subtract Background parameter (box 7).\nAutomatization of HK-means: To apply the same parameters for all images (fully automated processing), set the Nb of classes (box 11), the Minimum size (box 12), and the Maximum size (box13) (see step 5.3.1). These parameters must be set to select a maximum of foreground pixels and to optimize the individualization of foreground objects. For the semi-automated processing version, no intervention is needed.\nAutomatization of marker extractions: for the fully-automated version, expand the box Internal Markers extraction (box 27) and set the value of the “dynamic” parameter in line 13 of the script. For the semi-automated processing version, no intervention is needed.\n\t\t\tNOTE: Markers are extracted by applying an extended-minima transformation on an input image controlled by a “dynamic” parameter. In the marker-based watershed algorithm, flooding from these markers is simulated to perform object segmentation. For the successful segmentation of foreground objects, one single marker per foreground object should be extracted. The setting of the “dynamic” parameter for optimal markers extraction depends mostly on the resolution of images. Thus, if being not familiar with this parameter, use the semi-automated version.\nRun the workflow (for details, see part 7).",
    "At the beginning of the processing, dialog boxes HK-means parameters and Marker-based watershed successively open. To apply the same parameters for all images (fully-automated version), click on YES. Otherwise, click on NO. An information box opens, asking to “Determine optimal ROIs with HK-Means plugin and close image”. Click on OK and manually apply the HK-Means plugin (Detection and Tracking|HK-Means) on the image, which automatically opens. Select the Export ROIs option in the HK-Means plugin box. Apply the best parameters to have ROIs containing a maximum of foreground pixels and to optimize the individualization of foreground objects. When optimal ROIs are found, directly close the image.\nAt the end of the first segmentation method, an information box opens and asks to “Remove unwanted ROIs and close image”. These ROIs correspond to the borders of the segmented objects. Select OK and remove ROIs of mis-segmented objects in the image, which automatically opens. An ROI can be easily removed by placing the cursor on its border and using the “Delete” button of the keyboard. Close the image. Repeat the same procedure after completion of the second segmentation step.\nAt this stage, if the YES button was selected for the full-automatization of the marker-based watershed algorithm, the previously set parameters will be applied to all images.\nIf the NO button was selected, an information box opens, asking to “Determine and adjust internal markers”. Click on OK and within the ImageJ interface of Icy, go to Plugins | MorphoLibJ | Minima and Maxima|Extended Min & Max. In Operation, select Extended Minima.",
    "Select Preview to pre-visualize on the automatically opened image the result of the transformation. Move the dynamic until optimal markers are observed. Markers are groups of pixels with a value of 255 (Not necessarily white pixels). Optimal parameters lead to one marker per object. Focus on the remaining objects that have not been well segmented with the two previous segmentation methods.\nIf necessary, improve the markers by applying additional morphological operations like “Opening” or “Closing” (Plugins | MorphoLibJ | Morphological Filters). When getting the final image of markers, keep it open and close all the other images ending with the image initially used as an input for the Extended Minima operation. Click on No if an ImageJ box asks to save changes on this image.\nIn the box Nb of images with Information Box (box 14), determine how many images with Information Boxes should appear.\nSegmentation E: Clustered cytoplasm\n\t\tNOTE: This block uses previously segmented nuclei as individual markers to initiate cytoplasm segmentation. Be sure that the block of nuclei segmentation has processed before using it.\n\t\t\nIn the box Channel cytoplasm (box 1), set the channel of the cytoplasmic signal.\nIn the box Extension segmented nuclei (box 2), write the format used to save images of segmented nuclei (tif, jpeg, bmp, png). The default format is tif.\nIn the box Text (box3), write the \\Name of the folder containing segmented nuclei.\nIn the box Format of images of segmented cytoplasms (box 4), set the format to use for saving segmented objects images (Tiff, Gif, Jpeg, BMP, PNG).\nDuring the process, a folder is automatically created to save images of segmented cytoplasms. In the box Text (box 5), name this folder (ex: Segmented cytoplasms). The folder is created in the folder containing merged images.",
    "Follow the same steps as in step 5.3.1 to set parameters of boxes Gaussian filter and Active Contours (Be careful, box ranks are not the same as in step 5.3.1).\nRun the workflow (for details, see part 7).  \n6. Fluorescent signal detection and analysis\nSelect the adapted block.\n\t\nIn the block Fluorescence Analysis A: 1 Channel, perform detection and analysis of foci in one channel inside one type of segmented object: detection of coilin foci (red channel) within the nucleus.\nIn the block Fluorescence Analysis B: 2 Channels in the same compartment, perform detection and analysis of foci in two channels inside one type of segmented object: detection of coilin (red channel) and 53BP1 (green channel) foci within the nucleus.\nIn the block Fluorescence Analysis C: 2 Channels in two compartments, perform detection and analysis of foci in one or two channels, specifically inside the nuclei and their corresponding cytoplasm: detection of Coilin foci (red channel) both within the nucleus and its corresponding cytoplasm or detection of Coilin foci (red channel) within the nucleus and G3BP foci (green channel) within the corresponding cytoplasm.\nIn the block Fluorescence Analysis D: Global Translocation, calculate the percentage of signal from one channel in two cellular compartments (a and b). For example, in a cytoplasm/nucleus translocation assay, export calculated percentages of nuclear and cytoplasmic signals for each image in the final “Results” spreadsheet. The formula used to calculate the nuclear signal percentage is shown below. This block can be used for any subcellular compartment:\nimgsrc://cloudfront.jove.com/files/ftp_upload/60990/60990eq1.jpg\nIn the block Fluorescence Analysis E: Individual Cell Translocation, calculate the percentage of signal from one channel in two cellular compartments for each cell. This block is specially optimized for nucleus/cytoplasm translocation assay at the single-cell level.",
    "NOTE: Because the block Fluorescence Analysis E: Individual Cell Translocation performs analysis at the single-cell level, efficient segmentation of nucleus and cytoplasm is needed.\nLink the output0 (File) of the block Select Folder (block 1) to the folder input (white arrows in black circles) of the chosen block.\nSet the parameters of the chosen block.\n\t\nFluorescence Analysis A: 1 Channel, Fluorescence Analysis B: 2 Channels in the same compartment and Fluorescence Analysis C: 2 Channels in two compartments\n\t\t\nIn the box Folder images ROI, write the name of the folder containing images of segmented objects preceded by a backslash. (For example: \\Segmented nuclei).\nIn the box Format of images of segmented objects (box 2), write the format used to save images of segmented objects (tif, jpeg, bmp, png). The default format is tif.\nIn the box Kill Borders?, write Yes to remove border objects. Otherwise, write No. The installation of the MorphoLibJ collection of ImageJ is required to use this function (see step 5.3.3).\nIn the box(es) Channel spots signal, set the channel where spots have to be detected. In classical RGB images, 0=Red, 1=Green, and 2=Blue.\nIn the boxes Name of localized molecule, write the name of the molecule localizing into the spots. The number of fields to enter depends on the number of molecules.\nIn the box(es) Wavelet Spot Detector Block, set spot detection parameters for each channel. Set the scale(s) (referred to spot size), and the sensitivity of the detection (a smaller sensitivity decreases the number of detected spots, the default value being 100 and the minimum value being 0). Exhaustive documentation of this plugin is available online: http://icy.bioimageanalysis.org/plugin/Spot_Detector. Parameters can also be manually defined in Icy (Detection and Tracking | Spot Detector).",
    "As an option, in the box Filter ROI by size, filter the segmented objects where spots are detected by setting an interval of size (in pixels). This step is especially useful to remove under- or over-segmented objects. To manually estimate the size of objects, see step 5.3.1. Default parameters do not include the filtering of ROIs by size. The block 2 Channels in two compartments contains two boxes: Filter nuclei by size (box 19) and Filter cytoplasm by size (box 46).\nOptionally, in the box Filter spots by size, filter the detected spots according to their size (in pixels) to remove unwanted artifacts. To manually estimate spot size, click on Detection and Tracking and open the Spot detector plugin. In Output options, select Export to ROI. Be careful that default parameters do not include filtering of spots by size, and that filtered spots are not taken into account for the analysis. The number of fields to enter depends on the number of channels.\nOptionally, in the box Filter spots, apply an additional filter (contrast, homogeneity, perimeter, roundness) on the detected spots. Be careful that default parameters do not include spot filtering and that filtered spots are not taken into account for the analysis. The number of fields to enter depends on the number of channels.\nOptionally, in the boxes Spot size threshold, set a threshold for the area (in pixels) of analyzed spots. The number of counted spots below and above this threshold is exported in the final Results spreadsheet. The number of boxes to be informed depends on the number of channels.\nRun the workflow (for details, see part 7). Data are exported in a Results spreadsheet saved in the folder containing merged images.\nFluorescence Analysis D: Global Translocation and Fluorescence Analysis E: Individual Cell Translocation:",
    "In the boxes Folder images (boxes 1 and 2), write the \\Name of the folder containing images of segmented objects. In the block Fluorescence Analysis D: Global Translocation, the two types of ROI are identified as ROI a and ROI b. For the block Fluorescence Analysis E: Individual Cell Translocation, in Folder images segmented nuclei and Folder images segmented cytoplasms boxes, write the name of the folder containing segmented nuclei and cytoplasms, respectively.\nIn the box Channel signal (box 3), enter the channel of the signal.\nIn the box Format of images of segmented objects (box 4), write the format used to save images of segmented objects (tif, jpeg, bmp, png). The default format is tif. The Kill Borders option is also available to remove border objects (see step 6.3.1).\nOptionally, in boxes Filter ROI by size, filter the segmented objects by setting an interval of size (in pixels). This step could be useful to remove under- or over-segmented objects. To manually estimate object size, see step 5.3.1. There are two fields to enter, one per channel. Default parameters do not include ROI filtering by size.\nRun the workflow (for details, see part 7). Export data in a spreadsheet Results saved in the folder containing merged images.\n7. Run the protocol\nTo process one block in a run, remove the connection between the selected block and the block Select Folder. Place the wanted block at the 1st rank. On the upper left corner of the wanted block, click on the link directly to the right of folder. In the Open dialog box which appears, double-click on the folder containing the merged images. Then, click on Open. Click on Run to start the workflow. The processing can be stopped by clicking on the Stop button.",
    "To process different blocks in a run, keep connections of chosen blocks with the block Select Folder (block 1). Make sure that their rank allows the good processing of the workflow. For example, if a specific block needs segmented objects to process, be sure that the segmentation block processes before. Before running the workflow, remove unused blocks and save the new protocol with another name.\nClick on Run to start the workflow. When the open dialog box appears, double-click on the folder containing the merged images. Then, click on Open. The workflow automatically runs. If necessary, stop the processing by clicking on the Stop button.\nAt the end of the processing, check that the message The workflow executed successfully appeared in the lower right-hand corner and that all the blocks are flagged with a green sign (Figure 2b). If not, the block and the inside box presenting the error sign indicate the element to correct (Figure 2b).\n\tNOTE: After the workflow executed successfully, a new run cannot be directly started, and to process the workflow again, at least one block should be flagged with the sign “ready to process”. To change the state of a block, either delete and re-create a link between two boxes inside this block or simply close and re-open the protocol. If an error occurs during the processing, a new run can directly be started. During a new run, all the blocks of the pipeline are processed, even if some of them are flagged with the green sign. \nSubscription Required. Please recommend JoVE to your librarian."
  ],
  "subjectAreas": [
    "Bioengineering"
  ],
  "bigAreas": [
    "Bioengineering & Technology"
  ]
}