{
  "id": 19679,
  "origin_website": "Wiley",
  "title": "The COPILOT Raw Illumina Genotyping QC Protocol",
  "procedures": [
    "This protocol provides the user with complete instructions to load and thoroughly QC raw Illumina genotyping data using the Illumina GenomeStudio software. Genotype arrays contain several thousand or even millions of genetic markers on each array, which makes it impractical to visually verify every single marker. Therefore, different intensity-related criteria are used to identify genetic markers that deviate from their expected pattern and should be manually reviewed.\nNecessary Resources\nHardware\nAs recommended by Illumina, the following hardware recommendations are required to run GenomeStudio software:\nCPU Speed–2.0 GHz or greater\nProcessor–64-bit, with 2 or more cores\nMemory–8 GB or more\nHard Drive–100 GB or larger\nVideo Display–1280 × 1024\nOperating System–Windows 7 or higher\nSpecific OS Requirements–Microsoft .NET Framework 3.5\nNetwork Connection–1 GbE or faster\nSoftware\nGenomeStudio genotyping (current version at writing this article is GenomeStudio v2.0.5):\n               \nhttps://emea.support.illumina.com/array/array_software/genomestudio/downloads.html[href=https://emea.support.illumina.com/array/array_software/genomestudio/downloads.html]\nFiles\nThe input files for GenomeStudio are:\n         \nIllumina iDat files (.dat)–These are the raw intensity files generated by the Illumina microarrays\nIllumina genotyping array manifest (.bpm)–This contains information on the target region\nIllumina sample sheet (.csv)–This contains information on the sample and is usually provided by the genotyping laboratory. Additional phenotypic information can be added to this file to aid in the QC process. The sample sheet file contains the following columns:\n               \n1.Sample ID\n2.SentrixBarcode (chip barcode on which the sample has been genotyped)\n3.SentrixPosition (position on the chip of where the sample has been genotyped)\n4.Sample_Plate (plate ID)\n5.Sample_Well (well position of the sample)\n6.Sample_Group (optional: Tissue source, i.e., saliva, buccal, blood, etc…)\n7.Gender (optional: F, M, Female or Male, with the first letter always in uppercase. Any other nomenclature will be imported as “Unknown”. Without gender information the sex chromosomes cannot be reliably processed.)\n8.Sample_Name (optional: alias name)\n9.Replicate (optional: specify the “Sample_Name” of any replicated samples)",
    "10.Parent 1 (optional: Father's “Sample_Name” if genotyped–can be used to identify parent-child or parent-parent-child SNP discrepancies)\n11.Parent 2 (optional: Mother's “Sample_Name” if genotyped–parent-child or parent-parent-child SNP discrepancies)\n12.Path (Full path to data directory containing the IDAT file for the sample)\n1. Configuring GenomeStudio.\nGenomeStudio uses the GenCall algorithm to cluster the raw intensity data and assign genotype calls. The software has default parameters and setting which can be adjusted to speed up the internal calculations.\n         \nFrom the main window, select “Tools” > “Options” > “Project”:\n               \nCheck the “Exclude Female Y-SNPs from SNP Statistics” box.\nEnsure the “No-call Threshold” is set to 0.15.\nClick “Use for all New Projects”.\nFrom the main window, select “Tools” > “Options” > “Module” > “Genotyping”:\n               \nCheck the “Use memory-based storage” box. This will massively speed up the clustering process; however, sufficient memory is required for this option. We have successfully used this option with a 32 GB RAM machine, clustering thousands of samples.\nGenomeStudio will often reset these settings to default. Users are strongly advised to check these settings every time a project is created/opened.\n2. Creating a new genotyping project.\n         \nFrom the main window, select “File” > “New Project” > “Genotyping” and follow the GenomeStudio Project Wizard.\n               \nUnder “Projects Repository”, navigate and select the folder where you want to create and store the GenomeStudio project.\nUnder “Project Name”, create a project name, e.g., we suggest [PROJECT_NAME]_[DATE]_01.bsc and click “Next”. The “_01” file will be the raw data without QC. We will save any modifications to this data as a separate file later in this protocol, which will have the same project name except it will end in “_02”, to represent a processed project.\nSelect “use sample sheet to load sample intensities” and click “Next”.",
    "Specify sample sheet, .idat file location, and manifest location, and click “Next”.\nHere we have an option to “import cluster positions from a cluster file” to cluster the data. From experience, we have discovered that using the default Illumina cluster file, or a cluster file generated from a different laboratory from which the data was generated, can lead to poor clustering. This is generally due to laboratory-specific variation leading to intensity data variations which lead to cluster drifts. We recommend not using a cluster file, but clustering the data using the data itself. Note, the clustering algorithm requires a minimum of 100 samples to work effectively. Once a Genotype project has undergone QC, the cluster positions can be exported and re-used to cluster new data genotyped on the same genotype chip. To use an existing cluster file, check the “Import cluster positions form a cluster file” box and specify the cluster file (.egt) location. Otherwise, check “Cluster SNP's”. Generating a cluster file after QC is further detailed later in this protocol.\nCheck “Calculate Sample and SNP Statistics” and “Pre-calculate” boxes.\nEnsure Gen Call Threshold is set at 0.15 and click “Finish” to create the project. Depending on the computing power and number of samples/SNPs, this process may take several minutes to several hours to cluster the data and calculate the statistics.",
    "Once the project has been created, check that the sample numbers in GenomeStudio match those in the sample sheet. If there are any errors in the sample sheet, a sample is not present at the location specified in the sample sheet, or the .idat files are corrupt for a given sample, then GenomeStudio will not upload the sample in question, and may not prompt an error. Therefore, it is vital to check that sample numbers in GenomeStudio correspond to those specified in the sample sheet.\n3. Overview of GenomeStudio windows.\nAn overview of the software window is shown in Figure 1[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.373#cpz1373-fig-0001]. The three main panes that will be used are (A) “SNP Graph”, which displays the intensity (green and red) of samples for a given SNP that is selected in the “SNP Table”. Samples are colored according to their genotype, where red represents AA homozygote genotype, purple represents AB heterozygote genotype, blue represents BB homozygote genotype, and black represents uncalled. The number of samples called within each cluster is displayed below the cluster. (B) “SNP Table” displays the SNP information, which includes clustering statistics, and (C) “Sample Table” displays sample information. The green boxes within the “SNP Table” and “Sample Table” panes contain options that will be used during the QC process, such as sorting of tables and filtering of rows. The remaining panes are the “Project”, “Errors Table”, and ”Log”, and should be inspected for any errors; as they are not used thereafter, they can be closed to make the remaining panes bigger and easier to view.\n<p>imgsrc:https://currentprotocols.onlinelibrary.wiley.com/cms/asset/3077d6f1-bd54-4288-9a4c-b8e2869f9439/cpz1373-fig-0001-m.jpg</p>\nFigure 1\nAn overview of GenomeStudio window.\n4. Validating internal genotyping controls.",
    "All Illumina genotyping arrays are equipped with internal probes to verify the accuracy and reproducibility of the assay. These internal controls should be checked before the individual sample or SNP QC to verify the reliability of the data. The internal controls do not have specific threshold criteria due to differing intensities across genotype assays. Therefore, the internal controls are based on relative intensities and should be checked according to the Illumina “evaluation of Infinium genotyping assay control training guide”, which is available on the Illumina website https://support.illumina.com/content/dam/illumina-support/courses/eval-inf-controls/story_content/external_files/Infinium_Controls_Training_Guide.pdf[href=https://support.illumina.com/content/dam/illumina-support/courses/eval-inf-controls/story_content/external_files/Infinium_Controls_Training_Guide.pdf] (Illumina, 2012[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.373#cpz1373-bib-0007]).\nTo view the internal controls, from the main window, click on “Analysis” > “View Controls dashboard”.\n5. Manually editing clusters.\nDuring this protocol, SNPs may need to be manually edited to correctly cluster samples. To manually edit a cluster:\n         \nFrom the “SNP Graph” pane, press and hold the Shift key, and move the cursor to the center of a cluster. Once you are at the middle of the cluster, over the “+”, the cursor head will turn from an arrow to a directional “+” symbol.\nOnce the cursor head has turned into a “+”, left click and hold, and drag the cluster to the desired location\nAlternatively, users can select samples they would like to exclude/include from a cluster, and GenomeStudio will attempt to exclude/include these samples.\n         \nc.From the “SNP Graph” window, draw a box (left click and drag the cursor) around the sample(s) you want to include/exclude from a cluster.\nd.Right-click on the highlighted sample(s) and choose from the following self-explanatory options:\n               \ni.Define AA cluster using selected samples\nii.Define AB cluster using selected samples\niii.Define BB cluster using selected samples\niv.Exclude selected samples\nv.Include selected samples\n6. Manually removing SNPs.",
    "During this protocol, some SNPs will be identified as incorrectly clustered, which cannot be rectified by manual re-clustering. These SNPs should be removed from the data. To manually exclude SNPs:\n         \nFrom the “SNP table”, right-click on the SNP that you want to exclude (many can be selected simultaneously by using the shift key).\nSelect “Zero Selected SNP”.\nAlternatively:\n         \nc.From the “SNP table”, left click to highlight the SNP you want to exclude.\nd.Press the “F2” button.\nUsers can highlight several SNPs and zero them all simultaneously; however, the F2 button does not work on multiple SNPs.\n7. Excluding poor performing samples by GenCall score.\nGenomeStudio assigns a GenCall (GC) score to each sample. The GC score is calculated by the sample clustering algorithm where each SNP is evaluated based on the angle of the clusters, dispersion of the clusters, the overlap between clusters, and intensity (Illumina, 2014[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.373#cpz1373-bib-0008]). The GC score ranks samples based on how often the sample appears at the center of a cluster, with scores ranging from 0 to 1 where low values represent samples that do not cluster well with other samples. These poor clustering samples interfere with the clustering algorithm and are usually samples with low DNA quality. It is not unusual to remove up to 10% of samples. Once these samples are removed, users can re-cluster the data using good quality samples, which will create cleaner, tighter clusters and ultimately increase the sample/SNP call rate for the project.\nTo remove samples based on low GC scores:\n         \nFrom the main window, select “Analysis” > “Exclude samples by best run” > “Use GC10” > “Use sample ID”.",
    "The p10GC score for each sample represents the 10th percentile of the distribution of GC scores across all genotypes and is used to evaluate the quality and performance of samples. To remove samples on low p10GC scores:\n         \nb.Identify samples with a p10GC <0.4 and remove these samples.\n               \ni.From the “Samples Table”, click on the “p10 GC” column header to highlight the column.\nii.Click the “sort column (Ascending)”.\niii.Highlight and remove samples with a low p10GC score (0.4) by right-clicking on these samples selecting “Exclude selected sample”.\niv.When prompted, “Do you want to update SNP statistics for all SNPs”, click “No”.\n8. Excluding poor performing samples by call rate.\nLow sample call rates are a good indication of poorly clustering samples. These samples tend to be of low-quality DNA and do not cluster well with other samples, causing larger more diffused clusters, which can interfere with neighboring clusters. Removing these samples and re-clustering the data can lead to tighter, more defined clusters and can improve call rates for the remaining samples. From experience, samples with a call rate below 90% cannot be rescued to a call rate above 98%, while samples with a call rate above 90% are more likely to improve above 98% following the completion of this protocol. To remove sample with a call rate below 98%:\n         \nFrom the “Samples Table”, arrange samples by “Call Rate” and highlight all samples with a call Rate of <0.90.\nRight-click and “Exclude Selected Samples”.\nWhen prompted, “Do you want to update SNP statistics for all SNPs”, click “No”.\n9. Re-clustering SNPs based on good clustering samples.",
    "Following the removal of poorly performing sample(s), it is important to re-cluster the data to define clusters based on good data. If no sample was removed, then this step can be skipped. To re-cluster the data and re-calculate statistics:\n         \nFrom the “SNP Table”:\n               \nClick on the “Select all” tab.\nRight-click on SNPs and “Cluster Selected SNPs”.\nWhen prompted, click “yes” to update SNP statistics for the selected SNPs.\n10. Updating sample statistics\nRemoval of samples will change some of the columns in the samples table to appear red. This indicates that the sample statistics has changed and has not been updated. The sample statistics can be updated by:\n         \nFrom the “Samples Table”:\n               \nClick on the “Select all tab”\nClick the “Calculate” tab\nThe sample statistics will now be updated and a zero call rate will be assigned to any samples removed.\n11. Assigning gender-specific colors to SNP graph.\nThroughout the QC process, gender information can be used for QC purposes and to identify sex-specific effects. Each dot in the “SNP Graph” represents a sample, and these dots can be given custom colors to distinguish them by any given phenotype, such as gender, disease status (case vs control), sample source, ethnicity, etc… To assign colors based on gender:\n         \nFrom the “Samples Table”:\n               \nClick the “Filter rows” tab:\n                     \nSelect “Gender” from the “Columns” sub-window. Keep the operation function as “=” and enter the Value box, enter “Female”\nSelect “Call rate” from the “Columns” sub-window. Change the “operations” to “!=” and enter the value “0”.\nEnsure the “Action” under the “Sub-Statement” section is set to “AND”.\nClick the “→” button and then click “OK”.\nFrom the “Samples Table”:\n               \nClick the “Select all” tab to highlight all samples.",
    "Right-click anywhere on the highlighted rows > Mark Selected Rows > Add New > write “Female” and change the color to “Yellow” > select “OK”.\nThis will highlight female samples in the “SNP Graph” as yellow. If there are samples with unknown genders, this process can be repeated to highlight males or the unknown samples as a different color, so that the user can differentiate between the three classes when performing QC.\n12. Quality control of Y chromosome.\nFemales do not have a Y chromosome, and therefore should not be included in the Y chromosome clusters. GenomeStudio does not exclude female samples when clustering the Y chromosome SNPs, and therefore they are inadvertently clustered along with the male samples, leading to incorrect cluster formations. Female samples fail to bind the Y chromosome probe and generally lie at the bottom of the SNP graph. These samples need to be manually removed from clusters. To speed up this process, users can remove all female samples, re-cluster the Y chromosome based on male sample intensities alone, and then reintroduce the female samples.\n         \nFrom the “SNP Table”:\n               \nSelect “Clear filter” to remove any predefined filters\nThen, re-cluster the Y chromosome SNPs using male samples only. From the “Samples Table”:\n               \nClick the “filter rows” tab and select “Gender” from the “Columns” sub-window. Keep the operation function as “!=” and enter the value “Male”\nSelect “Call rate” from the “Columns” sub-window, change “operations” to “!=”, and enter the value “0”.\nEnsure that the “Action” under the “Sub–Statement” is set to “AND”.\nClick the “→” button and then click “OK”.",
    "The samples at this stage will be filtered to samples that are not male. These would be female and samples with unknown gender assignments. These will now be temporarily labeled and removed to leave only male samples. From the “Samples Table”:\n               \nClick the “select all” tab and right-click on the highlighted rows > “Mark selected Rows” > “Add New”. Label these samples as “temp_removed” and click “OK”. This will label all the non-male samples before removal, which will ensure they do not become mixed with previously removed samples (if any).\nClick the “select all” tab, right-click on the highlighted rows, and click “Exclude Selected Samples”. When prompted “Do you wish to update SNP statistics for all SNPs”, select “No”.\nThe Y chromosome SNPs can then be re-clustered using male samples only. From the “SNP Table”:\n               \nClick the “filter rows” button and select “Chr” from the “Columns” sub-window. Select the operation “=” and enter the value “Y” (this is case sensitive), then click the “→” tab and then click “OK”.\nClick the “select all” button to highlight all Y chromosome SNPs and then right-click and select “Cluster Selected SNPs”. If prompted, do not update statistics.\nThe non-male samples can now be reintroduced. From the “Samples Table”:\n               \nRight-click > “Select Marked Rows > select “temp_removed”.\nRight-click and “Include Selected Samples”. When prompted “Do you wish to update SNP statistics for all SNPs”, select “Yes”.",
    "Now the Y chromosome SNPs can be processed. Female samples should not bind the Y chromosome probe, and as a result will exhibit a low binding intensity, which is represented in the “SNP Graph” with a low NormR intensity (<0.2). However, due to the repetitive nature of the Y chromosome and the fact that probe sequences are only 50 bp, probes targeting the Y chromosome may bind a different region of the genome, resulting in unusually high NormR intensity (>∼0.2). In the previous step, the female samples were highlighted to appear yellow within the SNP Graph pane. Using this color differentiation between males and females, the Y chromosome SNPs are processed. From the “SNP Table”, scroll through all Y chromosome SNPs and use the following criteria to manually re-cluster or zero any unreliable Y chromosome SNP:\n               \nFemale samples are expected to have a NormR intensity <0.2. If female samples have an unexpectedly higher value, then the Y chromosome probe has most likely bound to a different region of the genome and therefore needs to be manually removed. An example is provided in Figure 2[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.373#cpz1373-fig-0002].\nIf female samples have been clustered and the NormR intensity is <0.2, manually remove these samples from the cluster. An example is provided in Figure 3[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.373#cpz1373-fig-0003].\nNo samples should be assigned to the AB Cluster.\n<p>imgsrc:https://currentprotocols.onlinelibrary.wiley.com/cms/asset/ff338045-db55-4ea3-9361-9f3fa6382345/cpz1373-fig-0002-m.jpg</p>\nFigure 2",
    "Y chromosome SNP with high female sample intensities. Y chromosome SNPs should not include female samples in any cluster. In this scenario, the female samples are highlighted in yellow and have intensities similar to the male samples (red dots). Given the repetitive nature of the Y chromosome and the fact that probe sequences are only 50 bp, this Y chromosome probe has most likely bound to a different region of the genome, and is, therefore, an unreliable SNP and should be removed.\n<p>imgsrc:https://currentprotocols.onlinelibrary.wiley.com/cms/asset/fa54ab0a-bc2f-4699-bb9f-945cb356cf72/cpz1373-fig-0003-m.jpg</p>\nFigure 3\nY chromosome unclustered SNP. In this scenario, the female samples are highlighted in yellow. (A) Demonstrates GenomeStudio attempting to cluster the female samples, causing the clusters to overlap; due to the closeness of the clusters the SNP is given a no call (indicated by the pale coloring of the background and no numbers under the clusters). (B) The same SNP can be rescued by manually moving the clusters to exclude the female samples.\n13. Quality control of X chromosome.\nMales have a single X chromosome; therefore, X SNPs should have no male subjects in the heterozygote cluster (AB). From the “SNP Table”:\n         \nFrom the “SNP Table”:\n               \nSelect the “Clear filter” button to remove any predefined filters.\nClick the “filter rows” button > select “Chr” from the Columns sub-window > select the operation “=” > enter the value “X” (this is case sensitive) > Click the “→” tab > click “OK”.\nArrange SNPs by descending AB Frequency by selecting the “AB Freq” column followed by the “sort column (descending)” tab.\nReview these SNPs and ensure that no Male sample is assigned to the heterozygote (AB) cluster. If the male samples cannot be manually removed from the heterozygote cluster, then the SNP should be zeroed. An example is provided in Figure 4[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.373#cpz1373-fig-0004].\n<p>imgsrc:https://currentprotocols.onlinelibrary.wiley.com/cms/asset/138d74d9-6f25-4aba-a435-de2f5b86b8f4/cpz1373-fig-0004-m.jpg</p>\nFigure 4",
    "X chromosome unreliable SNP. This X chromosome SNP has female samples highlighted in yellow and male samples are red, purple, or blue depending on their clustering location. Male samples have a single X chromosome and therefore cannot be heterozygote as shown above. If the male samples cannot be manually removed from the heterozygote cluster, then the SNP should be zeroed.\n14. Quality control of MT chromosome.\nThe MT chromosome is maternally inherited and should not show any heterozygote clusters.\n         \nFrom the “SNP Table”:\n               \nSelect the “Clear filter” button to remove any predefined filters.\nUse the “filter rows” button to select only MT chromosome SNPs and arrange by descending AB Frequency by selecting the “AB Freq” column followed by the “sort column (descending)” tab. Manually review all SNPs, ensuring there are no heterozygote clusters.\n15. Quality control of XY chromosome.\nThe XY SNPs are known as the Pseudo autosomal (PAR) SNPs, and are present on both X and Y chromosomes; therefore, these SNPs may show male heterozygotes. There is no specific QC process for XY SNPs, and these should be processed along with the autosomal chromosomes.\n16. Quality control of autosomal chromosomes.\nThe following steps will identify unreliably clustered SNPs that require manual reviewing and validation. Since the X, Y, and MT chromosomes have already been reviewed, these SNPs should be excluded from all the following filters; however, the XY chromosomes can be processed along with the autosomal chromosome. The following filters are all applied from the “SNP Table” window by selecting the “Filter Rows” tab. Some filters need to be selected from the “Sub Columns” window (within the “Filter Rows” option), which can be activated by selecting the chip name (usually 3rd last selection) in the “Columns” window.",
    "Exclude the X, Y, and MT chromosomes. This filter should remain active when applying the autosomal chromosome filters. From the “SNP Table”:\n               \nUse the “filter rows” button to select “Chr != X” and “Chr != Y” and “Chr != MT”. Click “OK”.\nReview all SNPs that have failed to cluster:\n               \nUse the “filter rows” button to add an additional filter where the “Call Freq = 0”. These SNPs have failed to cluster. Review these SNPs to see if any can be rescued by manual reclustering.\nReview low-intensity SNPs. Remove the previous filter and individually add the following filters to identify SNPs with unexpected low intensities (example provided in Fig. 5[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.373#cpz1373-fig-0005]). Review SNPs after each filter, remove, and then add the next filter.\n               \nUse the “filter rows” button to select “AB Freq != 0” and select the chip name from the “Columns” window to activate the “Sub Columns” window. Then, from the “Sub Columns” window, select “AB R Mean”, and select operation “<” and value “0.2”.\nRemove the previous filter. Use the “filter rows” button to select “AA Freq != 0” and select the chip name from the “Columns” window to activate the “Sub Columns” window. Then, from the “Sub Columns” window, select “AA R Mean”, and select operation “<” and value “0.2”.\nRemove the previous filter. Use the “filter rows” button to select “BB Freq != 0” and select the chip name from the “Columns” window to activate the “Sub Columns” window. Then, from the “Sub Columns” window, select “BB R Mean”, and select operation “<” and value “0.2”.\nReview clusters that are closer to neighboring clusters than expected. Occasionally, clusters will be overlapping. If the clusters cannot be separated, then these SNPs should be zeroed. An example is provided in Figure 6[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.373#cpz1373-fig-0006].",
    "Remove the previous filter. Use the “filter rows” button to select “Cluster Sep < 0.35\". The data can be arranged by selecting the sort by ascending the “Cluster sep” column to have the SNPs with most likely overlapping clusters at the top of the table.\nReview unusual levels of samples in the heterozygote (AB) cluster (Figs. 7[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.373#cpz1373-fig-0007] and 8[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.373#cpz1373-fig-0008]). Remove the previous filter, individually add the following filters, and review the filtered SNPs.\n               \nUse the “filter rows” button to select “AB frequency > 0.6”. This will identify SNPs with excess samples in the heterozygote cluster.\nUse the “filter rows” button to select “AB frequency = 0 and minor allele frequency > 0”. This will identify SNPs with a lack of samples in the heterozygote cluster.\nUse the “filter rows” button to select “AA frequency = 1 and Call Freq < 1”. This will identify missed AB calls. If the number of SNPs to review is high, then call Freq can be reduced to a large value such as Call Freq = 0.98.\nUse the “filter rows” button to select “BB frequency = 1 and Call Freq < 1”. This will Identify missed AB calls. If the number of SNPs to review is high, then call Freq can be reduced to a large value such as Call Freq = 0.98.\nUse the “filter rows” button to select “Het excess > 0.3”. This will identify SNPs with excess samples in the heterozygote cluster to the expected Hardy-Weinberg Equilibrium.\nUse the “filter rows” button to select “Het excess < -0.3”. This will identify SNPs with a lack of samples in the heterozygote cluster to the expected Hardy-Weinberg Equilibrium.",
    "Review SNPs where their clusters are outside their expected theta position (Fig. 9[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.373#cpz1373-fig-0009]). Remove the previous filter and individually add the following filters and review the filtered SNPs.\n               \nUse the “filter rows” button to select “AA theta mean >0.3 and AA Freq !=0”.\nUse the “filter rows” button to select “BB theta mean <0.7 and BB Freq !=0”.\nUse the “filter rows” button to select “AB theta mean <0.3 and AB Freq !=0”.\nUse the “filter rows” button to select “AB theta mean >0.7 and AB Freq !=0”.\nReview unusually large clusters (Fig. 10[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.373#cpz1373-fig-0010]). Remove the previous filter and individually add the following filters and review the filtered SNPs.\n               \nUse the “filter rows” button to select “AA theta deviation >0.025”.\nUse the “filter rows” button to select “AB theta deviation ≥0.07”.\nUse the “filter rows” button to select “BB theta deviation >0.025”.\nReview SNPs where the GenomeStudio algorithm has low confidence in clustering. The GenTrain score ranges from 0-1 where high values indicate high confidence in clustering.\nRemove the previous filter and use the “filter rows” button to filter SNPs with “GenTrain scores of <0.7 and Edited !=1”. The edited column records SNPs that have been manually edited. In this filter, manually edited clusters are excluded from the filtered list.\n<p>imgsrc:https://currentprotocols.onlinelibrary.wiley.com/cms/asset/db89522b-19da-40db-86ed-86270606bf75/cpz1373-fig-0005-m.jpg</p>\nFigure 5\nLow-intensity SNP. This shows an example of a low-intensity SNP where the heterozygote and homozygote clusters have an unexpected Norm R intensity value below 0.2 and the clusters cannot be clearly differentiated from one another. This SNP should be zeroed.\n<p>imgsrc:https://currentprotocols.onlinelibrary.wiley.com/cms/asset/69e398c5-ce20-40cb-9e84-b3c88326b690/cpz1373-fig-0006-m.jpg</p>\nFigure 6\nPoor cluster separation. Using the cluster separation filter can help identify overlapping clusters. In this SNP, the heterozygote and homozygote clusters cannot be clearly distinguished from one another; therefore this SNP should be zeroed.\n<p>imgsrc:https://currentprotocols.onlinelibrary.wiley.com/cms/asset/de4c1303-3628-43bb-ad57-9450c1c67a68/cpz1373-fig-0007-m.jpg</p>\nFigure 7",
    "High levels of samples in the heterozygote cluster: The “Het excess >0.3” or “AB frequency >0.6” filter can identify clusters with excess samples in the heterozygote cluster, which can be merged clusters. This example illustrates two distinct clusters within the heterozygote cluster that can be manually separated into a homozygote and a heterozygote cluster.\n<p>imgsrc:https://currentprotocols.onlinelibrary.wiley.com/cms/asset/7643d2a4-3159-4000-887a-0139dfc9587a/cpz1373-fig-0008-m.jpg</p>\nFigure 8\nLow levels of samples in the heterozygote cluster. Using the Het excess <0.3 filter can identify deficient heterozygote clusters based on what is expected by Hardy-Weinberg equilibrium. This SNP has two distinct clusters within the AA homozygote cluster that can be manually separated into a homozygote and heterozygote cluster. If the clustering algorithm does not allow the clusters to be separated, then the SNP should be zeroed.\n<p>imgsrc:https://currentprotocols.onlinelibrary.wiley.com/cms/asset/e29e4f32-7672-4314-b0f4-440b609a8abf/cpz1373-fig-0009-m.jpg</p>\nFigure 9\nUnexpected cluster position: (A) The AA homozygote cluster has shifted to the right, where the AB cluster is expected, causing the AA homozygote and heterozygote cluster to be classified as AA homozygote. (B) The clusters can be manually moved to correct the misclassification.\n<p>imgsrc:https://currentprotocols.onlinelibrary.wiley.com/cms/asset/08803fc2-7b8b-4264-b683-d623a65f2543/cpz1373-fig-0010-m.jpg</p>\nFigure 10\nUnusually large clusters. This SNP has diffused or “fat” clusters which cannot be clearly differentiated from one another; therefore, this SNP should be zeroed.\n17. Quality control of replicated samples.\nSamples can be replicated across batches for various reasons. GenomeStudio can identify discrepancies in SNPs between replicated samples and can flag them for the user to review. This can be extremely useful to identify batch effects or unreliable SNPs. Replicated samples are specified in the sample sheet, under the “replicate” column when loading data. However, users can specify these samples during QC by:",
    "From the main window, select “Analysis” > “Edit Replicates”, select the replicate samples under the “Sample_ID1” and “Sample_ID2” sub-windows, and then click “Add”. Once all replicates have been added, click “OK” and GenomeStudio will update the statistics.\nDiscrepancies in replicated samples will be indicated by a square box in the “SNP Graph” window (Fig. 11[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.373#cpz1373-fig-0011]). To QC based on replicate samples:\n         \nb.From the “SNP Table”, remove all previous filters and use the “filter rows” button to filter SNPs with “Rep errors = “.\n<p>imgsrc:https://currentprotocols.onlinelibrary.wiley.com/cms/asset/f1a2c105-1551-4d9c-8c26-122e580d0b21/cpz1373-fig-0011-m.jpg</p>\nFigure 11\nReplicate error. A sample has been repeated twice in this assay and is indicated by the yellow square box. Both samples have a different genotype for the same SNP, and therefore this SNP is unreliable and should be zeroed.\n18. Quality control of parent-child samples.\nSimilar to replicated samples, parental information can be entered into the sample sheet when loading data into GenomeStudio or can be specified in GenomeStudio once a project has been created as follows:\n         \nFrom the main window, select “Analysis” > “Edit Parental Relationships” and select the appropriate samples under “Parent 1”, “Parent 2”, and “Child” sub-windows. Click “Add” and then click “OK”.\nDiscrepancies in parent-child (P-C errors) or parent-parent-child (P-P-C errors) will be indicated by a small “O” and “X” in the “SNP Graph” window, where “O” represents the parent and “X” represents the child. (Fig. 12[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.373#cpz1373-fig-0012]). To QC based on relationship:\n         \nb.From the “SNP Table”, remove all previous filters and use the “filter rows” button to filter SNPs with “P-P-C errors =1”, or if only one parent information is available, then filter by “P-C errors = 1”.\n<p>imgsrc:https://currentprotocols.onlinelibrary.wiley.com/cms/asset/1ce554b1-8405-462b-b0fd-9f5829eb1abe/cpz1373-fig-0012-m.jpg</p>\nFigure 12",
    "Relationship errors. This SNP has the parents represented as a yellow “O” and the child represented as a yellow “X”. The SNP has been filtered due to P-P-C issues, as both parents are homozygote (AA) and the child is a heterozygote (AB). Furthermore, the AA cluster has three distinct clusters; the AB cluster consists of 2-3 clusters and the BB cluster is not well defined. Multiple clusters within a cluster can indicate failure in the assay, and as such should be removed.\n19. Predicting gender for samples.\nGenomeStudio uses the X chromosome to estimate the gender of samples. Therefore, the gender of samples should only be predicted after processing the X chromosome:\n         \nFrom the “SNP Table”:\n               \nSelect “Clear filter”.\nClick the “Select all” button to highlight all SNPs, right-click, and “Update Selected SNP Statistics”.\nFrom the “Samples Table”:\n               \nRight-click and “Recalculate Statistics for all Samples”.\nClick the “Select all” button to highlight all samples, right-click, and select “Estimate Gender for selected samples”. When prompted “populate Gender column”, select “No”.\nSelect the “Column Chooser” icon and show “Gender Est” from Hidden Columns.\n20. Updating statistics.\nFollowing QC, the statistics for samples and SNPs should be updated. This step can be skipped if the gender was predicted in the previous step, as the gender prediction process incorporates updating statistics. To update statistics:\n         \nFrom the “SNP Table”:\n               \nClick “Select all”.\nRight-click on the highlighted SNPs.\nClick “Update Selected SNP Statistics”.\nFrom the “Samples Table”:\n               \nClick “Select all”.\nRight-click on the highlighted samples.\nClick “Recalculate Statistics for all Samples”.\n21. Saving cluster positions.",
    "Once a project has been processed, the cluster positions for the SNPs can be exported and used to process the next batch or a new project. This can significantly reduce the time required for QC. However, it is recommended to merge and process batches together, as more samples lead to clearer and more well-defined clusters. Nevertheless, this process can be used to process different batches or projects that have been genotyped on the same genotype array (including version number).\nTo export the cluster positions:\n         \nFrom the main window, click “File” → “Export Cluster Positions” → “For all SNPs”.\nSelect a location to store the cluster file (.egt) and save.\nThis file can be used to cluster new data that have been genotyped on the same genotyping array. When creating a new genotyping project, check the “Import cluster positions form a cluster file” box and specify the cluster file (.egt) location when prompted. This is further detailed in this protocol under step 2, “Creating a new genotyping project”.\n22. Saving project.\nIt is strongly advised to save changes to the project while QC is ongoing and after QC has finished.\n         \nFrom the main window, click on “File” → “Save Project Copy As”.\nUnder “projects Repository”, browse to the location where you would like to save the data.\nUnder “Project Name”, create a name for the project. Keeping in line with the naming convention used to create the project, we recommend using [PROJECT_NAME]_[DATE]_02.bsc, where the “02” indicates processed data.\nClick “OK”.\n23. Creating input file format for COPILOT container.\nThe COPILOT container will automate a series of bioinformatics analyses that will apply a secondary clustering algorithm to improve data quality, while also identifying potential issues with the data. The following steps will generate the required input format from GenomeStudio:",
    "Remove all filters from the “Samples Table” and the “SNP Table”.\nSelect the “Full Data Table” tab.\nSelect “Column Chooser”.\nFrom the “Displayed Columns” window select:\n               \nIndex\nAddress\nGen Train Score\nFrac A\nFrac C\nFrac G\nFrac T\nClick Hide.\nFrom the “Displayed Subcolumns” window select:\n               \nScore\nTheta\nR\nClick Hide\nFrom the “Hidden Subcolumns” window select:\n               \nX\nY\nClick Show.\nEnsure that the columns are in the order as illustrated in Table 1[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.373#cpz1373-tbl-0001].\nClick the “Select all” icon to highlight all the SNPs.\nClick the “Export displayed data to file” icon.\nBrowse to a location where you want to save the data, and save as [PROJECT_NAME]_[DATE]_intensity_data.report in tab-delimited format.\n24. Creating PLINK data (optional).\nUsers can generate PLINK-formatted data directly from GenomeStudio and follow guidelines in Coleman et al. (2016[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.373#cpz1373-bib-0002]) to perform a typical GWAS analysis. However, it is strongly advised to generate the COPILOT output format data as described above and further process the data through the COPILOT container to further increase data quality. Nevertheless, if users would like to generate PLINK-format data at this stage, then:\n         \nDownload and install the PLINK plugin from the GenomeStudio website (version used in this protocol is v2.1.4) at https://support.illumina.com/downloads/genomestudio-2-0-plug-ins.html[href=https://support.illumina.com/downloads/genomestudio-2-0-plug-ins.html].\nFrom the main window, click “Analysis” > “Reports” > “Report Wizard”.\n               \nClick “Custom Report” and select “PLINK InputReport 2.1.4 by Illumina, Inc. from Illumina, Inc.”.\nUsers are then provided with options on how to handle repeated samples (if present) by either selecting best sample by GC Score or assigning unique IDs to each sample.\nIf multiple sample groups are available and have been specified in the sample sheet, GenomeStudio will provide an option to export by sample group. Select the group you would like to export and click “Next”.",
    "Next, users are provided options on how to handle zeroed samples. They can be removed at this stage or users can have them exported into the PLINK file with a zero call rate. We recommend removing these zeroed samples at this stage to lower the computational burden.\nThis is followed by the options on how to handle zeroed SNPs. Similar to zeroed samples, we recommend removing these zeroed SNPs to lower the computational burden.\nSelect the “Output Path” and provide a name in the “Report Name”, then Click “Finish”.\nTable 1.\n                Input Format Required for COPILOT Container\ntable:\n﻿Name,Chr,Position,Sample 1,Sample 1.1,Sample 1.2,Sample 2,Sample 2.1,Sample 2.2,…\n,,,G Type,X,Y,G Type,X,Y,…",
    "This protocol deploys a containerized workflow (COPILOT) that will effortlessly further process genotype data that has been pre-processed in GenomeStudio. The COPILOT container starts by performing pre-analysis checks of the input data, calculates basic statistics, and prepares for the zCall rare variant–calling algorithm. The zCall caller is an established software (Goldstein et al., 2012[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.373#cpz1373-bib-0005]), which attempts to assign genotype calls to SNPs that have been missed by the GenomeStudio GenCall algorithm, which commonly represent the rare variants. This process essentially increases the overall sample call rates, which effectively increases data quality. COPILOT then converts data to PLINK format and uses the manifest file to update all alleles in AB format to Illumina TOP strand, and then performs multiple analyses as recommended in Coleman et al. (2016[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.373#cpz1373-bib-0002]). These include iteratively removing SNPs and samples to a user-defined threshold, pruning data for linkage disequilibrium (LD), and removing high regions of LD and non-autosomal regions, identifying potential sex discrepancies, calculating identity-by-descent (IBD), performing a heterozygosity test, and calculating ancestry of each sample based on the 1000 Genomes reference panel (Altshuler et al., 2012[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.373#cpz1373-bib-0001]).\nGenotyping data often consists of duplicate sample IDs, which can cause issues during data processing. COPILOT handles duplicate sample IDs by assigning temporary unique sample IDs to duplicate samples, allowing each duplicate sample to be independently treated during the data processing stage. The resulting processed data is provided back to the user in PLINK format, with any duplicate sample IDs reverted to the original ID, but with a record kept for users to re-identify them if required. An outline of the COPILOT process is provided in Figure 13[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.373#cpz1373-fig-0013].\n<p>imgsrc:https://currentprotocols.onlinelibrary.wiley.com/cms/asset/c7122657-3c29-4f43-b6c2-41a5ae3d09d3/cpz1373-fig-0013-m.jpg</p>\nFigure 13\nOverview of COPILOT container process.\nNecessary Resources\nHardware\nCPU Speed–2.0 GHz or greater\nProcessor–64-bit, with 2 or more cores\nMemory–8 GB or more\nHard Drive–100 GB or larger",
    "Operating System–Linux or Windows or macOS\nSoftware\nDocker\nFiles\nGenomeStudio output file as created in Basic Protocol 1[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.373#cpz1373-prot-0001]. See Table 1[href=https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.373#cpz1373-tbl-0001]. An example file is available at:\n               \nhttps://khp-informatics.github.io/COPILOT/COPILOT_user_guide.html[href=https://khp-informatics.github.io/COPILOT/COPILOT_user_guide.html]\nhttps://brcilluminadata.s3-eu-west-1.amazonaws.com/COPILOT/example_genomestudio_file.txt[href=https://brcilluminadata.s3-eu-west-1.amazonaws.com/COPILOT/example_genomestudio_file.txt]\nGender file: The gender file contains the gender for each sample in tab-delimited format. The file contains two columns with sample ID in the first column and gender information in the second column (no headers). For genders, M/Male must be used for male samples and F/Female must be used for female samples. If the gender is unknown for any reason, then the genders can be left blank or kept as “Unknown”. An example file is available at:\n               \nhttps://khp-informatics.github.io/COPILOT/COPILOT_user_guide.html[href=https://khp-informatics.github.io/COPILOT/COPILOT_user_guide.html]\nhttps://brcilluminadata.s3-eu-west-1.amazonaws.com/COPILOT/example_gender_file.txt[href=https://brcilluminadata.s3-eu-west-1.amazonaws.com/COPILOT/example_gender_file.txt]\nIllumina manifest file: The Illumina manifest file (*.csv) contains details about the SNPs used for genotyping. This file is used to update the allele coding to Illumina TOP. Ensure that the manifest and project are in the GRCh37 (hg19) genome build, as the ancestry data is calculated based on these positions. The Illumina manifest file name should end in “A1”; if it ends in “A2” this is most likely the 38 build. An example file is available at:\n               \nhttps://khp-informatics.github.io/COPILOT/COPILOT_user_guide.html[href=https://khp-informatics.github.io/COPILOT/COPILOT_user_guide.html]\nhttps://brcilluminadata.s3-eu-west-1.amazonaws.com/COPILOT/HumanCoreExome-24v1-0_A.csv[href=https://brcilluminadata.s3-eu-west-1.amazonaws.com/COPILOT/HumanCoreExome-24v1-0_A.csv]\nCOPILOT container:\n               \nThe docker image is available at:\n                     \nhttps://khp-informatics.github.io/COPILOT/COPILOT_user_guide.html[href=https://khp-informatics.github.io/COPILOT/COPILOT_user_guide.html]\nhttps://brcilluminadata.s3.eu-west-1.amazonaws.com/COPILOT/copilot.tar[href=https://brcilluminadata.s3.eu-west-1.amazonaws.com/COPILOT/copilot.tar]\nCOPILOT execution file:\n               \nThe file to run the docker image is available at:\n                     \nhttps://khp-informatics.github.io/COPILOT/COPILOT_user_guide.html[href=https://khp-informatics.github.io/COPILOT/COPILOT_user_guide.html]\nhttps://brcilluminadata.s3-eu-west-1.amazonaws.com/COPILOT/COPILOT_execution.sh[href=https://brcilluminadata.s3-eu-west-1.amazonaws.com/COPILOT/COPILOT_execution.sh]\n1. Installing Docker.\nDocker should be downloaded and installed as detailed on their website (https://docs.docker.com/get-docker/[href=https://docs.docker.com/get-docker/]).\n2. Importing the COPILOT container.\n         \na.Using a CLI, navigate to the folder where the docker image (COPILOT.tar) is stored and import the image into your docker repository:\n               \ndocker load -i COPILOT.tar\nb.Confirm the docker image has been correctly imported using:\n               \ndocker images",
    "c.Give the newly imported docker image a name, replacing the docker IMAGE ID (c0ae9d5736fc) with what you have listed. Ensure the new name provided is “COPILOT”, as the execution script will be looking for this image.\n               \ndocker tag c0ae9d5736fc COPILOT\nd.Confirm the docker image has been correctly renamed using:\n               \ndocker images\n3. Running the COPILOT container.\n         \nMove the GenomeStudio report file, gender file, Illumina manifest file, and COPILOT execution script into the same directory.\nEdit the “execution file” and specify:\n               \ndata_location: This is the location where the data is stored and where the output folders and files will be generated. Ensure you specify the full path of the folder.\nmanifest_file: This is the name of the manifest file.\nclinical_gender: This will be the name of the clinical gender file.\nreport_file: This will be the name of the GenomeStudio report file.\nsample_call_rate: Samples with a call rate below 95% are removed before processing the data through the rare variant calling algorithm, zCall (as recommended by the zCall protocol). To calculate potential problematic samples post zCall, such as sex discrepancies, heterozygote outliers, IBD, ancestry, etc…, an additional “sample_call_rate” threshold is applied. Samples below this threshold are only temporarily removed to identify problematic samples; they are re-introduced into the data at the end of the pipeline for the user. The recommended (default) value is set at 0.98. Only change from default if the data has a large number of samples with a low call rate below 0.98. Users can specify 0.95, 0.96, 0.97 or 0.98\nSave changes to the script and run the execution script:\n               \nbash COPILOT_execution.sh\nThe docker container will be running in the background. To view the progress of the container, the user can view the output folder or check the docker progress using:\n               \ndocker ps -a",
    "Check the “QC_logfile.txt” file for any errors after the pipeline has finished.\n               \ngrep \"error\" QC_logfile.txt"
  ],
  "subjectAreas": [
    "Bioinformatics"
  ],
  "bigAreas": [
    "Bioinformatics & Computational Biology"
  ]
}