{
  "id": 5855,
  "origin_website": "Bio",
  "title": "Brief Protocol for EDGE Bioinformatics: Analyzing Microbial and Metagenomic NGS Data",
  "procedures": [
    "Note: The procedure described herein assumes a user has obtained access to a demo version of EDGE bioinformatics, or has installed EDGE locally. Users must be logged-in to an EDGE account to upload data, run analyses, or view past submissions. If you wish to install EDGE, step-by-step command line instructions are detailed https://edge.readthedocs.io/en/v1.5/installation.html[href=https://edge.readthedocs.io/en/v1.5/installation.html]. Feel free to contact any member of the development team directly, or visit our google group at edge-users@googlegroups.com[href=https://bio-protocol.org/mailto:edge-users@googlegroups.com]. The procedure is outlined in the following sections: Accessing EDGE, Upload Data Files, Run EDGE Input Sample, Run EDGE Choose Processes, Run EDGE Job Submission, and Navigating Projects. A web-based video tutorial series describing how to set-up and run each EDGE module can be found at http://tutorial.getedge.org[href=http://tutorial.getedge.org/]. Accessing EDGENote: To run EDGE on any platform (i.e., in-house or demo versions), users are required to create an account and log-in. User permissions can be set to manage access levels to data and analyses. User Accounts & Log-inOpen a web browser and access EDGE (see demo versions above, or access local version). Web addresses (URLs) will depend on the internal network configuration for locally installed versions.At the EDGE interface, click on the silhouette in the top right-hand corner. For new users, submit information for a new account. For returning users, sign-in using EDGE credentials.Upload data filesClick on ‘Upload Files’ tab. Drag and drop files for upload, or click the ‘+ Add Files’ button. Select ‘Start Upload’ to complete. Note that the maximum file size for upload is 5 GB. This is configurable on a local installation of EDGE. Allowed file types include FASTQ, FASTA, GenBank, and test (txt, config, ini), and can be in gzip format. These files can be located in the MyUploads directory. Run EDGE: Input sample (see Figure 1)Note: EDGE parameter configurations are optimized for Illumina data.",
    "To run EDGE, sequence data files are needed in FASTQ format for a single sample. Click ‘Run EDGE’ to set-up and submit jobs to the EDGE bioinformatics pipeline. The first section, ‘Input Raw Reads’, requires users to provide a project name, and sequencing data at a bare minimum. EDGE accepts raw FASTQ files (single or paired-end), or Sequence Read Archive (SRA) accession numbers. Details for each setting are provided herein.imgsrc:https://en-cdn.bio-protocol.org/attached/image/20171128/20171128001953_7337.jpgFigure 1. Initiating a run in EDGE. Required input includes a unique project name and the location of sequencing reads to be processed/analyzed. Batch submission is possible and metadata collection is encouraged.Input Raw ReadsProject NameRequired field. Enter project name. Note that the same project name can be reused, hence unique identifiers are encouraged. There is a 3-character minimum and 30-character limit for the project name. Avoid using spaces, but dashes and underscores are acceptable.DescriptionOptional field. Entry space to describe project/sample in more detail.Input from Sequencing Read Archive (SRA)Clickable Yes/No toggle that controls options for accessing location of input sequencing reads. The default setting is No; this requires users to use single- or paired-end FASTQ files from the EDGE Input Directory or Upload File directory. (See step C1d for instructions on how to proceed when set to No). When this toggle is set to Yes, reads are obtained from SRA accession numbers. Internet access is required to use the Yes option. Supported SRA accession formats include: studies (SRP*/ERP*/DRP*), experiments (SRX*/ERX*/DRX*), samples (SRS*/ERS*/DRS*), runs (SRR*/ERR*/DRR*), or submissions (SRA*/ERA*/DRA*).Sequencing ReadsRequired field. Default settings require users to indicate the direct path for data (see step C1c for SRA input). EDGE accepts sequence data files in FASTQ format; compressed files (.gz) are also acceptable. Both paired-end and single-end sequences are permissible. Absolute file paths are required to run EDGE.",
    "Users can click the round button to the right of the file path text box to access data from the Upload File directory, or other directory structures configured internally (i.e., directly linked to an in-house Illumina sequencer). Additional OptionsIn most cases, the additional options can be ignored. If a user wants to add more input read files, or increase the CPUs for a job, this field provides those options. Clicking on this field will expose the following parameters:Add paired-end input: add absolute path for additional paired-end input read files.Add single-end input: add absolute path for additional single-end input read files.Use # of CPUs: Specify the number of CPUs to be used; default and minimum value is ¼ of total number of CPUs on the server.Config file: a configuration file is generated automatically for every EDGE run. In the event that a job was interrupted and unfinished, submitting the config file will re-run the job and ensure that the submission runs exactly the same, with the same options.Batch Project SubmissionBatch submission allows a user to run multiple samples using the same configuration, rather than submitting jobs one-by-one. Batch submission is off by default. If this module is turned on, the ‘Input Sequence’ module will be turned off. To implement batch submission, an Excel file with project name, inputs, and project descriptions must be submitted; a sample is available for download.Batch Excel File: If turned on, user must provide absolute path to Batch Excel File.Sample MetadataEDGE supports the input and storage of metadata associated with the genomic or metagenomic sample being analyzed. This currently includes sample type (human, animal, or environmental), isolation source, sample collection date, sample collection location, sequencing platform and sequencing date.Run EDGE: Choose processes/analyses (see Figure 2)imgsrc:https://en-cdn.bio-protocol.org/attached/image/20171128/20171128002228_2692.jpgFigure 2. Selecting the EDGE modules for analysis.",
    "Users can include any module in a workflow by simply clicking the toggle ‘On’ for the module. Clicking on the arrow to the left of the module title shows subsections of the module and parameters which can be adjusted.EDGE v1.5 has seven modules: Pre-processing, Assembly and Annotation, Reference-based Analysis, Taxonomy Classification, Phylogenetic Analysis, Gene Family Analysis, and PCR Primer Tools. After input files have been selected and a project name has been assigned, click ‘Submit’ to run the EDGE suite using default parameters. The following analyses are automatically turned on: Pre-processing Quality Trim and Filter, Assembly and Annotation, Taxonomy Classification. Users have full control over which modules to run, and can modify parameter values according to project needs. Each module, and its key parameters are outlined below.Note: Modules can be expanded or collapsed by clicking the module header. To turn modules on or off, use the toggle button within each header. Expand each module to see/edit settings. Module parameters and default settings are listed in Table 1. Modules/processes which are set ON by default are shown in Table 1 in green. Table 1. EDGE modules and default settingsimgsrc:https://en-cdn.bio-protocol.org/attached/image/20171204/20171204005252_6964.jpgPre-processing (Default is ON)Note: Pre-processing contains two components: Quality Trim and Filter, and Host Removal. By default, Quality Trim and Filter is turned ON, and Host Removal is turned OFF. This module is not required for downstream analyses, but highly recommended when processing raw reads. Quality Trim and FilterFaQCs software (Lo and Chain, 2014) is used to rapidly analyze reads for quality, then trim or filter those with poor quality. Pre-set parameter values are appropriate to filter unwanted reads in most cases. Exceptions can arise when specialized adapter sequences have been added.",
    "In this case, a user can supply FASTA files or specify the number of base pairs to trim from each end of the reads. After this step, only high-quality reads are passed to downstream analyses. Each parameter is described below; default settings can be found in Table 1.Run Quality Trim and Filter: Yes/No command to execute pipelineTrim Quality Level: minimum quality threshold based on Phred scoresAverage Quality Cutoff: filter based on average quality score of entire readMinimum Read Length: filter reads based on length‘N’ Base Cutoff: discard reads with more than this number of continuous ‘N’ bases Low Complexity Filter Ratio: indicate maximum fraction of mono-/di-nucleotide sequence permissibleAdapter FASTA: adapters can be removed from sequences; user must provide FASTA file containing adapter sequencesCut #bp from 5’-end: define a set number of base pairs to remove from the 5’ end of each read Cut #bp from 3’-end: define a set number of base pairs to remove from the 3’ end of each readHost RemovalWhile called ‘Host Removal’, this module is used to subtract unwanted reads that align to any selected reference. For example, unwanted reads derived from hosts and/or from positive controls, such as PhiX, can be filtered out at this step. Whether to employ this step and if so, which genomes to select for use in host removal, depend on each sample’s origin and therefore is left to the user’s discretion. Reads are mapped to reference genome(s) using BWA, and removed based on the similarity threshold parameter. At the EDGE interface, this module must be turned on to run. Parameter descriptions and uses:Run Host Removal: Yes/No command to execute pipelineSelect Genome(s): Click on dropdown menu to select common hosts or search for additional hosts from RefSeq by typing in the search text box.",
    "Choose relevant host genomes by clicking; blue checkmarks will indicate selected hosts. The number of hosts selected is unlimited. Click on the X in the top left corner of the selection menu to save results. Note: This RefSeq database refers to all complete bacterial and archaeal genomes plus complete viral genomes and near neighbors.Host FASTA File: a user also has the option to upload a specific host sequence (i.e., sequenced in-house, or host is not present in the EDGE database) for removal. To do so, provide the direct path to the FASTA formatted file containing the host sequence.Similarity (%): Minimum percent similarity threshold is used in host removal when calculated by [Reads aligned bases]/[Reads length] x 100. 90% similarity is the default and lowest recommended setting.Assembly and Annotation (Default is ON)Note: Assembly and Annotation pipelines are turned on by default in EDGE. In order to annotate a genome or perform any downstream contig-based analysis, assembly must be completed. There is an option to upload pre-assembled contigs in the form of a FASTA file, then bypass the assembly module. If assembly fails, downstream modules requiring contig files will be bypassed. AssemblyThree different de novo assembler options are provided: IDBA_UD (Peng et al., 2012), SPAdes (Bankevich et al., 2012), and MEGAHIT (Li et al., 2015). Optimal selection of an assembler can depend on sample type (e.g., isolate vs. metagenome), data size, and time available for analysis. Pre-set parameters for each assembler are robust and perform well in the majority of cases. Users can set the minimum cut-off value for final contigs. As default, contigs smaller than 200 bp are filtered out. If using sequence reads longer than 200 bp (for instance 2 x 300 bp), this threshold should be adjusted to the read length.",
    "Read-alignment validation is used to ensure confidence in assembly.Bypass Assembly and use Pre-assembled Contigs: Yes/No command to executeAssembler: Three de novo assemblers are built into EDGE. IDBA_UD (default) performs efficiently using either isolates and metagenomic samples, however it is not ideal for large genomes. There are multiple preset configurations in SPAdes (tailored for single cells, metagenomes, plasmids, or RNA-Seq) and SPAdes performs well on isolates and metagenomes, but can be very computationally intensive for any large dataset. SPAdes can additionally take in long read data (PacBio or Nanopore) with the Illumina short read data and produces a hybrid assembly; this option increases the computational resources required. MEGAHIT is a fast, robust solution for large and complex metagenomic samples. Validation Aligner: Bowie 2 (default) or BWA mem can be selected to map reads back to assembled contigs for validation.AnnotationSuccessful assembly is a prerequisite for annotation. EDGE offers users two annotation tools: PROKKA (Seemann, 2014) and RATT (Otto et al., 2011). PROKKA is appropriate for most cases; it has been designed for rapid annotation of prokaryotic genomes. Alternatively, users can use RATT to transfer annotation from an annotated reference genome to an unannotated sample.Annotation: Yes/No command to execute pipelineMinimum Contig Length for Annotation: User defined length of contig to include in annotationAnnotation Tool: Two annotation tools are provided. If PROKKA is selected, the user must also choose the genome type to annotate under Specify the Kingdom (Archaea, Bacteria, Mitochondria, Viruses, Others). RATT, on the other hand, will transfer the annotation from a reference genome to the sample of interest. The reference genome must be a close relative to the sample. If RATT is selected, a user must provide the GenBank formatted reference/source annotation file.",
    "Reference-based AnalysisReference-based analysis is a useful tool for investigating samples of known composition, for instance, studying a pure bacterial culture. This module maps reads and contigs to references selected by the user to obtain coverage information, and identify uncovered regions where sample reads or assembled contigs, do not align to the reference. The output of this module provides information on variants, such as single nucleotide polymorphisms (SNPs), and uncovered regions (potential insertion/deletions) that do not align to the reference. Variants are identified using SAMtools (Li et al., 2009). The in-depth results can be interactively explored using the genome browser, JBrowse (Skinner et al., 2009). Note: Reference-based analysis is off by default. Users can turn this module on using the toggle button. Select Genome(s): Pre-built reference list. Click on dropdown menu and search for microbial species of interest. It is important to choose closely related organisms. Click on desired references and blue checkmarks will indicate selected genomes. The number of hosts selected is unlimited. Click on the X in the top left corner of the selection menu to save results.Reference Genome: If a reference organism is not in the pre-constructed list, users can upload an appropriate FASTA or GenBank file for your experiment.Reads Aligner: Users can choose Bowtie 2 or BWA-MEM as the read mapper. The two algorithms will yield very similar results and can be set based on user preference.Taxonomy classification (Default is ON)The EDGE Taxonomy module will perform sequence classification and determine sample composition. This module is useful for identifying organisms in complex samples. Similarly, taxonomy classification is useful for analyzing purified cultures to detect contamination coming from lab reagents or mishandling of samples. Note: By default, taxonomic classification is turned on for both reads and contigs. EDGE implements several different databases and algorithms for taxonomy assignments.",
    "By default, all of the tools are turned on to take advantage of their strengths and provide users with cross-validated assessments. The tools vary in sensitivity and classification. Read-based taxonomy classificationAlways Use All Reads: Yes/No command to indicate what reads will be used in taxonomy. Yes (default) indicates that all reads that pass pre-processing will be used. If the user has provided a reference for Reference-based analysis, and selects No, then results will include only reads that are different from the reference.Classification Tools: Drop down menu with checkbox selection for different profiling tools. Default settings implement all databases, which is recommended in order to take advantage of all tools which vary significantly in terms of sensitivity and specificity. GOTTCHA will provide the most specific results (a very low false positive rate), while BWA and Kraken will provide the most sensitive results (a very low false negative rate).1) GOTTCHA Bacterial Databases (Genus, Species, Strain) (specific) (Freitas et al., 2015), version 20150825.2) GOTTCHA Viral Databases (Genus, Species, Strain) (specific) (Freitas et al., 2015), version 20150825.3) Read Mapping using BWA against RefSeq (see Note above for description) (sensitive) (Chen et al., 2010)4) MetaPhlAn, searches clade-specific marker genes (specific) (Segata et al., 2012)5) Kraken mini, exact alignment of k-mers (sensitive) (Wood and Salzberg, 2014)Contig-based Taxonomy ClassificationContigs classification: Yes/No command to execute. Yes (default) indicates contigs will be mapped against NCBI databases for taxonomy and functional annotations.Phylogenetic AnalysisEDGE will construct phylogenetic trees for reads and contigs. PhaME (Ahmed et al., 2015) software is implemented to align core conserved sections of genomes, perform whole-genome SNP discovery, and build a phylogenetic tree. Users can choose from pre-computed pathogen databases or build their own by selecting genomes provided in EDGE databases, or uploading their own.Note: Phylogenetic analysis will not automatically run.",
    "Users must turn the toggle switch on and address required parameters for this module. Due to the nature of the tool, users should choose closely related strains or species only; this will ensure that the user’s target genome falls within the final tree build. Additionally, although this module has been successfully applied to metagenomes, the phylogeny tool was engineered with isolate genome projects in mind. If a user selects genomes with little to no similarity, the tool will exclude them from the analysis. Tree Build Method: Users have two options for generating phylogenetic tree. FastTree is fast and selected as default (Price et al., 2010). RAxML is more accurate, but more time consuming (Stamatakis, 2014).Pre-built SNP DB: EDGE supports 5 pre-computed pathogen databases for SNP phylogeny analysis (Escherichia coli, Yersinia, Francisella, Brucella, Bacillus).Select Genome(s): RefSeq genomes (see Note above for description) are available in this dropdown menu. Open menu, search, and click on desired genomes to select.Add Genome(s): User can provide FASTA entries for genomes to be built into tree. A maximum of 20 reference genomes can be used and including an outgroup is recommended.SRA Accessions: SRA entries are allowed for specifying references to be used in phylogenetic analysis.Bootstrap: Yes/No command to execute bootstrap in analysis.Bootstrap Number: Can be modified if user indicates Yes for Bootstrap method.Gene Family AnalysisNote: The Gene Family Analysis module searches reads and annotated coding sequences (CDS) for specific gene families (currently, antibiotic resistance and virulence gene families). There are two components to this module: read-based and contig-based profiling. To perform either analysis, users must first turn this module on using the toggle switch, then ensure each sub-analysis is set to Yes. Contig-based analysis requires successful assembly. Read-based Gene Family AnalysisThe read-based analysis uses the ShortBRED (Kaminski et al.",
    ", 2015) algorithm to search for antimicrobial resistance genes in the Antibiotic Resistance Genes Database, ARDB, (Lui and Pop, 2009) and Resfams (Gibson et al., 2014) databases. Similarly, ShortBRED will search for virulence genes using a version of the Virulence Factor Database, VFDB, (Chen et al., 2005) curated by an EDGE developer.Read-based Gene Family Analysis: Yes/No command to execute analysis.Contig-based (CDS) Gene Family AnalysisSimilarly, virulence genes are called using ShortBRED and VFDB. However, for antibiotic resistance gene finding, the Comprehensive Antibiotic Resistance Database (CARD) program RGI (Jia et al., 2017) is used for CDS-based analysis performed on contigs.Contig-based (CDS) Gene Family Analysis: Yes/No command to execute analysis.PCR Primer AnalysisNote: The PCR Primer Analysis module consists of two processes: validation of existing primers and design of new primers. PCR Primer Analysis will not automatically run. Users must turn the toggle switch on, and turn on each independent component of this module. Primer ValidationIn the validation pipeline, users upload a file containing existing primer sequences. EDGE maps these primers to the sample’s assembly using BWA to determine if the amplicon is generated. Users can define the number of mismatches allowed in this validation.Run Primer Validation: Yes/No command to execute analysis.Primer FASTA Sequences: Provide absolute path to input file with existing primers to be validated. Must contain an even number of forward and reverse primers saved in FASTA format.Maximum Mismatch: Indicate the maximum number of mismatches allowed per primer sequence. Click on the number to select (i.e., 0, 1, 2, 3, or 4).Primer DesignTo design primers for newly assembled contigs, EDGE identifies unique regions of the sample using BWA then generates primer sets using Primer3 (Untergasser et al., 2012). Primers are designed, and compared to RefSeq to ensure the selected regions in the sample genome are indeed unique.",
    "Users indicate desired primer reaction parameters for melting temperature, amplicon sizing, and the number of primer pairs.Run Primer Design: Yes/No command to execute analysis.Primer Settings: All reaction parameters can be modified. Parameters for primer design include: Tm Optimum (°C), Tm Range (°C), Length Optimum (bp), Length Range (bp), Background Tm, Differential (°C).The number of Primer Pairs: Desired amount of new primer pairs to be designed.Run EDGE: Job submissionAfter input files, project name, and desired process options have been defined (Procedure A-Procedure D), a job is ready for submission. To submit a job, click on the ‘Submit’ button at the bottom of the page. Red and/or green indicators will immediately appear to indicate successful job submission. If errors occur, the message (in red) is clickable and will return users to the section needing attention where the data entry box(es) with errors are highlighted with a yellow glow. Navigate ProjectsUpon successful submission, users can monitor job status by clicking ‘Projects’ in the navigation bar on the left-hand side of the user interface. This provides a list of projects submitted by the user. Job status of each project in the list is indicated by a color-coded system: grey = not yet begun, red = error, orange = in progress (running), green = completed. Errors normally only occur if there are issues in retrieving or reading the input data files. If a job is in progress, clicking on the project in the left navigation bar will open the Project page where results are posted in real time. The Project page has links to other pages and to the project list on the left (which can be hidden with a link in the upper left corner). Project information and results are shown in the center section.",
    "The information on this page is static and allows users to access portions of the run that are already complete, however the page needs to be refreshed for any updates to the project. A small square icon in the upper right corner of the screen opens a sidebar on the right that displays active monitoring of job progress and server usage. Options to interrupt, delete, rerun or share the project and view the live log are available in this sidebar. Figure 3 shows a screen shot of a project page from https://bioedge.lanl.gov/[href=https://bioedge.lanl.gov/] and originally published by Oxford University Press in Nucleic Acids Research (Li et al., 2017). imgsrc:https://en-cdn.bio-protocol.org/attached/image/20171128/20171128004208_4977.jpgFigure 3. The EDGE Project page displays an analysis in progress"
  ],
  "subjectAreas": [
    "Microbiology",
    "Systems Biology"
  ],
  "bigAreas": [
    "Molecular Biology & Genetics"
  ]
}