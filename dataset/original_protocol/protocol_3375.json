{
  "id": 3572,
  "origin_website": "Cell",
  "title": "Automatic quantification of myocardial remodeling features in human ventricular tissue from label-free microscopy",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nThis protocol includes the following steps: sample collection, image acquisition, image pre-processing, analysis of collagen amount, aggregation and spatial distribution and lipofuscin quantification.\nSample collection\nTiming: 1–2 days for tissue collection and fixation and 1 day for tissue sectioning\nThis section describes the procedure used for tissue collection and processing before image acquisition.\nCollect left ventricular tissue samples from donors immediately after being placed on cardiopulmonary bypass. Specifically, transmural biopsies can be extracted using a 14G tru-cut needle without perforating the myocardial wall.\nNote: Transmural left ventricular tissue samples obtained from living donors are used in this protocol, but other kinds of tissues discarded for transplantation, endocardial biopsies, or cadaveric tissues could be used too.\nStore the tissue samples in ice-cold Tyrode’s solution for transportation to the laboratory.2[href=https://www.wicell.org#bib2] Alternatively, commercial cardioplegic solution, ringer lactate or standard ice-cold PBS are also suitable for histological applications as the ones described in this protocol.\nTransfer the samples to 1.5 mL tube containing ice-cold fixative solution of 4% paraformaldehyde and incubate them for 1 h at 4°C or on ice.\nCritical: The fixation time and volume depend on the tissue size. This pipeline is optimized for biopsies collected using disposable 14 G tru-cut biopsy needles that render 5-to-10-mm long and approximately 2-mm thick ventricular tissue samples.\nRemove the fixative solution and transfer the samples to 0.01% sodium azide-PBS at 4°C until embedded in paraffin blocks.\nCarry out tissue dehydration and paraffin embedding with the Tissue-Tek Xpress x50 Tissue Processor System (Henry Schein, USA).\nMount tissue blocks using the paraffin embedding station EG1150H (Leica, Germany) and the HI1210 Water bath for paraffin sections (Leica, Germany). Other tissue sample processing and embedding procedures, preferentially automatized to minimize variability in tissue processing, are also applicable.",
    "Section the tissue blocks with the microtome Shandon finesse 325 (Thermo Scientific, USA) to obtain 5-μm sections.\nNote: Both a confocal and a two-photon microscope have the capability to capture high-quality optically sectioned images of tissue sections, even those with a thickness exceeding 100 μm. In samples with highly scattering structures, the crucial factor affecting image quality is the imaging depth rather than the actual thickness of the tissue section. Using the surface closest to the imaging objective lens always allows for the collection of high-quality images, even when dealing with thick tissue sections, as the light does not need to traverse the entire thickness of the section.\nMount the sections on microscope slides (MENZAA00008032E011, VWR, USA). Let the sections dry out 24 h before image acquisition with the microscope.\nNote: Tissue sections should be allowed to dry after being mounted on the microscope to facilitate that the tissue better adheres to the slides. This drying is recommended regardless of the technique to be subsequently applied (e.g., label-free imaging or immunohistochemistry).\nImage acquisition\nTiming: 3 min for imaging 1 mm2 tissue and around 20 min to set position and focus and save the imaged data\nThis section describes how to characterize collagen deposition in left ventricular tissue samples using Second Harmonic Generation (SHG) microscopy combined with two-photon excitation fluorescence (TPEF) microscopy to detect the autofluorescence of the myocardial tissue and the lipofuscin. We used a Zeiss LSM 880 microscope (Carl Zeiss, Germany) mounted on the rear port of an Axio Observer.Z1 stand. This analysis does not require any staining. Paraffined tissue sections mounted on microscope glass slides can be directly observed under the microscope.\nThe SHG and TPEF image acquisition procedure and microscope configuration are as follows:",
    "Rotate a suitable objective lens into the imaging position (i.e., plan-apochromat 20× objective (NA 0.8, Carl Zeiss, Germany)).\nPlace a sample on the microscope sample holder. Locate and focus the sample using transmission or fluorescence imaging.\nNote: Cellular and lipofuscin autofluorescence can be visualized using typical excitation and emission filters used for green (e.g., EGFP, Fluorescein) or red (e.g., mCherry, Alexa Fluor 555) fluorophores, respectively.\nCreate a suitable light path to steer the femtosecond pulsed laser light to the sample.\nNote: In our setup, laser light from the femtosecond pulsed laser (Mai Tai DeepSee, Spectra-Physics, CA, USA) is directed through an acousto-optic modulator into an LSM880 scanhead (Carl Zeiss, Germany). A 760 nm shortpass dichroic mirror (MBS 760+) is used to direct the laser light to the sample and to separate the laser light from the fluorescence and SHG signal.\nActivate three detectors to simultaneously detect the SHG signal, cellular autofluorescence and lipofuscin autofluorescence.\nNote: The data can also be acquired sequentially in case three suitable detectors are not available.\nAdjust each detector channel to detect the optimal wavelength range:\nSHG signal: 380–420 nm.\nCellular autofluorescence: 500–552 nm.\nLipofuscin autofluorescence: 650–735 nm.\nNote: In our setup, Ch1 (PMT), ChS1 (32 channel GaAsP array), and Ch2 (PMT) of the 34 channel QUASAR spectral detector unit of the Zeiss LSM 880 microscope are used for the SHG signal, cellular, and lipofuscin autofluorescence, respectively.\nNote: The ZEISS QUASAR multichannel photomultiplier detection technology is based on a filter-free system that guides the desired wavelength range to the target detector using adjustable optical wedges and slider light stops. If using other microscopes, multiple emission filters can be suitable as long as they match the wavelength ranges listed in this protocol.",
    "Tune the femtosecond pulsed laser (Mai Tai DeepSee, Spectra-Physics, CA, USA) to a central wavelength of 810 nm and adjust the transmission through the acousto-optic modulator so that ∼80 mW average power is focused on the sample through a plan-apochromat 20× objective (NA 0.8, Carl Zeiss, Germany).\nAdjust the acquisition parameters to acquire images with sufficient resolution and dynamic range.\nNote: Preferentially use a bit depth of 16 bits. In our setup, a zoom factor of 1.3 is used to ensure a homogeneous illumination, and 1872 by 1872 pixels are acquired, thus resulting in a square pixel size of 170 nm by 170 nm.\nFully open the pinhole(s) for each channel.\nOptimize the detection of each detector channel by adjusting the detector gain and offset.\nNote: Use a range indicator lookup table while optimizing the detector settings to minimize data clipping by e.g., saturation. We employed the following detector settings:\nCh1: detector gain 750, digital offset 256.\nChS1: detector gain 680, digital offset 64.\nCh2: detector gain 750, digital offset 256.\nDefine a tilescan or mosaic image for samples larger than a single field-of-view by means of a rectangular grid or a bounding box for rectangular/square samples or irregular samples, respectively. Define sufficient overlap (i.e., 10%) between the different tiles to ensure proper stitching.\nCritical: Microscope acquisition settings need to be maintained between independent acquisition sessions so that all the tissue images are equally acquired.",
    "Note: Higher quality images can be acquired using the non-descanned detectors of a confocal NLO microscope. In our setup, the conventional internal detectors are selected, as they allowed the acquisition of all three channels simultaneously, with good lateral and axial overlap, significantly speeding up the acquisition process. To maximize the signal, the pinhole is fully opened, and optical sectioning is performed by the selective two-photon excitation process.\nImage pre-processing\nTiming: 5 min per sample\nThis section describes the image pre-processing for characterization of collagen features and quantification of lipofuscin content.\nImage export and pre-processing:\nZen Blue software is used to export 16-bit TIFF gray-scale images from the original czi files with each channel detected in a separate file. Images can be exported at once using batch processing. To keep the same parameter settings for the pre-processing of all the images, select Export image parameters for the first image > Copy parameters > Paste parameters in the other images (Figure 1[href=https://www.wicell.org#fig1]).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3141-Fig1.jpg\nFigure 1. ZEN parameters for image export using batch configuration\nOpen the three individual channels of each tissue section using ImageJ software.\nDelimit the tissue of interest of every channel with the tool “Polygon selection” and select “Edit > Clear outside” to clean isolated regions that should be discarded from the analysis due to e.g., fluorescence artifacts (Figure 2[href=https://www.wicell.org#fig2], see troubleshooting[href=https://www.wicell.org#troubleshooting] problem 1[href=https://www.wicell.org#sec6.1]).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3141-Fig2.jpg\nFigure 2. Screen view of Fiji edit menu to clean images before analysis\nSelect “Image > Adjust > Brightness/Contrast” for automatic brightness scaling.3[href=https://www.wicell.org#bib3] Select each channel image and press “Auto” bottom once and then “Apply” (Figure 3[href=https://www.wicell.org#fig3]A). Repeat this step with the other channels (Figure 3[href=https://www.wicell.org#fig3]B).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3141-Fig3.jpg\nFigure 3. Fiji image menu to adjust image brightness\n(A) Screen view of Fiji image.",
    "(B) Original images (upper panel) and the corresponding images after brightness adjustment (lower panel) for autofluorescence signal from the myocardial tissue (left), SHG signal (middle) and lipofuscin (right).\nSave each of the adjusted images as a new 8-bit TIFF file.\nCritical: For robustness of the analysis, image pre-processing should preferably be applied to high-quality (16-bit) images.\nCollagen amount, aggregation, and spatial distribution analysis\nTiming: 10–15 min per sample\nThis section describes the methods used to characterize collagen features in ventricular tissue samples.\nCollagen amount quantification:\nLoad each adjusted image saved as an 8-bit TIFF file and split it into its individual channels in grayscale.\nApply a binarization filter to the gray-level images corresponding to the SHG signal or the autofluorescence signal from the myocardial tissue. Generate binary masks for each of the SHG signal, on the one side, and for the autofluorescence signal, on the other. These masks are referred to as binary_SHG_channel_mask and binary_myocardial_tissue_mask.\n>binary_myocardial_tissue_mask = imbinarize(cellular_autofluorescence_channel,Thr1)      (1)\n>binary_shg_channel_mask = imbinarize(shg_signal_channel,Thr2)                            (2)\nThe MATLAB function “imbinarize” creates a binary image from a grayscale image by thresholding. The threshold luminance value is a numeric scalar with values in the range [0, 1]. The binarization threshold range that we used to generate binary masks was in the range 0.17–0.35 for the autofluorescence signal (   T h r  1  ) from which the myocardial tissue mask was extracted, and it was in the range 0.08–0.35 for the SHG signal (   T h r  2  ) from which the collagen mask was extracted.\nFill empty spaces with less than 20 pixels in the myocardial tissue mask.\n>myocardial_tissue_mask =imfill(binary_myocardial_tissue_mask,conn,'holes')            (3)",
    "The MATLAB function “imfill” fills holes in a binary image, in this case the binary_myocardial_tissue mask. A hole is a set of background pixels that cannot be reached by filling in the background from the edge of the image. The input parameter   c o n n   specifies the pixel connectivity. In our setup, 4-connected background neighbors are used, which means that the pixels are connected if their edges touch. The neighborhood of a pixel involves the adjacent pixels in the horizontal or vertical direction.\nIdentify and remove isolated segments and/or artifacts in the SHG binary mask. In our setup, areas with less than 15 pixels in the SHG binary mask are discarded (defined as new_binary_shg_signal_mask).\n>new_binary_shg_signal_mask = bwareaopen(binary_shg_signal_mask,P)                (4)\nThe MATLAB function “bwareaopen” removes small objects from binary images.   P   defines the minimum number of pixels an area should have not to be removed.\nSeparate the myosin and collagen signals in the SHG signal by considering that collagen is the part of the SHG signal that does not colocalize with the myocardial tissue mask (3). Based on this absence of colocalization, the collagen mask is obtained from the SHG channel mask (4) as follows (Figure 4[href=https://www.wicell.org#fig4]A):\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3141-Fig4.jpg\nFigure 4. Collagen characterization from SHG images\n(A) Unprocessed SHG image (green) and autofluorescence (blue) levels of a left ventricular tissue specimen (top panel left), extracted tissue mask obtained from the tissue autofluorescence signal (top panel right), collagen mask obtained by subtraction of autofluorescence to SHG signal (bottom panel left) and merge of collagen (green) and myocardial tissue (blue) masks (bottom panel right).\n(B) Windowing of collagen mask to evaluate spatial distribution. Adapted from García-Mendívil et al.1[href=https://www.wicell.org#bib1]\n>rowNumber = size(new_binary_shg_signal_mask,1);                           (5)\n>columnNumber = size(new_binary_shg_signal_mask,2);\n>collagen_mask = zeros(size(new_binary_shg_signal_mask));\n>for i = 1 to rowNumber do\n>for j = 1 to columnNumber do",
    ">if new_binary_shg_signal_mask(i,j) = 1 and myocardial_tissue_mask(i,j) =0 then\n>collagen_mask(i,j) = 1;\n>end if\n>end for\n>end for\nUsing the myocardial tissue mask (3) and the collagen mask (5), the percentage of collagen (   P c   ) is calculated as the number of activated pixels in the collagen mask (   N c   ) divided by the sum of activated pixels in the myocardial tissue (   N m   ) and the collagen masks:\nP\nc\n=\nN\nc\n(\nN\nc\n+\nN\nm\n)\n100\nwhere:\n>Nc = nnz(collagen_mask);                                        (6)\n>Nm = nnz(myocardial_tissue_mask);\nThe MATLAB function “nnz” returns the number of nonzero elements in a specific matrix.\nNote: The obtained binary masks are used in subsequent analyses.\nCollagen aggregation analysis:\nUsing the collagen binary masks, the global clustering degree (   P  s c    ) is computed as the ratio between the number of collagen pixels surrounded by collagen pixels in a circle of 2-pixel radius (denoted by    N  s c   )   and the total number of collagen pixels:\nP\ns\nc\n=\nN\ns\nc\nN\nc\n100\nwhere:\n>Nc = nnz(collagen_mask);\n>Nsc = nnz(collagenPixelsSurrounded);\nwith the matrix collagen Pixels Surrounded being defined as follows:\n>collagenPixelsSurrounded = zeros(size(collagen_mask));\n>centroX_origen = radius+1;\n>centroY_origen = radius+1;\n>[columnsInImage rowsInImage] = meshgrid(centroX_origen - radius:centroX_origen\n+ radius,centroY_origen - radius:centroY_origen+radius);\n    >circleRadiusPixels = (rowsInImage - (radius+1))2 + (columnsInImage - (radius+1))2 ≤\nradius2;\n>[row_collagen_mask,column_collagen_mask] = find(collagen_mask==1);\n>for i = 1 to length(row_collagen_mask) do\n>if (row_collagen_mask(i) > radius) and (row_collagen_mask(i) <\n      size(collagen_mask,1) - radius) and (column_collagen_mask(i) > radius) and\n      (column_collagen_mask(i) < size(collagen_mask,2) - radius) then\n>centerX = column_collagen_mask(i);\n>centerY = row_collagen_mask(i);\n>collagen_mask_window = collagen_mask (centerY - radius:centerY+\n      radius,centerX - radius:centerX + radius);\n>connected_pixels = collagen_mask_window.∗circlePixelsMask;\n>if (connected_pixels== circlePixelsMask) then\n>collagenPixelsSurrounded (row_white(i),column_white(i)) = 1;\n>end if\n>end if\n>end for",
    "Calculate a relative clustering degree as the product of percentages of collagen and clustering degree, which is expressed as per ten thousand (‱).\nCollagen spatial distribution assessment:\nDivide the collagen binary mask into subimages of 500 × 500 pixels (Figure 4[href=https://www.wicell.org#fig4]B).\nInclude in the analysis only the subimages of the collagen binary mask with a minimum of 200 activated pixels.\nFor each of the subimages, compute the collage clustering degree as described in step 12.\nBuild the histogram of the collagen clustering degree from all subimages of a given image. Determine the collagen clustering median, calculated as the median of the clustering distribution statistical distribution, and the collagen clustering dispersion, calculated as the interquartile range of the clustering degree statistical distribution.\nNote: In our setup, the following parameter values are determined empirically from our images: the 2-pixel radius for global collagen aggregation, the window of 500 × 500 pixels for the characterization of collagen spatial distribution, and the threshold of 200 pixels for subimage acceptance in collagen spatial distribution assessment. These three parameter values and the threshold values for the construction of the tissue and collagen binary masks should be adapted for each set of images being analyzed.\nNote: The median and interquartile range of the collagen clustering statistical distribution is determined using MATLAB.\nLipofuscin quantification\nTiming: 5–10 min per sample\nThis section describes the pipeline used for lipofuscin quantification in ventricular tissue samples.\nLipofuscin content quantification:\nApply a binarization filter to the gray-level image corresponding to the lipofuscin signal to generate a binary lipofuscin mask (Figure 5[href=https://www.wicell.org#fig5]). The same MATLAB functions and Equations 1 and 2 are used, although in this case the threshold (Thr3) range is in the range 0.48–0.7.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3141-Fig5.jpg\nFigure 5. Quantification of lipofuscin accumulation by an automatic method",
    "Unprocessed confocal microscopy image of a human left ventricular tissue section with lipofuscin (red) and tissue autofluorescence (blue) channels (top panel left), computed myocardial tissue mask (top panel right), computed lipofuscin mask (bottom panel left) and merge of lipofuscin and myocardial tissue masks (bottom panel right). Extracted from García-Mendívil et al.1[href=https://www.wicell.org#bib1]\n>binary_lipofuscin_mask =imbinarize(lipofuscin_autofluorescence_channel,Thr3)         (7)\nCompute the percentage of lipofuscin (   P l   ) as the number of activated pixels in the lipofuscin mask (   N l   ) divided by the activated pixels in the myocardial tissue mask (   N m   ):\nP\nl\n=\nN\nl\nN\nm\n100\nwhere:\n>Nl = nnz(binary_lipofuscin_mask);                                      (8)\n>Nm = nnz(myocardial_tissue_mask);\nNote: The MATLAB functions “imbinarize” and “nnz” are described in step 11."
  ],
  "subjectAreas": [
    "Computer Sciences",
    "Biotechnology And Bioengineering",
    "Microscopy"
  ],
  "bigAreas": [
    "Bioengineering & Technology"
  ]
}