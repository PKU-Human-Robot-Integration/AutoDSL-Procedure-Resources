{
  "id": 3026,
  "origin_website": "Cell",
  "title": "Protocol for performing pooled CRISPR-Cas9 loss-of-function screens",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nMaking virus, infecting cells, selecting, and growing\nTiming: 4 weeks\nCritical: Maintaining coverage, or representation of sgRNAs, is extremely important at all stages of screening. Higher coverage reduces potential bottlenecks and background sampling noise.5[href=https://www.wicell.org#bib5] We and collaborators have empirically determined that 200 cells/sgRNA at infection and 1000 cells/sgRNA during selection, growth, and sequencing are sufficient for high-confidence results11[href=https://www.wicell.org#bib11] (Figure 4[href=https://www.wicell.org#fig4]).\nPlate 7.5 × 106 HEK293T cells into a 150 mm culture plate in 30 mL DMEM + 10% FBS for ∼50% confluence 24 h later.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2569-Fig4.jpg\nFigure 4. Schematic illustrating coverage maintenance at major steps of pooled CRISPR screens\nAfter 24 h, transfect HEK293T cells with Mirus LT1 transfection reagent, 8 μg lentiviral packaging vector mix, and 8 μg library lentiviral plasmid at a 3:1 Mirus:DNA ratio.\nCritical: To ensure sufficient viral titers are reached, all library and packaging plasmids should be endotoxin-free and the packaging HEK293T cells need to be healthy prior to transfection.\nIncubate cells for 72 h.\nAfter 72 h, collect viral supernatant through a 0.45 μm filter. Use immediately or store at 4°C for up to one week or −80°C for up to six months.\nNote: Most pooled CRISPR screens rely on the assumption that all sgRNAs are represented and that there is only one sgRNA per cell. Before infection, viral titer is estimated by serial dilution. Cells should be infected with the volume of virus that results in a 20%–50% mCherry positive population 72 h after infection.\nNote: Virus can be concentrated using viral precipitation solution (e.g., ALSTEM # VC100).\nPlate 10 × 106 HuH7 cells into a 245 mm culture plate in DMEM + 10% FBS such that cells are at ∼80% confluence 24 h later.",
    "After 24 h, introduce sgRNA-containing viral medium to the cells in one well with 8 μg/mL polybrene. Incubate for 24 h.\nNote: Cells should be infected with an expectation that 20%–50% will express mCherry 72 h post-infection, and the number of infected cells should be at least 200× coverage.\nAfter 24 h, remove all media and replace with DMEM + 10% FBS.\nTrypsinize and re-seed all cells into new plates at ∼40%–50% confluence. Expand for another 24 h.\nAfter 24 h, begin antibiotic selection by replacing media with DMEM + 10% FBS containing 2 μg/mL puromycin. Replace the selection media every 3–4 days until all control cells have died.\nNote: 1000× coverage (e.g., 1,000 cells per sgRNA) should be maintained during selection and throughout the rest of the screening process.\nOnce all the control cells have died, replace media with fresh DMEM + 10% FBS without antibiotic to allow for recovery.\nFreeze cells at −80°C and store in liquid nitrogen.\nNote: We recommend freezing multiple vials of cells at 2000× coverage before phenotypic selection to ensure there will be enough cells for multiple conditions and/or biological replicates.\nAntibiotic selection\nTiming: 1 week (FACS-based), 2–3 weeks (death-based)\nThaw cells in excess (2000× coverage) to prevent loss of coverage if cells die during thawing. Passage after 48 h and grow for another 48 h (96 h total).\nCritical: The number of passages and duration of growth can affect cellular phenotypes due to genetic compensation. When performing replicates or using multiple libraries in the same experiment, cells should be grown for the same number of days/passages.\nThe parameters of these steps will differ depending on whether the phenotypic selection is fluorescence-based or death-based.\nFluorescence-based screen.\nTreat cells (if applicable).",
    "Trypsinize (if using adherent cells) and collect cells in excess of 1000× coverage in FACS sorting media.\nNote: We recommend trypsinizing cells at >3000× coverage before FACS sorting to maintain a buffer in case of technical error and to account for sorting out any non-fluorescent cells. The number of cells that will be collected from cell sorting will be 1000× (500× in each gate). Sort cells and collect high and low fluorescence bins.\nNote: The FACS buffer used will depend on the characteristics of the cell line to be sorted. We use phenol red-free DMEM containing 3% FBS and 1% BSA for HuH7 cells.\nNote: The size of high-reporter and low-reporter bins affects the quality of screen data. A study5[href=https://www.wicell.org#bib5] computationally determined that collecting the highest 25% and lowest 25% bins results in the greatest signal-to-noise ratio. However, bin sizes can be altered depending on the biological question.11[href=https://www.wicell.org#bib11] We have collected the top and bottom 30% fluorescence bins3[href=https://www.wicell.org#bib3] and recommend these parameters for FACS-based screens.\nAfter sorting, spin cells at 500 × g for 10 min. Carefully aspirate FACS buffer and wash once with PBS. Spin cells again at 500 × g, remove PBS, and store cell pellets at −80°C.\nDeath-based screen.\nTrypsinize and collect cells in media containing 10% FBS.\nCount cells and seed in 245 mm square TC-treated culture dishes at 10% confluence (8–15 × 106 cells, depending on the cell size).\nNote: The total amount of cells seeded should be above 1000× coverage. Use a minimum of 60 mL cell culture media containing the drug or vehicle at the desired concentration (determined in before you begin[href=https://www.wicell.org#before-you-begin]) for each plate.\nReplace the media and drug/vehicle every 3 days and continue culturing the cells until they are confluent.",
    "Repeat steps 14b–c until vehicle control treated cells divide >10 times (doubling cycles).\nWhen cells reach >10 doubling cycles, harvest cells by trypsinization and wash once in media containing 10% FBS and once with PBS.\nSpin cells at 500 × g for 5 min, aspirate PBS, and store cell pellet at −80°C. Each cell pellet should contain cells at >1000× coverage.\nPreparing for deep sequencing\nTiming: 1 week\nTo identify the sgRNAs present in each cell population, genomic DNA (gDNA) is extracted from frozen cell pellets and guide sequences are amplified by PCR.\nCritical: Cross contamination of libraries poses a huge risk to the integrity of screen results. To avoid contamination, some labs have designated spaces and hoods for these steps. At the very least, it is essential to thoroughly clean workspaces and equipment (e.g., pipettes, tube racks) with RNase Away (Thermo # 7002PK) or ELIMINase (Decon Labs # 1101) before the experiment and routinely wipe the bench surface and all pipettes during sample processing. Filtered pipette tips are essential. We recommend having a set of designated equipment for DNA processing.\nExtract gDNA from cell pellets using Qiagen QIAamp DNA Blood Midi Kit (Cat # 51183) according to manufacturer’s instructions (link[href=https://www.qiagen.com/us/resources/download.aspx?id=bf32146a-77fd-40c2-8743-c28974f7935b&lang=en]).\nNote: We slightly modified this protocol for increased yield. For the DNA precipitation step, increase the spin time if centrifuging at a slower speed to fully precipitate DNA. Elute with Qiagen Buffer EB (10 mM Tris-Cl, pH 8.5; Cat # 19086) instead of Buffer AE. Spin at 4,500 × g for 5 min. Elute 2–3 times with new Buffer EB each time (do not reload eluate).\nMeasure the gDNA concentration by nanodrop. We typically obtain 100 μg gDNA per 20 × 106 cells.",
    "Note: Although measuring DNA by Qubit dsDNA assay is more sensitive and accurate than by nanodrop, we noticed running PCRs based on the concentration of gDNA from the Qubit assay sometimes resulted in a poor amplifying efficiency. Therefore, we recommend using a nanodrop to measure DNA concentration.\nAmplify the integrated sgRNA (PCR1) with the following reagents and reaction program:\nCritical: To make sure the diversity and coverage of sgRNAs is not lost during PCR1, multiple 100 μL PCR reactions are required for screen preparation. Empirically, we recommend 1 PCR reaction for every 2,500 sgRNA in the library (e.g., For a customized library that has 25,000 sgRNAs, at least 10 PCR reactions are needed, and therefore a minimum of 100 μg gDNA is required).\nNote: Although this protocol calls for 10 μg of genomic DNA per 100 μL PCR1 reaction, DNA input can be decreased to 5 μg or less if necessary. See troubleshooting[href=https://www.wicell.org#troubleshooting] section for a brief explanation on why a user may want to decrease the amount of input genomic DNA.\ntable:files/protocols_protocol_2569_3.csv\n∗25 nM per dNTP.\ntable:files/protocols_protocol_2569_4.csv\nNote: As the amount of genomic DNA collected from cell samples can be limited, especially for FACS-based screens, it is highly recommended to run a single (or “pilot”) PCR1 to ensure all conditions are correct and yield an amplified fragment.\nPool and mix all amplicons of the PCRs from the same gDNA sample. Add Illumina sequencing indexes with the following reagents and reaction program:\ntable:files/protocols_protocol_2569_5.csv\ntable:files/protocols_protocol_2569_6.csv\nNote: Though PCR1 uses 18 cycles, it was empirically determined that 20 cycles for PCR2 resulted in the best signal-to-noise ratio.",
    "Note: Selecting index adapters with diverse sequences for pooled libraries is CRITICAL: for successful sequencing and data analysis. For information on how to optimize the color balance of the index adapters see the “Index Adapters Pooling Guide” published by Illumina (link[href=https://support-docs.illumina.com/SHARE/IndexAdapterPooling/Content/SHARE/IndexAdapterPooling/Intro_dtP.htm]).\nNote: Only one 100 μL PCR2 reaction is sufficient to achieve sequencing depth.\nLoad PCR products onto 2% TBE-agarose gel.\nRun the sample at 120 V for 50 min. Excise the brightest band.\nNote: The size of the band is expected to be 280 bp but may run higher due to overloading of the gel.\nPurify DNA products using QiaQuick Gel Extraction Kit (Cat # 28706) according to manufacturer’s instructions (link[href=https://www.qiagen.com/ye/resources/download.aspx?id=a9de0fd4-e405-4bb7-b3a0-a74b336d613e&lang=en]).\nNote: We slightly modified this protocol for increased yield. When dissolving the gel, add 4 volumes Buffer QG instead of 3. For the DNA precipitation step, add 3 M sodium acetate pH 5.2 at a 1:100 ratio. For the wash step, wash with Buffer PE two times instead of once. Elute DNA in Buffer EB, not water.\nCheck DNA concentration by Qubit dsDNA HS Assay. We typically obtain 30 ng/mL DNA.\nVerify DNA quality using a fragment analyzer. DNA fragments should run as a single band at ∼300 bp (Figure 6[href=https://www.wicell.org#fig6]B).\nIf the DNA runs as a single band at ∼300 bp without contamination at other sizes, pool equal amounts of DNA from each screen sample so that the final concentration is 3 nM. Send the pooled library for deep sequencing.\nNote: The molecular weight of the DNA can be calculated based on the nucleotide sequence.\nWe typically send 50 μL of the pooled library at 3 nM and 30 μL of the Bassik custom sequencing Illumina sequencing primer (oMCB1672_new10gCRKO) at 100 μM. Both are sent in Qiagen EB (10 mM Tris, pH 8.5).",
    "Critical: The pooled library loses diversity after ∼26 bp. For the sequencing read, 22–25 cycles single end read is recommended. Alternatively, request the sequencing facility to add 20%–30% PhiX to increase the diversity.\nNote: A minimum of 200× coverage is required when choosing a sequencing platform. For example, if a sgRNA library contains 30,000 elements, a pooled DNA library from 2 cell samples and 20% PhiX requires 30,000 × 200 × 2 × (100% + 20%) = 14.4 × 106 single-end read. A standard MiSeq v3 has up to 25 × 106 reads, which is enough to sequence this library.\nNote: We recommend requesting the sequencing data in the demultiplexed FASTQ format, as demultiplexing separates each barcoded sample reads into individual files.\nAnalysis of deep sequencing data using casTLE\nTiming: 2–5 days, not including any additional time needed by the facility performing the sequencing",
    "Analysis of deep sequencing reads can be performed using a number of statistical frameworks, all of which involve sequence read alignment and gene enrichment calculations to identify hit genes that influence the phenotype of interest. Commonly used pipelines include MAGeCK,12[href=https://www.wicell.org#bib12],13[href=https://www.wicell.org#bib13] MAGeCK-iNC,14[href=https://www.wicell.org#bib14] HiTSelect,15[href=https://www.wicell.org#bib15] DeSEQ,16[href=https://www.wicell.org#bib16] and RIGER.17[href=https://www.wicell.org#bib17] Here we describe the analysis pipeline for cas9 high-Throughput maximum Likelihood Estimator (casTLE8[href=https://www.wicell.org#bib8]). The casTLE package consists of custom scripts for sequence read alignment using Bowtie, hit gene identification, and quality control and data visualization. CasTLE is built upon an empirical Bayseian framework that combines measurements from multiple targeting reagents (e.g., multiple sgRNAs per gene) to estimate a maximum effect (phenotype) size and an associated p-value by comparing each set of gene-targeting guides to the negative controls. For each gene, casTLE calculates enrichment (casTLE effect) as a median normalized log ratio of counts, with an associated confidence score (casTLE score), which is twice the log-likelihood ratio of the effect. CasTLE can analyze two replicate screens side-by-side, and a combination gene score and effect can then be calculated for each gene. CasTLE also contains plotting scripts, which allow the user to visualize the results as a volcano plot (see step 31[href=https://www.wicell.org#o0365]), plot the distribution of targeting guides relative to negative controls (see step 36[href=https://www.wicell.org#o0395]), graph and calculate guide representation (see step 30[href=https://www.wicell.org#o0360]), and assess reproducibility between samples (see step 35[href=https://www.wicell.org#o0390]).\nDownload and back up raw sequencing FASTQ files.\nNote: Many NGS core facilities delete the FASTQ files after a few weeks, so download and back them up shortly after receiving them.\nNote: Raw FASTQ files must be unzipped to be opened in a text editor. It is usually unnecessary to view them unless a potential quality issue is detected as the files are large and time consuming to download.",
    "Note: FASTQC (link[href=https://www.bioinformatics.babraham.ac.uk/projects/fastqc/]) can be used for a quality control assessment of FASTQ files (e.g., identification of irregularities, such as overrepresented sequences).\nInstall casTLE version 1.0 (link[href=https://github.com/elifesciences-publications/dmorgens-castle]) and the required modules (link[href=https://www.anaconda.com/products/distribution]). We recommend running casTLE on Linux or MacOS.\nNote: CasTLE scripts were written for python 2.7 (link[href=https://www.python.org/download/releases/2.7/]) and Bowtie version 1 (link[href=http://bowtie-bio.sourceforge.net/index.shtml]).\nNote: Install the parallel python module (link[href=https://www.parallelpython.com/downloads.php]) to increase speed of the casTLE analysis (optional but recommended).\nNote: Alternatively, casTLE analysis workflow can be run on the new, web-based platform LatchBio (https://latch.bio/[href=https://latch.bio/]).\nOpen Terminal and navigate to the folder containing the casTLE scripts. CasTLE scripts are run from the command line.\nNote: All casTLE scripts should be run from the top folder.\nFor screens conducted using sgRNA libraries other than the Bassik Human or Mouse CRISPR Knockout Library (Addgene # 101926-34, # 1000000121-30), create a bowtie index using the casTLE script makeIndices.py.\nNote: If using the Bassik Human or Mouse CRISPR Knockout Library, skip this step and proceed to step 29.\npython Scripts/makeIndices.py <list sequence file> <screen type> <screen type index>\ntable:files/protocols_protocol_2569_7.csv\nNote: In the event of the error bowtie-build: not found rerun the script with -b <bowtie-build location> at the end of the command. The error indicates that bowtie-build (the bowtie script required for casTLE’s makeIndices.py script) cannot be located, and -b will indicate the location.\nAlign FASTQ sequences to the reference sgRNA library using the casTLE script makeCounts.py.\npython Scripts/makeCounts.py <file base for FASTQ file> <output file name> <screen type>\ntable:files/protocols_protocol_2569_8.csv\nNote: To change the length of the sequencing read to be aligned, include the conditional argument -r [number] in which the number indicates how many base pairs should be used in the alignment. CasTLE’s default read length is 17 base pairs.",
    "Note: If using a library other than the Bassik human or mouse library, the naming scheme for control sgRNAs (as used in the list sequence file) must be indicated. At the end of the argument, include -n [prefix of negative control sgRNAs].\nVisualize the distribution of elements in each count file using the casTLE script plotDist.py (Figure 5[href=https://www.wicell.org#fig5]A). The output is a .png file containing a plot of elements (x-axis) versus frequency (y-axis).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2569-Fig5.jpg\nFigure 5. CasTLE analysis of deep sequencing data\n(A) Example output from the casTLE plotDist.py script. Counts for each element were normalized to the total number of counts and diversity was calculated as normalized entropy using the total number of elements to define the max entropy.\n(B) Example volcano plot of casTLE effects versus casTLE scores calculated using the casTLE analyzeCounts.py script. The plot was created in GraphPad Prism.\n(C and D) Reproducibility plots of casTLE scores (C) and casTLE effects (D) generated using the casTLE plotRep.py script.\n(E–G) Example cloud plots and histograms for a hypothetical CRISPR screen showing genes with multiple enriched sgRNAs (E), multiple disenriched sgRNAs (F), or sgRNAs that were neither enriched nor disenriched (G). Cloud plots (top panels) show individual element counts of negative sgRNAs (grey) and sgRNAs targeting the gene of interest (color). Histograms (bottom panels) plot the null distribution (negative sgRNAs; red) and the distribution of sgRNAs targeting the gene of interest (blue), with each solid vertical line indicating the casTLE effect of an individual sgRNA and the dashed vertical line denoting that gene’s casTLE effect.\npython Scripts/plotDist.py <output file name> <count file >\ntable:files/protocols_protocol_2569_9.csv\nTo visualize element distributions from more than one count file (e.g., three counts files), run the following script:",
    "python Scripts/plotDist.py <output name> <count file 1> <count file 2> <count file 3> -l Sample1 Sample2 Sample3\nWhere -l indicates sample names to be included in the plot’s legend, in order of count files in the command.\nNote: If analyzing counts from a specific sublibrary within the Bassik library, indicate the sublibrary with -x [sublibrary]. For example, -x ACOC.\nCompare sgRNA enrichment between two files (e.g., vehicle vs. treated or GFP high vs. GFP low) using the casTLE script analyzeCounts.py.\npython Scripts/analyzeCounts.py <count file 1> <count file 2> <output results file>\ntable:files/protocols_protocol_2569_10.csv\nThe output is a .csv file (and an associated record file) containing 13 columns:\ntable:files/protocols_protocol_2569_11.csv\nNote: By default, casTLE removes sgRNAs with fewer than 10 sgRNA counts from the analysis. To change the threshold for removal, include -t [number] at the end of the argument. For example, -t 50 will tell casTLE to remove genes with fewer than 50 counts from the analysis.\nNote: The casTLE script plotVolcano.py can be used to quickly visualize the casTLE effect (x-axis) versus casTLE score (y-axis). We recommend generating volcano plots in a program such as GraphPad Prism for publication quality figures (Figure 5[href=https://www.wicell.org#fig5]B).\nEstimate p-values using the casTLE script addPerm.py and calculate false discovery rate (FDR).\npython Scripts/addPermutations.py <results file> <number of permutations>\ntable:files/protocols_protocol_2569_12.csv\nNote: For publication, we recommend that the number of permutations run is 50× the number of genes in the library. For example, run 150,000 permutations for a library that contains 3,000 genes.\nTo calculate 10% FDR, sort genes from lowest to highest p-value and use the following equation: =IF([p-value]<0.1×(ROW()-1)/[total # of genes],1,[subsequent row]).\nCompare screens using the casTLE script analyzeCombo.py. The output file will contain a new, combined casTLE effect and casTLE score for each gene.\npython Scripts/analyzeCombo.py <results file 1> <results file 2> <output file name>",
    "table:files/protocols_protocol_2569_13.csv\nEstimate p-values for the combined casTLE results using the casTLE script addCombo.py. Calculate false discovery rate (FDR) as described in step 32.\npython Scripts/addCombo.py <combo results file> <number of permutations>\nCompare casTLE effects and casTLE scores between replicates using the casTLE script plotRep.py (Figures 5[href=https://www.wicell.org#fig5]C and 5D). The output is two scatter plots (PNG files) with the coefficient of determination (R2).\npython Scripts/plotRep.py <results file 1> <results file 2> <output file name>\nVisualize distribution of sgRNAs for genes of interest versus null distribution using the casTLE script plotGenes.py (Figures 5[href=https://www.wicell.org#fig5]E–5G).\npython Scripts/plotGenes.py <results file 1> <gene name 1> <gene name 2>…\nNote: The output is a cloud plot and a histogram. The cloud plot (top panels) is a scatter plot showing the deep sequencing counts for each element targeting the gene of interest (color scale) along with all the negative sgRNAs (gray). The histogram (bottom panels) is a frequency distribution of the casTLE effect for negative controls (red) versus the gene of interest (blue). Vertical solid lines indicate the individual casTLE effects for each guide, and the vertical dashed line indicates the casTLE effect for that gene. Figures 5[href=https://www.wicell.org#fig5]E–5G shows examples of cloud plots and histograms for hypothetical enriched gene X (Figure 5[href=https://www.wicell.org#fig5]E), depleted gene Y (Figure 5[href=https://www.wicell.org#fig5]F), and unaffected gene Z (Figure 5[href=https://www.wicell.org#fig5]G).\nNote: This script also serves as a quality control step by plotting the distribution of negative control sgRNAs, in both the cloud plot and the histogram.\nNote: To change the file type, add -f [file type] to the end of the command. For example, to generate SVG files instead of PNG files, the script should end with -f svg, and the output file will be a SVG file."
  ],
  "subjectAreas": [
    "Genomics",
    "Flow Cytometry",
    "Crispr",
    "Cell Culture",
    "Cell-Based Assays",
    "Molecular Biology"
  ],
  "bigAreas": [
    "Molecular Biology & Genetics",
    "Bioengineering & Technology"
  ]
}