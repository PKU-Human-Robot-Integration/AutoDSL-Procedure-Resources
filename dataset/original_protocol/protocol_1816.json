{
  "id": 1926,
  "origin_website": "Cell",
  "title": "A protocol for investigating lipidomic dysregulation and discovering lipid biomarkers from human serums",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nAn overview of the workflow of the protocol is summarized in Figure 1[href=https://www.wicell.org#fig1]. The serum samples were slowly thawed at 4°C and then extracted by ethanol for lipids (steps 1–10). The extracts were injected into the LC-MS system for untargeted lipidomics (steps 11–19). The acquired data were imported to MS-DIAL 4 for identification and quantitation of serum lipids (steps 20–26). Statistical analysis including differential expression analysis and differential correlation analysis was performed to investigate the disease-related lipidomic dysregulations (steps 27–28). To investigate the potential of serum lipid dysregulation for clinical diagnosis of the studied disease, biomarkers discovery (steps 29–32) and machine learning were further performed (steps 33–37).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1408-Fig1.jpg\nFigure 1. An overview of the experimental and computational procedures of the protocol\nSerum samples were extracted by ethanol. Quality control (QC) sample was generated by mixing equal volumes of each sample. Blank samples were prepared by extraction of Milli-Q water. These samples were injected for LC-MS analysis in the order as shown in the figure. The acquired data was imported to MS-DIAL for peak alignment, blank filter, lipid identification and quantification. The obtained peak area matrix of serum lipids was finally used for statistical analysis and machine learning for investigation of lipid dysregulation and discovery of lipid biomarkers.\nSample preparation for LC-MS analysis\nTiming: 1–2 day for ∼300 samples\nSlowly thaw the serum samples (50 μL/sample) at 4°C.\nAdd 150 μL ice-cold ethanol to each sample to make a final solution of 75% (v/v) ethanol.",
    "Note: Ethanol was used as the extraction solvent for serum lipids in our study to ensure inactivation of viruses. It can sufficiently extract most classes of lipids including phosphatidylcholine (PC), and phosphatidylethanolamine (PE). However, its extraction efficiency was not satisfactory considering some highly hydrophobic lipids such as triacylglycerol. For extraction of total serum lipids, we suggest the Bligh and Dyer (1959)[href=https://www.wicell.org#bib1] or Folch (Folch et al., 1957[href=https://www.wicell.org#bib4]) method, or methyl tert-butyl ether−methanol (MTBE-MeOH) method (Matyash et al., 2008[href=https://www.wicell.org#bib9]), which are the most commonly used methods.\nNote: Use of internal standards can correct possible deviations from sample preparation to LC-MS analysis, making quantification more accurate and reliable. Readers can refer to (Wang et al., 2017[href=https://www.wicell.org#bib15]) for suggestions for more accurate quantification using internal standards.\nVortex the mixture vigorously for 5 min to ensure sufficient lipid extraction and protein precipitation.\nCentrifuge the mixture at 1,6200×g, 4°C for 5min and collect 150 μL of the supernatant to a new 1.5mL tube.\nIncubate the supernatant at −80°C for 12h to facilitate protein precipitation.\nCentrifuge the mixture again at 4°C, 1,6200×g for 10 min and collect the supernatant to a new 0.5mL tube carefully without disturbing the pellet for final LC-MS analysis.\nNote: −80°C incubation and repeat centrifugation of the samples can remove the serum proteins more adequately and thus reduce the risk of clogging of the LC separation column in the subsequent analysis procedure.\nPrepare a pooled quality control (QC) sample by mixing equal volumes of each sample (10–20 μL depending on the sample size).",
    "Note: The pooled QC sample contains all the lipid features of the biological samples under study. So, it can be used to measure the stability of the data acquisition procedure for all the detected features. Features with excessive shift in retention time, signal intensity and mass accuracy can be excluded for subsequent statistical analysis or be corrected before further analysis.\nDivide the QC samples into small aliquots of 50 μL/sample and transfer them into pre-labeled glass inserts assembled in glass vials respectively. Seal the vials with screw caps and tap the bottom of each vial to release air bubbles present at the bottom. Store the samples at −80°C until LC-MS analysis.\nNote: Dividing the QC samples into small aliquots can avoid long-time placement of QC samples in the sampler at 4°C in the subsequent analysis procedure.\nDivide the rest of each sample into small aliquots of 20–30 μL/sample and transfer them into pre-labeled glass inserts assembled in glass vials respectively. Seal the vials with screw caps and tap the bottom of each vial to release air bubbles present at the bottom. Store the samples at −80°C until LC-MS analysis.\nNote: Dividing the analysis samples into small aliquots can avoid repeated freezing and thawing in the subsequent analysis procedure, as freshly thawed aliquots can be separately used for positive and negative mode. The remained aliquots can be used in case re-analysis is required.\nPrepare blank samples by extraction of Milli-Q water using the same procedure as for serum and transfer them into pre-labeled glass inserts assembled in glass vials respectively. Seal the vials with screw caps and tap the bottom of each vial to release air bubbles present at the bottom. Store the samples at −80°C until LC-MS analysis.",
    "Critical: To avoid potential infection risk with bloodborne pathogens, perform all work with appropriate personal protection equipment.\nNote: Sample preparation order should be randomized to avoid possible systematic biases.\nUntargeted lipidomic analysis based on LC-TIMS-TOF/MS\nTiming: 20 min/sample, 10 days for ∼300 samples in positive and negative ion mode\nPerform preventative instrument maintenance including cleaning and washing of the pipelines, electrospray needles and MS ion source according to the manufacturer’s guidelines.\nPrepare mobile phase A, mobile phase B and sodium formate solution as described in the ‘‘materials and equipment[href=https://www.wicell.org#materials-and-equipment]’’ section.\nInstall the HPLC solvent lines into the HPLC solvent reservoirs\nPurge the solvent lines A and B separately at a flow rate of 3 mL/min for 5 min.\nEquilibrate the LC and MS system for at least 0.5h using the parameters in Tables 1[href=https://www.wicell.org#tbl1] and 2[href=https://www.wicell.org#tbl2].\nNote: Check the state of the LC-TIMS-TOF/MS system according to the manufacturer’s guidelines before sampling, mainly including column pressure, background noise, MS sensitivity, signal stability, etc. See troubleshooting 1[href=https://www.wicell.org#troubleshooting] for the high back pressure of the system.\nCalibrate the MS system using the sodium formate solution by direct injection using a syringe.\nTake the samples out of the −80°C refrigerator followed by thawing at 4°C. Vortex the samples again to make a homogenous solution. Put them in the UPLC autosampler operating at 4°C.\nNote: Take one QC sample and 60 analysis samples every one day for analysis, this allows a maximal exposure time of all samples at 4°C to be within 24 h, thus avoiding lipids’ deterioration during the long-time storage at 4°C.",
    "Create a batch table as shown in Figure 1[href=https://www.wicell.org#fig1]. 5 Blank samples are injected at the start of the analytical batch followed by 10 QC samples. Then insert pooled QC samples once every nine analytical samples. The last sample in the batch should also be QC.\nNote: Sample analysis order should be randomized and different from sample preparation order to avoid possible systematic biases.\nNote: Blank samples should not be inserted in the subsequent analysis procedure to avoid disturbance of the equilibrium state of the system.\nNote: QC samples should be inserted at least once every fifteen analytical samples. More frequent data acquisition of QC samples may increase the accuracy of subsequent corrections of MS signals, if needed.\nAnalyze samples in positive and negative ion mode separately. Chromatographic separations and MS detection are performed as described in the ‘‘materials and equipment[href=https://www.wicell.org#materials-and-equipment]’’ section.\nNote: Perform pre-experiments to check the possibility of carry over, this can be realized by injection of blank samples after a continuous analysis of real samples. Ensure that no peaks of lipids are observed in the total ion chromatography (TIC) of blank samples or no lipids can be identified by MS-DIAL. If this problem occurs, wash the column with 100% mobile phase B for about 5 min at the end of each separation process before being balanced to the initial mobile phase ratio. In our previous work, the TIC of QC and blank are shown in Figure 2[href=https://www.wicell.org#fig2].\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1408-Fig2.jpg\nFigure 2. TIC of QC and blank samples (after sample injection) in positive and negative mode\nNote: Injection volume was set as 5 μl for positive ion mode and 10μl for negative ion mode due to the low sensitivity of negative ion mode.",
    "Note: All samples were first analyzed in positive ion mode. Then switch the polarity of the MS to negative and repeat step 11–18 for analysis in negative ion mode.\nNote: Check the signal of the blank samples to ensure that the LC-MS system is free of contamination. See troubleshooting 2[href=https://www.wicell.org#troubleshooting] for high background signals in blank samples.\nNote: The continuous injection of multiple QC samples at the beginning of the analysis process is carried out for two reasons. The first is to equilibrate the LC-MS system with the sample matrix to block the active sites after preventative maintenance. It has been reported that the first eight injections for LC-MS are not reproducible (Zelena et al., 2009[href=https://www.wicell.org#bib18]). The second is to check the stability of the LC-MS system.\nNote: The direct contact of sample components with many parts of the LC-MS system may cause contamination of the instrument, which may lead to bias of the analytical result. So, we must check the stability of the data acquisition process frequently. This can be realized by analyzing the drift of retention time, accurate mass, and peak area of the detected features in QC samples during the analysis process. In general, the retention time shift within 0.15 min across all QC samples indicates good reproducibility of the LC separation procedure. 70% of the detected features across all QC samples with coefficient variation of less than 30% indicate good stability of the MS signal (Want et al., 2010[href=https://www.wicell.org#bib16]). For TIMS-TOF/MS used in our study, the mass shift within 10 ppm across all QC samples indicates good mass accuracy. Figure 3[href=https://www.wicell.org#fig3] shows the drift of retention time, peak area, and mass accuracy of a lipid feature in QC samples with the order of analysis in our study.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1408-Fig3.jpg",
    "Figure 3. An example of the TIMS-TOF/MS system’s stability during continuous analysis of serum extracts from Hao et al. (2021)[href=https://www.wicell.org#bib6]\n33 QC samples were injected throughout a series of 267 samples. PC 16:1_18:1 was chosen as an example here. (A) Variation in peak area of PC 16:1_18:2 in QC versus analysis order, expressed as percentage deviation from the mean intensity (coefficient of variation = 4.3%; n = 33. (B) Retention time drift during analyses, expressed in seconds deviation from the mean retention time (9.264 min ± 0.6 s; n = 33). (C) Variation in accurate mass measurement, in ppm deviation from the mean of accurate masses.\nSee troubleshooting 3[href=https://www.wicell.org#troubleshooting], 4[href=https://www.wicell.org#troubleshooting], 5[href=https://www.wicell.org#troubleshooting] if the obtained data are not of good quality.\nQuantitative and qualitative analysis of lipids by MS-DIAL\nTiming: 1 day for ∼300 samples\nUntargeted lipidomic data are processed by MS-DIAL following the guidelines of the tutorial online (https://mtbinfo-team.github.io/mtbinfo.github.io/MS-DIAL/tutorial[href=https://mtbinfo-team.github.io/mtbinfo.github.io/MS-DIAL/tutorial]).\nPerform post-run mass calibration for each sample using signal of the sodium formate cluster ions by the DataAnalysis software (Bruker) to improve mass accuracy.\nNote: For mass calibration of a large number of samples, it is recommended to use script files for batch analysis according to the manufacturer’s guidelines.\nConvert the resulting data files (.d format) to ABF format using Reifycs file converter and CompassXtract (Bruker).\nNote: The size of the original .d data file is commonly 230 MB for positive ion mode and 120 MB for negative ion mode, and the resulting abf file is about 11 MB for positive ion mode and 3.5 MB for negative ion mode.\nImport the .abf files into MS-DIAL (version 4.24) for data processing including peak extraction, alignment and annotation using the parameters in Table 3[href=https://www.wicell.org#tbl3].\ntable:files/protocols_protocol_1408_7.csv",
    "Note: Set the retention time tolerance to 100 min and uncheck “Use retention time for scoring and filtering options” in the identification tab unless an identical LC condition is used.\nExport the alignment result including raw data matrix (Area), retention time matrix and m/z matrix.\nNote: Filter the result by the ion abundances of blank samples. Replace zero values with 1/10 minimum peak height over all samples. See troubleshooting 6[href=https://www.wicell.org#troubleshooting] for a low number of chromatographic peaks.\nNote: The alignment result can be used to check retention time shifts, intensity drifts and mass accuracy of detected features in QC or all samples.\nExclude the peak features with relative standard deviations (RSDs) of over 30% in the QC samples.\nCheck and correct the annotation results of lipids manually by comparing the experimental MS/MS spectrum with reference on the graphical user interface of MS-DIAL to reduce false positive annotations.\nNote: This step requires the participation of a skilled MS specialist and may take several days to complete.\nNote: An ideal MS/MS spectrum for lipid identification should contain abundant diagnostic ions and few interfering ions (Figure 4[href=https://www.wicell.org#fig4]A). However, the experimental MS/MS spectrum of a lipid is often contaminated by the co-elute lipids with the same m/z due to the large number of isomers in lipid species (Figure 4[href=https://www.wicell.org#fig4]B). Besides, if the Δ m/z is within 2 between the interferential lipids and the target lipid, both will be isolated for acquisition of the MS/MS spectrum, which may also confuse characterization (Figure 4[href=https://www.wicell.org#fig4]C). So, attention must be paid to these confusions to avoid false-negative as well as false-positive results.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1408-Fig4.jpg\nFigure 4. An example of MS/MS spectrum match of the experimental spectrum (black) with reference (red) from Hao et al. (2021)[href=https://www.wicell.org#bib6]",
    "(A) MS/MS spectrum of PC 32:2 (16:0_18:2) with abundant diagnostic ions and few interfering ions that were favorable for identification.\n(B) MS/MS spectrum of DG 32:1 consisting of two isomers as DG 16:0_16:1 and DG 14:0_18:1 that were co-eluted on the C18 column.\n(C) MS/MS spectrum of PC 36:6 (14:0_22:6) contaminated by the co-eluted PC 36:5 (18:2_18:3).\nNote: For the identification of fatty acids, diagnosis ions are often not sufficiently obtained in the MS/MS spectrum. So, retention time comparison with standards is needed for structure characterization. Besides, the retention time of fatty acids on C18 is linearly related to carbon atom numbers and unsaturation degrees, which can be used as another criterion for identification.\nNote: For the identification of PC and PE, identification in negative ion mode is preferred due to the informative MS/MS spectrum with high-intensity diagnosis ions of acyl chains. Besides, PC is commonly identified in the form of [M+HCOO]- in negative ion mode, while PE is commonly identified in the form of [M−H]−, thus reducing the confusion between them.\nIntegrate the lipidomics data in positive and negative ion mode to generate a matrix containing lipid name and peak area information of all samples. The peak area matrix is saved to a ‘.xlsx’ file as shown in Table S1[href=https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1408-Mmc1.xlsx].\nNote: The same lipid can be detected and identified in multiple ion forms such as [M+H]+, [M+NH4]+, [M+Na]+ (positive ion mode) or [M−H]−, [M+HCOO]− (negative ion mode). Choose one form for further analysis according to their peak intensity and reliability of MS/MS spectra match.\nFor more details about the use of MS-DIAL, see the online tutorial (https://mtbinfo-team.github.io/mtbinfo.github.io/MS-DIAL/tutorial[href=https://mtbinfo-team.github.io/mtbinfo.github.io/MS-DIAL/tutorial]).\nStatistical analysis\nTiming: 3 h",
    "Statistical analysis combined with visual images can better help us to further investigate the molecular basis of diseases. Here, we use hypothesis testing combined with heatmap and differential correlation analysis combined with networking.\nConstruct heatmap for significant differential lipids:\nCalculate the p-value of each lipid between asymptomatic and healthy groups by two-sided Wilcoxon rank-sum test.\nCorrect p-value by Benjamini & Hochberg (BH) correction to get adjusted p-value.\nCalculate log2 fold-change (log2 FC) by log2-scaling the ratio of mean peak area in asymptomatic and healthy groups for each lipid.\nSelect the significant differential expressed lipids which are defined using the criteria of adjusted p-value less than 0.05 and absolute log2 FC larger than 0.25.\nThe heatmap of significant differential lipids is generated with R package ‘heatmap’ (Figure 5[href=https://www.wicell.org#fig5]A) and two input data (Figures 5[href=https://www.wicell.org#fig5]B and 5C).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1408-Fig5.jpg\nFigure 5. The screenshot of the R code and two input data for heatmap\n(A) The screenshot of the R code.\n(B) The screenshot of input data 1. The row, column and value represent lipid name, sample number and peak area.\n(C) The screenshot of input data 2. Three columns represent sample type, sex and age of each sample.\nNote: In our previous work (Hao et al., 2021[href=https://www.wicell.org#bib6]), the scripts and example data of calculating adjusted p-value and log2 FC were saved in the file named ‘FC&p-value.R’ and ‘432_lipid.csv’. The script and example data of heatmap were saved in the file named ‘heatmap.R’, ‘area_matrix.csv’ and ‘annotation.csv’. These script files and example data can be found in github (https://github.com/Chen-micslab/Covid19_TIMS/tree/main/R[href=https://github.com/Chen-micslab/Covid19_TIMS/tree/main/R]).\nBuild Networking for differential correlation: Changes in lipid-lipid correlation patterns between disease and healthy groups may reveal pathologically related metabolic disorders.",
    "Calculate the differential correlation of lipid pairs. The number of the lipid pairs was calculated based on the number of the identified lipids (typically > 400) multiplied by the number of the subjects. The differential correlation of a lipid pair in asymptomatic and healthy groups is calculated through the package DGCA in R (Figure 6[href=https://www.wicell.org#fig6]A). The input data (Figure 6[href=https://www.wicell.org#fig6]B) is directly put into the function ‘ddcorAll’ in DGCA, and the ‘corrType’ is set to ‘Spearman’ and the ‘adjust’ is set to ‘BH’. All lipid pairs with adjusted P values less than 0.05 were retained. The output data is saved to a ‘.csv’ file (Figure 6[href=https://www.wicell.org#fig6]C).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1408-Fig6.jpg\nFigure 6. The screenshot of the R code, input data and output data for calculating differential correlation\n(A) The screenshot of the R code.\n(B) The screenshot of input data. The row and column represent lipid name and sample type. The value is peak intensity.\n(C) The screenshot of output data.\nNote: In our previous work, the scripts and example data of calculating differential correlation were saved in the file named ‘differential correlation.R’ and ‘432_lipid.csv’, and can be found in github (https://github.com/Chen-micslab/Covid19_TIMS/tree/main/R[href=https://github.com/Chen-micslab/Covid19_TIMS/tree/main/R]).\nVisualize the networking in the Cytoscape program.\nThe column ‘Gene1’, ‘Gene2’ and ‘Classes’ in the output data of step a are extracted and saved to a ‘.txt’ file. Click ‘‘File’’ -> ‘‘Import’’ -> ‘‘Network from file…’’ -> choose the ‘.txt’ file generated by step 28-a. Names of lipids are set as nodes and classes of lipid pairs are set as edges.\nDiscovery of lipid biomarkers\nTiming: <1 d",
    "The presence of hundreds of lipids would be challenging for clinical diagnosis. To improve the feasibility of detection and enhance the training speed of machine learning, it is necessary to perform feature selection to find out the lipids that are crucial for classification. Here, we developed a unique feature selection method for our untargeted lipidomics data (Figure 7[href=https://www.wicell.org#fig7]).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1408-Fig7.jpg\nFigure 7. The workflow of discovering lipid biomarkers\nCalculate the average feature importance of each lipid of 100 random forest models (Svetnik et al., 2003[href=https://www.wicell.org#bib12]).\nNote: The feature importance is calculated based on the average variation of the feature’s Gini index. Here, all the hyperparameters of the random forest model are fixed (n_estimators are set to 100 and other parameters are the default values), except for the random_state. The feature importance is calculated respectively in 100 different random_state.\nAlternatives: Other tree-based models can also be used as alternatives, such as XGBoost (Torlay et al., 2017[href=https://www.wicell.org#bib13]).\nChoose the top X important lipids according to the average feature importance.\nNote: In our previous work, the top 60 important lipids are selected from all 432 lipids. The number of selected top important features can be changed according to the actual situation of the experimental data.\nDivide the lipids into N sets according to their belonging subclasses.\nNote: In our previous work, the top 60 important lipids are divided into 12 sets.\nSelect one lipid randomly from the top 3 important lipids of each set to build a panel containing N lipids.\nRepeat step 32 until all the possible panels are generated.\nEvaluate these panels by the average accuracy of 20 repeated five-fold cross-validations in random forest models (n_estimators is set to 100 and other parameters are the default values) and choose the panel with the highest average accuracy as the initial panel.",
    "Alternatives: The construction of the initial panel can be a time-consuming process. If your computer has limited computing power, you could change top 3 to top 2 or 1 in step 32, and you could also reduce the number of repetitions of five-fold cross-validation.\nAdd remaining lipids to panel:\nWhen the current panel containing H lipids, each of the remaining lipids in the H lipids are added into the current panel respectively to get (X – H) new panels containing (H + 1) lipids, and evaluate these panels by the average accuracy of 20 repeated five-fold cross-validations in random forest models and choose the panel with the highest average accuracy as the new panel.\nRepeat step 35 until the accuracy of all new panels is lower than the current panel. These lipids in the current panel will be the final panel for subsequent machine learning.\nMachine learning for clinical diagnosis\nTiming: ∼1 d\nConsidering the significant importance of sensitivity in clinical diagnosis, here, we propose an ensemble learning model based on a voting algorithm to improve sensitivity of the model. This part contains model selection, model training, model ensemble and model evaluation. To avoid wasting much computing time, we recommend that your computer should be equipped with at least 2.4 GHz CPU Clock Speed and at least 8 G memory. In our previous work, machine learning codes are all based on Python and the package ‘Scikit-learn’.\nDivide data set randomly into training set and testing set.\nCritical: The testing set cannot be used in any process of model training.",
    "Note: In clinical diagnosis, it will be better if you can get another independent cohort collected at different times or areas as the testing set. In our previous work, we did not have anindependent cohort. We used five-fold cross-validation which means the testing set contains 20% of the whole data set.\nList candidate models, such as SVM (Support vector machine) (Cortes and Vapnik, 1995[href=https://www.wicell.org#bib2]), RF (random forest), LG (logistic regression) (Pregibon, 1981[href=https://www.wicell.org#bib10]), MLP (multi-layer perceptron) (Gardner and Dorling, 1998[href=https://www.wicell.org#bib5]).\nSelect models by nested cross-validation (Krstajic et al., 2014[href=https://www.wicell.org#bib7]): For subsequent ensemble learning, two models that perform best on our data need to be selected from the candidate models. Here, nested cross-validation is used to optimize parameters and measure performance of each model (Figure 8[href=https://www.wicell.org#fig8]).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1408-Fig8.jpg\nFigure 8. The diagram of nested cross-validation\nDivide the training set into five-fold.\nUsing each one-fold as the testing set of the outer loop and the other four-fold as the inner loop.\nOptimize the parameters of each model in the inner loop by the average accuracy of 10 repeated ten-fold cross validation.\nEvaluate the performance of each model’s optimized parameters on the testing set of the outer loop by accuracy.\nRepeat step a, b, c, d 20 times with different random states of step a in each time.\nCalculate the average accuracy of each model in step e.\nSelect two models with highest average accuracy.",
    "Notes: Different models have different parameters, such as the gamma and C of SVM, the hidden_layer_sizes of MLP. The parameters of each model are optimized by grid search, for example, in SVM, C = [0.5, 5, 50, 500], gamma = [0.0005, 0.005, 0.05, 0.5, 5], the best group of parameters which could get the highest average accuracy in the 10 repeated ten-fold cross-validation will be selected from 20 random combinations of two parameters.\nAlternatives: The repeated k-fold cross-validation is not fixed. You can choose an appropriate k-fold based on your data, and we recommend more than 4-fold and at least ten repetitions.\nAlternatives: Here we choose two models to construct an ensemble model. In your experiment, you could try more models to find out the most suitable number of models.\nSee troubleshooting 7[href=https://www.wicell.org#troubleshooting] for the poor performance of individual models.\nTrain model by 20 repeated ten-fold cross-validation based on training set:\nNotes: Grid search is used to select the best group of parameters for each model.\nAlternatives: The 20 repeated ten-fold cross-validation used in the inner loop is also not fixed. You can choose k-fold based on your data, and we recommend more than ten repetitions.\nModel ensemble:\nThe method of ensemble learning used here is based on the stacking method (Li et al., 2019[href=https://www.wicell.org#bib8]). We replace the meta-learner of the stacking method with a voting algorithm. The algorithm follows the rule below:\nIf (model_1 = healthy) and (model_2 = healthy):\n        Ensemble_output = healthy\n      Else:\n        Ensemble_output = disease\nA sample will be predicted as healthy by the ensemble model only when the outputs of the two models are healthy. If the output of one model is disease, the final output of the ensemble model will be disease.\nFigure 9[href=https://www.wicell.org#fig9] shows the workflow of model training and model ensemble.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1408-Fig9.jpg",
    "Figure 9. The workflow of model training and model ensemble\nAlternatives: Here we choose two models to construct an ensemble model. In your experiment, you can try more models to find out the most suitable number of models. You can also design other voting algorithms according to your task requirements.\nEvaluate model on testing set: The final ensemble model will be tested on the testing set which was not used in any previous step. These indicators are used to evaluate the performance of the model: accuracy, sensitivity, specificity, ROC curve and PR curve. All these indicators could be calculated from the confusion matrix (Figure 10[href=https://www.wicell.org#fig10]A). For the binary classification model, the confusion matrix is composed of TP (true positive), TN (true negative), FP (false positive) and FN (false negative).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1408-Fig10.jpg\nFigure 10. An example of models’ indicators from Hao et al. (2021)[href=https://www.wicell.org#bib6]\n(A) The confusion matrix.\n(B) Accuracy, sensitivity and specificity of individual models and the ensemble model.\n(C) ROC curve of ensemble model.\n(D) PR curve of ensemble model.\n  a c c u r a c y =    ( T P + T N )   ( T P + T N + F P + F N )    \n  s e n s i t i v i t y =    ( T P )   ( T P + F N )    \n  s p e c i f i c i t y =    ( T N )   ( T N + F P )     (Figure 10[href=https://www.wicell.org#fig10]B) shows an example of the three results adopted from our previous study for the diagnosis of asymptomatic COVID-19 patients (Hao et al., 2021[href=https://www.wicell.org#bib6]).",
    "ROC curve: The abscissa of the ROC curve represents (1-specificity) and the ordinate represents sensitivity. Each point on the ROC curve is the sensitivity and (1-specificity) of the model on different classification cutoff values (Figure 10[href=https://www.wicell.org#fig10]C).\nNote: In our previous work, we used the default cutoff of each model in scikit-learn. Readers can also set the cutoff value according to their own situation.\nPR curve: The abscissa of the PR curve represents recall (equal to sensitivity) and the ordinate represents precision    (   (  T P  )  /  (  ( T P + F P )  )   )   . Each point on the PR curve is the recall and precision of the model on different classification cutoff values (Figure 10[href=https://www.wicell.org#fig10]D)."
  ],
  "subjectAreas": [
    "Bioinformatics",
    "Health Sciences",
    "Metabolism",
    "Biotechnology And Bioengineering",
    "Mass Spectrometry",
    "Clinical Protocol"
  ],
  "bigAreas": [
    "Biomedical & Clinical Research",
    "Bioinformatics & Computational Biology"
  ]
}