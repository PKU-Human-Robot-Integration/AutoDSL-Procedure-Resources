{
  "id": 3414,
  "origin_website": "Cell",
  "title": "Quantitation of mitotic cells in the neural tube of&nbsp;zebrafish embryos using automated nuclei counting",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nFixation of zebrafish embryos\nTiming: 1–2 days\nThe first step in this protocol is to collect zebrafish embryos at the desired time points and fix them in paraformaldehyde for further processing. The following steps were performed on embryos at 18 h post fertilization (hpf), but the steps can be adapted for other developmental time points.\nSet up adult zebrafish mating the day before you want to collect fertilized eggs. Collect embryos from mating pairs and maintain in E3 media at 28.5°C (Westerfield, 1995).3[href=https://www.wicell.org#bib3]\nPrior to fixation, dechorionate embryos using a fine pair of tweezers. Transfer 25 embryos at 18 hpf for each sample into 1.5 mL centrifuge tubes.\nNote: Sex characteristics are not distinguishable at early stages, but both sexes are typically represented in a clutch of embryos.\nAdd 1 mL of 4% PFA per tube and fix samples for 1–2 h at 22°C–25°C while gently rocking on rocker plate.\nRemove PFA and rinse embryos 3 × 5 min in 1X PBS. Rinse for 4–24 h in 1X PBS at 4°C while laying tube on its side, or on rocker plate, to further clean the embryos.\nNote: Fixation for longer periods can lead to higher background. Use fresh fixative (less than 1 month old).\nCritical: Use personal protective equipment (PPE), including gloves and surgical mask. Work under a fume hood if possible. PFA is toxic and liquid waste should be collected and discarded according to specific handling protocols.\nPermeabilization and immunostaining\nTiming: 2 days\nEmbryos are permeabilized in cold acetone and incubated at -20°C to prepare them for blocking and antibody incubations. Embryos are then rinsed and blocked prior to incubations with primary and secondary antibodies.\nPrechill a small amount of acetone at -20°C, enough for permeabilizing all samples.",
    "Remove PBS from tubes and add 1 mL prechilled acetone.\nIncubate tubes on their sides at -20°C for 7 min.\nNote: For older embryos (48–72 hpf), 8–10 minutes can be used, but timing should be optimized for each age.\nQuickly remove acetone and wash embryos once quickly in water at 22°C–25°C, dropping the last few drops on top to push floating embryos back down into the tube.\nCritical: Use personal protective equipment (PPE), including gloves and surgical mask. Acetone waste should be collected and discarded according to specific handling protocols.\nRemove water and rinse embryos 2 × 5 min washes in PBST at 22°C–25°C while gently rocking on rocker plate.\nReplace wash solution with 500 μL Blocking Buffer and incubate embryos for at least 1 h at 22°C–25°C on rocker plate.\nIncubate embryos in anti-phospho-histone H3 primary antibody (diluted 1:200) in Blocking Buffer (200 μL per tube) for 12–24 h at 4°C on rocker plate.\nNote: To ensure embryos stay submerged, you can prop the tubes up on their hinges.\nThe next day, rinse embryos 4 × 5 min in PBST at 22°C–25°C on rocker plate.\nIncubate embryos in secondary antibody (diluted 1:500) in Blocking Buffer (500 μL per tube) for 4 h at 22°C–25°C or for 12–24 h at 4°C on rocker plate.\nNote: Embryos should be protected from light during and after they are immunolabeled with the secondary antibody to prevent photobleaching.\nRinse embryos for several hours in 5 changes of PBST at 22°C–25°C while gently rocking on rocker plate.\nNote: Embryos can be kept in PBS for 12–24 hours at 4°C before imaging without loss of signal.\nMounting embryos in agarose and collecting image stacks\nTiming: 1+ days",
    "Embryos are mounted in a row using 2% low melting point agarose in the same orientation to capture regions of interest. The imaging tray is then placed on a confocal or 2-photon microscope and image stacks are collected at 1 μm intervals to capture all the immunolabeled nuclei. Parameters can be changed to collect images from other regions of interest.\nEquilibrate a 50 mL conical tube containing 25 mL of 2% low melting point agarose in 1x PBS at 40°C before mounting embryos.\nSelect well labeled embryos under fluorescence and place in a small depression slide or similar shallow holding container.\nMoving quickly, select an embryo from the holding container using a glass Pasteur pipette and quickly drop it into the warm agarose with as little buffer as possible. Remove residual buffer from transfer pipette. Immediately draw up the embryo with the glass pipette and transfer the embryo in a small droplet of liquid agarose onto the glass imaging chamber bottom (Figure 1[href=https://www.wicell.org#fig1]A).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2993-Fig1.jpg\nFigure 1. Steps to isolating a well labeled nucleus to use as a template\n(A) Shown here is a region of a single optical section from an image stack. An isolated nucleus is shown in the yellow box.\n(B) The boxed region in A was cropped to a 32 × 32 × 32 volume with the nucleus centered within the volume and no other fluorescent objects present within the volume.\n(C) The template was processed by applying a Gaussian Blur (radius = 1.5) and adjusting brightness and contrast.\nQuickly orient the embryo within the agarose droplet so that the region of interest is facing upward, which is the direction from which the microscope objective will be imaging.\nCollect image stacks of your region of interest.\nImage processing using Fiji/ImageJ\nTiming: 1+ days",
    "Image stacks are processed using Fiji/Image J to enhance brightness and contrast and to mask areas that are not included in the analysis (see Methods video S1[href=https://www.wicell.org#mmc1]).\nOpen an image stack in Fiji/ImageJ by selecting “Open” under the File dropdown menu and then selecting the .tif file name of your image stack.\nIn the “Bio-Formats Import Options” window, select “Hyperstack” in the “View stack with” dropdown menu at the top and select “Autoscale” at the bottom left. Click “OK” at the bottom.\nAdjust Brightness/Contrast of your images by selecting the “Image” dropdown menu and then the “Adjust” and “Brightness/Contrast” options. When you have adjusted the brightness and contrast of the nuclei in your image stack, click “Apply” to retain the settings.\nTo remove noise from your image stack, select the “Process” dropdown menu and then “Filters” and “3D Gaussian Blur”. This will blur the pixelated noise within your image. Select a radius that reduces the noise without blurring the image too much. For our images, we used a radius of 1.5 for X, Y and Z sigma. Click “OK” to apply the filter.\nMake a Z projection of your image stack by selecting the “Image” dropdown menu and then selecting “Stack” and then “Z Project”. Select “Max Intensity” to make the Z Projection image (Figure 1[href=https://www.wicell.org#fig1]B). Click “OK” to continue.\nSelect the Freehand selection from the ImageJ toolbar. Using a continuous line, encircle the area of interest (Figure 1[href=https://www.wicell.org#fig1]C).\nClick on the original window of the image stack and then the “Edit” dropdown menu. Click on the “Selection” option and then select “Restore selection”. This should transfer the encircled region of interest from the Z projection to the image stack.",
    "Click on the “Edit” dropdown menu again and select “Clear Outside”. This will delete the image outside of your encircled region of interest.\nSave your new image stack as a new file name by clicking on the “File” dropdown menu, clicking on “Save As”, and then selecting the “Tiff…” format. Create a new folder and rename all of your new masked files.\nTo generate a template for cross-correlation, identify an isolated, well-labeled nucleus. Crop the nucleus in 3D, such that no other nuclei or fluorescent debris are present within the volume. The presence of extraneous fluorescence within the template will introduce noise into the correlation map. To generate a template nucleus, center the nucleus within a square bounding box, then select the \"Image\" dropdown menu and then \"Crop” (Figure 2[href=https://www.wicell.org#fig2]A) Then select the \"Image/Stack/Tools/Make Substack\" command in the Fiji dropdown menu. Select the sections containing the nucleus, leaving at least 2 blank sections above and below the selected nucleus. The nucleus should be centered in XYZ within the volume (Figure 2[href=https://www.wicell.org#fig2]B). To remove noise, select the \"Process\" dropdown menu and then, \"Filters\" and \"3D Gaussian Blur” (Figure 2[href=https://www.wicell.org#fig2]C). Select a radius that reduces the noise without blurring the image too much. For our images, we used a radius of 1.5 for X, Y and Z sigma. Click “OK” to apply the filter.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2993-Fig2.jpg\nFigure 2. Running the MATLAB script\nThe script may be run either by clicking the \"Run\" arrow (red box) or by typing Auto_Count into the Command Window. The only parameters that need to be modified are the filenames and the threshold value (highlighted in yellow) in the Editor Window. Once finished, the number of detected cells will be stored in the \"Count\" variable (highlighted in red), which can be found in the Workspace (right-hand side of screen).",
    "Your browser does not support HTML5 video.\n  \n      Methods video S1. Image processing steps using Fiji/Image J and quantitation of labeled nuclei using MATLAB, as shown in steps 4 and 5\n    \nQuantification of labeled nuclei using MATLAB\nTiming: 1+ days\nProcessed image stacks are analyzed using a custom script written in MATLAB (see Methods video S1[href=https://www.wicell.org#mmc1]).\nOpen MATLAB. Navigate to the folder containing your image stacks and cropped template. Open the Auto_Count.m script in the Editor window. Prior to running the script, parameters such as \"threshold\" and the filenames of the template and image stack can be edited.\nMake sure that the Auto_Count.m script is in your MATLAB search path or that it is in the active folder.\nTemplateName='template.tif'; % an image stack containing a well-shaped, isolated nucleus, cropped to powers of 2, 16x16x16, for example.\nFileName ='image_0001.tif'; %the base name (without the sequential numbers) of image stacks with nuclei to be counted\nthreshold=0.02; % the threshold to filter peaks in imhmax. Optimize for your own data.\n          % Higher values--> fewer cells\n          % Lower values--> more cells\n          % Depends on image noise and pre-processing,\n          % as well as cell density\n%to avoid boundary effect in the FFT, both the template and image need to\n%be padded to the nearest power of 2: a 512x512x128 stack should be padded to 1024x1024x256\n%the FFT runs more efficiently if the dimensions are powers of 2 (128, 256, 512, 1024, ...)\n%this is accomplished in the template by defining the S array for the fftn\n%function\n%this is accomplished for the image stack using padarray function\n%both H (the transform of the template) and F (the transform of the stack)\n%must have the same dimensions.\ntemplate = read_file(TemplateName);  %reads in multiplane TIFF file (or some other file formats)",
    "S=[1024,1024,256];            %assumes a padded stack size of 1024,1024,256\nH=conj(fftn(single(template),S));\n%cross-correlation, then read the cell numbers into the row vector \"Count\"\nstack=padarray(read_file(FileName),[256 256 64]); %pads 512x512x128--> 1024x1024x256\n                                % by adding 128 pixels to each edge and 64 slices to top and bottom of stack\n[Center, avg_img, Cell_N] = CC3D(H,stack,threshold); %pass the fft'd template,\n                                  % the padded image stack and the filter threshold to a function\nCount = Cell_N;\nfigure, imagesc(max(avg_img,[],3));\nhold on scatter(Center(:,1,:),Center(:,2,:),'m∗');\nfigure, scatter3(Center(:,1,:),Center(:,2,:),Center(:,3,:),'m∗');\n%function to do the 3D cross-correlation and gives the number of correlation peaks above the threshold\nfunction [Center, corm_sing, Cell_N] = CC3D(H,stack,threshold)\n  F=fftn(single(stack));\n  corrm=real(ifftn(H.∗F));\n  corm_sing=single(mat2gray(corrm));\n  corrmap1=imhmax(corm_sing,threshold);\n  corrmap2=imregionalmax(corrmap1);\n  masks=bwlabeln(corrmap2);\n  objects=regionprops(masks,'centroid');\n  Center=cat(1,objects.Centroid);\n  Cell_N=length(Center);\nend\nIn the Editor window, assign the name of your cropped template to the variable, TemplateName, in the Auto_Count script. For example, TemplateName = 'template.tif'; Assign the name of the file to. Be analyzed to the variable, FileName. For example, 'image_0000' or 'wild_type': FileName = 'wild_type.tif'; or FileName = 'image_0001.tif';\nRun the script by typing Auto_Count at the MATLAB command line or by clicking the \"Run\" button in the Editor tab toolbar. The number of cells detected is governed by the threshold parameter. Increasing the threshold increases the stringency of the peak detection (reduces the number of identified cells). The threshold will need to be adjusted to each new dataset and use (Figure 3[href=https://www.wicell.org#fig3]).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2993-Fig3.jpg\nFigure 3. Imaging chamber, steps of image processing and final 3D graph showing nuclei counted within region of interest\n(A) Shown here is one example of an imaging chamber, made using Sugru to create walls to hold buffer on a standard 3 inch by 1 inch slide. The embryo orienting tool was made using monofilament fishing line and the handle of a long cotton swab.",
    "(B) A maximum intensity projection of a 128 image stack of phospho-histone H3-immunopositive cells in an 18 hpf embryo was made using Fiji/ImageJ image processing program. Scale bar, 50 μm.\n(C) The freehand selection tool was used to select the nuclei located within the neural tube and to exclude labeled cells on the surface of the yolk. The selection was applied to the image stack and the “Clear Outside” function was selected to remove the surrounding nuclei. Scale bar, 50 μm.\n(D) Running the MATLAB Script “Auto_count.m” on the processed image stack yields a total count of labeled nuclei found only within the neural tube throughout the 128 images. Scale bar, 50 μm.\nThe number of cells detected in each stack will be stored in the variable, Count, which will appear in the Workspace window on the right-hand side of the MATLAB environment (Figure 3[href=https://www.wicell.org#fig3])."
  ],
  "subjectAreas": [
    "Cell Biology",
    "Neuroscience",
    "Developmental Biology"
  ],
  "bigAreas": [
    "Biomedical & Clinical Research",
    "Molecular Biology & Genetics"
  ]
}