{
  "id": 14997,
  "origin_website": "Jove",
  "title": "Assisted Selection of Biomarkers by Linear Discriminant Analysis Effect Size (LEfSe) in Microbiome Data",
  "procedures": [
    "NOTE: The protocol was sourced and modified from the research of Segata et al.3. The method is provided at https://bitbucket.org/biobakery/biobakery/wiki/lefse.\n1. Preparation of input file for analysis\nPrepare the input file (Table 1) of LEfSe, which could be easily generated by many workflows8 or previous protocols9 with the original files (sample file and corresponding species annotation file).\n2. LEfSe native analysis (limited to the Linux server)\nLEfSe Installation\n\tNOTE: The LEfSe pipeline is recommended to be installed with Conda10.\n\t\nRun the following commands to exclude the possibility of dependencies conflict. Create a conda environment for LEfSe (This step is recommended but not required.). -n stands for the environment name.\n$ conda create -n LEfSe-env\nTo activate the LEfSe environment that was created, run:\n$ source activate LEfSe-env\nTo install LEfSe with channel bioBakery where -c stands for channel name, run:\n$ conda install -c biobakery lefse\nFormat data for LEfSe\n\t\nRun the following command to format the original file to the internal format for LEfSe. Table.txt is the input file and Table-reformat.in is the output file. -c is used to set the feature, which is used as class (default 1) and -o is used to set the normalization value (default -1.0 meaning no normalization).\n$ format_input.py Table.txt Table-reformat.in -c 1 -o 1000000\nCalculation of linear discriminant analysis (LDA) effect size\n\t\nRun the following command. The purpose of this step is to perform LDA of the previous result and generate the result file for the visualization. Table-reformat.in is generated using the previous step and is used as the input file in this step. Table-reformat.res is the result file.\n$ run_lefse.py Table-reformat.in Table-reformat.res\nVisualization by plots",
    "Plot the LEfSe results. To plot the effect size of the biomarkers in a pdf file,.Table-reformat.res is generated using the previous step and the LDA.pdf is the plot file. –format is used to set the output file format.\n$ plot_res.py Table-reformat.res LDA.pdf --format pdf\nPlot the cladogram. To draw the species tree and display the biomarkers in a cladogram. cladogram.pdf is the output file.\n$ plot_cladogram.py Table-reformat.res cladogram.pdf --format pdf\nPlot one feature (optional) To plot the differences of a single biomarker among different groups. -f is used to set the features of plot. If one was set, the –feature_name must be given.\n$ plot_features.py -f one --feature_name \"k__Bacteria.p__Firmicutes.c__Bacilli.o__Bacillales\" --format pdf Table-reformat.in Table-reformat.res Bacillales.pdf\nPlot the differential features (optional) to draw all the features, but there is too much to be done with caution. --archive is used to choose whether to compress the results. ./ means the path of the results.\n$ plot_features.py -f diff --archive none --format pdf Table-reformat.in Table-reformat.res ./\n3. LEfSe online analysis (galaxy)\nGo to the huttenhower galaxy server11: http://huttenhower.sph.harvard.edu/galaxy.\nUpload the files. Press the Up arrow button on the left pane and upload the file. Click on Choose local file to select the input file and select the format tabular, and then click on the Start button.\n\tNOTE: Referred to the webpage (https://bitbucket.org/biobakery/biobakery/wiki/lefse), use the script (taxonomy_summary.R) to generate the input file of LEfSe, and the format (each column with a group name, each line with a different level of annotation separated by “|”) is required as shown in Table 1. A schematic overview of the uploading process is shown in Figure 1.",
    "Format the data for LEfSe. Click on the LEfSe | Format Data for LEfSe link on the left pane, and select the specific rows for class in the file, and click on the Execute button. A schematic overview of the operational process and the parameters used are shown in Figure 2.\nCalculate the LDA effect size. Click on the LEfSe | LDA Effect Size (LEfSe) link on the left pane, and select parameter values according to the analysis requirements. Click on Execute. A schematic overview of the operational process and the parameters used are shown in Figure 3.\nPlot the LEfSe results. Click on the LEfSe | Plot LEfSe Results link on the left pane, and click on the Execute button. A schematic overview of the operational process and the parameters used are shown in Figure 4.\nPlot the cladogram. Click on Plot Cladogram on the left pane, and click on the Execute button after selecting the parameter values. A schematic overview of the operational process and the parameters used are shown in Figure 5.\nPlot one feature by clicking on Plot One Feature on the left pane, and clicking on the Execute button after selecting parameter values. A schematic overview of the operational process and the parameters used are shown in Figure 6.\nPlot differential features by clicking on Plot Differential Features on the left pane, and clcking on the Execute button after selecting parameter values. A schematic overview of the operational process and the parameters used are shown in Figure 7.\n\tNOTE: These generated figures can be visualized and downloaded against the resulting output in the right pane.\nSubscription Required. Please recommend JoVE to your librarian."
  ],
  "subjectAreas": [
    "Genetics"
  ],
  "bigAreas": [
    "Molecular Biology & Genetics"
  ]
}