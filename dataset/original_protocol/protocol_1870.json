{
  "id": 1981,
  "origin_website": "Cell",
  "title": "FusionAI, a DNA-sequence-based deep learning protocol reduces the false positives of human fusion gene prediction",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nDownload our package and install the prerequisites\nTiming:  < 10 min\nDownload the latest version of FusionAI into your preferred directory. The running will be executed inside of this directory (a, b, c, and d are required for running FusionAI. e, f and g are required to draw feature landscape images for the chosen fusion genes):\nDownload FusionAI_pred.py from https://compbio.uth.edu/FusionGDB2/FusionAI/FusionAI_pred.py[href=https://compbio.uth.edu/FusionGDB2/FusionAI/FusionAI_pred.py]\nDownload FusionAI model (newdat_newmod_jj.h5) from https://compbio.uth.edu/FusionGDB2/FusionAI/newdat_newmod_jj.h5[href=https://compbio.uth.edu/FusionGDB2/FusionAI/newdat_newmod_jj.h5]\nDownload preprocessing script (pre_processing_for_FusionAI_from_tab_delim.py) from https://compbio.uth.edu/FusionGDB2/FusionAI/pre_processing_for_FusionAI_from_tab_delim.py[href=https://compbio.uth.edu/FusionGDB2/FusionAI/pre_processing_for_FusionAI_from_tab_delim.py]\nDownload example fusion gene file (k562_starfusion.txt) https://compbio.uth.edu/FusionGDB2/FusionAI/k562_starfusion.txt[href=https://compbio.uth.edu/FusionGDB2/FusionAI/k562_starfusion.txt]\nDownload 44 human genomic feature information files (features.tar.gz, features_info.txt, and chromosome_size.txt) from https://compbio.uth.edu/FusionGDB2/FusionAI/features.tar.gz[href=https://compbio.uth.edu/FusionGDB2/FusionAI/features.tar.gz], https://compbio.uth.edu/FusionGDB2/FusionAI/features_info.txt[href=https://compbio.uth.edu/FusionGDB2/FusionAI/features_info.txt], and https://compbio.uth.edu/FusionGDB2/FusionAI/chromosome_size.txt[href=https://compbio.uth.edu/FusionGDB2/FusionAI/chromosome_size.txt]\nDownload human gene structure file and nib files (gencode_hg19v19_.txt and nib_files_hg19.tar.gz) from https://compbio.uth.edu/FusionGDB2/FusionAI/gencode_hg19v19_.txt[href=https://compbio.uth.edu/FusionGDB2/FusionAI/gencode_hg19v19_.txt] and https://compbio.uth.edu/FusionGDB2/FusionAI/nib_files_hg19.tar.gz[href=https://compbio.uth.edu/FusionGDB2/FusionAI/nib_files_hg19.tar.gz]\nInstall R packages using the command install.packages(). Input the individual R package name into the parenthesis like install.packages(‘devtools’). These\nPrepare input data of 20 Kb DNA sequence of fusion genes\nTiming:  < 1 min\nFusionAI takes the input data of fusion gene breakpoint information, which is given by other fusion gene prediction tools or known fusion gene information (k562_starfusion.txt and Table 2[href=https://www.wicell.org#tbl2]). The preprocessing script will make 20 Kb DNA sequences for individual fusion genes, which is the combined sequence of +/-5 Kb flanking sequence from the two breakpoints’ genomic position for individual fusion partner genes (Figure 1[href=https://www.wicell.org#fig1] and Table 3[href=https://www.wicell.org#tbl3]).\ntable:files/protocols_protocol_1463_2.csv\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1463-Fig1.jpg\nFigure 1. Make input data of FusionAI\ntable:files/protocols_protocol_1463_3.csv\nRun preprocessing script to make a 20 Kb DNA sequence from the given fusion gene information. The fusion gene information should include the following information in tab-delimited format: Hgene, Hchr, Hbp, Hstrand, Tgene, Tchr, Tbp, Tstrand. The command is shown below. Here the $ INPUT_FILE is the output file after checking the junction position of the fusion breakpoints in step 2.\n>python pre_processing_for_FusionAI_from_tab_delim.py [INPUT_FILE]\n>python pre_processing_for_FusionAI_from_tab_delim.py k562_starfusion.txt",
    "Critical: The timing is based on the number of fusion genes of the input file.\nRun FusionAI\nTiming:  < 2 s (depending on your data)\nFusionAI takes the 20 Kb DNA sequence of fusion genes from the previous step and outputs two probabilities as not being used and being used as the fusion gene breakpoints (Figure 2[href=https://www.wicell.org#fig2]).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1463-Fig2.jpg\nFigure 2. Diagram of fusion gene breakpoints classification by FusionAI\nRun FusionAI prediction script to predict the fusion breakpoint tendency from the FusionAI model. Here the $ INPUT_FILE is the output file after making the 20 Kb DNA sequence in the previous step. $COLA and $COLB are the DNA sequences of 5′ and 3′ fusion partner genes that were created from the previous step. If the user wants to run for one specific fusion gene, then set $INDEX_OF_FUSION as row index of interested line in the input file.\n>python FusionAI_pred.py [-h] -f [INPUT_FILE] -m [MODEL, default: newdat_newmod_jj.h5] -o [OUTPUT_FILE] -A [COLA] -B [COLB] -I [INDEX_OF_FUSION]\n>python FusionAI_pred.py -f k562_starfusion.FusionAI.input -o k562_starfusion.FusionAI .output -m newdat_newmod_jj.h5\nSelect high scored fusion genes (or interested fusion genes) from FusionAI output\nTiming:  < 5 s",
    "From the output scores of FusionAI for the fusion candidates that were predicted from other tools, the users can select high scored or interested fusion genes. This can be done by the user in a text editor or another appropriate tool of choice. The users can stop the pipeline at this step if they do not need to do further analyses including feature importance analysis or drawing a landscape image of human genomic features in fusion genes, which take relatively long. With the output scores of FusionAI, still uses can reduce the false positives. For better understanding, Table 4[href=https://www.wicell.org#tbl4] shows the comparison results among different cutoff of FusionAI scores, other prediction tools, and experimentally validated fusion genes. Table 5[href=https://www.wicell.org#tbl5] shows the accuracy comparisons. When we used a higher threshold of FusionAI output scores, we could reduce the false positives efficiently.\ntable:files/protocols_protocol_1463_4.csv\ntable:files/protocols_protocol_1463_5.csv\nSort the FusionAI prediction output based on the FusionAI scores of individual fusion genes and select high-scored fusion genes. The users can choose the cutoff score, which should be larger than 0.5. Table 4[href=https://www.wicell.org#tbl4] below shows the examples that were chosen with different cutoffs like 0.5 or 0.95. Then, the selected fusion genes will be used for further analyses such as screening of the feature importance scores and landscaping the human genomic features across 20 Kb fusion DNA sequence in the following steps.\nCalculate the feature importance scores across 20 Kb DNA sequence\nTiming:  < 33 min",
    "After selecting the reliable fusion gene candidates, the users can check the distribution of the feature importance scores of individual fusion genes across the 20 Kb fusion DNA sequence. To calculate the feature importance score (FIS), we masked 20 bp each time by setting all the 20 values to zero and measured the change of prediction outcome upon this masking. We slide this 20 bp window 20 nucleotides each time along the whole 20K input sequence and repeated the procedure to obtain the FIS for all the 20 bp segments. In this way, we got 20,000/20 = 1,000 FIS for each input sequence.\nRun FusionAI feature importance score script to get the feature importance scores across the 20 Kb fusion DNA sequence. Here the $ INPUT_FILE is the output file after making 20 Kb DNA sequence in step 3. $COLA and $COLB are the DNA sequences of 5′ and 3′ fusion partner genes that were created from step 3. If the user wants to run for one specific fusion gene, then set $INDEX_OF_FUSION, the row indexes of interested lines in the input file. If the user can use multiple GPUs, then the user can control the number of GPUs using the parameter of NGPUS. However, the GPU is not necessary (Figure 3[href=https://www.wicell.org#fig3]).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1463-Fig3.jpg\nFigure 3. Calculate the feature importance scores across 20 Kb fusion DNA sequence\n>python FusionAI_FIS.py [-h] -f FILENAME [-m MODEL, default: newdat_newmod_jj.h5] [-o OUTPUT] [-A COLA] [-B COLB] [-I ROWI] [-N NGPUS]\n>python FusionAI_FIS.py -f k562_starfusion.FusionAI.output -o k562_starfusion.FusionAI.output.FIS\nVisualize 44 human genomic features across 20 Kb DNA sequence\nTiming:  < 1 h 10 min and < 20 min for step 6 and 7, respectively",
    "After getting reliable fusion gene candidates and feature importance scores, it is important to interpret the aspect of human genomic features. From our original work, we integrated 44 human genomic features across five important cellular mechanism categories such as integration site category of 6 viruses, 13 types of repeat category, 5 types of structural variant category, 15 different types of chromatin state category, and 5 gene expression regulatory category (Kim et al., 2021a[href=https://www.wicell.org#bib10], 2021b[href=https://www.wicell.org#bib11]). From this step, the users can create two figures on the landscape of the fusion gene breakpoint-related genomic features across the 20 Kb fusion DNA sequence. Each script will create separate figures of individual fusion genes that have the FIS values from the previous step. All figures will be created under the user defined directory. The first figure is the overlap between the 20 Kb fusion DNA sequence and 44 genomic features and the second figure is the overlap between the top 1% FIS regions and 44 genomic features (Figure 4[href=https://www.wicell.org#fig4]).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1463-Fig4.jpg\nFigure 4. Left - distribution of 44 human genomic features across 20 Kb fusion DNA sequence\nRight - overlap between the top 1% FIS regions and 44 different types of human genomic features across 20 Kb fusion DNA sequence.\nVisualize 44 human genomic features across a 20 Kb DNA sequence. Run FusionAI genomic feature analysis script to make a landscape image of overlap between fusion breakpoints area (+/- 5 Kb) and 44 human genomic features.\n>Rscript FusionAI_genomic_features.R -g [FUSION_GENE_FILE] -f [FEATURE_PATH] -s [CHROMOSOME_SIZE_FILE] -i [FEATURE_INFO_FILE] -o [OUTPUT_FILE_PATH]\n>Rscript FusionAI_genomic_features.r -g K562_STARfusion.FusionAI.output.FIS -f ./features/ -s chromosome_size.txt -i features_info.txt -o ./K562/whole_features/",
    "Visualize the overlaps between the top 1% FIS regions and 44 human genomic features across 20 Kb DNA sequence. Run FusionAI genomic feature analysis script to have the landscape of overlap between high-FIS regions of fusion genes and 44 human genomic features.\n>Rscript FusionAI_genomic_features2.R -g [FUSION_GENE_FILE] -f [FEATURE_PATH] -s [CHROMOSOME_SIZE_FILE] -i [FEATURE_INFO_FILE] -o [OUTPUT_FILE_PATH]\n>Rscript FusionAI_genomic_features2.r -g K562_STARfusion.FusionAI.output.FIS -f ./features/ -s chromosome_size.txt -i features_info.txt -o ./K562/top1pct_features/"
  ],
  "subjectAreas": [
    "Genomics",
    "Bioinformatics",
    "Computer Sciences",
    "Health Sciences",
    "Molecular Biology"
  ],
  "bigAreas": [
    "Biomedical & Clinical Research",
    "Molecular Biology & Genetics",
    "Bioinformatics & Computational Biology"
  ]
}