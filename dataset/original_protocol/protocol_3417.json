{
  "id": 3617,
  "origin_website": "Cell",
  "title": "Protocol to obtain long movement trajectories of leaders and followers in ant tandem runs",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nVideo recording of ant nest relocation\nTiming: 6 h\nThis section describes the protocol for recording nest emigration in ants.\nIntroduce the ant colony to the maze arena by placing their current nest at the beginning of the maze. Also, place an empty artificial nest at the other end of the maze.\nOpen the upper lid of the current nest to promote nest relocation and start recording.\nThe recording will last until all individuals move to the new nest.\nNote: Nest relocation is stimulated by opening the lid of the container, which is a practice widely used in ant nest emigration experiments, e.g., Mukhopadhyay and Sumana, Pratt et al., and Pratt.13[href=https://www.wicell.org#bib11],14[href=https://www.wicell.org#bib12],15[href=https://www.wicell.org#bib13] Following nest destruction, ants wander around the maze arena to look for a potential nest site. Once they find the new nest and begin to recruit to it, colony emigration begins. In Diacamma cf. indicum, all individuals, including queens, move from the old nest to the new nest via tandem runs. Nest emigration is completed when all individuals move into the new nest. Including exploration and emigration, it requires up to 6 h for Diacamma cf. indicum to complete an emigration in this setup. It may take different periods for different ant species.\nCritical: Emigration videos will be analyzed by tracking software that uses image binarization as an algorithm to detect individuals. Thus, consistent lighting during recording is essential. Make sure that there are no light fluctuations during recording due to, e.g., observer’s shade, sunset, sunrise, and changes in other light sources. For example, the experimental setup can be in an isolated dark room to minimize disturbance. Also, turn off your camera’s automatic brightness adjustment function and use manual focus to minimize unintended fluctuations of the images.",
    "Critical: Similarly, human presence near the experimental setup may affect the ants’ movements. The experimental setup should be isolated during nest relocation.\nChoosing the tandem events to analyze\nTiming: 3–4 h (per colony)\nIn this step, we describe the protocol to preprocess the recorded videos for further analysis. During nest relocation, most individual ants are led in tandem runs, hence the total number of runs can be very large. However, we do not analyze all these events. Instead, we focus on a subset of tandem runs that took at least 10 min to be completed. These longer runs provide enough data for the information theory analysis described in Valentini et al.2[href=https://www.wicell.org#bib2] and Mizumoto et al.1[href=https://www.wicell.org#bib1] The original videos are subdivided into several clips, each of which includes a focal tandem running event.\nMeasure the length of tandem running events using the focal sampling method. Repeat this for all tandem runs to obtain enough samples of long runs.\nOpen videos with a media player (e.g., QuickTime Player 10.5) and locate the frame at which the tandem run initiates at the old nest. Note the time of this frame so that you can later measure how long this tandem run has lasted.\nNote: Any video editing software can be used as long as it has a trimming function (e.g., PowerDirector 365 and Final Cut Pro).\nNote: Sometimes, a tandem run can start in the middle of the arena due to encounters between lost or solo individuals. In this protocol, we only focus on tandem runs that start at the old nest and end at the new nest.\nBy playing videos and moving the seek bar, follow the movement and outcome of the focal tandem run.",
    "If the focal tandem run breaks up and one of the partners starts tandem running with another ant, stop the observation and go back to 4a for the next tandem run.\nNote: Tandem runs sometimes temporarily break up when the partners separate a short distance before later reuniting. This separation-reunion process is an integral part of analyzing social interactions. In most cases, ants reunite within a short period (about several seconds). However, when separated, individuals may encounter and pair with other tandems/solo individuals/other separated individuals. Such events are not suitable for studying the leader-follower relationship of specific partners. These events happen when there are many tandem pairs on a bridge, especially in a large colony.\nCritical: Multiple tandem pairs can be found at the same time in the maze arena. Especially for the frame in which the focal tandem pair movement intersects with other tandem pairs, careful observation is required not to confuse tandem pairs with each other. Speed control of video playback can enhance the efficiency of observation.\nIf the focal tandem run arrives at the new nest, stop the observation and note the time of the frame at which the tandem arrived. By referring to the initial frame recorded at 4a, check if the tandem lasted more than 10 min. If it was less than 10 min, reject this tandem and return to 4a to find the next tandem run.\nIf the focal tandem duration is at least 10 min, save a video clip extending from the initial to the final frame of the tandem run.\nGo back to 4a for the next tandem run.\nNote: We collected the first five tandem running events that exceeded 10 min for each colony emigration.\nPreliminary tracking of tandem runs as a pair\nTiming: 10–30 min (per tandem)",
    "After obtaining video clips, the following sections describe detailed steps for movement tracking. Movement tracking consists of three different processes. First, among many ants in the experimental arena, find the focal tandem pair and extract the coordinates of the center of the pair. For this purpose, we use FastTrack software11[href=https://www.wicell.org#bib14] as this allows a variable number of individuals to be present in the video image. Other software with similar specifications may be compatible. However, any software that requires a fixed number of individuals to be present in the video image cannot be used.\nStart FastTrack and open the video file to analyze.\nSpecify the image options.\nCreate a background using the Average method with 100 images.\nSet the region of interest (ROI) to only include the experimental arena.\nBinarize the image with the light background option to detect tandem pairs. The appropriate threshold will depend on the recording conditions. We used values around 4–16 for the example analysis.\nPerform morphological operations on binary images to improve image segmentation of tandem running pairs. Ideally, tandem pairs should be represented by a single object. We use the Dilation operation with the Rectangle Kernel (size = 1–8) to smooth the boundaries between leaders and followers.\nSet the “Detection” parameter to detect tandem pairs but exclude solo ants. Thus the minimum size should be larger than single ants, and the maximum size should be slightly larger than tandem pairs. We use the values 45–80 and 300–500, respectively.\nSpecify Tracking options.\nTune tracking parameters with the option Spot to track: Body. We use the Maximum Time (T) = 60–100 and Maximum Distance (L) = 30–60. Other parameters are automatically determined by clicking the “Level” button.\nPerform Preview to check if tracking is performed as intended.",
    "Run Track. It will take 10–30 min, depending on your computers’ specifications and video length/resolution.\nNote: As FastTrack detects the tandem pair as a single object, it fails to detect pairs when the partners are separated. When the pair was not detected for a while and then detected again due to separation-reunion processes, two parameters, Maximum Time (T) and Maximum Distance (L), are used to determine if these objects are identical. If the object was not detected for less than T and moved less than L during this period, the identity of the object is held. These two parameters may need to be adjusted depending on the species.\nManually correct the tracking errors using Tracking Inspector.\nName the focal tandem pair as “0” and go through the video. Assign “0” to the focal tandem pair if the tandem identity was swapped.\nThe data will be autosaved. The results are in the directory “Tracking_Result_(Filename).” The “Export” button will generate a video with annotations.\nObtain finalized tracking.txt in the result directory.\nCreating videos containing only the focal tandem\nTiming: 15–30 min (per tandem)\nUsing the coordinates of the center of the tandem running pair obtained above, this step generates videos that will be used for steps 15–18: Final tracking of the leader and the follower. Because FastTrack skips any frame in which it fails to recognize an object, coordinates in skipped frames are assigned by calculating the averaged values of the frames before and after the skipped frames. Then, a video that shows only the focal tandem running pair is generated. This is accomplished by using a background image to mask all regions outside the area immediately surrounding the coordinates of the tandem pair. The Python script that performs all these processes is at http://www.github.com/nobuaki-mzmt/ant_tandem_mask[href=http://www.github.com/nobuaki-mzmt/ant_tandem_mask] (Python >= 3.8).",
    "Place the original video files and the FastTrack .txt result files in the same folder. These two should have the same name but different extension, e.g., Ant-video-01.mp4 and Ant-video-01.txt.\nOpen an Anaconda Prompt (Anaconda 3).\nDownload the Python code GenerateMaskVideo.py from the GitHub repository https://github.com/nobuaki-mzmt/ant_tandem_mask[href=https://github.com/nobuaki-mzmt/ant_tandem_mask]. This can be done in two ways:\nClick in the ‘Code’ tab, download the zip folder, and extract all files.\nAlternatively, run the following command line if the git tool is installed on the computer.\n> git clone https://github.com/nobuaki-mzmt/ant_tandem_mask.git[href=https://github.com/nobuaki-mzmt/ant_tandem_mask.git].\nRun GenerateMaskVideo.py from Anaconda Prompt.\n>cd [name-of-folder-that-includes-GenerateMaskVideo.py]\n>python GenerateMaskVideo.py\nThe GUI window will automatically pop up to specify the folder created at step 9 (Figure 2[href=https://www.wicell.org#fig2]).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3182-Fig2.jpg\nFigure 2. The relationship between “Tandem window size” and the output masked video\n(A) The pop-up GUI window.\n(B) Larger windows tend to include other ants.\n(C) With smaller window sizes, tandem partners may be cut off.\nNote: It will also ask for the “Tandem window size,” which is 20 pixels by default. This parameter specifies a square region around the tandem pair coordinates that is not masked by the background image.\nCritical: The best value for this tandem window size depends on the recording setup and potentially on the species’ behavior. Larger values will be required if the recorded individuals fill a larger pixel space and when a long distance often separates tandem leaders and followers (Figure 2[href=https://www.wicell.org#fig2]C). However, at the same time, a larger window size will tend to include other individuals in the non-masked area. See also Notes in the following section (Figure 2[href=https://www.wicell.org#fig2]B).\nGenerated videos will be automatically stored in the output folder.\nFinal tracking of the leader and the follower\nTiming: 30–60 min (per tandem)",
    "This section describes the second stage of tracking to get detailed tracks of both leaders and followers from the masked video generated at step 14. We recommend using UMATracker software because it usually performs well with tandem runs in ants1[href=https://www.wicell.org#bib1],2[href=https://www.wicell.org#bib2] and termites.16[href=https://www.wicell.org#bib15],17[href=https://www.wicell.org#bib16] If UMATracker is unavailable, try other software that assumes a fixed number of individuals.\nUMATracker consists of four programs: UMATracker-FilterGenerator; UMATracker-Tracking; UMATracker-TrackingCorrector; UMATracker-Area 51.\nExecute UMATracker-FilterGenerator and load the video file.\nSelect Background / Create background and perform background removal.\nBinarize the video. An example of the combination of Filter Block Operation is “output <- Threshold (30–45) <- BGRToGray <- Rectangle Selection <- input”. Save the filter after confirming that ants are shown as white blobs and other regions are in black.\nExecute UMATracker-Tracking and drag and drop the video file and filter file.\nSet the parameter of # of objects = 2, indicating the leader as 0 and the follower as 1.\nRun the object tracking.\nAfter the tracking is finished, select Save Data to save a CSV file with ant coordinates across frames.\nIf the # of objects is set > 2, open the CSV file and delete the columns for the objects other than the leader and the follower.\nNote: If many ants come in and out of the frame, it may be easier to set the number of objects > 2 (Figure 3[href=https://www.wicell.org#fig3]). When the number of objects is set >2, but there are only two ants in the frame, UMATracker assigns two points to a single individual. Make sure 0 is always on the leader while 1 is always on the follower.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3182-Fig3.jpg\nFigure 3. An example in which high local ant density has led to more than two ants appearing in the frame of the masked video",
    "Execute the Tracking Corrector and drag and drop the video and CSV files.\nMove the seek bar to confirm that the leader has identifier 0 and the follower has identity 1 in all frames.\nIf there is a swapping of identity between leader and follower, right-click the markers to correct the error.",
    "Critical: In frames where the leader and the follower are separated by more than the threshold distance (indicated at “Tandem window size” in the previous Python script; see step 13), ants may not be detected in the masked video frames. For these frames, it may be easier to do another tracking using the original video by selecting ROI larger than “Tandem window size.” When ants other than the focal tandem pair are detected in this ROI, set the parameter “# of objects” as larger than the maximum number of ants in this region. When the number of ants in the frame is smaller than the “# of objects,” UMATracker assigns multiple points to a single individual (see the note above too). Again, ensure 0 is always on the leader while 1 is always on the follower. This separate tracking does not need to cover all the video frames. Instead, this focuses on obtaining the coordinates of the leader and follower only in the frames where ants are not detected in the masked video. UMATracker needs to start tracking from the beginning of the video, but the software may be stopped once it has completed tracking the frames of interest. Then, open the CSV file, copy the coordinates of the leader and follower in the corresponding frames, and manually merge these coordinates into the main CSV file. The CSV files look like Table 1[href=https://www.wicell.org#tbl1], and the “position” row indicates the frame number. Make sure to match the frame numbers of the main CSV file and the CSV file of the separate tracking.\ntable:files/protocols_protocol_3182_1.csv",
    "Column information: (1) frame number, which is equivalent to seconds when divided by FPS, (2) x coordinate of the leader, (3) y coordinate of the leader, (4) x coordinate of the follower, and (5) y coordinate of the follower."
  ],
  "subjectAreas": [
    "Evolutionary Biology",
    "Neuroscience",
    "Behavior"
  ],
  "bigAreas": [
    "Biomedical & Clinical Research",
    "Ecology & Environmental Biology"
  ]
}