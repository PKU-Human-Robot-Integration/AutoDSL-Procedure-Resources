{
  "id": 3438,
  "origin_website": "Cell",
  "title": "A high-throughput protocol for deamination of long single-stranded DNA and oligo pools containing complex sequences",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nRecombinant AID protein expression and purification\nTiming: 4–5 days\n      In this section, recombinant AID is expressed in Expi293F cells and\n      purified using amylose resin. The total yield of purified AID is about\n      1.25 mg from 500 mL culture.\n    \n        Expi293F cell culture and transfection.\n        Troubleshooting 1[href=https://www.wicell.org#troubleshooting].\n        \n            Day 1. Grow starter cultures in 125–250 mL conical cell culture\n            flasks with vented caps, in volumes between 30 and 60 mL.\n            \nMaintain cells at 0.5–5 × 106 cells/mL.\nPassenger cells the day before transfection.\n                Incubate the cells in an orbital shaker incubator at 37°C,\n                120 rpm, 5% CO2.\n              \n            Day 2. Transfect Expi293F cells with pcDNA3.4-MBP-hAID plasmid using\n            PEI-MAX and culture the cells in serum-free medium at 37°C with 5%\n            CO2 for 60 h.\n            \n                Before transfection, change the cell culture medium to fresh\n                medium and keep the final density at 2.0 × 106\n                cells/mL.\n              \n                For a 500-mL culture, add 500 μg of filter-sterilized\n                pcDNA3.4-MBP-hAID plasmid into 12.5 mL fresh medium and gently\n                mix by inverting 5–6 times.\n              \n                Pipette 250 μL (PEI-MAX:plasmid = 3:1, mass ratio) of the\n                filter-sterilized PEI-MAX solution to the other 12.5 mL fresh\n                medium and gently mix by inverting 5–6 times.\n              \n                Mix the plasmid and PEI-MAX master mix in the above two steps,\n                then incubate for 20 min at 20°C–25°C.\n              \n                Add the 25 mL of plasmid:PEI-MAX:medium mixture to the 500 mL of\n                cell culture and shake the bottle for 5 s.\n              \n                Incubate the transfected cells in an orbital shaker incubator at\n                37°C, 120 rpm, 5% CO2 for 60 h.\n              \nCritical: Serum-free Expi293F medium\n      should be pre-warmed in a 37°C water bath prior to any cell culture work.\n      The Expi293F serum-free medium is a ready-to-use complete medium without\n      any further additives and can be repaced by other media of the same class,",
    "e.g., Expi293 expression medium (A1435101; ThermoFisher Scientific).\n    \nNote: Cells are harvested at 2–3 days\n      post-transfection without changing or adding new medium. The\n      pCDNA3.4-MBP-AID plasmid will be deposited to Addgene. The plasmid was\n      generated by inserting an N-terminal His-MBP tag and a PreScission\n      protease cleavage site following the human AID coding sequence downstream\n      of the CMV promoter based on the pCDNA3.4 vector (Thermo Fisher\n      Scientific).\n    \nNote: The amount of plasmid and PEI-MAX\n      can be adjusted proportionally according to the cell number.\n    \n        AID protein purification.\n        Troubleshooting 2[href=https://www.wicell.org#troubleshooting].\n        \n            Day 5. Harvest cells by centrifugation at 2,000 × g for\n            20 min at 4°C.\n            \nCritical: All the buffer for\n              purification should be autoclaved or filtered with a 0.22 μm\n              filter before use. Keep the whole operation on ice or at 4°C.\n            \n            Discard supernatant and thoroughly resuspend cells in 30–40 mL of\n            pre-chilled lysis buffer.\n            \nNote: Add PMSF, DTT and DNase I to\n              the lysis buffer prior to use.\n            \n            Lyse the cells using a high-pressure crusher (manufacture model) or\n            similar instrument at 100 Pa for 1 min followed by 300 Pa for 5 min.\n          \n            Centrifuge the lysate at 45,000 × g for 40 min at 4°C to\n            pellet the cell debris.\n          \n            Equilibrate 1 mL of amylose resin with 40 mL of pre-chilled\n            ddH2O and then with 20 mL of pre-chilled protein\n            purification wash buffer in a gravity chromatography column.\n            \nNote: Add DTT to the wash buffer\n              prior to use.\n            \n            Load the supernatant onto the column, and allow it to flow slowly\n            under gravity (1 mL per minute). Repeat this loading step two more\n            times to increase the final protein yield.\n          \n            Wash the resin with 10–20 column volumes of protein purification\n            wash buffer.\n          \n            Elute the protein from the column using 10 × 500 μL protein elute\n            buffer.\n            \nNote: Add DTT to the protein elute",
    "buffer prior to use. Add 500 μL protein elute buffer each time. In\n              general, the protein concentration is higher from elute 2 to elute\n              4.\n            \n            Measure the concentration and purity of the recombinant AID protein\n            by Bradford assay and gel electrophoresis (Figure 1[href=https://www.wicell.org#fig1]B).\n            \nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3015-Fig1.jpg\n                  Figure 1. Preparation of long ssDNA substrates and recombinant\n                  AID protein\n                \n                  (A) Overview of the preparation of long ssDNA substrates. The\n                  ssDNA was prepared with a biotin-conjugated non-C primer via\n                  linear-amplification mediated (LAM)-PCR.\n                \n                  (B) Recombinant purified AID protein separated by the SDS-PAGE\n                  followed by Coomassie blue staining are shown at left.\n                  Prepared dsDNA and ssDNA substrates were separated on the\n                  agarose gel followed by Ethidium bromide staining are shown at\n                  right.\n                \n            Aliquot the protein and snap freeze with liquid nitrogen, then store\n            at −80°C.\n          \nLong ssDNA substrates preparation\nTiming: 2–3 days\n      In this section, long ssDNA substrates (∼200 nt) are generated using a\n      linear-amplification mediated PCR (LAM-PCR) approach followed by\n      biotin-streptavidin purification. With this protocol, 1,500 ng of ssDNA\n      can be prepared.\n    \n        dsDNA template preparation.\n        \n            Day 1. Design primers to amplify the specific DNA sequence.\n            \nNote: As an example, we chose a\n              124-bp substrate that covers the FR3-CDR3 sequence of the mouse\n              VHB1-8 exon, which has biased WRC mutations in the CDR3\n              in vivo.13[href=https://www.wicell.org#bib13],14[href=https://www.wicell.org#bib14] To facilitate\n              downstream PCR reactions, an additional non-C sequence is added to\n              both ends of the dsDNA template, resulting in a final length of\n              198 bp (Figure 1[href=https://www.wicell.org#fig1]A).\n            \n            Set up eight 50-μL PCR reactions for each sequence as below: PCR\n            reaction master mix\n            table:files/protocols_protocol_3015_17.csv\nNote: non-C or non-G sequences are\n              underlined, gene-specific sequences are shown in blue. To amplify\n              the sense strand substrate:\n            \nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3015-Fx5.jpg\n            Set a PCR program to amplify the DNA fragments as below: PCR cycling\n            conditions\n            table:files/protocols_protocol_3015_18.csv\nNote: For different templates, the",
    "annealing temperature, extension time and number of cycles can be\n              adjusted.\n            \nPause point: Amplified DNA\n              products can be stored at −20°C for months.\n            \n            Separate the PCR products by agarose gel electrophoresis.\n            \nPool the eight tubes of PCR products.\nAdd 80 μL 6× DNA loading dye directly to the pool.\nRun the sample by a 2% agarose gel in 1× TAE buffer.\nCut the 198-bp DNA fragment from the gel.\n            Add 2–3 mL of PC buffer included in the Universal DNA Purification\n            Kit to the excised gels and allow to completely dissolve at\n            20°C–25°C.\n          \n            Add 500 μL BL buffer to a Universal DNA Purification column and spin\n            at 13,523 × g for 1 min at 20°C–25°C, discard the\n            flow-through.\n          \n            Add the solubilized gel mixture to the balanced column and spin at\n            13,523 × g for 1 min at 20°C–25°C, discard the flowthrough.\n          \n            Add 600 μL PW buffer to the column, spin at 13,523 × g for\n            1 min at 20°C–25°C, discard the flowthrough. Repeat this step one\n            more time.\n          \n            Spin the column at 13,523 × g for 2 min at 20°C–25°C,\n            transfer the column to a new 1.5 mL microtube.\n          \n            Add 50–100 μL ddH2O to the column, incubate for 2 min at\n            20°C–25°C, spin at 13,523 × g for 2 min at 20°C–25°C.\n          \n            Check the DNA concentration using a NanoDrop or similar instrument.\n            \nPause point: Purified DNA\n              products can be stored at −20°C for months.\n            \n        LAM-PCR and size selection.\n        Troubleshooting 3[href=https://www.wicell.org#troubleshooting].\n        \n            Day 2. Prepare four 50-μL PCR reactions for sense or antisense\n            strand as follows:\n            Primers for LAM-PCR:\n            Biotinylated primer: 5′ Biotin-AGATGTGGATGAGGAAGGTT-3′. PCR reaction\n            master mix\n            table:files/protocols_protocol_3015_19.csv\n            Set the PCR program to linear-amplify ssDNA as below: PCR cycling\n            conditions\n            table:files/protocols_protocol_3015_20.csv\nNote: Do not leave PCR products in\n              the PCR machine for too long at 4°C after the PCR amplification,",
    "as the TransStart FastPfu DNA polymerase may resect the 3′ ends of\n              the ssDNA products.\n            \n            Size selection.\n            \n                Add 60 μL Dynabeads MyOne Silane (2.4 mg) to each 50 μL PCR\n                products.\n              \nMix by gentle pipetting 5–6 times.\n                Incubate at 20°C–25°C for 10 min to remove excess biotinylated\n                primer.\n              \n            Retrieve the beads on a magnetic stand for 2 min, and discard the\n            supernatant.\n          \nWash the beads three times with 200 μL 70% ethanol.\n            Remove the 70% ethanol and dry the beads for 3–5 min at 20°C–25°C.\n          \nResuspend the beads in 40 μL Tris-HCl (10 mM, pH7.4).\nRetrieve the beads on a magnetic stand for 2 min.\n            Combine the supernatants of 4 reactions in a new tube, final volume\n            160 μL.\n            \nPause point: The ssDNA\n              fragments can be stored at −20°C for up to one week. Longer\n              storage is not recommended as ssDNA products are not stable.\n            \nNote: Completely resuspend the\n              streptavidin beads by vortexing for at least 30 s prior to\n              pipetting. Different concentrations of Dynabeads can be used to\n              capture DNA of different sizes. The final concentration can be\n              adjusted according to specific conditions.\n            \n        Streptavidin affinity purification.\n        \n            Day 3. Add 40 μL 5 M NaCl (1 M final) and 2 μL 0.5 M EDTA (pH 8.0,\n            5 mM final) to the 160 μL ssDNA products.\n          \n            Transfer 20 μL Dynabead MyONE C1 Streptavidin Beads (200 μg) to a\n            new 1.5-mL microtube, add 600 μL 1× Binding and Washing (B&W)\n            buffer and mix by pipetting.\n            \nNote: Before pipetting\n              streptavidin beads, fully resuspend the beads by vortexing for at\n              least 30 s.\n            \n            Retrieve the beads on a magnetic stand for 2 min, and discard the\n            supernatant. Repeat this step three times.\n          \n            Resuspend the beads with pooled ssDNA products from step 5a, and",
    "incubate the mixture on a rotary shaker at 20°C–25°C for at least 2\n            h.\n            \nNote: Although 2 h is sufficient\n              for the beads to capture most of the biotinylated PCR products,\n              longer incubation times (up to 4 h) can be used.\n            \n            Retrieve the DNA-beads complex on the magnetic stand and wash the\n            DNA-beads complex with 200 μL 1× Binding and Washing (B&W)\n            buffer, 200 μL 10 mM NaOH, 200 μL 1× Binding and Washing (B&W)\n            buffer and 200 μL Tris-HCl (10 mM, pH7.4), respectively.\n          \n            Retrieve the DNA-beads on a magnetic stand for 2 min, and discard\n            the supernatant.\n          \n            Resuspend the DNA-beads complex with 30–50 μL ddH2O. Heat\n            the final ssDNA at 95°C for 10 min and flash-cool the sample on ice.\n          \nRetrieve the ssDNA supernatant on the magnetic stand.\n            Determine the ssDNA concentration using a NanoDrop or a similar\n            machine.\n          \nAliquot the ssDNA and store at −20°C.\n            Evaluate the purity of the ssDNA by running 200 ng of ssDNA on a 3%\n            agarose gel in 1× TAE buffer (Figure 1[href=https://www.wicell.org#fig1]B).\n          \nssDNA oligo pools preparation\nTiming: 3–4 weeks\n    \n      In this section, we design oligo pools as deamination substrates. As an\n      example, IGHV oligo pools containing 1,084 IGHVs from 27 species, and\n      4,096 random N6 oligo pool are designed.\n    \nCritical: Oligo pool design takes\n      about a few days and oligo synthesis takes 2–3 weeks. The non-C primers\n      and non-C barcodes should be added to both sides of each oligo. For the\n      IGHV oligo pool, the sense and antisense strand oligo pools are designed\n      separately. We use the sense strand as an example. The antisense strand\n      oligo pool contains the same set of primers and barcodes as the sense\n      strand, but only reverse-complement tested sequences. All custom scripts\n      used in this section are available at\n      https://github.com/ZhangSenxin/Deamination-HTS-Pipeline[href=https://github.com/ZhangSenxin/Deamination-HTS-Pipeline]\n      (https://doi.org/10.5281/zenodo.8271540).\n    \n        IGHV oligo pool design.",
    "Week1. Download the functional L-PART1-IGHV-EXON segments from 16\n            species and the functional V-REGION without leader sequences from 11\n            species from the IMGT database.15[href=https://www.wicell.org#bib15]\nNote: Chicken has only 1\n              functional V gene, so we include other pseudogenes as well. For\n              the V-REGION without leader information, we arbitrarily add 50 of\n              N on the 5′ side.\n            \n            Select the ∗01 allele of each V gene, resulting in a total of 1,084\n            Vs.\n            table:files/protocols_protocol_3015_21.csv\n            Divide each V gene into a 50-nt oligonucleotide pool at 25-nt\n            resolution.\n            \nNote: Since the average length of\n              each V is about 350 bp, each V is tiled into 13–15 oligos (Figure 2[href=https://www.wicell.org#fig2]A).\n            \nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3015-Fig2.jpg\n                  Figure 2. Design of short ssDNA oligo pools containing complex\n                  sequences\n                \n                  (A) Illustration of short ssDNA oligo pools. Two oligo pools,\n                  corresponding to the sense and antisense strands, were\n                  synthesized to cover the IGHVs and control regions.\n                  Each sequence was tiled into a 50-nt oligo pool at 25-nt\n                  resolution. L/N notes the leader sequence or 50 N added to the\n                  5′ side of V-REGION without leader. The final substrates are\n                  5’ - ‘12 nt adapter’ - ‘6 nt barcode’ - 50-nt - ‘6 nt barcode’\n                  - ‘12 nt adapter’ - 3’.\n                \n                  (B) Illustration of 4096 random N6 ssDNA oligo\n                  pools. The final substrates are 5’ - ‘12 nt adapter’ - ‘8 nt\n                  barcode’ - 28-nt - ‘8 nt barcode’ - ‘12 nt adapter’ - 3’.\n                \n            Pool all of the 50-nt sequences together and remove duplicates,\n            resulting in a total of 9,753 unique sequences.\n          \n            Select 52 AID off-targets (OT) in mouse CSR-activated B cells and\n            the first exon of highly-transcribed genes (HiG)16[href=https://www.wicell.org#bib16]\n            in mouse GC B cells as controls.\n          \n            For OT or HiG regions, select 50-nt sequences with a WRCH motif in\n            the middle (23-nt-WRCH-23-nt), resulting in a total of 1,355 unique",
    "OT sequences and 892 unique HiG sequences, respectively. (g-i)\n            Unique barcode design.\n          \n            Extract and cluster the 9-nt sequences on both sides of the IGHVs\n            and control sequences using custom scripts as follows:\n            Troubleshooting 9[href=https://www.wicell.org#troubleshooting].\n            \n>python3 cluster_inbarcode.py -i SEQ_FILE -o\n                  CLUSTER_PATH\n>python3 barcode_assignment.py -i CLUSTER_PATH -o\n                  SAVE_FILE -m\n            Determine the largest sequence number in the cluster of identical\n            9-nt sequences.\n            \nNote: For example, in the current\n              IGVH pool, the largest cluster contains ∼500 sequences because\n              many IGVHs from different species share some degree of similarity.\n            \n            Select 30 of the 6-nt non-C barcodes with at least 2 nt difference,\n            and add the barcodes to both sides of the 50-nt sequence, resulting\n            in ssDNA 62 nt long.\n            6-nt non-C barcode\n            table:files/protocols_protocol_3015_22.csv\nNote: There are 900 different\n              combinations of 30 × 30 barcodes, which is enough to cover the\n              largest cluster in the IGVH pool (∼500 sequences). Different\n              clusters use the same set of barcodes. In the IGVH pool, the 15-nt\n              in-barcodes on both side of ssDNA sequence are used to demultiplex\n              the reads in the following steps. The length of the non-C barcode\n              can be extended accordingly.\n            \n            Run a simulation test using a custom script to demultiplex each\n            sequence according to the in-barcodes as follows:\n            \n>python3 fastq_simulation.py -I SEQ_FILE -o\n                  FASTQ_PATH\n                Generate raw data files with 10 paired-reads for each sequence,\n                named as R1_10.fq.gz and R2_10.fq.gz\n              \n                Prepare the metafiles.\n                \nNote: Each metafile contains\n                  500 sequences. The format is as follows: (ID, ‘barcode1+9 bp\n                  sequence’-‘the reverse complementary sequence of barcode2+9 bp\n                  sequence’).\n                \ntable:files/protocols_protocol_3015_23.csv\ntable:files/protocols_protocol_3015_24.csv\n                …\n              \n                Perform the simulation test using this code:\n                \n>fastq-multx -x -B meta.test1.txt -m 1 -d 1 -b\n                      R1_10.fq.gz R2_10.fq.gz -o test1/%_R1.fq.gz\n                      test1/%_R2.fq.gz\n> out.test1_m1.txt\n                If each sequence is accurately split into 10 reads, the\n                simulation is successful, indicating that the in-barcodes can be\n                used to distinguish each sequence.",
    "Add the 12-nt non-C PCR primers to both sides of the 62-nt\n            sequences, resulting in a final length of 86 nt.\n            \nNote: The final oligo sequence is\n              5′- GTAAGGGTGAGG-barcode1-’50-nt test\n              sequence’-barcode2-GATAGGGTGGTG-3’ (Figure 2[href=https://www.wicell.org#fig2]A).\n            \n        4,096 N6 oligo pool design.\n        \n            Week1. Generate 4096 sequences of\n            A6N6AGCTA12 in silico. N\n            represents A, G, C or T.\n          \n            Add a unique 8-nt non-C barcode pair on each side of the 28-nt\n            sequences, for a total length of 44 nt.\n          \n            Add 12-nt non-C PCR-primers to each side of the above sequence,\n            resulting in a final length of 68 nt.\n            \nNote: The oligo sequence is 5′-\n              GTAAGGGTGAGG-barcode1-\n              A6N6AGCTA12-barcode2-GATAGGGTGGTG-3’\n              (Figure 2[href=https://www.wicell.org#fig2]B).\n            \n            As in Step 6j, run a simulation test to demultiplex each sequence\n            according to the in-barcodes.\n          \n        Week2-Week4. Synthesize the oligo pool using a commercial vendor (Twist\n        Bioscience or similar).\n      \nIn vitro AID deamination assay\nTiming: 1–1.5 h\n      This section describes how to perform the in vitro AID deamination\n      reaction.\n    \n        Reaction setup. Troubleshooting 4[href=https://www.wicell.org#troubleshooting],\n        5[href=https://www.wicell.org#troubleshooting].\n        \n            Thaw AID protein on ice from the −80°C refrigerator.\n            \n                Centrifuge the enzyme at 9,391 × g for 10 min at 4°C\n                prior to use.\n              \n                Retrieve the supernatant carefully. Discard the ∼5 μL of liquid\n                at the bottom to remove any aggregated proteins.\n              \n            Heat the ssDNA at 95°C for 10 min, and quickly place the tube into\n            ice to completely denature the substrates.\n          \n            Perform the reaction in a 10-μL format.\n            \nAdd the pre-cooled reaction buffer.\n                Add the ssDNA and AID.\n                \nNote: The deamination reaction\n                  buffer contains 20 mM HEPES pH7.4, 10/150 mM NaCl and 1 mM\n                  DTT.\n                \nPipette the mixture up and down several times.\nQuick-spined on a desktop centrifuge for 5 s.\n                Incubate the tube at 37°C for 5–60 min.\n                \nNote: In our hands, the\n                  reaction reaches a plateau after 60 min.\n                \nAfter incubation, stop the reaction by heating (95°C, 10 min).",
    "Note: The salt concentration in the AID\n      protein buffer should be counted in the final reaction salt concentration.\n      Reaction time, substrate/enzyme ratio should be tested for each batch of\n      purified enzyme, as exampled in Figures 3[href=https://www.wicell.org#fig3]A and 3B.\n    \nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3015-Fig3.jpg\n          Figure 3. HTS-data analysis of long ssDNA substrates and short ssDNA\n          oligo pools\n        \n          (A) Mutation profiles of a FR3-CDR3 region from the VHB1-8 allele in in vitro deamination assay with\n          different molar ratio of ssDNA:AID. Deamination frequency, i.e.,\n          substitution in total sequencing reads, at each nucleotide along the\n          124-nt region is plotted as a bar graph with green error bars,\n          representing mean with SEM from 3 repeats. WRC/GYW motifs are labeled\n          in yellow, and AGCT is labeled in orange.\n        \n          (B) Deamination products of IGHV oligo pools were subjected to\n          mutation spectrum (upper) and seqlogo analyses (lower). The seqlogo\n          was obtained from the top16 tetramer with high mutation frequency in\n          all 64 NNCN combinations.\n        \nPause point: The final reaction\n      product can be stored for up to one week at −20°C. Longer storage is not\n      recommended because ssDNA is not stable.\n    \nAmplicon-seq library preparation\nTiming: 1 day\n      This step describes how to prepare the amplicon sequencing library from\n      deamination products for high-throughput sequencing (HTS).\n    \n        U-friendly PCR. Troubleshooting 6[href=https://www.wicell.org#troubleshooting].\n        \n            Set up a 10-μL PCR reaction for each sample as below:\n            table:files/protocols_protocol_3015_25.csv\nNote: Primers for long ssDNA\n              substrates (underlined sequences are used as the primer sites for\n              the next step PCR, in-barcodes are in red, non-C or non-G\n              sequences are in blue). A pair of primers used for\n              VB1-8 FR3-CDR3 amplicon is shown.\n            \nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3015-Fx6.jpg\n            Primers for short ssDNA oligo pools: (underlined sequences are used\n            as the primer sites for the next step PCR, in-barcodes are in red,\n            12-nt non-C or non-G sequences are in blue).\n            imgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3015-Fx7.jpg\n            Set up the following PCR program:\n            table:files/protocols_protocol_3015_26.csv",
    "Note: This 1st step of\n              PCR can also use other U-friendly enzymes, such as Q5U Hot Start\n              High-Fidelity DNA Polymerase, or Phusion U DNA polymerase. The\n              in-barcode is used to distinguish the difference batch of\n              experiments, which is different from the in-barcode designed in\n              step 6 or 7.\n            \n        Amplicon-seq HTS library preparation.\n        \n            Set up a 25-μL PCR reaction for each sample as below:\n            table:files/protocols_protocol_3015_27.csv\nNote: Primers for 2nd\n              step PCR (underlined sequences overlap with 1st step\n              PCR primers, barcode is in red):\n            \nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3015-Fx8.jpg\n            Set the following PCR program to amplify the DNA fragments:\n            table:files/protocols_protocol_3015_28.csv\nPause point: Amplified DNA\n              products can be stored at −20°C for months.\n            \n        HTS-library purification.\n        \n            Add 5 μL 6× DNA loading dye directly into the PCR products and run\n            the sample on a 2% agarose gel in 1× TAE buffer.\n          \nExcise the target DNA fragments from the gel.\n            Add 2–3 mL of PC buffer provided in the Universal DNA Purification\n            Kit into the excised gels and allow to fully dissolve at 20°C–25°C.\n          \n            Add 500 μL BL buffer to a Universal DNA Purification column and spin\n            at 13,523 × g for 1 min at 20°C–25°C, discard the flow\n            through.\n          \n            Load the dissolved gel mixture onto the balanced column and spin at\n            13,523 × g for 1 min at 20°C–25°C, discard the flow-through.\n          \n            Add 600 μL buffer PW to the column, spin at 13,523 × g for\n            1 min at 20°C–25°C, discard the flow-through. Repeat this step one\n            more time.\n          \n            Spin the column at 13,523 × g for 2 min at 20°C–25°C,\n            transfer the column to a new 1.5 mL tube.\n          \n            Add 50–100 μL ddH2O to the column, incubate for 2 min at\n            20°C–25°C, spin at 13,523 × g for 2 min at 20°C–25°C.\n          \nMeasure the concentration using a Qubit Quantification Kit.\nHTS data analysis\nTiming: 1–2 days",
    "This section describes how to perform the\n      HTS data analysis[href=https://www.wicell.org#sec3.6]. Data from long-ssDNA and\n      oligo-pool substrates are processed differently.\n    \nCritical: All custom scripts used in\n      this section are available at\n      https://github.com/ZhangSenxin/Deamination-HTS-Pipeline[href=https://github.com/ZhangSenxin/Deamination-HTS-Pipeline]\n      (https://doi.org/10.5281/zenodo.8271540).\n    \n        Create a metafile.txt file for Hiseq run.\n        Troubleshooting 7[href=https://www.wicell.org#troubleshooting],\n        8[href=https://www.wicell.org#troubleshooting].\n      \nNote: The metafile contains the\n      configuration information needed to process sequence reads for a given\n      sample. Incorrect information can lead to errors at various stages of the\n      pipeline or produce incorrect results. The metadata file is a\n      tab-delimited plain text file containing the following header line with\n      each subsequent line describing the design of a single sample.\n    \ntable:files/protocols_protocol_3015_29.csv\n      “experiment”- the unique name of the sample, this ID will be used to name\n      most files generated by the pipeline.\n    \n      “genotype”, “allele”, “mouse/cell”, “tissue/clone”- information to\n      describe the sample.\n    \n“PE-P7-index”- the unique PE-P7 index ID.\n“barcode”- sequence of the PE-P7-index.\n“forward_primer”- sequence of the gene-specific primer on P5 side.\n“reverse_primer”- sequence of the gene-specific primer on P7 side.\n      “in-barcode-F”- barcode on the P5 side that you will add to your\n      forward_primer.\n    \n      “in-barcode-R″- barcode on the P7 side that you will add to your\n      reverse_primer.\n    \n      “reference”- The pipeline uses this name to find the reference sequence\n      and bowtie2 index on the filesystem.\n    \n      “start”- position of the next nucleotide at the end of the forward_primer.\n    \n      “end”- position of the next nucleotide at the end of the reverse_primer.\n    \n        For long ssDNA substrates, run the SHM pipeline13[href=https://www.wicell.org#bib13]\n        to generate the result files. Multiple samples can be processed in the\n        same time.\n      \n>perl SHMPipeline.pl --meta meta.wyy.txt --in raw --out\n          result_wyy\n--ref ./ref --threads 8--ow &> wyy.nohup.txt\nNote: The SHM pipeline reads the metafile\n      and calls bowtie2 to align the forward and reverse reads to the reference\n      sequence.\n    \n        The WYY∗_filt_profile.txt can be used directly to plot the mutation\n        profile using the custom scripts as follows:",
    ">For WYY in ∗txt\n>do RScript ./SHMPlot2_zhou1_WRC.R ./$WYY/$WYY.pdf tstart=xx\n          tend=xxx plotrows=1 ymax=0.35 figureheight=2 showsequence=T or F;\n          done\nNote: Where tstart and tend are the start\n      and end filled in the metafile, plotrows defines the number of rows\n      displayed in the plot, ymax means the maximum value of the mutation\n      frequency, figureheight defines the height of the plot, showsequence = T\n      or F means to show or hide the sequence information, as illustrated on\n      Figure 3[href=https://www.wicell.org#fig3]A.\n    \n        For short ssDNA oligo pools, demultiplex the raw reads and remove the\n        12-bp adapters at the 5′ and 3′ ends of the oligos using cutadapt v1.9\n        as follows:\n      \n>bash cutadapter.sh\n        Filter out reads with Illumina Sequencing Quality Scores less than 30.\n      \n>source activate fastp\n>fastp -i WYY∗_recut_R1.fq.gz -I WYY∗_recut_R2.fq.gz -o\n          WYY∗_recut_R1_q30.fq.gz -O WYY∗_recut_R2_q30.fq.gz -q 30 -u 10\n          -A\n        Divide each substrate according to the in-barcodes.\n        \n            Create multiple metafile_cut.txt files with no header to split the\n            reads.\n            \nNote: Since the fastq-multx\n              program has an upper limit for each run, each metafile contains\n              500 rows and 2 columns, the first column is the sample ID, the\n              second column is the internal barcode information, the format is\n              5′barcode-3′barcode (reverse complement).\n            \n            Divide each sequence into different files using the custom script as\n            follows:\n            \n>bash multx.sh\n        Annotate and generate mutation profiles using the custom script as\n        follows:\n      \n>python3 read_fq.gz.py -m ./array1_ref.txt -f ./array1/\n-s ./array1/out2/ -c 1 > array1.txt\nNote: Where -m: oligo pool reference file,\n      -f: the data path generated in step 19b, -s: save path, -c defines the\n      sense strand (-c 1, default) or the antisense strand (-c 0).\n    \n        Mutation spectrum analysis.\n        \n            Mutation spectrum statistics for A, G, C, T using the custom script\n            as follows (Figure 3[href=https://www.wicell.org#fig3]B):\n            \n>python3 mut_summary.py -m ./IGHV_ref_kabat.txt\n-f ./array1/out2/ -s\n                  ./array1/out3_kabat/ > mutation_summary01_out.txt\nNote: Where -m: oligo pool",
    "reference file containing region information (one sequence spans\n              up to 3 regions), -f: the data path generated in step 20 -s: save\n              path.\n            \n            Mutation spectrum statistics for C in WRC, SYC, WGCW, AGCT using the\n            custom script as follows:\n            \n>python3 mut_summary2.py -m ./IGHV_ref_kabat.txt\n-f ./array1/out2/ -s\n                  ./array1/out3_kabat/ > mutation_summary02_out.txt\nNote: Where -m: oligo pool\n              reference file containing region information (one sequence spans\n              up to 3 regions), -f: the data path generated in step 20, -s: save\n              path.\n            \n        Combine the tiling assay into a full-length V gene.\n        Troubleshooting 10[href=https://www.wicell.org#troubleshooting].\n      \n>python3 mapping2full_length_sequence.py\n-m ./full_length_reference.csv\n-r ./IGHV_ref_kabat.txt -f ./array1/out2/\n-s ./array1/full_length_out/\n-i ./array1/full_length_mismatch.txt > full_length_out.txt\nNote: Where -m: sequence reference file\n      containing full length V, -r: oligo pool reference file containing region\n      information (one sequence spans up to 3 regions), -f: the data path\n      generated in step 20, -s: save path, -i file path to save mismatch\n      information (if exist).\n    \nNote: This step combines each 50-nt\n      segment from a V gene and generate the full-length V mutation information.\n    \n        Plot mutation frequency for V genes.\n        Troubleshooting 11[href=https://www.wicell.org#troubleshooting].\n        \n            Pre-process the data:\n            \n>python3 data_produce.py -m\n                  ./full_length_reference.csv\n-r ./V_region_kabat.csv -f ./array1/full_length_out/\n-s ./array1/plot_data/ -p\n                  ./species.txt > data_produce_out.txt\nNote: Where -m: sequence reference\n              file containing full length sequence, -r: region reference file\n              containing V gene region info, -f: the data path generated in step\n              22, -s: save path, -p species information.\n            \n            Plot mutation frequency based on specie pre-processed data (as shown\n            in Wang et al.1[href=https://www.wicell.org#bib1]):\n            \n>python3 figure_plot.py -f ./array1/plot_data/\n-s ./array1/plot_figure/ -p ./species.txt\nNote: Where -f: the data path\n              generated in step 23a, -s: save path, -p species reference file."
  ],
  "subjectAreas": [
    "Sequence Analysis",
    "Immunology",
    "Bioinformatics",
    "Protein Expression And Purification",
    "Biotechnology And Bioengineering",
    "Cell Biology",
    "Molecular Biology",
    "Sequencing",
    "Protein Biochemistry"
  ],
  "bigAreas": [
    "Biomedical & Clinical Research",
    "Molecular Biology & Genetics",
    "Bioinformatics & Computational Biology",
    "Bioengineering & Technology"
  ]
}