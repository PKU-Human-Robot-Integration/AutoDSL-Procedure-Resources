{
  "id": 2823,
  "origin_website": "Cell",
  "title": "In vitro clonal multilineage differentiation of distinct murine hematopoietic progenitor populations",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nFor the standard cell differentiation protocol, follow steps 1-20. For the alternative barcoding protocol, please follow steps 1-3 and then skip to step 21.\nCell sorting- Day 1\nTiming: 1 day\nIn this step your population of interest is sorted as single cells in 96-well plates.\nHarvest BM.\nIn the morning, euthanize mouse according to your ethical permit.\nDissect BM containing bone such as pelvis, femur, tibia-fibula, radius-ulna, humerus, spine (vertebra), scapula, and ribs from mice and collect these in a 50 mL tube containing cold (4°C) FACS-buffer.\nNote: In our experience tibia, femur and pelvis contain the highest number of BM cells.\nCrush bones in ice-cold FACS-buffer with a mortar and pestle and make single-cell suspensions by gently pipetting up and down using a 1 mL pipette tips.\nFilter through a 40 μm cell strainer. Count the cells and centrifuge at 350 × g for 5 min at 4°C.\nRemove the supernatant and resuspend cells in FACS-buffer, 1 mL/250 × 106 cells.\nSet aside around (10k) cells for “FMO APC” and “Unstained control”. The remaining cells will be used for C-Kit-enrichment.\nNote: This step is important to enrich for LSK population and reduces sorting time. Lineage depletion also can replace C-kit enrichment in this step.\nC-Kit-enrichment.\nAdd 2 μL c-Kit-APC-antibody per 1 mL cell suspension.\nIncubate samples at 4°C in darkness and gentle shaking for 30 min.\nWash cells by filling up the tube with FACS-buffer and spin 350 g for 8 min.\nRe-suspend the cell pellet in 500 μL FACS-buffer with 25 μL anti-APC beads/250 × 106 cells.\nIncubate dark at 4°C for 30 min. Shaking is not required.\nWash cells by filling up the tube with FACS-buffer and spin 350 g for 8 min.\nRe-suspend cells in 500 μL FACS buffer.",
    "For C-Kit-enrichment insert MACS column into the MACS separator magnet and put a 50 μm cup filter on top of each column.\nEquilibrate the columns by running 3 mL FACS buffer through the column and discard the liquid flow through.\nPlace labeled collection-tubes underneath each column and pipette the 500 μL sample through the filter.\nRinse the sample-tube with 500 μL of buffer and add to column.\nAdd 3 mL of buffer to the column to rinse off the unbound cells, wait until the buffer run through then repeat this step two more times.\nSeparate the column from the separator magnet and place it on top of a new collection-tube.\nAdd 5 mL buffer to the column and flush out the cells by firmly pushing the supplied plunger.\nCell staining.\nCount the cells using an Automated Cell Counter.\nSet aside around (200k) cells for the remaining “FMOs”.\nSpin the cell suspensions at 4°C 350 g for 8 min; remove the supernatant.\nResuspend the cell pellet in FACS buffer containing FC-block (1:100) at the volume of 100 μL/107 c-Kit enriched cells and incubate for 5 min in 4°C.\nAdd antibody staining cocktail according to the table in the “materials and equipment[href=https://www.wicell.org#materials-and-equipment]” section.\nStain the sample and FMO controls and incubate dark for 45 min at 4°C and gentle shaking.\nWash cells in FACS buffer, spin at 350 g for 8 min at 4°C, remove supernatant.\nRe-suspend pellet in FACS-buffer containing 7AAD (1:200), and re-suspend FMO PECy5 and unstained-control in FACS-buffer without 7AAD.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2329-Fig2.jpg\nFigure 2. FACS cell sorting gating strategy for hematopoietic stem and progenitor populations\n(A) Representative FACS gating strategy for LSK, LTHSCs and LMPP.\n(B and C) Purity check and FMOs have been shown in (B) for LTHSCs, LMPPs and (C) for LSK.",
    "Note: We sorted on an AriaIII instrument, according to configuration designed in “FACS cell sorter and analyser” in “materials and equipment[href=https://www.wicell.org#materials-and-equipment]” section.\nCell sorting.\nSort single cells (LT-HSCs) into 96-well plate containing the OP9-layer according to the gating strategy in (Figures 2[href=https://www.wicell.org#fig2]A and 2B).\nOptional: Activate index sorting in the FACS sorting software to save the immunophenotypic profile for each single cell.\nNote: In this study we used 70 μm nozzle in AriaIII with the sort of precision mode 4-way purity (0-32-0). The sorting purity is recommended to be greater than 95% of viable cells (Figure 2[href=https://www.wicell.org#fig2]B).\nAfter sorting, wipe the surface of the plate with 70% ethanol and keep it in a closed container together with a petri culture dish containing autoclaved water.\nStore in incubator at 37°C and 5% CO2 for 4 days.\nPreparation for switch culture- Day 3\nTiming: 2–3 h\nIn this step the growing single-cell cultures will be split equally to Erythroid or B cells conditions according to the experimental design (Figure 3[href=https://www.wicell.org#fig3]A). The 96 well plates used in this step should be with low evaporation lid.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2329-Fig3.jpg\nFigure 3. Methodology and FACS read out for the switch culture protocol\n(A) Experimental strategy for clonal switch-culture.\n(B and C) Representative FACS gating strategy of (B) LTHSCs-derived Myeloid (My), Macrophage (MΦ) and B clones from B condition at day 21 co-cultures, and (C) Myeloid (My), Macrophage (MΦ) and Erythoid (ER) clones for ER culture system at day 21.\n(D) Lineage distribution of clones derived from single cells from the indicated sub-populations (LT-HSCs and LMPP). Error bars indicate standard deviation.\n(E and F) Representative May-Gruwald-Giemsa staining of cytospin slides from the cells of readout in (E) Erythroid or (F) B condition at day 21. Scale-bare represents 20 μm.",
    "For B-cell differentiation culture, 2000 OP9 cells are seeded into a new flat bottom 96 well culture plate containing 50 μL complete OptiMEM with cytokine.\nNote: The cytokine concentration should be appropriate for final volume of 200 μL according to the table “Alternative 1-cytokines B conditions”.\nFill the wells surrounding the seeded cells with autoclaved water and incubate at 37°C and 5% CO2 preferably overnight or at least 6 h before sorting.\nFor Erythroid (ER) differentiation culture, prepare a new flat bottom 96-well plate with 50 μL complete SFEM with cytokines.\nNote: The cytokine concentration should be appropriate for a final volume of 200 μL according to the table “Alternative 1- cytokines Erytrhoid condition”.\nFill the wells surrounding the SFEM wells with autoclaved water, keep them in 4°C overnight in a sterile container.\nNote: This step can be prepared at day 4 as well.\nSwitch culture- Day 4\nTiming: 0.5 day\nSterilize the tissue culture hood and microscope according to step 1.\nCheck the plate with sorted cells after 4 days under the microscope to verify the growth of clones.\nNote: At this stage the earliest colonies from certain progenitors such as LMPP may be visible; however, colonies from LT-HSCs will appear later. As a positive control seed a well with 10 cells while sorting.\nPlace the plate with sorted cells as well as the plates prepared in steps 1 and 3 in the hood.\nHomogenize the cells in each well (100 μL) by pipetting with a Multichannel pipette.\nDivide 50 μL into B cell differentiation culture and 50 μL in ER cell differentiation culture (Figure 3[href=https://www.wicell.org#fig3]A). Make sure to plate the cells in the same plate-position as in the (index) sorted plate.",
    "Rinse each well two times with 50 μL complete SFEM medium or OptiMEM medium without cytokines to recover all the cells.\nDivide the cells equally to each differentiation condition (the total volume in each condition should be 200 μL/well).\nCheck the sorted plate under the microscope to ensure that no cells remain in the wells.\nNote: If cells remain, rinse again with complete SFEM or OptiMEM medium and add to the respective well of each condition. Adjust cytokine concentration accordingly.\nKeep plates in a sterile container including a petri dish with autoclaved water in 37°C and 5% CO2 incubator until readout.\nChange half the medium every 7-day.\nVerify cell growth by microscope analysis.\nCentrifuge the plate for 5 min in 350 g at 4°C.\nRemove 100 μL medium from top carefully without interfering with the growing clone.\nAdd 100 μL fresh medium with cytokine concentration appropriate for 200 μL and incubate in 37°C and 5% CO2.\nNote: If the cells are confluent they should be moved to a larger-sized plate. In this case, homogenize the cells in a 96-well plate by pipetting the cells and transfer (200 μL/well) into the newly prepared 48-well plates, for B condition (containing OP9 cells) or erythroid condition, as previously explained. Rinse the 96-well plates two times with 100 μL medium supplemented with appropriate cytokine concentrations for a total of 400 μL, and transfer to the 48-well plate (in total 400 μL/well).\nRead out-Day 21\nTiming: 1 day\nThe kinetics of progenitors and lineage differentiation varies. It is important to optimize the time point for read out for the test population beforehand at bulk or single cell level.\nNote: In our experience, the kinetics of bulk cells is slightly faster compared to single cells; therefore we recommend setting up the experiment at single cell level.",
    "FACS analysis.\nHomogenize the cells by pipetting up and down (using 8- Multichannel pipette), transfer cells to V- bottom 96 well plates.\nRinse each well once more with 100 μL of FACS buffer and add to the respective well in the V- bottom 96 well plates.\nCentrifuge plates for 5 min in 350 g and discard supernatant without disturbing the cell pellet.\nRe-suspend the pellets in 50 μL of FACS buffer containing FC-block (1:100) and incubate for 5 min at 4°C.\nFor Erythroid or B cell differentiation culture, respectively, stain cells according to the table “Alternative 1- antibody cocktail” and incubate for 45 min, in dark, 4°C on slow shaker.\nRinse stained cells with FACS buffer, centrifuge at 350 g for 5 min at 4°C.\nRemove supernatant and re-suspended cells in 200 μL FACS buffer containing 7AAD (1:200).\nSet up staining compensation matrix using single stained controls (beads) on LSR-Fortessa (BD).\nSet gates as shown for Erythroid cultures in (Figure 3[href=https://www.wicell.org#fig3]B) or B-cell cultures in (Figure 3[href=https://www.wicell.org#fig3]C).\nRun samples and FMOs using plate or tube reader.\nNote: If a plate reader is used; the “maximum wash” setting should be applied between each sample according to the specific FACS instrument’s settings.\nFollowing FACS, lineage output is analyzed in FlowJo for the presence of Erythroid cells (CD45-, F4-80-, Mac1-, Gr1-, TER119+), B cells (CD45+, CD19+, Mac1-) and myeloid cells (either CD45+, Mac1+, Gr1+, or CD45+, Mac1+, F-480+).\nNote: We set the cut-off to ensure that we accurately capture the population. For clones to be considered positive, the scatter profile must contain at least 50-gated events. Each lineage clone's population should be distinct in back gating, and more than 20 events must be recorded within the scatter profile for the analysis to score as positive.\nVerify cell type\nTiming: 0.5 day",
    "As an alternative the morphology of cells could be confirmed by May-Grünwald/Giemsa-staining (Figures 3[href=https://www.wicell.org#fig3]E and 3F).\nCytospin and May-Grünwald/Giemsa-staining in brief.\nCells were Cytospinned using Shandon Cytospin 3, at 550 r.p.m with low acceleration for 3 min.\nNote: When spinning less than 1000 cells, pre-wet the filter with 50 μL PBS, spin at 550 r.p.m with low acceleration for 3 min, and load 100 μL of cell suspension.\nStain air-dried slides in May-Grünwald solution for 5 min.\nAfter a brief wash with water, stain the slides in Giemsa solution for 10 min.\nWash the slide with dH2O and air dry before microscopic analysis.\nNote: In our hand, it is critical to dilute Giemsa with dH2O or miliQ water (1:10) and cover cuvette with a lid to reduce evaporation. Otherwise, a higher concentration of Giemsa will confound results.\nAlternative protocol 2 (barcoding protocol)\nIn this protocol, we have optimized the differentiation culture system and included barcoding, allowing for higher throughput and bulk culture. This protocol also allows for the differentiation and growth of all lineages without a switch in culture conditions (Figure 4[href=https://www.wicell.org#fig4]).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2329-Fig4.jpg\nFigure 4. Summary of the barcoding protocol’s experimental workflow\nCellular barcoding is emerging as a powerful tool for addressing individual cell fates on a large scale by tagging individual cells of interest with unique heritable identifiers or barcodes. The generation of lentiviral barcode libraries, the significance of complexity and size of libraries, as well as analytical challenges, has all been carefully reviewed before.2[href=https://www.wicell.org#bib3],3[href=https://www.wicell.org#bib4],4[href=https://www.wicell.org#bib5] Prior planning is necessary to ensure an appropriate experimental design. The barcoding protocol used here adopts technology from Kristiansen et al.5[href=https://www.wicell.org#bib2] to track the multilineage differentiation of LSK cells in-vitro. However, this protocol is also useful for assaying committed progenitors as exemplified by the LMPP data in Figure 6[href=https://www.wicell.org#fig6]B.\nPreparation",
    "The preparation step is performed as described above. Only steps 4c and 4d are different from switch culture and marked as Alternative protocol 2.\nPlease perform steps 1-3 above before continuing with step 21.\nCell sorting and transduction\nTiming: 1 day\nCell sorting. We used a BDAria III instrument (configuration listed in “materials and equipment[href=https://www.wicell.org#materials-and-equipment]” section).\nSort at least 2500 LSK (Lin-, Sca1+, C-kit+) or LMPP (LSK, CD34+, Flt3+) cells according to the gating strategy in Figure 2[href=https://www.wicell.org#fig2]A, into prepared collection tubes containing 150 μL cold complete OptiMEM with cytokines (step 4d in preparation).\nRecord the cell counts from the sort and store tubes on ice.\nIn a sterile tissue culture hood, seed the 150 μL sorted cells in one well from a 48-wells plate (HSCs-plate) containing OP9 cells from step 4c in preparation (in total 300 μL per well).\nVirus Transduction.\nCritical: Before performing the experiment, it is important to titrate your barcoding-containing lentivirus for the population of choice and determine the amount of virus required to achieve transduction efficiency that ensures the number of transduced cells per recipient does not exceed 10% of the complexity of the lentiviral barcode library, for an estimated barcode complexity of 80k as previously shown.4[href=https://www.wicell.org#bib5],6[href=https://www.wicell.org#bib6] Here, we titrated the virus using a dilution series and a multiplicity of infection (MOI) to achieve a transduction efficiency of 15–30% (Figure 5[href=https://www.wicell.org#fig5]), to reduce the risk of multiple barcode integration, as previously described in Kristiansen et al.5[href=https://www.wicell.org#bib2]\nThis step should be performed in an adequate cell culture hood using procedures approved for lentiviral transduction and adhering to the appropriate local safety and ethical protocols.\nAdd the previously optimized amount of lentivirus to each well except for the un-transduced controls.\nGently rock the plate to disperse the virus.",
    "Incubate in humidified incubator at 37°C and 5% CO2 incubator overnight.\nWash the cells in the morning.\nCentrifuge plate at 350 g for 5 min at 4°C.\nRemove supernatant and wash the cells with 300 μL of FACS buffer, spin at 350 g for 5 min at 4°C,\nRemove supernatant and repeat the wash one more time. Centrifuge the plate at 350 g for 5 min, 4°C.\nRemove the supernatant. Add 300 μL of complete OptiMEM with cytokine and incubate in humidified, 37°C and 5% CO2 incubator.\nNote: Make sure to adhere to your specific safety rules regarding the handling of virus-transduced cells according to your local safety and ethical protocols.\nMeasure transduction efficiency (Day 3).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2329-Fig5.jpg\nFigure 5. Example of GFP transduction efficiency readout on day 3\nViable single LSK and LMPP cells are shown from un-transduced control (left) and transduced LSK and LMPP samples (middle and right respectively).\nCollect 50 μL of the transduced cells and un-transduced controls into individual FACS tubes with 200 μL of FACs buffer.\nCentrifuge samples at 350 × g for 5 min at 4°C and remove supernatant.\nRe-suspend each sample in 150 μL staining buffer containing 7AAD.\nAnalyze GFP+ cells by FACS among live (7AAD-Neg) cells (Figure 5[href=https://www.wicell.org#fig5]).\nTransfer cells to larger plate when confluent (approximately day 7–11).\nSeed 50k OP9 cells in 6-well plates (Op9-plate) with 2 mL of complete optiMEM at the day of, or (>6 h) before transferring cells.\nThe following day, remove 1.3 mL of medium in Op9-plate (700 μL left in Op9-plate).\nHomogenize the cells in the HSCs-plate by pipetting, and transfer cells (300 μL/well) to the Op9-plate from step 24b (in total 1 mL/well).",
    "Rinse each well from the HSCs-plate 4 times with 250 μL of fresh complete optiMEM with cytokine concentration appropriate for a total volume of 2 mL, and transfer to Op9-plate. The final volume after transfer to Op9-plate is 2 mL per well.\nChange half of the medium every 7 days to fresh complete optiMEM with cytokine.\nNote: The cytokine concentration should appropriate for a total volume of 2 mL according to the table “Alternative 2- cytokine” in the “materials and equipment[href=https://www.wicell.org#materials-and-equipment]” section, without disturbing the cell layers.\nBarcode extraction, day 21 post transduction\nIn this step we recover the cell-specific barcodes. All steps are previously described in Kristiansen et al.5[href=https://www.wicell.org#bib2] Differentiation kinetics is unique for each progenitor and can additionally be affected by the virus transduction. It is recommended to optimize the readout time based on the specific population assayed since readout time point can vary. Here, we sort LSK output cells at day 16 and day 21 and LMPP at day 8 and day 16 to ensure discovery of clonal output into multi-lineages with different differentiation kinetics.\nCell sorting and lyses.\nTransfer cells into 3 mL FACS tubes and centrifuge at 350 × g for 5 min at 4°C.\nResuspend cells in FACS buffer containing FC-block (1:100) and incubate for 5 min in 4°C.\nStain cells according to the table “Alternative 2-antibody cocktail” in the materials and equipment, incubate 45 min in darkness at 4°C and gentle shaking.\nWash cells in FACS-buffer at 350 g, 8 min.\nRe-suspend cells in FACS-buffer containing 7AAD (1:200).\nNote: Our staining suggestion was sorted on AriaIII according to configuration in “materials and equipment[href=https://www.wicell.org#materials-and-equipment]”.\nThe FACS gating strategy for sorting of Megakaryocyte, Erythroid, myeloid (granulocyte and Monocyte/Macrophage) and Lymphoid (B) cells are shown in (Figure 6[href=https://www.wicell.org#fig6]).",
    "Note: For small number of cells, sort directly into lysis buffer.\nSort GFP+ cells into “non-stick tubes “(low-binding surface) containing 500 μL of FACS buffer. Store at −80°C as cell pellet for a maximum of 7 days before lysing.\nExtraction of genomic DNA.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2329-Fig6.jpg\nFigure 6. Representative FACS sorting strategy at read out of barcoding cultures\n(A and B) (A) Sort purity check and Representative May-Gruwald-Giemsa staining of cytospine slides for Myeloid (My), Macrophage (MΦ), B, Megakaryocyte (MK) and Erythroid (ER) form lineage output of LSK cells after 21 day or (B) LMPP cells after 8 day or 16 day of co-culture, Scale-bare represent 5 μm.\nPrepare lysis buffer according to table lysis buffer in the “materials and equipment[href=https://www.wicell.org#materials-and-equipment]”.\nCell pellets are lysed to extract genomic DNA in 100 μL cell lysis buffer for 2 h at 56°C, followed by 10 min at 95°C to inactivate proteinase K. Store at −20°C or continue with step 28.\nLibrary preparation and barcode sequencing.\nPurify genomic DNA using Ampure XP beads in 1:1 ratio according to manufacturer's protocol (Beckman Coulter).\nMeasure genomic DNA concentration using a high sensitivity method e.g., the Qubit dsDNAhs Assay Kit according to manufacturer's protocol (Thermo Fisher Scientific).\nDivide up to 40 ng DNA from each sample into two technical replicate PCR reactions (20 ng each).\nNote: Use the appropriate primers and a high-fidelity DNA Taq polymerase (e.g., Q5 Taq DNA polymerase) for amplification of the barcode fragment (Figure 4[href=https://www.wicell.org#fig4]). PCR reaction master Mix and PCR cycling is described in “materials and equipment[href=https://www.wicell.org#materials-and-equipment]”. Following this step, the DNA can be stored at −20°C.\nPurify the amplified fragments (155 bp) using Ampure XP beads 1:1.5× ratio according to the manufacturer’s recommendations (Beckman Coulter).\nNote: Here the fragments can be stored at −20°C.",
    "Measure DNA concentration using a high sensitivity method e.g., the Qubit Fluorometer and the Qubit dsDNA HS Assay Kit.\nOptional: A second step of PCR amplification can be performed to add multiplexing adaptors, depending on the design of the PCR primers and the sequencing platform used.\nRun second PCR according to the manufacturer’s recommendations (Thermo Fisher Scientific, InvitrogenTM).\nNote: PCR reaction master Mix and PCR cycling condition are described in “materials and equipment[href=https://www.wicell.org#materials-and-equipment]”. The PCR product can be stored at −20°C.\nPurify the amplified fragments (225 bp) using Ampure XP beads 1:1.5× ratio as previously described in “11d”. The fragments can be stored at −20°C.\nQuantify amplicons (size and concentration) using the Bioanalyzer HS DNA Analysis Kit.\nNote: A product of the correct size without contaminating primer dimer is critical for successful sequencing. The presence of primer dimers can be removed through an additional round of Ampure XP bead purification.\nPool equivalent amounts of amplified and indexed barcode libraries for sequencing according to the instructions for the chosen method for sequencing.\nNote: Here we used the Illumina MiSeq instrument and the v3 high output kit (150 cycles).\nStatistical analysis\nThe aim of the data analysis is to generate a list of reliable barcodes for each sorted sample, which will be combined with barcode read frequency, reflecting the abundance of each clone within the population. To enable rapid analysis of the data generated using our protocol, we have developed a Python package called Bartide. The package contains modules tailored to streamline three key challenges viz., barcode extraction, sequencing error correction and cross-sample comparison.\nTo install Bartide you need to have Python version 3.9 or upward. Use the following command to install Bartide.\n>pip install bartide==0.3.2",
    "Barcodes are extracted from the sequencing reads using Bartide’s BarcodeExtractor class. This class is provided two input files, one for each end of paired-end sequencing, in FASTQ format.\nNote: This class is designed to automatically extract the barcodes assuming that the barcodes are of the same lengths, they span the same position in the reads, and the flanking sequence is constant. This is achieved by first summarizing the nucleotide composition at each position for all the reads (or a sample of reads). The flanking sequence will be dominated by a single nucleotide while the barcode should have variable base composition. This pattern is used to identify the position of barcodes and the flanking primer sequence. This behaviour can be overridden by providing the barcode length and the flanking primer sequence to BarcodeExtractor. Below we show an example of how to call the BarcodeExtractor class and perform automatic flank identification.\n>import bartide\n>extractor = bartide.BarcodeExtractor(\n  ‘sample1_read1.fastq.gz’,\n  ‘sample1_read2.fastq.gz’\n)\n>extractor.identify_flanks()\nAlternatively, users can provide the flanking sequence and the barcode lengths manually as shown below:\n>extractor = bartide.BarcodeExtractor(\n  ‘sample1_read1.fastq.gz’,\n  ‘sample1_read2.fastq.gz’,\n  left_flank='GTAGCC',\n  right_flank='AGATCG',\n  barcode_length=27\n)\nOnce the flank sequences and barcode length are determined, they are stored as extractor.leftFlank, extractor.rightFlank and extractor.barcodeLength. Now the barcodes can be extracted, and their frequency counted.\nNote: The BarcodeExtractor class will compare the barcode sequence and its reverse complementary sequence from the other pair of the sequenced read. By default, there should not be more than 3 mismatches between the two sequences otherwise the extraction fails for that read. Users can change the maximum allowed mismatch value by using the max_dist parameter when calling BarcodeExtractor.\nThe actual extraction of barcodes is triggered by the following command:\n>extractor.count_barcodes()\nUsers can access these uncorrected barcodes with the following command:\n>print (extractor.rawCounts)",
    "This prints the barcodes and their frequencies as shown below:\nTTGTAGGGGTGTGTTCTACCGGTAATT    2843\nGTGCTGGTAATGTGGGCGACGGTGGGG    913\nTTGGTGAAGCATAGTTCCGTGATTGAA    909\nTTCCATGACGTTAAATACCTCCTTATA    723\nATCTGGCGTCCAGCAGATATTAGTTTT    717\n                                    ...\nAAGTTACATGCCGCAAAGGGTTCTTTG      1\nAAGGATGAATGACAAGGTGCTAGCCAT      1\nGGTACAAGGCGGGATTACCATGCATTG      1\nGTGCTGGAAATGTGGGCGACGGTGGGG      1\nAAGTCACATGCCGCAAAGTGTCCATTG      1\nNext, the list obtained above may still contain barcodes that harbor sequencing errors. We assume that a barcode contains error(s) if it has less than three nucleotide differences with a higher abundance barcode. Since the pairwise comparison of all the barcodes can be computationally prohibitive, we use the approximate nearest neighbor detection library ‘nmslib’ to efficiently identify similar barcodes.\nNote: If an erroneous barcode is found, its frequency is added to the barcode with the nearest match. This functionality is implemented in the SeqCorrect class. Users can obtain the corrected barcode list (in the same format as the uncorrected list above), by running the following command:\n>corrector = bartide.SeqCorrect()\n>corrector.run(extractor.rawCounts)\nThe corrected list of barcodes is stored under corrector.correctedCounts. These barcodes can then be saved in CSV format table as shown below:\n>corrector.save_to_csv(‘barcodes_freq_sample1.csv’)\nThe SeqCorrect class will by default, remove any barcode with a frequency of less than 20, as suggested previously 5. This behavior can be overridden by changing the value of the min_counts parameter when calling SeqCorrect.\nOnce the corrected barcode frequencies are saved for all the samples, they can be compared using the BarcodeAnalyzer class.\nNote: This class is initialized by providing the name, with full path, of the directory wherein all the CSV files were saved. the following command illustrates this:\n>analyzer = bartide.BarcodeAnalyzer(‘barcodes_dir’)\nThis will lead to aggregation of all the barcodes across all the samples that can be accessed from a single table stored under analyzer.barcodes. Users can perform all the custom downstream analysis using this table as the starting point.",
    "Bartide provides four essential plots that allow users to easily identify how the barcodes are shared across the sample.\nNote: The first plot is the ‘Upset’ that shows all the combinations of samples and the number of barcodes that overlap between them. This plot, compared to Venn diagrams, allows easy visualization of the overlaps and non-overlaps of barcodes. Please note that when using upset plots, we only look at the unique number of barcodes found in each of the samples and not their frequencies.\n>analyzer.plot_upset()\nSometimes due to large differences in the number of barcodes captured, it might be difficult to easily identify the similarity or differences between the samples. To solve this, rather than using the absolute number of barcodes in a sample, the percentage overlap of barcodes from a sample with all other samples is used. This allows the barcodes from a sample to be defined in terms of proportions and may allow insights into sample similarity that is otherwise difficult to discern using absolute frequencies. The following command shows the proportions in the form of a stacked barplot:\n>analyzer.plot_stacked()\nAn alternative way to deal with the situation wherein the absolute number of unique barcodes is quite different across the samples is to perform normalization by dividing the overlap value by the sum of the total barcodes from the two samples. The resulting normalized values can be visualized in the form of a heatmap.\n>analyzer.plot_overlap_heatmap()\nIn all the above three plotting functions, we do not use the frequencies of the barcodes, which are indicative of how dominant a particular barcode is in the samples. A weighted overlap of barcodes is calculated between two samples as following:\n   ∑ b B    (   S b i  −  S b j   )  2",
    "Wherein, S is a column-sum normalized matrix of samples (columns) and barcodes (rows) containing barcode frequencies, i and j are two samples, b is a barcode in a set of barcodes B that are present in either of the two samples or both. These overlap values are then plotted in the form of a heatmap using the following function:\n>analyzer.plot_weighted_heatmap()\nTo save the images generated by the functions above, users can pass a value (path and name of the file where to save) to the save name parameter."
  ],
  "subjectAreas": [
    "Genomics",
    "Bioinformatics",
    "Stem Cells",
    "Cell Isolation",
    "Flow Cytometry",
    "Cell Culture",
    "Cell Biology",
    "Molecular Biology"
  ],
  "bigAreas": [
    "Biomedical & Clinical Research",
    "Molecular Biology & Genetics",
    "Bioinformatics & Computational Biology",
    "Bioengineering & Technology"
  ]
}