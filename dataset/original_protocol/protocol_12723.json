{
  "id": 15150,
  "origin_website": "Jove",
  "title": "RNA Next-Generation Sequencing and a Bioinformatics Pipeline to Identify Expressed LINE-1s at the Locus-Specific Level",
  "procedures": [
    "1. Cytoplasmic RNA extraction\nObtain cells via the following methods.\n\t\nCollect live cells from 2.75%–100% confluent, T-75 flasks.\n\t\t\nWash the flask 2 times in 5 mL of cold PBS, and in the last wash scrape off cells and transfer to a 15 mL conical tube. Centrifuge for 2 min at 1,000 x g and 4 °C, and carefully remove and discard supernatant (Table of Materials).\nCollect cells from tissue specimens.\n\t\t\nPrepare tissue for cytoplasmic RNA extraction within an hour from being dissected and always keep on ice. For long-term storage, use RNA inhibitor solutions to store tissue for up to 72 hours after dissection following the manufacturer’s protocol (Table of Materials).\nDice a 10 µm3 sample and homogenize the fresh sample with 5 mL of cold PBS in a sterile dounce homogenizer, transfer to a 15 mL conical tube, centrifuge for 2 min at 1,000 x g at 4 °C, and carefully remove and discard supernatant (Table of Materials).\nAdd 2 mL of lysis buffer to cellular pellet- mix and incubate on ice for 5 min.\n\t\nPrepare fresh lysis buffer with 150 mM NaCl, 50 mM HEPES (pH 7.4), and 25 μg/mL digitonin (Table of Materials).\nAs the minimum concentration of digitonin in the lysis buffer required to penetrate the plasma membrane may vary by cell type, microscopically confirm that cells treated with lysis buffer lose the plasma membrane and retain the intact nuclear membrane.\nJust before use, add 1,000 U/mL RNase inhibitor (Table of Materials).\nCentrifuge for 1 min at 1,000 x g and 4 °C, and collect the supernatant.\nAdd supernatant to pre-chilled 7.5 mL of Trizol and 1.5 mL of chloroform. All the steps that require chloroform must be done inside a clean chemical hood (Table of Materials).",
    "Centrifuge for 35 min at 3,220 x g and 4 °C.\nTransfer the aqueous portion (top layer) to a fresh pre-chilled 15 mL tube.\nAdd 4.5 mL of chloroform and vortex.\nCentrifuge for 10 min at 3,220 x g and 4 °C.\nTransfer the aqueous portion to fresh pre-chilled tube.\nAdd 4.5 mL of isopropanol, shake well, and incubate at -80 °C overnight (Table of Materials).\nCentrifuge at 3,220 x g and 4 °C for 45 minutes.\nRemove isopropanol, add 15 mL of 100% ethanol (Table of Materials).\nCentrifuge at 3,220 x g for 10 min.\nRemove ethanol, drain and dry for approximately 1 h.\n\t\nUse a sterile cotton swab to blot out any remaining ethanol (Table of Materials).\nRe-suspend sample in 100 to 200 μL of RNase free water depending on pellet size (Table of Materials).\nFractionate samples using electrophoresis technology to determine quality and concentration of samples according to manufacturer’s intructions23 (Table of Materials).\n\t\nSamples qualify for RNA-Seq analysis if RIN > 824.\n2. Next-Generation sequencing\nSubmit cytoplasmic RNA samples to be sequenced using next-generation sequencing platform aimed at generating at least 50 million paired-end 100 bp reads.\nSelect for poly-adenylated RNAs and strand-specific sequencing.\n3. Create annotations (optional if one has an existing annotation)\nCreate full-length L1 annotation or download the full-length L1 annotation (Supplemental File 1a-b).\n\t\nDownload Repeat Masker annotations for LINE-1 elements from the UCSC genome browser with the table browser tool (https://genome.ucsc.edu/cgi-bin/hgTables). Specify the mammal clade, the human genome, the hg19 assembly (or hg38 for a more updated genome), and filter for “LINE1” under Class Name. Download as a .gtf file and label as FL-L1-BLAST.gtf.",
    "Run a local BLAST search of the first 300 bp of the L1.3 full-length L1 element encompassing the promoter region in the human genome and add 6,000 bp downstream to create an end of the L1 coordinates to the annotation file. Save in a gtf file and label as FL-L1-RM.gtf.\nIntersect the RepeatMasker annotation and the promoter-based L1 annotation using bedtools, and label as FL-L1-BLAST_RM.txt (Software Packages).\n\t\t\nUse this command in the Linux terminal: bedtools intersect -a FL-L1-BLAST.gtf -b FL-L1-RM.gtf > FL-L1-BLAST_RM.txt.\nSeparate the intersected FL-L1 annotation by the top and bottom strand.\n\t\t\nCopy over the FL-L1-BLAST_RM.txt into spreadsheet software and sort by the “minus” and “plus” strand and then sort by chromosome location.\nCreate two new spreadsheet documents, one with the intersected coordinates for full length L1s on the minus strand and one on the bottom strand, and save as FL-L1-BLAST_RM_minus.xls and FL-L1-BLAST_RM_plus.xls.\nSave the two new documents as .txt files.\nUse the mac2unix program to convert the .txt files to the correct annotation files (Software Packages).\n\t\t\nUse this command in the terminal: mac2unix.sh FL-L1-BLAST_RM_minus.gff.\nUse this command in the terminal: mac2unix.sh FL-L1-BLAST_RM_plus.gff.\nSave new files with the .gff extension.\nAlternatively, use AWK to filter rows associated with the + and – strand.\n\t\t\nUse the following command to get the + strand: awk ‘/+/’ FL-L1_BLAST_RM.gtf > FL-L1_BLAST_RM_plus.gtf.\nUse the following command line to get the - strand: awk ‘/-/’ FL-L1_BLAST_RM.gtf > FL-L1_BLAST_RM_minus.gtf.\n4. Read alignment pipeline to identify expressed L1s\ntable:\n﻿0,1\nOption,Description\n–p,This details the number of threads the computer should use running the alignment. Larger computer memory will allow more threads and should be empirically d.\n–m 1,This tells the program to only accept reads that have one match in the genome that is better than any other genome match.",
    "– y,This is the tryhard switch which makes the mapping search for all possible matches and not allow it to quit after a fixed number of matches is reached.\n–v 3,This only allows the program to utilize memory for mapped reads with 3 or less mismatches to the genome.\n–X 600,This only allows paired reads that map within 600 bases of one another. This makes sure the read pairs are co-linear in the genome and selects against s involving processed RNA molecules.\n–chunkmbs 8184,This command assigns extra memory for handling the large amount of alignments possible for each L1-related read.\nTable 1: Command line options for Bowtie.\nRun alignment paired-end sequencing fastq files with the RNA-Seq sample of interest using Bowtie.\n\tNOTE: Bowtie1 must be used and not Bowtie2 because the parameters required for unique alignment are specifically only found in this version of bowtie (Software Packages). Bowtie is used over splice-aware aligners like STAR in order evaluate concordant, contiguous reads more relevant to L1 biology and expression.\n\t\nUse this command line in the Linux terminal: bowtie -p 10 -m 1 -S -y -v 3 -X 600 --chunkmbs 8184 hg_X_Y_M_index -1 hg_sample_1.fq -2 hg_sample_2.fq | samtools view -hbuS - | samtools sort – hg_sample_sorted.bam. See Table 1 for a description of command line options for Bowtie.\nStrand separate the output bam file using samtools (Software Packages) and the following Linux commands. Note that the actual flag values may vary if one is not using standard next generation sequencing protocols.\n\t\nUse this command line to select for the top strand: samtools view -h hg_sample_sorted.bam | awk 'substr($0,1,1) == \"@\" || $2 == 83 || $2 == 163 {print}' | samtools view -bS - > hg_sample_sorted_topstrand.bam.",
    "Use this command line to select for the bottom strand: samtools view -h hg_sample_sorted.bam | awk 'substr($0,1,1) == \"@\" || $2 == 99 || $2 == 147 {print}' | samtools view -bS - > hg_sample_sorted_bottomstrand.bam.\nGenerate read counts against annotations for L1 loci using bedtools (Software Packages).\n\t\nUse this command line to generate read counts for L1s in the sense direction on the top strand: bedtools coverage -abam FL-L1-BLAST_RM_plus.gff -b hg_sample_sorted_topstrand.bam > hg_sample_sorted_bowtie_tryhard_plus_top.txt.\nUse this command line to generate read counts for L1s in the sense direction on the bottom strand: bedtools coverage -abam FL-L1-BLAST_RM_minus.gff -b hg_sample_sorted_bottomstrand.bam > hg_sample_sorted_bowtie_tryhard_minus_bottom.txt.\nIndex bam file from step 5.1.1 to make it viewable in the Integrative Genomics Viewer (IGV)25 (Software Packages).\n\t\nUse this command line: samtools index hg_sample_sorted.bam\nTo use a batch mode to increase the number of RNA-Seq samples piped through at a time, use a supercomputer script to complete step 4.1 called human_bowtie.sh, a script to complete steps 4.2-4.3 has been created called human_L1_pipeline.sh, and a script to complete step 4.4 has been created called bam_index.sh. These scripts may be found in Supplemental File 2 with associated supercomputer commands to run the scripts.\n5. Manual curation\nCreate a spreadsheet for reads mapped to each annotated L1 locus.\n\t\nCopy over hg_sample_sorted_bowtie_tryhard_minus_bottom.txt created in step 4.3.2 and label page as “minus-bottom.”\n\t\t\nSort all columns based on highest to lowest number of reads found in column J.\nCopy over hg_sample_sorted_bowtie_tryhard_plus_top.txt created in step 4.3.1 and label as “top-plus” in another spreadsheet.\n\t\t\nSort all columns based on highest to lowest number of reads found in column J.\nCreate a third page labeled as “combined” and add all loci with ten or more reads from “minus-bottom” and “plus-top” pages.\n\t\t\nSort all columns based on highest to lowest number of reads found in column J.",
    "Load the following files into IGV25 (Software Packages): 1) reference genome of interest to visualize annotated genes, 2) FL-L1-BLAST_RM.gff to visualize the L1 annotation, 3) hg_sample_sorted.bam to visualize mapped transcripts from sample of interest, and 4) hg_genomicDNA_sorted.bam to assess mappability of genomic regions.\nRemove coverage and junction rows associated with each bam file.\nCompress hg_sample_sorted.bam and hg_genomicDNA_sorted.bam so all the IGV tracks fit on one screen.\nManually curate.\n\t\nUsing coordinates from loci listed on the spreadsheet “combined” page, view called loci in IGV25 (Software Packages).\nCurate a locus to be authentically expressed off its own if there are no reads upstream in the L1 direction up to 5 kb.\n\t\t\nLabel the row green in color and note why it is an authentically expressed L1.\n\t\t\tNOTE: An exception to this rule exists if the region upstream of the L1 is not mappable. If this is the case, label the row red in color and note that the expression of the region upstream of the L1 promoter cannot be evaluated and therefore the L1’s expression is not able to be confidently determined.\nCurate a locus to not be authentically expressed off its own promoter if there are reads upstream up to 5 kb.\n\t\t\nLabel the row red in color and note why it is not an authentically expressed L1.\nCurate a locus as false if it is expressed within an intron of an expressed gene in the same direction with reads upstream of the L1, if it is downstream of an expressed gene in the same direction with reads upstream of the L1, or for un-annotated expression patterns with reads upstream of the L1.",
    "NOTE: An exception to this rule applies when there are minimal reads directly overlapping the L1 promoter start site, but slightly upstream of the L1. If there are no other reads upstream of an L1 case like this, consider this L1 to be authentically expressed. Label the row green color and note why it is an authentically expressed L1.\nCurate an L1 locus as likely to be false if the pattern of mapped reads to the locus do not correlate with the specific L1’s regions of mappability.\n\t\tNOTE: For example, if an L1 is highly mappable but only has a pile up of reads in a condensed region within the L1, it is less likely to be related to L1 expression off its own promoter and more likely to be from un-annotated sources like exons or LTRs. In cases like this, curate the loci as orange and note why the locus is suspicious. Verify sources of suspicious pile-ups by checking the L1 location in UCSC genome browser.\nCurate a locus to not be authentically expressed if it is within a genomic environment of sporadically expressed un-annotated regions\n\t\tNOTE: For example, reads may be expressed 10 kb upstream of the L1, but every 10 kb or so there are mapped reads and some of those reads align with the L1. These L1s are less likely to be expressed off its own promoter, and more likely to have mapped reads due to un-annotated patterns of genomic expression. In cases like this, curate the loci as orange and note why the locus is suspicious.\n6. Read alignment strategy to assess mappability in reference genome (optional if one has an existing aligned genomic DNA dataset)\nDownload whole genome DNA sequence files and convert to .fq files\n\t\nGo to the NCBI website found here: https://www.ncbi.nlm.nih.gov/sra",
    "Type in WGS HeLa paired end.\nSelect for Homo sapiens under Results by taxon.\nSelect a sample that is paired end and has reads with 100 or more bp like the following sample: https://www.ncbi.nlm.nih.gov/sra/ERX457838[accn]\nConfirm read length by selecting Run and then Metadata as shown here: https://trace.ncbi.nlm.nih.gov/Traces/sra/?run=ERR492384\nTo download the whole genome DNA sequence data, enter this command in the Linux terminal: sratoolkit.2.9.2-mac64/bin/prefetch -X 100G ERR492384\n\t\tNOTE: The SRA toolkit prefetch function downloads the accession number “ERR492384” found in the NCBI site (Software Packages). The “100G” limits amount of downloaded data to 100 gigabytes.\nEnter this command in the Linux terminal: fastq-dump --split-files ERR492384\n\t\tNOTE: This splits the downloaded genomic DNA dataset into two fastq files.\nRun alignment using Bowtie.\n\t\nUse this command in Linux for alignment: bowtie -p 10 -m 1 -S -y -v 3 -X 600 --chunkmbs 8184 hg_X_Y_M_index -1 hg_genomicDNA_1.fq -2 hg_genomicDNA_2.fq | samtools view -hbuS - | samtools sort – hg_genomicDNA_sorted.bam.\n\t\t\nRefer to step 4.1 to understand parameters used in the Bowtie alignment (Software Packages).\nDownload the genomically aligned bam file to assess mappability available upon author request.\nIndex bam file from step 4.2.1 using samtools to make it viewable in IGV25 (Software Packages) to further inform manual curation.\n\t\nUse this command line in Linux: samtools index hg_genomicDNA_sorted.bam\nAssess mappability of each L1 loci\n\t\nDetermine the number of uniquely mapped reads to L1 loci using the bedtools program, the FL-L1 annotation, and the aligned genomic sequence data (Software Packages).\n\t\t\nUse this command line in Linux: bedtools coverage -abam FL-L1-BLAST_RM.gtf –b hg_genomicDNA_sorted.bam > L1_Mappability_hg_genomicDNA.txt.\nDesignate an L1 locus to have full coverage mappability when 400 unique reads are aligned to it.\nDetermine the factor required to scale up or down genomic DNA aligned reads to 400 for each individual L1.",
    "To have a scaled measure of expression according to individual L1 locus mappability, multiply the factor determined in step 6.4.3 to the number of RNA transcript reads that align to authentically expressed L1s determined in sections 4–5."
  ],
  "subjectAreas": [
    "Genetics"
  ],
  "bigAreas": [
    "Molecular Biology & Genetics"
  ]
}