{
  "id": 3455,
  "origin_website": "Cell",
  "title": "Identifying essential long non-coding RNAs in cancer using CRISPRi-based dropout screens",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nTarget identification\nSelection of cell system and nuclei isolation\n      An adequate cell system or cell lines of interest should be initially\n      selected. Any cell line that can be expanded in vitro is in\n      principle suited for this protocol. Our laboratory mainly focuses on\n      colorectal cancer and we, therefore, established this procedure using a\n      panel of CRC cell lines (e.g., Colo320HSR, LS180, HT55 and LS411N). Each\n      cell line is then profiled using GRO-seq. To capture nascent transcripts,\n      millions of cell nuclei are isolated and transcription is reinitiated in\n      presence of an analog of UTP (Br-UTP). Nascent transcripts with\n      incorporated Br-UTP can be captured with an agarose-conjugated anti-BrdU\n      antibody (Santa Cruz, IIB5). This section describes how to isolate cell\n      nuclei, perform and analyze GRO-seq. Steps related to the GRO-Seq protocol\n      are illustrated in Figure 2[href=https://www.wicell.org#fig2]A.\n    \nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3032-Fig2.jpg\nFigure 2. Global run-on sequencing\n          (A) Scheme highlighting key steps required to perform global run-on\n          sequencing.\n        \n          (B) Example of nuclei obtained from the CRC cell line HCT116,\n          following the procedure illustrated in A1.\n        \n          (C) Analysis of two purified run-on reactions (S1 and S2) using a\n          Bioanalyzer RNA 6000 Pico Chip. The size distribution is indicated by\n          a ladder (L).\n        \n          (D) Electropherograms of samples presented in B. Fragment sizes\n          (nucleotides, nt) are plotted against arbitrary fluorescence units\n          (FU).\n        \nCritical: RNA is sensitive to\n      temperature and enzymatic digestion by RNases, which are normally present\n      on skin, surfaces, etc. Keep all surfaces and equipment clean while\n      performing this protocol. We also recommend to wear gloves and to keep\n      samples on ice whenever indicated in the protocol. Only use RNase-free\n      materials and chemicals.\n    \nNote: Here we describe the procedure from\n      the day cells are harvested for nuclei isolation. We do not consider\n      seeding density, expansion time and possible treatments. However, if you",
    "have different treatments or conditions in your experimental setup, these\n      factors should be carefully considered in the overall planning. For cancer\n      cell lines, we generally harvest 20 × 106 cells per replicate\n      and combine two run-on reactions (each with 5 × 106 nuclei) in\n      order to obtain sufficient material for the preparation of a sequencing\n      library. However, if the transcriptional output of your cells of interest\n      is low, you may have to increase the number of pooled run-on reactions per\n      replicate.\n    \nDay 1\n        Prepare the swelling, lysis, and freezing buffers and pre-cool them on\n        ice.\n      \nCool down a centrifuge to 4°C and pre-warm the trypsin.\n        Trypsinize the cells until they become rounded and floating.\n        \n            Neutralize the trypsin with 2 volumes of 10% FBS-supplemented medium\n            and transfer each sample to a 50 mL tube. Make sure that cells are\n            properly singularized.\n          \n            Centrifuge samples for 5 min at 300 × g, and discard the\n            supernatants.\n          \n            From here on, keep the pellets on ice unless indicated otherwise.\n          \n        Resuspend each pellet in 30 mL of swelling buffer.\n        \n            Incubate samples 10 min on ice with occasional inverting of the\n            tubes.\n          \nCentrifuge samples for 5 min at 500 × g (4°C).\n            Carefully remove the supernatant without disturbing the pellet.\n          \n        Resuspend each pellet in 10 mL of lysis buffer and transfer the\n        suspension into a 15 mL tube.\n        \n            Invert the tube 30 times and spin down for 5 min at 500 × g\n            (4°C).\n          \nRemove the supernatant.\nRepeat step 5.\nNote: If a large number of cells (>\n      5 × 107) is collected per sample, you may split them in several\n      tubes to obtain a better swelling and lysis reactions. You can visually\n      inspect your sample under the microscope (after step 6), and confirm the\n      presence of clean nuclei (see Figure 2[href=https://www.wicell.org#fig2]B). If not, you",
    "can repeat step 5, before resuspending the sample in freezing buffer.\n    \n        Resuspend the pellet in 1 mL of freezing buffer and transfer the\n        suspension to a 1.5 mL tube.\n        \nCount nuclei using trypan blue.\nSpin down samples for 5 min at 500 × g (4°C).\n            Resuspend the nuclei in freezing buffer to reach a concentration of\n            5 × 106 nuclei per 100 μL of buffer.\n          \nAliquot 100 μL into 1.5 mL tubes and keep them on ice.\nPause point: Here you can STOP and\n      freeze nuclei aliquots at −80°C OR proceed to the run-on reactions.\n    \nNote: For each replicate, we recommend to\n      perform two run-on reactions (each with 5 × 106 nuclei). If\n      your harvest did not yield enough nuclei for two run-on reactions, you can\n      repeat the previous steps or control the efficacy of your nuclei isolation\n      by taking along cell lines with high nuclei isolation yield such as HCT116\n      and HEK293.\n    \nRun-on reactions\nTiming: 1 h\n      Here we describe the use of global run-on sequencing to identify expressed\n      or regulated lncRNAs in a cell line of interest. Compared to conventional\n      RNA-Seq, GRO-Seq captures nascent transcripts, which improves the\n      detection of less stable and lowly transcribed RNAs (including non-polyA\n      RNAs).9[href=https://www.wicell.org#bib3],10[href=https://www.wicell.org#bib4] In addition, this method\n      allows the precise mapping of transcription start sites (TSSs). This\n      feature is particularly important since current CRISPRi tools achieve best\n      transcriptional regulation when gRNAs are targeted to these regions.\n    \nPreheat a thermo-mixer to 30°C.\n        Prepare the reaction buffer according to Table 2[href=https://www.wicell.org#tbl2] and\n        preheat to 30°C.\n        table:files/protocols_protocol_3032_2.csv\nComposition of buffers for nuclei isolation.\ntable:files/protocols_protocol_3032_3.csv\nComposition of buffers for run-on reactions.\nIf you have stored the nuclei at −80°C, thaw them on ice.\n        Add 100 μL of pre-warmed reaction buffer (1× volume) to each reaction\n        tube with 100 μL of nuclei and keep tubes at 20°C.",
    "Cut off the tip of a 200 μL pipette tip (the mixture is very\n            viscous) and pipette up and down each reaction mixture. Change the\n            tip between each sample to avoid contamination. Pipette carefully to\n            avoid air bubbles.\n          \nIncubate samples for 5 min at 30°C.\n            Pipette the reaction mixtures up and down (using cutoff tips) after\n            2–3 min of incubation, while keeping the samples at 30°C. Pipette\n            gently and avoid making air bubbles.\n          \n        Add 600 μL (3× volume) of Trizol LS to each reaction tube and mix\n        samples by vortexing.\n        \nIncubate samples for 5 min at 20°C.\nPause point: You can STOP here and\n      store samples at −80°C, according to the manufacturer’s recommendations OR\n      proceed with the RNA purification.\n    \nRNA purification and capture of nascent transcripts\nTiming: 7–12 h over 3 days\n    \nDay 1\nTiming: 2–3 h\n      Here we detail the methods used to purify nascent RNAs and prepare\n      sequencing libraries.\n    \nPre-cool a tabletop centrifuge to 4°C.\n        Add 160 μL of chloroform to each sample.\n        \nVortex samples for 15 s and incubate for 3 min at 20°C.\nCentrifuge samples for 15 min at 12000 × g (4°C).\n            Transfer 400 μL of the aqueous phase (top) into a 1.5 mL collection\n            tube. We recommend transferring 2 × 200 μl (using 200 μl tips) to\n            avoid potential contamination with the interphase.\n          \nDiscard tubes with the bottom phase.\n        Add 400 μL (1× volume) of acid phenol-chloroform to each sample.\n        \nVortex samples for 30 s.\nCentrifuge the tubes for 10 min at 12000 × g (4°C).\n            Transfer 300 μL of the aqueous phase (top) to a new collection tube.\n          \nDiscard the tubes with the bottom phase.\n        Add 300 μL (1× volume) of chloroform to each sample.\n        \nVortex samples for 30 s.\nCentrifuge samples for 10 min at 12000 × g (4°C).",
    "Transfer 250 μL of the aqueous phase (top) to a new collection tube.\n          \n            Combine 2 run-on reactions per sample into one tube (total of\n            500 μL).\n          \nDiscard tubes with the bottom phase.\n        Add 2 μL Glyco Blue to each sample.\n        \nVortex vigorously for 10 s.\n        Add 350 μL (0.7 x volume) of isopropanol to each tube.\n        \nVortex vigorously for 15 s.\nIncubate samples 14–18 h at −20°C.\n        Prepare buffers as detailed in Table 3[href=https://www.wicell.org#tbl3].\n        table:files/protocols_protocol_3032_4.csv\n          Composition of buffers to prepare anti-BrdU beads.\n        \n        To prepare anti-BrdU beads, transfer 60 μL (for each sample) of the bead\n        solution into a 1.5 mL tube.\n        \nSpin down the beads for 30 s at 500 × g.\nCarefully remove the supernatant.\nAdd 800 μL of bead blocking buffer per tube.\n            Spin down the beads for 30 s at 500 × g and remove the supernatant.\n          \nRepeat step 21.\n        Resuspend the bead pellet in 1 mL of bead blocking buffer.\n        \nAdd BSA to a final concentration of 1 mg/mL.\nIncubate the beads on a rotator for 14–18 h (4°C).\nDay 2\nTiming: 3–5 h\nNote: To minimize the loss of RNA, use low\n      binding 1.5 mL collection tubes for the following steps.\n    \nPre-cool a tabletop centrifuge to 4°C.\n        Spin down the BSA-blocked beads for 30 s at 500 × g.\n        \nRemove the supernatant.\nResuspend each bead pellet in 500 μL of bead binding buffer.\n        Centrifuge RNA samples for 30 min at maximum speed (4°C). A small blue\n        pellet should be visible after the centrifugation step.\n        \nRemove the supernatant without disturbing the pellet.\n        Add 800 μL of 75% ethanol to each RNA pellet and vortex the samples for\n        5 s.\n        \nSpin down samples for 5 min at maximum speed (4°C).\n            Remove the supernatant and let the pellets dry with an open lid on\n            the bench.",
    "Remove residual traces of liquid by carefully flicking the tube.\n          \nNote: Make sure that the pellet is\n      completely dry before adding H2O.\n    \n        Add 100 μL of H2O (supplemented with RNase inhibitor) to each\n        pellet and put the samples on ice.\n      \nNote: We use SUPERaseIN RNase inhibitor at\n      a concentration of 20 U in 10 mL of H2O. You can use similar\n      products at a comparable concentration.\n    \nPreheat a thermo-mixer to 70°C.\n        Dissolve RNA pellets for 5 min on ice, and carefully pipette up and down\n        each sample.\n      \nIncubate samples for 5 min at 70°C.\n        Quickly transfer samples on ice and incubate for 2 min.\n        \n            Spin down samples for 5–10 s to collect all liquid at the bottom.\n          \n        Transfer each RNA sample (100 μL) to previously prepared tube containing\n        blocked anti-BrdU beads, and mix carefully by pipetting (total volume\n        ∼600 μL).\n        \nIncubate samples on a rotor for 2 h at 4°C.\n        During this incubation time, prepare the Low-salt, High-salt,\n        Tris-EDTA-Tween and Elution buffer (without DTT), as specified in\n        Table 4[href=https://www.wicell.org#tbl4].\n        table:files/protocols_protocol_3032_5.csv\n          Composition of buffers to purify and capture nascent RNA transcripts.\n        \n        Pre-chill the Low-salt, High-salt and Tris-EDTA-Tween buffers on ice.\n      \nKeep the Elution buffer at 20°C and add DTT just before use.\nNote: You can prepare buffers before\n      performing this protocol. However, Tween20-containing buffers should be\n      kept in the dark, and RNase-inhibitors as well as DTT should be freshly\n      added before use.\n    \n        Spin down the beads for 30 s at 500 × g.\n        \n            Carefully remove the supernatant without disturbing the pellet.\n          \n        Start the washing steps by adding 500 μL of Low-salt buffer per sample,\n        and place tubes on a rotator for 5 min at 20°C.\n        \n            Spin down samples for 30 s at 500 × g and remove the\n            supernatant.\n          \nRepeat step 38.",
    "Add 500 μL of High salt buffer per sample, and place tubes on a rotator\n        for 5 min at 20°C.\n        \n            Spin down samples for 30 s at 500 × g and remove the\n            supernatant.\n          \nRepeat step 39.\n        Add 500 μL of Tris-EDTA-Tween buffer per sample, and place tubes on a\n        rotator for 5 min at 20°C.\n        \n            Spin down samples for 30 s at 500 × g and remove the\n            supernatant.\n          \nRepeat step 40.\nAdd DTT to the Elution buffer and keep at 20°C.\nPrepare low binding tubes for the elution step.\n        Add 150 μL of Elution buffer to each sample and incubate on a rotator\n        for 5 min at 20°C.\n        \nSpin down samples for 30 s at 500 × g.\nTransfer each eluate to a low binding tube.\n            Repeat the elution (step 43) two more times and combine eluates of\n            the same sample (total volume ∼450 μL).\n          \nPre-chill a tabletop centrifuge to 4°C.\n        Add 500 μL of acid phenol-chloroform to each sample.\n        \nVortex samples for 30 s.\nCentrifuge samples for 5 min at 12000 × g (4°C).\n            Transfer 400 μL of the aqueous phase (top) to a new low binding\n            collection tube.\n          \nDiscard tubes containing the bottom phase.\n        Add 400 μL (1× volume) of chloroform.\n        \nVortex samples for 30 s.\nCentrifuge samples for 5 min at 12000 × g (4°C).\n            Transfer 400 μL of the aqueous phase (top) to a new low binding\n            collection tube.\n          \nDiscard tubes containing the bottom phase.\n        Add 1 μL of Glyco Blue to each sample.\n        \nVortex vigorously for 10 s.\nNote: Here we use less Glycogen as\n      compared to the previous steps to avoid inhibition of the reverse\n      transcriptase.\n    \n        Add 1100 μL (2–3× volume) of 100% ethanol per sample.\n        \nVortex vigorously for 15 s.\nIncubate samples for 14–18 h at −20°C.\nDay 3",
    "Timing: 2–4 h\nPre-chill a tabletop centrifuge to 4°C.\n        Spin samples for 30 min at maximum speed (4°C).\n        \nRemove the supernatant.\nDry pellets and remove residual liquid around the pellet.\nNote: You should see a small, light blue\n      pellet. If there is no pellet visible, the yield is probably too low to\n      continue.\n    \n        Carefully add 6 μL of H2O (supplemented with 1 μL of\n        SUPERaseIN per 10 mL) to each pellet and incubate tubes for 2 min on\n        ice.\n        \n            Vortex samples and spin down to collect the liquid at the bottom.\n          \nKeep samples on ice.\nNote: It is recommended to run a small\n      amount of each RNA sample (0.8 μL) on a Bioanalyzer instrument (Agilent)\n      to visually inspect the quality of the run-on, before proceeding to the\n      sequencing library preparation. An example of two run-on reactions\n      analyzed with a Bioanalyzer (Eukaryote Total RNA, RNA 6000 Pico Chip) are\n      shown in Figures 2[href=https://www.wicell.org#fig2]C and 2D. To avoid RNA degradation,\n      we recommend proceeding immediately to the 1st strand synthesis\n      step.\n    \n        Proceed with the preparation of the sequencing library according to the\n        manufacturer’s manual.\n      \nNote: We generated the libraries for\n      sequencing using the TruSeq Stranded mRNA Library Prep Kit (Illumina).\n      Using a stranded sequencing kit is essential to determine strand-specific\n      transcriptional activities. Moreover, we quantified libraries with the\n      NEBNext Library Quant Kit (New England Biolabs). Barcoded samples were\n      pooled equimolarly and sequenced on the Illumina HiSeq4000 platform\n      (single-end 50 bp reads).\n    \nAnalysis of GRO-Seq and generation of output matrices\nTiming: 2–3 h per sample\n    \n      In this section, we process the GRO-Seq data to identify expressed or\n      differentially regulated genes.\n      Troubleshooting 2[href=https://www.wicell.org#troubleshooting] &\n      Troubleshooting 3[href=https://www.wicell.org#troubleshooting].\n    \nCritical: The analysis was executed\n      and tested on an Ubuntu (version 20.04) virtual environment via Windows\n      Subsystem for Linux (WSL[href=https://learn.microsoft.com/en-us/windows/wsl/install], version 1).",
    "Before you start: Download the output files from the GRO-Seq and\n      install python[href=https://www.python.org/]. Using a package\n      manager like\n      anaconda[href=https://www.anaconda.com/products/distribution] with\n      useful pre-installed packages (including jupyter notebook) is highly\n      recommended. Create a new directory called “CRISPRi” for all the data\n      ($DIR from now on). Download the “Cleanup and guide picking.html”,\n      “Ordered csv.html”, and “Merge files.html” files (Supplementary files) and\n      place them in the CRISPRi folder.\n    \n        In order to identify low quality regions in the generated reads, install\n        and run the tool FastQC.\n      \nNote: In general, reads classified with a\n      green flag are high-quality reads and will be used for the GRO-seq\n      analysis. In some cases, the reads classified with yellow flags require\n      further attention. In particular, rRNA contamination and other quality\n      issues should be analyzed, and if the quality of the reads is too low,\n      re-sequencing is necessary.\n    \n        To remove low-quality sequences identified in the previous step,\n        download and install the tool Trimmomatic.5[href=https://www.wicell.org#bib5]\nNote: The command line code used in this\n      step will depend on the issue identified by the FASTQC tool. Therefore, we\n      recommend to carefully read the documentation of Trimmomatic and correct\n      the reads accordingly.\n    \n        To map high-quality reads to the human reference genome with the STAR\n        aligner tool,2[href=https://www.wicell.org#bib6] download necessary files\n        to generate the reference genome:\n      \n$ wget\nhttps://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_XX/GRCh38.primary_assembly.genome.fa.gz.[href=https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_XX/GRCh38.primary_assembly.genome.fa.gz]\n$ wget\nhttps://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_XX/gencode.vXX.long_noncoding_RNAs.gtf.gz[href=https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_XX/gencode.vXX.long_noncoding_RNAs.gtf.gz].\n      \nGenerate the reference genome.\n$ STAR --runThreadN 12 \\ --runMode genomeGenerate \\ --genomeDir\n          GRCh38_star_index \\ --genomeFastaFiles\n          GRCh38.primary_assembly.genome.fa \\ --sjdbGTFfile\n          gencode.vXX.long_noncoding_RNAs.gtf \\ --sjdbOverhang 149\nNote: Here, we generate a genome with\n      lncRNA annotations only. If you would like to analyze coding genes as\n      well, repeat steps 55 and 56 with protein coding annotation files, which\n      will generate a protein coding reference genome.\n    \n        Align reads to the reference genome and generate a bam file containing\n        all mapped reads as output.\n        Troubleshooting 1[href=https://www.wicell.org#troubleshooting].",
    "$ STAR --runThreadN 12 \\ --readFilesIn ath_seed_sample.fastq \\\n          --genomeDir ath_star_index \\ --outSAMtype BAM SortedByCoordinate \\\n          --outFileNamePrefix seed_sample \\ --outSAMunmapped Within \\\n          --outWigType wiggle\n        Download and install the tool NRSA (Nascent RNA Sequencing Analysis)\n        available on:\n        https://github.com/vermeulenlab/lncRNA/[href=https://github.com/vermeulenlab/lncRNA/].\n      \nNote: The NRSA_guide.txt file includes\n      information about the download and installation of the NRSA tool. The NRSA\n      perl scripts Pause_PROseq.pl will be used for calculating the differential\n      expression of expressed genes. The NRSA contains processed reference files\n      from various organisms. In this protocol, we are using the processed\n      version of the GRC38 reference files which are the same files used for\n      mapping the GRO-seq reads. Ensure that the version of the genome used by\n      NRSA is consistent with the one to which the reads were aligned to in the\n      previous step.\n    \n        To generate output files, execute the following steps sequentially.\n      \nNote: In this example, the mapped reads\n      from two different conditions were named 'condition1.bam' and\n      'condition2.bam'. In the case of multiple BAM files corresponding\n      to different replicates, all BAM files should be added and separated by a\n      space (e.g. -in1 condition1_rep1.bam condition1_rep2.bam -in2\n      conditions2_rep1.bam condition2_rep2.bam).\n    \n$ perl ./bin/pause_PROseq.pl -o ./pause_out/ -in1\n          ./data/condition1.bam ./data/condition2.bam -in2 ./data/condition2.bam\n          -m GRCh38\n$ perl ./bin/eRNA.pl -w ./pause_out/ -in1 ./data/condition1.bam\n          ./dat/condition2.bam -in2 ./data/condition2.bam -m GRCh38\n        Obtain the output files gb_change.txt, which contain transcriptional\n        changes of genes .\n      \nNote: These output files can be imported\n      into R, Python, and Microsoft Excel for further analysis. Depending on\n      your experimental design, different cutoffs such as minimum read coverages\n      or specific fold changes (control vs treatment) can be used to define a\n      list of candidate lncRNAs.\n    \nVisualizing expression data and defining target regions\nTiming: 10–20 min per file\n    \nTiming: 2–10 min per candidate\n    \n      Here, we briefly outline the steps to visualize custom expression data on",
    "the UCSC genome browser. We further detail how to define and target\n      genomic regions of interest.\n    \nNote: Hereafter, we only briefly describe\n      the generation of custom expression data tracks on the UCSC genome\n      browser. Detailed documentation can be found in the\n      User's Guide[href=https://genome.ucsc.edu/goldenPath/help/hgTracksHelp.html#CustomTracks]. Alternatively, the protocol using bigWig files can be found\n      here[href=https://genome.ucsc.edu/goldenPath/help/bigWig.html].\n    \n        Remove any “track” or “browser” lines from your .wig files output\n        obtained in the previous step.\n      \n        Generate bigWig files from your .wig files using the binary utilities\n        fetchChromSizes and wigToBigWig from the UCSC utilities.\n      \n        Host the bigWig files on a http(s) or ftp accessible location (e.g.,\n        github).\n      \n        Generate the tracks with the UCSC protocol for bigWig files linked\n        above.\n      \nNote: Here, we describe how to select\n      genomic regions of interest for efficient silencing with the CRISPRi\n      system.\n    \n        Open the output matrix obtained from the GRO-Seq data, and use the\n        ENSEMBL gene-IDs to visualize the regions on your UCSC track. A visual\n        example is depicted in Figure 3[href=https://www.wicell.org#fig3].\n        \nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3032-Fig3.jpg\n              Figure 3. Visualization of GRO-seq data with the UCSC genome\n              browser\n            \n              UCSC genome browser screenshot showing lncRNA transcripts\n              (green\\blue annotations) and sequencing tracks of 2 cell lines\n              (track 1 and 2). Read coverage on the sense (red) and antisense\n              (blue) strands are shown as separate tracks. The presence of\n              H3K27Ac (transcriptionally active chromatin) is also displayed.\n              Important features to select the region of interest are\n              highlighted; transcription start site peaks (green box),\n              transcript annotations (black box), and repeat sequences (orange\n              box).\n            \n        Zoom in on the TSS region and define a 400 nucleotides (nts) stretch by\n        selecting 50 nts upstream and 350 nts downstream of the transcription\n        initiation signal. An example is shown in Figure 4[href=https://www.wicell.org#fig4].\n        \nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3032-Fig4.jpg\n              Figure 4. Defining and retrieving target sequences\n            \n              (A) Zoomed in view showing the selection of a genomic region",
    "encompassing 50 nucleotides before and 350 nucleotides after the\n              transcription start site. The ”View” button is highlighted in\n              green.\n            \n              (B) The ”View” dropdown menu, with the correct DNA option\n              selected.\n            \nNote: In Figure 3[href=https://www.wicell.org#fig3], the\n      displayed transcript is encoded on the sense strand (red). The TSS can be\n      defined by locating the beginning of the read coverage for your gene of\n      interest. While annotations can help to pinpoint a region, significant\n      variations can be observed between previously annotated and observed TSS\n      in your specific cell system. When annotations and GRO-seq reads are not\n      perfectly aligned, we recommend to use your sequencing reads to determine\n      the TSS. In addition, most TSSs will also display some transcription\n      (initiation peak) on the opposite strand (here: blue), which is helpful to\n      pinpoint the right region.\n    \n        Following the “Zoom in” on the region of interest, the DNA sequence is\n        retrieved by clicking on “View” and “DNA” (highlighted).\n        \n            On the new page, check the boxes “Mask repeats” and “to N”, prior to\n            retrieving your DNA sequence by clicking “get DNA”.\n          \n        Copy the sequence and paste it in a new Notepad file, name it according\n        to the ENSEMBL Gene-ID as “ENSG00000XXXXXX.txt” and save it in the\n        CRISPRi folder. It is imperative to save all the sequences separately to\n        properly run the guide design package.\n      \nNote: Following these steps, you will have\n      a CRISPRi folder filled with .txt files of all candidate TSS sequences\n      (−50 nts to +350 nts = 400 nt total), named by their ENSEMBL Gene-IDs.\n    \nCRISPRi screen\nDesign gRNAs\nTiming: 2–3 h to prepare the\n      packages/files and 5–15 min for the design of gRNAs (per candidate)\n    \n      Here we describe the design of guide RNAs (gRNAs) to epigenetically block\n      the transcription of selected genomic regions using CRISPRi.\n      Troubleshooting 2[href=https://www.wicell.org#troubleshooting] &\n      Troubleshooting 3[href=https://www.wicell.org#troubleshooting].",
    "Download a human genome file by opening up a new terminal window and\n        running:\n      \ncd $DIR\nsudo wget\nhttp://hgdownload.soe.ucsc.edu/goldenPath/hg38/bigZips/hg38.fa.gz[href=http://hgdownload.soe.ucsc.edu/goldenPath/hg38/bigZips/hg38.fa.gz].http://hgdownload.soe.ucsc.edu/goldenPath/hg38/bigZips/hg38.fa.gz[href=http://hgdownload.soe.ucsc.edu/goldenPath/hg38/bigZips/hg38.fa.gz]\nNote: We recommend using hg38 (from\n      ENSEMBL) as reference genome and\n      bowtie[href=https://bowtie-bio.sourceforge.net/manual.shtml] to\n      create an index. To design gRNAs and assess their specificity to one\n      genomic region, we use CCTop4[href=https://www.wicell.org#bib8],11[href=https://www.wicell.org#bib7] and BLAT, respectively.\n    \n        Unpack the archive to get the file “hg38.fa”. Then, we install all the\n        packages via the terminal, starting with bowtie:\n      \nsudo gunzip hg38.fa.gz\nsudo apt-get install -y bowtie\nThen, to install CCTop, run:\npip install CCTop.\n        The installation of BLAT is slightly complex and uses a C compiler to\n        make and make install the packages. If you don’t have an\n        existing C compiler on your computer, run:\n      \nsudo apt install build-essential.\nDownload and install a library that BLAT uses:\nwget\nhttp://downloads.sourceforge.net/project/libpng/libpng16/older-releases/1.6.2/libpng-1.6.2.tar.gz[href=http://downloads.sourceforge.net/project/libpng/libpng16/older-releases/1.6.2/libpng-1.6.2.tar.gz]\ntar -xvzf libpng-1.6.2.tar.gz\ncd libpng-1.6.2\n./configure\nmake\nsudo make install\n        Go back to $DIR, download the BLAT source code archive, unpack it, and\n        move all the library files to the /lib/ folder within the BLAT folder:\n      \ncd ..\nwget\nhttp://users.soe.ucsc.edu/∼kent/src/blatSrc.zip[href=http://users.soe.ucsc.edu/%7Ekent/src/blatSrc.zip]\nunzip blatSrc.zip\ncp ./libpng-1.6.2/png.h ./blatSrc/lib/\ncp ./libpng-1.6.2/pngconf.h ./blatSrc/lib/\ncp ./libpng-1.6.2/pnglibconf.h ./blatSrc/lib/\n        Finally, you have to configure some variables to allow BLAT to run from\n        the terminal:\n      \necho $MACHTYPE\nMACHTYPE=x86_64\nexport MACHTYPE\nsudo mkdir -p ∼/bin/$MACHTYPE\nmake\necho 'export MACHTYPE=x86_64' >> ∼/.bashrc\necho 'export PATH=$PATH:∼/bin/$MACHTYPE' >>\n          ∼/.bashrc\nsource ∼/.bashrc\nRun BLAT from the terminal by typing blat in the terminal.\n        Open the “.profile” file in your /home/username/ directory in\n        notepad and add the following line at the end to ensure you can always\n        use blat from the terminal, and use bash loops:\n      \nexport PATH=$PATH:∼/bin/$MACHTYPE\n        Create a bowtie index file from the human genome for CCTop. This should\n        output multiple .ebwt files. Execute the following code in $DIR:\n      \nbowtie-build -r -f hg38.fa human",
    "Run CCTop to design CRISPRi gRNAs on one of our candidate sequences\n        (“$FILE.txt”):\n      \ncctop --input $FILE.txt --targetSize 19 --index human\nYou can also run all the files automatically by running:\nfor SAMPLE in ∗.txt; do cctop --input ${SAMPLE} --targetSize 19\n          --index human; done\n        The output should consist of 3 files per input candidate: a .bed file\n        with gRNA locations along your input sequence, a .fasta file with all\n        designed gRNA sequences, and a .xls file with extra information,\n        including the CRISPRater score for each gRNA.\n      \n        Create new directories for the different output files and move all files\n        to these directories. In addition, the hg38.fa file is required for BLAT\n        and should therefore be moved to the fasta folder as well:\n      \nsudo mkdir fasta\nsudo mkdir xls\nsudo mv ∗.fasta ./fasta\nsudo mv ∗.xls ./xls\nsudo mv hg38.fa ./fasta\nNote: We highly recommend to create a\n      11.ooc file before running BLAT, as it will significantly speed up your\n      query. If you want to do so, run:\n    \ncd fasta\nblat hg38.fa /dev/null/ /dev/null/ -makeOoc=hg38.fa.11.ooc\n          -repMatch=1024\n        Blat all files by making a new output directory and by running:\n        \nsudo mkdir Blat\nfor i in ∗\".fasta\"; do echo \"{$i}\";\n              name=${i%%.fasta}; blat hg38.fa \"${i}\"\n              -ooc=hg38.fa.11.ooc -minIdentity=90 -minScore=15 -minMatch=1\n              -oneOff=1 -out=blast8 ./Blat/\"${name}\".psl; done\n            This should generate a .psl file, which includes all gRNAs targeting\n            a specific candidate region. Every file will be named according to\n            their specific ENSEMBL gene-ID.\n            \nNote: We recommend to covert the\n              .xls output file into a .csv file, which facilitates subsequent\n              steps in python. To this end, we use the libreoffice-calc package\n              from the terminal.\n            \nInstall the libreoffice-calc package if necessary.\nsudo apt install libreoffice-common\nsudo apt install libreoffice-calc\n        Convert the .xls files to .csv from the “xls” folder, and move them back\n        to the main directory.",
    "Note: libreoffice can only handle 250\n      files at a time, so if you have more candidates, move them to separate\n      folders and execute the code in that folder.\n    \nContinue from step 83:\ncd ..\ncd xls\nlibreoffice --headless --convert-to csv ∗.xls\nsudo mv ∗.csv ..\n(If running from separate folders for >250 candidates, use sudo mv\n          ∗.csv ../..)\nNote: To rearrange the .csv file, we\n      recommend to create a folder called “Clean”, and open the “Ordered\n      csv.html” file. Execute this code in jupyter notebook, and make sure to\n      substitute all the correct file paths (“./” is the current directory of\n      the .ipynb file).\n    \nStart jupyter notebook by running the following from $DIR:\njupyter notebook\nNote: If you are running Ubuntu via WSL,\n      add the command --no-browser.\n    \n        Now you should have an organized .csv file in the “Clean” folder for\n        every candidate, as well as a BLAT .psl file in the “fasta/Blat/”\n        folder.\n      \n        Create a new folder called “Final” in the CRISPRi main folder and run\n        the code from “Cleanup and guide picking.html” in jupyter notebook.\n      \nNote: Make sure to substitute all the\n      correct file paths and to adapt the “preseq” and ”postseq” variables\n      according to the homology arm sequences present in your selected gRNA\n      vector.\n    \n      The end result is the “Merged.csv” file, containing all selected gRNA\n      sequences, both with and without homology arms (“OrderSeq”).\n    \nStable genomic integration of KRAB-dCas9\nTiming: 5 days\n      Here we describe the transduction of cell lines to stably integrate an\n      inducible CRISPRi system. In this protocol, we use an inducible KRAB-dCas9\n      system or the TRE-KRAB-dCas9-IRES-BFP plasmid (Addgene #85449). This\n      construct allows for dox-dependent expression of KRAB-dCas9 and BFP, which\n      enables a more controlled setting as compared to constitutively active\n      promoters. The dox-dependent induction of KRAB-dCas9 and BFP requires the\n      co-expression of the reverse tetracycline transcriptional activator",
    "(rtTA). Stable integration and constitutive expression of rtTA is achieved\n      using pHR-EF1Alpha-Tet-on 3G (Plasmid #118592). Cell populations that\n      properly induce KRAB-dCas9/BFP (cells co-transduced with KRAB-dCas9/BFP\n      and rtTA) are enriched by FACS sorting. For an overview of all preparatory\n      steps, see Figure 6[href=https://www.wicell.org#fig6]A.\n    \nCritical: This protocol assumes a\n      basic understanding of the production of lentiviral particles (and\n      associated biosafety procedures) and 2D cell culturing. A general protocol\n      to generate lentiviral particles can be obtained\n      here[href=https://www.addgene.org/protocols/lentivirus-production/].\n    \nDay 1\nTiming: 1 h\n        Split cells of interest and seed approximately 4–6 x105 cells\n        (∼70%–80% confluent) in 1 mL of medium per well of a 6-well plate.\n      \nNote: The amount of cells depends on the\n      growth rate and size of your cells.\n    \n        Thaw the pre-generated viruses (filtered 0.45 μm) OR harvest fresh\n        lentiviruses containing KRAB-dCas9/BFP and rtTA.\n        \n            Add 1 mL of virus to the cell suspension and polybrene at a final\n            concentration of 4 μg/mL.\n          \nCentrifuge the plate for 30 min at 500 × g (32°C).\n            Place the plate in a cell culture incubator for 14–18 h at 37°C.\n          \nNote: In our experience, using 1mL of\n      lentiviral supernatant (not concentrated) is sufficient to obtain a\n      transduction efficiency that ranges between 1% and 10%. However,\n      concentrating lentiviral supernatants may be necessary to efficiently\n      co-transduce certain cell types.\n    \nDay 2\nTiming: 30 min\nRefresh the medium.\nDay 3–5\nTiming: 30 min\n        Transfer cells into a bigger vessel when the confluency reaches >90%.\n      \n        Maintain and expand cells at an appropriate confluence in at least 2\n        separate cell culture vessels.\n      \nEnriching cells harboring the inducible CRISPRi system\nTiming: Several weeks\n    \n      This section describes the selection of transduced cells by fluorescence\n      activated cell sorting (FACS). Cells co-transduced with\n      TRE-KRAB-dCas9-IRES-BFP plasmid (Addgene #85449) and EF1Alpha-Tet-on 3G\n      (Plasmid #118592) are dox-treated and BFP+ cells are sorted. To gradually",
    "enrich cells that properly induce KRAB-dCas9/BFP, multiple FACS sorting\n      cycles are required. In each cycle, cells are dox-treated, FACS sorted\n      (BFP positive cells sorted) and cells expanded (without dox). Enrichment\n      cycles are performed until the vast majority of cells (>95%) can induce\n      the BFP expression in a dox-dependent manner. In addition, leaky cells can\n      be removed by sorting out BFP positive cells in absence of dox.\n    \nNote: Our experimental setup uses a\n      construct that allows the selection of cells by a fluorescent marker.\n      Other constructs may contain distinct selection markers and may require a\n      different selection approach.\n    \nDay 6\nTiming: 5 min\n        Add dox to the culture medium (final conc. 1 μg/mL).\n        \n            Incubate the cultures at least 24h to induce the BFP expression.\n          \n            Keep one cell culture vessel without dox to use as control sample\n            for the FACS.\n          \nNote: In this protocol, we use 1 μg/mL of\n      dox in the culture medium to induce the CRISPRi system. However, different\n      cell lines may show different sensitivity to doxycycline, which may\n      require titration experiments to establish ideal experimental conditions.\n    \nDay 7\nTiming: 2–3 h\n        Trypsinize and collect cells into a 15 mL tube.\n        \nSpin down for 5 min at 500 × g.\n            Remove the supernatant and resuspend the cell pellet in 1–2 mL of\n            medium (depending on pellet size).\n          \n            Prepare a 15 mL collection tube for sorting with 2 mL of medium.\n          \nNote: In this protocol, we performed cell\n      sorting using the SH800 Cell Sorter (Sony). Settings may differ if other\n      cell lines and other FACS machines are used. An untreated control sample\n      (no dox) is essential to properly gate BFP+ cells.\n    \n        Determine the gating. An exemplary gating strategy is depicted in\n        Figures 5[href=https://www.wicell.org#fig5]B–5F.\n        \nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3032-Fig5.jpg\n              Figure 5. Generation of dox-inducible KRAB-dCas9-BFP cells\n            \n              (A–F) (A) Schematic illustrating steps to generate CRISPRi cell",
    "line using FACS sorting. Gating strategy is shown in (B) and (C).\n              Enrichment of BFP+ cells (dark blue) following 1 (D), 3 (E) and 8\n              (F) sorting cycles. Uninduced cells (light blue) were used as\n              negative control.\n            \n            To gate living cells, use the forward (FSC) and backward scatter\n            (BSC, equivalent to side scatter SSC) area (A).\n          \n            Select singlets by using an FSC-height and width density plot.\n          \nBFP+ cells are sorted using the 405 nm laser.\n        Sort the BFP+ cell population into the prepared collection tube.\n        \n            Transfer sorted cells back into an appropriate cell culture vessel\n            depending on the number of sorted cells.\n          \nDay 8–14\nTiming: 2–5 h\nCulture and expand the sorted cells accordingly.\nNote: Depending on the transduction\n      efficiency and proliferation rate of your cell line, dox-induction and\n      sorting steps may be performed with an alternative or better suited\n      time-schedule. Alternatively, single cell (BFP+) clone could be sorted and\n      expanded. However, molecular features of single cell clones may not\n      properly represent the complexity or heterogeneity of the initial\n      population.\n    \nDay 15-day x\nTiming: Several weeks\n    \n        Repeat steps 95 to 99 until you obtain a homogeneous population (>95%\n        BFP + cells; Figures 5[href=https://www.wicell.org#fig5]D–5F).\n      \nNote: We recommend testing the\n      functionality of your CRISPRi cell line, by targeting an essential gene.\n      This allows to validate the transcriptional repression of a target gene\n      and assess potential cellular phenotypic changes.\n    \nSetting up and performing a CRISPRi dropout screen\n      In this section we discuss how to perform a CRISPRi-based dropout screen\n      with adherent cells. An overview of the CRISPRi-dropout screen is shown in\n      Figure 6[href=https://www.wicell.org#fig6].\n    \nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3032-Fig6.jpg\n          Figure 6. CRISPRi dropout screen layout\n        \n          The cartoon shows key steps required to perform a CRISPRi dropout\n          screen. Following the transduction of a gRNA library in a CRISPRi cell",
    "line (KRAB-dcas9 BFP cells), cells are treated or not with dox and\n          collected at various time points (d0, T1 and T2). Sequencing is\n          performed to evaluate the relative abundance of each gRNA across\n          collected samples.\n        \n      The gRNA library is first cloned into a suited backbone vector, which\n      allows for the generation of lentiviral particles. Then, cells containing\n      the inducible KRAB-dCas9-BFP are transduced with lentiviral particles\n      containing the gRNAs. This should be performed at a low MOI to minimize\n      the presence of multiple integrations per cell. This section describes the\n      titration to obtain a low MOI.\n    \nCritical: This section assumes a basic\n      understanding of cloning. We followed the protocol by Wang et al.12[href=https://www.wicell.org#bib9]\n      to clone our gRNA library into a vector backbone and do not further\n      describe these steps here nor are these considered in the estimated\n      timing. We assume a general understanding of lentiviral particles\n      production (and associated safety procedures) and 2D cell culturing.\n      Troubleshooting 4[href=https://www.wicell.org#troubleshooting].\n    \nNote: We used the pDECKO-mCherry backbone\n      (Addgene #78534) to clone our gRNA library, a vector that contains the\n      mCherry fluorescent protein as well as a puromycin resistance gene for\n      selection. We use the live cell labeling with mCherry to evaluate the\n      transduction efficiency by flow cytometry and to adjust the conditions\n      (e.g., cell density and amount of virus) to obtain a low MOI. Then, we\n      select transduced cells by adding puromycin. Selection of cancer cell\n      lines is usually completed within 2 weeks. We highly recommend using both\n      the antibiotic-based selection as well as a fluorescent marker to easily\n      control and complete these steps. Prior to transduce CRISPRi cell lines,\n      the pDECKO-gRNA library DNA preparation can be PCR amplified (see section\n      “Preparing sequencing libraries”) and sequenced to validate the presence\n      of each gRNA (optional).\n    \nDay 1\nTiming: 1 h",
    "Harvest cell cultures and seed 5 × 106 cells per T75 flask.\n        \nPrepare at least 4 flasks.\nKeep one without virus as control.\nThaw pre-generated virus.\nNote: Number of cells may vary depending\n      on the features (e.g., size and proliferation) of your cells of interest.\n      In general, 70%–80% seeding confluency will yield robust and reproducible\n      results. We usually generate a big volume of viral particles containing\n      the gRNA library to avoid multiple titrations and minimize possible batch\n      effects. We filter, aliquot and store the virus suspension at −80°C.\n      Lentiviral particles can be stored several months without significant\n      impacts on the transduction efficiency.\n    \n        Add different amounts of virus per flask, e.g., 100, 400 and 800 μL of\n        virus.\n      \nAdd polybrene at a concentration of 4 μg/mL to each flask.\nPlace the flasks for 14–18 h at 37°C in a cell culture incubator.\nDay 2\nTiming: 30 min\nRefresh the medium.\nDay 3\nTiming: 2–3 h\n        Harvest and collect cells in tubes suited for flow cytometry analysis.\n      \nNote: We acquire the samples on the SH800\n      Cell Sorter (Sony) to assess transduction efficiencies. Settings may\n      differ if other cell lines, plasmids and FACS machines are used.\n    \n        Setup the gating strategy as mentioned in step 97.\n        \n            Visualize mCherry+ cells by using the 561 nm laser. An untransduced\n            control sample is required to properly gate mCherry+ cells.\n          \n            Examples of transduction efficiencies following the incubation of\n            CRISPRi-engineered cells with an increasing number of lentiviral\n            particles harboring the gRNA library (mCherry+) is shown in\n            Figure 7[href=https://www.wicell.org#fig7].\n            Troubleshooting 7[href=https://www.wicell.org#troubleshooting].\n            \nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3032-Fig7.jpg\n                  Figure 7. Titration of viral particles harboring the gRNA\n                  library\n                \n                  CRISPRi-engineered cells were either untransduced (ctrl) or\n                  transduced with an increasing amount of lentiviral particles\n                  (100, 400 and 800 μl). The transduction efficiency (percentage\n                  of mCherry+ cells) is displayed for each condition by plotting",
    "the mCherry signal (x-axis) against the BrilliantViolet signal\n                  (y-axis).\n                \nTransduction and selection of the gRNA library\n      Here we detail the steps leading to the transduction and selection of\n      cells harboring the gRNA library.\n    \n      The library is transduced with low MOI (<0.5) and cells are selected\n      with the appropriate marker (e.g., Puromycin or Blasticidin). The screen\n      is usually initiated with a gRNA coverage of 500× (e.g., 1,000 gRNA\n      library requires >500,000 cells) for each replicate and in presence or\n      absence of dox. We recommend harvesting several time points to follow\n      dropouts over time.\n    \nCritical: To ensure a good\n      representation of each gRNA, we usually transduce the cells of interest\n      with a 200× coverage. Screens can also be initiated with a coverage of at\n      least 200×. However, we do recommend using a coverage of 500× or more if\n      possible.\n    \nDay 4\nTiming: 1–2 h\n        Seed a sufficient amount of T75 flasks with each ∼5 × 106\n        cells (70%–80% confluent).\n      \nNote: The required number of flasks should\n      be determined based on the size of your library and the titration of your\n      lentiviral suspension. We usually aim to cover every gRNA 200 times with a\n      transduction efficiency varying between 1% to 10%.\n    \nThaw pre-generated virus.\n        Add an adequate amount of virus per flask to obtain a transduction\n        efficiency ranging between 1% to 10% based on previous titration (e.g.,\n        800 μL would achieve ∼5% mCherry+ cells in\n        Figure 7[href=https://www.wicell.org#fig7]).\n      \nAdd polybrene at a concentration of 4 μg/mL to each flask.\nPlace the flasks for 14–18 h at 37°C in a cell culture incubator.\nDay 5\nTiming: 30 min\nRefresh the medium.\nDay 6\nTiming: 1 h\n        Maintain and expand your cells at an appropriate confluency.\n        \n            Transfer cells into a bigger vessel when they reach confluency.\n          \nDay 7\nTiming: 1 h",
    "Start the selection of transduced cells by adding puromycin to the\n        culture medium.\n      \nNote: For CRC cell lines, we used\n      concentrations ranging between 1 and 5 μg/mL of puromycin, depending on\n      their sensitivity. Alternatively, determine the amount of puromycin needed\n      to kill untransduced cells by performing a dose-response experiment.\n      Selection of cancer cell lines is usually completed within 2 weeks.\n    \nDay 8 – X\nTiming: 1–4 weeks\n    \n        Maintain and expand the cell cultures at an appropriate confluency.\n      \n        Keep selecting cells with puromycin until the cell population is\n        color-labeled (> 95% mCherry+).\n      \nVerify the successful selection by flow cytometry.\nNote: When maintaining the cell culture,\n      it is important to preserve the complexity of the gRNA library by seeding\n      cells with at least 200× coverage.\n    \nDropout screen initiation and time point collection\nTiming: 7–30 days, depending on\n      experimental setup and harvesting time points.\n    \n      Here we describe the conditions and steps required to initiate and\n      complete a CRISPRi dropout screen.\n    \nCritical: We initiate our CRISPRi\n      screens with >500× coverage and recommend to use at least 200× for each\n      replicate. We also advise to freeze a stock of cells containing your gRNA\n      library that contains at least a 200× coverage per vial. However,\n      attention should be paid during the thawing step, as important cell death\n      may impact the complexity and therefore skew the representation of gRNAs.\n    \nNote: To monitor cell population dynamics,\n      we recommend harvesting 3 time points (e.g., 0, 12 and 20 days).\n    \nDay 1\nTiming: 1–2 h\n        Harvest all the library-transduced cells and collect them in a 50 mL\n        falcon.\n        \nCount the concentration of cells.\nNote: For better accuracy, ensure that\n      trypsinized cells are fully singularized before counting.\n    \n        For the “day 0” samples, collect in 3 different tubes (3 replicates) a",
    "number of cells corresponding to at least 200× the size of the gRNA\n        library.\n        \n            Centrifuge the cells for 5 min at 500 × g and remove the\n            supernatant.\n          \nStore cell pellets at −20°C.\n        For the screen, seed an adequate number of cells and culture vessels to\n        reach a library coverage of at least 200× for each replicate.\n        \n            Choose ideal culture vessel and cell seeding density to accommodate\n            4 days of cell expansion without reaching confluency (>95%).\n          \nNote: Depending on the size of your\n      library or properties of your cell line, it might be necessary to seed\n      cells in multiple plates per replicate. We recommend performing 3\n      replicates in parallel with and without dox to obtain a robust statistical\n      analysis of the screen.\n    \n        Add dox to a final concentration of 1 μg/mL (or use the ideal dox\n        concentration for your cell line as mentioned above) to the 3 induced\n        (+) replicates.\n        \nMaintain the other 3 replicates untreated (-).\nLabel the culture vessels appropriately.\nPlace them back in a cell culture incubator at 37°C.\nDay 3\nTiming: 10 min\n        Refresh the medium of all culture vessels.\n        \n            Add dox (1 μg/mL) to induced (+) culture vessels to maintain a\n            sufficient expression of KRAB-dCas9.\n          \nDay 5\nTiming: 2–3 h\nNote: To maintain viable conditions for\n      the cells, we replate cultures every 4 days over the course of the screen.\n    \n        Trypsinize cells.\n        \nCollect each replicate in separate and labeled 50 mL tubes.\nCount the cells.\n            Seed back cells into new culture vessels as performed in step 122.\n          \nAdd 1 μg/mL dox to the medium of induced (+) culture vessels.\n        Repeat step 124 every 2 days and step 125 every 4 days until the first\n        time point (T1) is reached.\n      \nDay X: First time point (T1)\nTiming: 2–4 h\n        To collect timepoint samples, trypsinize cells.",
    "Collect each replicate in separate and labeled 50 mL tubes.\nCount the cells.\n        For each replicate, transfer a number of cells corresponding to at least\n        200× the size of the gRNA library to a labeled 15 mL tube.\n        \nCentrifuge cells for 5 min at 500 × g.\nRemove the supernatant.\nFreeze the pellets at −80°C.\n        If another time point (TX) is harvested, seed back cells into new\n        culture vessels as performed in step 122.\n      \n        Repeat step 124 every 2 days and step 125 every 4 days until the next\n        time point (TX) is reached.\n      \nDay Y: Next time point\nPerform steps 127 to 130.\nPreparation of sequencing libraries\nTiming: 2 days\n      To prepare sequencing libraries, we PCR-amplify gRNAs (PCR1) from gDNA\n      obtained from collected samples. In a second amplification step (PCR2),\n      adapters and indices are added to perform standard Illumina multiplex\n      sequencing. PCR primers used to generate sequencing libraries are shown in\n      Table S2[href=https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3032-Mmc2.xlsx].\n    \nNote: We do not describe the steps\n      required for the library quantification. However, a detailed protocol can\n      be found online at the manufacturer’s page:\n      NEBNext® Library Quant Kit for Illumina®[href=https://www.neb.com/en/products/e7630-nebnext-library-quant-kit-for-illumina#Product%20Information].\n    \n        Extract the genomic DNA from each cell pellets with Genomic DNA\n        Purification Kit or a similar product.\n      \n        PCR-amplify gRNA sequences using PCR1 primers, which are specific to the\n        vector backbone.\n      \nNote: To properly amplify the complexity\n      of a library by PCR, each gRNA should be represented by at least 200\n      genomes (one integration per genome). Considering that the human diploid\n      genome is approximately 6.5 pg, then a library of 10,000 gRNAs requires to\n      PCR-amplify ∼13 μg of gDNA (200 × 10,000 × 6.5pg).\n    \n        PCR-amplify amplicons from PCR1 with PCR2 primers, in order to add\n        standard Illumina adapters.\n      \nNote: The second PCR is also used to add\n      indices to samples, thus allowing multiplex sequencing. For details, see",
    "Table S2[href=https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3032-Mmc2.xlsx].\n    \n        Purify amplicons obtained from PCR2 from the gel using the\n        NucleoSpin Gel & PCR Clean-up kit[href=https://www.bioke.com/webshop/mn/740609.html]\n        or similar.\n      \n        Quantify the concentration of all libraries, using the NEBNext® Library\n        Quant Kit for Illumina®.\n      \n        Dilute samples to the desired concentration (usually between 20–50 nM)\n        and pool all libraries (if multiplex sequencing is performed).\n      \nNote: To improve accuracy, we recommend an\n      initial dilution of libraries at a higher (2×) concentration (40–100nM).\n      Quantification is then repeated on the “2×” diluted samples before the\n      final dilution.\n    \nSequence all samples using next-generation sequencing.\nNote: Using single-end 50 bp sequencing\n      reads (SE50) is sufficient to retrieve your gRNA sequences. We also\n      recommend adding 5% phix and to cover each gRNA with at least 200 reads.\n    \nScreen analysis\nTiming: 30 min to install and prepare,\n      and 30–60 min per 30 million reads (for step 140)\n    \nTiming: 30–60 min per 30 million reads\n      (for step 147)\n    \n      Here we describe how to analyze the sequencing data obtained from a\n      CRISPRi dropout screen. We use the\n      MAGeCK[href=https://github.com/liulab-dfci/MAGeCK] package to\n      count the reads and\n      DESeq2[href=https://bioconductor.org/packages/release/bioc/vignettes/DESeq2/inst/doc/DESeq2.html]\n      package for subsequent analyses. Specific cutoffs and filters are also\n      applied to the data to produce a list of dropout candidates.\n      Troubleshooting 2[href=https://www.wicell.org#troubleshooting] &\n      Troubleshooting 3[href=https://www.wicell.org#troubleshooting].\n    \nCritical: The analysis is executed and\n      tested on an Ubuntu (version 20.04) virtual environment via Windows\n      Subsystem for Linux (WSL[href=https://learn.microsoft.com/en-us/windows/wsl/install], version 1).\n    \nBefore you start: Download the .fastq files generated by the\n      dropout screen, and place them in a convenient directory (“$DIR” from now\n      on). If you performed paired-end sequencing, only the forward reads (_R1\n      or similar) are necessary, therefore place the reverse reads (_R2 or\n      similar) in a separate folder in $DIR. Download and install R (The Comprehensive R Archive Network[href=https://cran.r-project.org/]\n      (r-project.org[href=https://cran.r-project.org/])) on your system.\n      We highly recommend R studio[href=https://posit.co/] for writing\n      and executing R codes.",
    "Prior to obtaining the read counts for each gRNA, adapter sequences\n      flanking the gRNA insert must be trimmed. The following steps are adapted\n      from the documentation of\n      Trimmomatic[href=https://apolo-docs.readthedocs.io/en/latest/software/applications/trimmomatic/trimmomatic-0.36/index.html].\n    \n        To install Trimmomatic, execute the following commands in a terminal\n        window:\n      \ncd $DIR\nwget\nhttp://www.usadellab.org/cms/uploads/supplementary/Trimmomatic/Trimmomatic-0.36.zip[href=http://www.usadellab.org/cms/uploads/supplementary/Trimmomatic/Trimmomatic-0.36.zip]\nunzip Trimmomatic-0.36.zip\nsudo mkdir ./Trimmed\nNote: In order to run Trimmomatic, Java\n      should be installed on your system. If Java is not present, run:\n    \nsudo apt install default-jre\nsudo update-alternatives --install \"/usr/bin/java\"\n          \"java\"\njava –version\n        Identify the gRNA flanking sequences by running the following code on\n        one of your .fastq output files (“$FILE”)\n      \ncd $DIR\nhead $FILE.fastq\nExample output:\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3032-Fx5.jpg\nNote: Adapter sequences before (yellow)\n      and after (green) the gRNA are highlighted for clarity.\n    \n        Count the length of the adapter that prepends the gRNA inserts (in this\n        case, 22 nucleotides).\n      \n        Pre-process the reads by running the following command.\n        \nReplace $FILE with your filenames\n            Replace the numbers following “-threads” and “HEADCROP:” with your\n            specific number of cores and the length of the adapter determined in\n            step 142, respectively:\n          \njava -jar ./Trimmomatic-0.39/trimmomatic-0.39.jar SE -threads 16\n          $FILE_trim.fastq ./Trimmed/$FILE_Trim.fastq HEADCROP:22 CROP:19\n        Run all the files automatically by executing a bash loop in the\n        terminal.\n      \nfor SAMPLE in ∗.fastq; do java -jar\n          ./Trimmomatic-0.39/trimmomatic-0.39.jar SE -threads 16 ${SAMPLE}.fastq\n          ./Trimmed/${SAMPLE}_Trim.fastq HEADCROP:22 CROP:19; done\nVerify successful cropping of the reads by running:\ncd ./Trimmed\nhead $FILE_Trim.fastq\nOutput:\nA00379:586:HCLLHDSX3:4:1101:14290:1000\n          1:N:0:GGTAGCATCT+TGGTCAGTGT\nCTGGCGTCCGGTGTGCAGG\n+\nFFFFFFFFFFFFFFFFFFF\n@A00379:586:HCLLHDSX3:4:1101:24035:1000\n          1:N:0:GGTAGCATCT+TGGTCAGTGT\nACAGGCCCAGCACACTCTC\n+\nFFFFFFFFFFFFFFFFFFF\n@A00379:586:HCLLHDSX3:4:1101:27941:1000\n          1:N:0:GGTAGCATCT+TGGTCAGTGT\nATCTCCATCTGCCTACCTT\nNote: The result is a cropped version,\n      containing only the guide sequence.\n    \n        Next, we use MAGeCK to count the reads. To install MAGeCK, open a new\n        terminal window and run:\n      \nsudo wget\nhttps://sourceforge.net/projects/mageck/files/0.5/mageck-0.5.9.4.tar.gz[href=https://sourceforge.net/projects/mageck/files/0.5/mageck-0.5.9.4.tar.gz]\ntar xvzf mageck-0.5.9.4.tar.gz\ncd mageck-0.5.9.4\npython setup.py install\nNote: Other packages similar to MAGeCK\n      (e.g. BAGEL13[href=https://www.wicell.org#bib10] and JACKS14[href=https://www.wicell.org#bib11]) could also be used to perform this step.",
    "Test by typing mageck in the terminal, which should output a help prompt\n        for using MAGeCK.\n      \n        Prepare the library file by opening a new excel sheet and adding three\n        columns. An example is shown in Table 5[href=https://www.wicell.org#tbl5].\n        table:files/protocols_protocol_3032_6.csv\n          Labeling: “seqID” is an identifier for the guide; “gRNAs” is the guide\n          sequence; “targetgene” is the gene targeted by the gRNA.\n        \nSave this excel sheet as a .csv in the /$DIR/Trimmed directory.\n        To count all the files, run the following command in the /$DIR/Trimmed\n        directory ($FILE is the library file.\n      \nmageck count –l $FILE.csv --fastq ∗.fastq\n        This should output multiple files, including .count.txt and\n        .count_summary.txt. Troubleshooting 5[href=https://www.wicell.org#troubleshooting].\n      \nNote: We recommend to review the counting\n      process by constructing a volcano plot from your count data (see\n      Figure 8[href=https://www.wicell.org#fig8]). It is important to verify that the negative\n      controls are not dropping out, while the positive controls are. To\n      generate volcano plots, we recommend using the R package EnhancedVolcano.\n    \nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3032-Fig8.jpg\nFigure 8. Dropout screen analysis\n          (A–C) The dropout fold changes (log2 FC) of (A) negative controls and\n          positive controls, and (B) candidate-targeting gRNAs (endpoint vs. day\n          0) are plotted against the p-value (log10 p-value). Plot (C) shows the\n          overlay of plots (A) and (B).\n        \nIdentifying dropout hits\nTiming: 1 h (for step 153)\n    \n      In this section we describe a general approach to identify potential\n      dropout hits. To this end, we compare the relative presence of each gRNA\n      in induced (+) and untreated (-) samples, using the\n      DESeq2[href=https://bioconductor.org/packages/release/bioc/vignettes/DESeq2/inst/doc/DESeq2.html]\n      package in R. Troubleshooting 6[href=https://www.wicell.org#troubleshooting].\n    \n        Install and load DESeq2 in R via Bioconductor by running the following\n        commands:\n      \nif (!require(\"BiocManager\", quietly = TRUE))\ninstall.packages(\"BiocManager\")\nBiocManager::install(\"DESeq2\")\nlibrary(DESeq2)\n        Format the data to remove the sgRNA column from the count matrix output.\n        Execute in R:\n      \ndata <- read.delim(“$DIR/Trimmed/.count.txt”, sep=”\\t”)\ndata = subset(data, select=-c(sgRNA))\nwrite.csv(data, “$DIR/Trimmed/count_formatted.csv”,\n          row.names=FALSE)",
    "Specify which samples belong to which condition in the count matrix. The\n        sample names and their original names can be found in .countsummary.txt.\n        \nName the samples that were induced (+) “treated”\nName the control samples (-) “untreated”. Using R:\nname<-c(\"sample1\",\"sample2\",\"sample3\",\"sample4\",\"sample5\",\"sample6\",\"sample7\",\"sample8\",\"sample9\",\"sample10\",\"sample11\",\"sample12\",\"sample13\",\"sample14\")\ncondition <- c(\"untreated\", \"untreated\",\n          \"untreated\", \"treated\", \"untreated\",\n          \"treated\", \"untreated\", \"treated\",\n          \"untreated\", \"treated\", \"untreated\",\n          \"treated\", \"untreated\", \"treated\")\ndf <- data.frame(condition, row.names=name)\n        Load all files in R.\n        \nTurn all row names into unique values\nCast columns are as the “factor” type\n            Remove possible whitespace characters from all values in the count\n            matrix\n          \nFormat the count matrix into a DESeqDataSet:\ncts <-\n          as.matrix(read.csv(\"/$DIR/Trimmed/count_formatted.csv\",sep=\",\"))\nrownames(cts) <- make.names(cts[,1], unique=TRUE)\ncts = subset(cts, select=-c(Gene))\ndf$condition <- factor(df$condition)\ncts <- cts[, rownames(df)]\ncts <- as.data.frame(apply(cts,2,function(x)gsub('\\\\s+',\n          '',x)))\ncts[,] <- sapply(cts[,], as.numeric)\ndds <- DESeqDataSetFromMatrix(countData = cts,\ncolData = df,\ndesign = ∼ condition)\nRun the DESeq function to analyze treated vs. untreated.\ndds$condition <- relevel(dds$condition, ref =\n          \"untreated\")\nddsseq <- DESeq(dds)\n        To identify gRNAs that show a significant downregulation, we recommend\n        starting the analysis with a p < 0.05 and a Log2FoldChange\n        (LFC) < −1.0 as cutoff:\n      \nres05 <- results(ddsseq, alpha=0.05)\nresdown <- res05[which(res05$log2FoldChange < -1.0),]\nNote: The resulting data frame shows gRNAs\n      that are significantly dropping out in the screen. We recommend narrowing\n      down the list of candidates by selecting transcripts targeted by at least\n      2 functional gRNAs.\n    \n        Make the row names for each target gene identical\n        \n            Count all the occurrences of identical genes in a new column called\n            ‘good_sgRNAs’.\n          \n            Filter the data frame to only include genes which have more than 1\n            ‘good sgRNA’\n          \nSave it as a .csv in $DIR:\nrownames(resdown) <-\n          gsub(\"\\\\..∗\",\"\",rownames(resdown))\nresdown$good_sgRNAs <- as.numeric(ave(rownames(resdown),\n          rownames(resdown), FUN = length))\ncandidates <- resdown[which(resdown$good_sgRNAs > 1),]\nwrite.csv(as.data.frame(candidates),\n          file=‘$DIR/candidates.csv”)\n        This should output a list of all genes for which at least 2 gRNAs drop",
    "out with an adjusted p-value of < 0.05 and an LFC < −1.0."
  ],
  "subjectAreas": [
    "Genomics",
    "Bioinformatics",
    "Crispr",
    "Cell Biology",
    "Molecular Biology"
  ],
  "bigAreas": [
    "Molecular Biology & Genetics",
    "Bioinformatics & Computational Biology"
  ]
}