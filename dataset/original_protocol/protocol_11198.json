{
  "id": 11976,
  "origin_website": "Jove",
  "title": "Quantifying the Brain Metastatic Tumor Micro-Environment using an Organ-On-A Chip 3D Model, Machine Learning, and Confocal Tomography",
  "procedures": [
    "1. Prepare the blood brain barrier niche mold\nNOTE: The culturing device used in this platform is a PDMS based scaffold that we build a cellular blood brain barrier niche upon. It is made of two parts separated by a porous membrane. To prepare the blood brain barrier niche two SU-8 molds made using photolithography are necessary26,27. The protocol will be described for the 100 µm thick mold first and then notes will be given for the 200 µm thick mold.\nTo prepare the mold, clean a 4” silicon wafer using acetone with a squeeze bottle and then dry it with a nitrogen gun.\n\t\nBake the silicon wafer on a hotplate for 10 min at 200 °C to remove all residual solvent.\nIn turn center the silicon wafer onto the chuck of a spin coater and dispense 1 mL of SU8-2075 for the top mold. Spin for 5 s at 500 rpm (acceleration 300 rpm/s) to disperse the photoresist and then 30 s at 2200 rpm (acceleration 300 rpm/s) to obtain a 100 µm thick SU-8 coating. Optimization may be necessary to achieve the specified thickness.\nSoft bake the wafer on a hotplate at 65 °C for 2 min and then immediately at 98 °C for 20 min.\nPlace the wafer into a photolithography lamp and position the mask centered onto the wafer according to standard procedures. Expose the SU-8 coated wafers with a radiance of 230 mJ/cm2 of UVB (360 nm ± 10 nm). An exposure matrix experiment may be performed to determine the optimum dosage. Mask designs are available in Supplemental File 1.\nPerform a post-exposure bake at 65 °C for 2 min and then immediately at 98 °C for 10 min to improve adhesion. Cool the wafer to 50 °C.",
    "Remove the un-exposed resist using SU-8 photo-developer. Rinse the wafer in developer for 5 min in a bath and then use a spray bottle filled with SU-8 developer in a chemical hood to agitate and remove remaining uncured SU-8. A 4x microscope can be used to observe if all the uncured SU-8 has been removed. A white line on the edges of the photoresist features indicates the SU-8 has not been removed fully.\nPerform a final hard bake in an oven at 110 °C for 60 min.\nFollow the same procedure for the 200 µm thick mold using SU-8 2075 but adjust the protocol to the following:\n\t\nSpin coater settings: Spin for 5 s at 500 rpm (acceleration 300 rpm/s) to disperse the photoresist and then 30 s at 1300 RPM (acceleration 300 rpm/s) to obtain a 200 µm thick coating.\nSoft bake at 65 °C for 2 min then at 98 °C for 40 min.\nExposure time of 340 mJ/cm2.\nPost exposure bake: 2 min at 65 °C, and then 98 °C for 15 min.\nFinally, silanize each wafer by placing them in a vacuum chamber inside of a chemical hood with a plastic container in which 3 drops (~150 µL) of silanizing solution (Trichloro perfluoro octyl silane) have been placed. Pull a vacuum and leave overnight to allow the vapor to coat the wafer. This step reduces adhesion between the SU-8 and PDMS, increasing the life of the mold.\n\tCAUTION: Trichloro perfluoroctyl silane should be always handled in the fume hood and kept away from water sources.",
    "Place individual wafer molds into 150 mm Petri dishes using two strips of double-sided tape. Ensure the wafers are flat. An alternative is to fabricate an aluminum mold within which the wafer can be placed. Because the aluminum mold is enclosed it will produce casts with a uniform thickness, whereas the Petri dish method is sensitive to the tilt of the surface is it placed on. The improved flatness of the PDMS casts reduces downstream confocal imaging time.\n2. Form and assemble the PDMS blood brain barrier (BBB) device\nMix 75 g of PDMS at a ratio of 1:10 (Crosslinker:Base) by weight in a plastic cup.\nPour the PDMS over the molds (1 mm thick for the 200 µm thick mold and 4 mm for the 100 µm thick mold) and degas in a vacuum desiccator for one hour or until all the bubbles have been removed. Place in a 65 °C oven overnight. The 1 mm thickness may be adjusted based on the working distance of the 10x objective in the confocal microscope.\nAfter the PDMS has cured use a blade to gently cut against the wafer through the PDMS around the edges. Peel the PDMS off and use a blade to cut along the rectangular guides and a 1.5 mm biopsy punch to open the inlets and outlets on the device. Cover the PDMS device parts with 48 mm wide packing tape to keep it clean from dust and debris.\nNext use dissection scissors to cut a 5 mm x 50 mm rectangle of polycarbonate membrane with 5 µm pores and store it inside of a Petri dish for later use.",
    "Gather the following: 200 µL pipette tip, 2 mL of 1:10 PDMS mixed with toluene at a ratio of 2:3 by weight in a glass vial, a Pasteur pipette with a squeeze bulb, the prepared PDMS upper and lower parts, the membrane, three 50 mm x 75 mm glass slides and transport it all to a spin coater. The following steps for assembly and cell seeding of the device are depicted in Figure 1.\nUse the Pasteur pipette to transfer 1 mL of PDMS:toluene glue solution into a 50 mm x 75 mm glass slide on the chuck of the spin coater. Spin for 5 seconds at 100 rpm (acceleration 300 rpm/s) and 30 seconds at 2000 rpm (acceleration 300 rpm/s).\nPlace the slide on a table and cover it with one PDMS upper chamber and one lower chamber so that the PDMS faces with features molded into it contact the slide and the glue is transferred to the PDMS face, outlining the perimeter of all features.\nFlip the PDMS upper chamber onto another slide with the glue coating facing up and carefully place the membrane across the device between the inlets and outlets. Place the 200 µL tip in the PDMS:toluene glue solution until it has wicked some into the tip. Touch the tip between each inlet and outlet to place a small drop near the edge of the membrane where it contacts the PDMS.\nRemove the other half of the device and place it on with the glue coating down while aligning the inlets and outlets on the two parts.",
    "Place the assembled device into an oven at 37 °C overnight to cure the glue. Transfer to a vacuum bell jar with desiccant and let dehydrate for two days. This is a crucial step to allow the Toluene to evaporate and to improve the consistency of seeding the device by regulating the absorbed water vapor in the laboratory air.\n3. Seed the brain micro-environment into the device\nCell culture and reagents: Before beginning this protocol, obtain the following reagents and cells. Cultivate all cell lines in an incubator set at 37 °C in 5% CO2.\n\t\nMaintain human triple-negative breast cancer cell line MDA-MB-231 (ATCC HTB-26) and MDA-MB-231-BR-GFP cells (obtained from Patricia Steeg, PhD) in DMEM with 4.5 g/L glucose, supplemented with 2 mM L-glutamine, 10% FBS and 1x antibiotic-antimycotic. Create MDA-MB-231-GFP fluorescent cells by transducing MDA-MB-231 cell with empty vector pLL-EV-GFP lentivirus. Sort the transduced GFP+ population using fluorescence-activated cell sorting (FACS) prior to experimentation.\nMaintain human brain microvascular endothelial cells hCMEC/D3 in EGM-2 medium. Create hCMEC/D3-DsRed fluorescent cells by transducing hCMEC/D3 with empty vector pLL-3.7-dsRed lentivirus. Remove all non-transduced, non-fluorescent cells from the culture using FACS prior to experimental use.\nMaintain normal human astrocytes (NHA) in DMEM supplemented with 4.5 g/L glucose, 10% FBS, 2 mM Glutamax, 1 mM sodium pyruvate, 1x N-2 growth supplement, and 1x antibiotic-antimycotic. Immortalize the astrocytes by transducing pLOX-TERT-iresTK lentiviral vector (Addgene 12245). Create the vector using plasmid psPAX2 and envelope plasmid pMD2.G (Addgene 12260 and 12259).",
    "Remove a µmBBN device from the vacuum desiccator and place onto a metal or paper (i.e., tape) surface with the inlets facing down and put it into a plasma chamber. Also place a 50 mm x 75 mm glass slide into the plasma chamber. Pull a vacuum and then treat with plasma at 80 W for 30 s.\nQuickly remove the glass slide and device from the plasma chamber and place the device with the inlets facing up onto the glass slide aligned using a guide (Supplemental File 2). This will create a permanent bond between the PDMS and glass slide and cannot be re-positioned.\nNext cut the tips off 16, 200 µL pipette tips, 2 mm from the tip. Insert the pipette tips into all the inlets and outlets. The device can be placed back into the vacuum desiccator at this point if not ready to seed the cells.\nPlace the device back in the plasma chamber and treat with plasma for 8 min at 200 W. After the device has cooled (5 min) from the plasma treatment place it inside a sterile secondary container, like a transparent pipette tip box. Perform the next step within ~15 min or the effectiveness of the plasma treatment may be reduced leading to clogging.\nSeveral days before the experiment culture Petri dishes of 1 x 106 endothelial cells (hCMEC/D3-DsRed) and 1 x 106 astrocytes (NHA). While the device is undergoing the 8 min plasma treatment, prepare a collagen solution consisting of 0.5 mL of 3 mg/mL PureCol type I bovine collagen with 64 µL of 0.8 M NaHCO3 and 20 µL of 10x high-glucose (250 mM) MEM. Suspend 5.0 x 105 NHA cells in the collagen solution. Maintain the solution on ice while not in use.",
    "Transfer 120 µL of the collagen/astrocyte/microglia solution into the device through the pipette tip for the bottom chamber (Figure 1 Red arrows). Allow the solution to wick across the chamber into the opposite pipette tip. After all four channels of the device have been filled place the chip in the CO2 incubator at 37 °C and 5% CO2 for 1 h or until the collagen has set.\nAfter the collagen sets, fill all pipette tips feeding the bottom chamber with a mixture of complete media. For chips containing endothelial cells and astrocytes, a 50:50 mix of endothelial:astrocyte media is used.\nCoat the upper chamber with 2% growth-factor reduced Matrigel in complete endothelial media using the upper chamber pipette tip (Figure 1 Blue arrows) and place in the incubator for 1 hr.\nRinse the upper chamber with the indicated media mixture and alternate which tip is seeded with endothelial cells (Figure 1 Green arrows). Suspend 1 x 106 endothelial cells in 1 mL of endothelial media and seed 30 µL every 15 min into alternating upper chamber tips for even coverage. Seed endothelial cells into each upper chamber tip twice, for a total of 4 times per chamber.\nAfter the final seeding of endothelial cells, fill all the tips with the media mixture and place the device in the incubator at 37 °C and 5% CO2, changing media in both chambers every 12 h.\n4. Monitor progression of the endothelial layer formation\nComplete coverage of the channel by the endothelial layer is observed after 3 days. Use one of two methods to monitor the coverage of the endothelial barrier: Fluorescence or TEER. the hCMEC/D3-DsRed fluorescence and according % coverage across the channel area can be quantified using ImageJ.",
    "Open the TIFF file in ImageJ representative of the hCMEC/D3-DsRed barrier. In the ImageJ software, click File > Open to select the file.\nMerge all the Z-layers of the image using the maximum intensity following these key commands and options: Image > Stacks > Z project > All Z slices, Maximum intensity.\nPerform a color threshold that is the same across all microfluidic chips assessed using this method. For the study presented we employed a threshold of 450. Use the threshold menu in ImageJ at: Image > Adjust > Threshold.\nSet the measurements to be recorded using the following commands and options: Analyze > Set Measurements > Limit to threshold, Area Fraction.\nSelect a representative region of the microfluidic channel to measure by drawing a box. The box tool is located on the main menu of ImageJ. Measure 3 technical replicates positioned at the beginning, middle, and end of each microfluidic channel using the same box size.\nAnalyze each channel and record the area fraction, representing the % endothelial coverage. Export these measurements as spreadsheet files to plot and visualize the data using the following commands: Analyze > Measure.\nAs an alternative, use Impedance spectroscopy-based TEER to measure endothelial tight junctions per area. Quantification of the endothelial barrier using TEER is a proxy for the integrity of the endothelial layer as a barrier.\n\t\nPosition two electrodes in the inlet and outlet of the upper and lower chambers.\nQuantify the impedance of the endothelial monolayer as a combination of the resistances, inductances, and capacitances in the chip according to a model proposed by Srinivasan et al.28,29.\n5. Seed cancer cells into the device\nAfter the endothelial layer has matured, seed cancer cells into the device. Prepare a 1 mL solution of 1 x 106 cancer cells in complete cancer cell media.",
    "Exchange the media in the chip to replenish cell culture nutrients.\nSeed each top chamber channel with 30 µL of cancer cells in suspension and then place the device back in the incubator for a 15 min. Always seed the cancer cells on the same side of all four top chamber channels within a single device.\nExchange the device with new media and the refill the tips every 12 hours until the device is imaged for metastatic behavior.\n6. Image the tumor micro-environment by confocal imaging\nAt the desired experimental timepoint (1, 2, or 9-days), use confocal imaging to capture a 3D image of the channel. We perform this step on a Nikon A1 using the settings described here. This step is automated, and each channel requires 20-40 min to image depending on how many fluorescent channels are included and the Z-depth needed to cover the positions of all the cells.\nTurn the microscope on, open the software and place the incubator cover onto the microscope.\nSet the microscope stage heater to 37 °C and CO2 to 5% if available.\nAfter the microscope incubator has stabilized, place the device into the microscope stage using the 50 mm x 75 mm mount.",
    "Focus on one side of the device (left if to be used with the provided analysis software) with a 10x objective and set the Z height as zero. Under z-stack settings, include a range of 100 µm above and 200 µm below the focus plane. Then use the stitching setting to set the number of X and Y fields to 1 and 9 respectively with 15% overlap. Set the pinhole to its recommended minimum and the z-layer height to 9 µm. Adjust the bright field exposure so that the porous membrane is visible. Turn on the excitation lasers for the dsRed (561 nm) and GFP (488 nm) channels and adjust the fluorescent laser powers and cutoffs so that each channel is visible without overexposing the pixels.\nVerify all fields are in focus when stepped over. If so, enter an output file name (001.nd2) for the image and start the experiment to automatically capture the 3D confocal image.\n7. Measure the tumor micro-environment via confocal tomography\nUse confocal tomography an approach to estimate a set of metrics and measurements that describe the individual cells and the tumor micro-environment within the device. Confocal tomographic analysis (Figure 2) converts a confocal z-stack into a three-dimensional representation of the cells. Using a custom python script within the Jupyter notebook/lab environment, a plane is then matched to the layer of cells which form the blood brain barrier like membrane30. Finally, make phenotypic measurements of the cancer cell populations (Table 1).\n\t\nPerform this analysis at the end of an experiment or over a time course. Install python and the appropriate libraries according to the referenced software guide, then open the software from Windows Command Prompt by running the command “conda activate”, followed by “jupyter lab”. The Jupyter environment will load within the default browser.",
    "From the Jupyter file explorer double click the Jupyter notebook “contom.ipynb” to open it. Run the cell below the title Import libraries, custom classes/functions and setup the notebook by clicking the notebook cell and then clicking the play button. All notebook cells below are executed using the same approach. Note that here notebook “cell” refers to a block of python code within the Jupyter notebook.\nPrepare the data. This algorithm uses the visualization toolkit (VTK) to manipulate and display the z-stack and three-dimensional data17.\n\t\nPlace the provided .XLSX file (“Experiment Tracker.xlsx”) in the same windows folder as the Jupyter notebook. The file tracks experiments and interfaces with the Jupyter notebook. Place the ND2 file from section 6 into a subfolder called “\\Experiment_XXX\\Confocal\\” below the Jupyter notebook location. Additional experiment folders can be added within by adjusting the “XXX” to the numerical ID assigned to new folders.\nLabel the first experiment folder “Experiment_001” and the ND2 file “001.nd2”. First, convert the ND2 imaging file into a stitched multi-image TIFF file separated by color channel. Do this by executing the notebook cell below the title “Read the confocal z stack into memory” with the Save_tiff_from_ND2 () function uncommented30. The ND2 file is a proprietary imaging format from Nikon, thus it is necessary to convert it to a format that open source software is compatible with.",
    "NOTE: The TIFF (Tag Image File Format) is used because it is ubiquitous, 16 bit compatible, easily imported into VTK, and multiple images can be stored in a single file, which is appropriate for z-stack images. Executing the notebook cell will read in an image from the ND2 file, extract information of the color and XYZ positions then store that image in a numpy array according to a pre-determined structure. It will then save the array as a TIFF file using the python library tifffile.\nConvert imaging data into 3D model\n\t\nImport the TIFF file into VTK (vtkTIFFReader) using a 3D rendering to visualize the cells (Figure 2). Select a threshold based on the color of the cells in the image. To clarify, the VTK object represents a block of pixels (X, Y, Z) in space (volume) but only certain pixels (green or red) represents cells, the rest are background or noise (black).\nTherefore, set an opacity filter on the volume which removes the background confirm that what fluorescence remains is only the cells. Do this using the Jupyter notebook cell titled, Change opacity values for each microscope channel by adjusting the Channel_alpha value variables (i.e., GFP_alpha). Visualize the effect using the notebook cell titled View a 3D rendering to verify the threshold are set correctly.\nSave the opacity values in the spreadsheet to use in the next step. Convert the volume data into individual 3D objects, each representing a cell in the image using a technique called marching cubes31. This algorithm extracts a polygonal mesh of an isosurface from three-dimensional discrete scalar fields of voxels.",
    "Use the opacity value in the marching cubes algorithm to separate each cell from the background. Complete this step for all fluorescent cells identified in each microscope channel by running Convert voxel image into a triangular mesh and save as a VTK file in the notebook.\nFitting a plane to the membrane\n\t\nFit a plane to the endothelial barrier by first locating the cell centroids (notebook cell: Analyze the RFP channel (endothelial barrier)). Iterate through the list meshes in the volume and extract the regions that are not connected using a PolyDataConnectivityFilter from VTK. Calculate the centroid of each mesh and add the measurement to a list of centroids filtering for meshes that are too large or too small (<50, >1000000 voxels).\nFit a plane to the list of centroids for the endothelial cells using a minimization of error method (notebook cell: Fit a plane to the RFP centroids (endothelial barrier)) (Figure 2, Figure 3)32. Inspect the fit of the plane by plotting the plane and centroids and adjust manually if necessary (using theta, beta and z) by running the notebook cell titled Visualize RFP centroids and plane fit.\nAfter the plane is properly fitted, save the normal of the plane to the Experiment Tracker File .XLSX file for future use.\nAnalyze the descriptive features of individual cancer cells for the following descriptors (Table 1).",
    "NOTE: If the computer performing the analysis is lagging, high throughput analysis via high performance computing is an option. This algorithm is useful on standard laptops for the analysis of small numbers of cells, however VTK is not well suited to a large number of individual objects (>1000). Therefore, it is optional to use the adapted algorithm to function on a high-performance computing cluster. This enables rapid analysis of experiments with many cells (Figure 2). All of 7.5 is accomplished by running the notebook cells titled Analyze the remaining microscope channels for phenotypic descriptors and Read in the Experiment_tracker information and analyze the channels that exist.\n\t\nMeasure the extravasation of the cancer cells: After characterizing the endothelial layer with a plane, measure the volume of each cancer cell that has migrated through the membrane. Clip each cell (Boolean) so that the mesh below the membrane is kept and the portion above the membrane is removed33. Then close the open mesh (vtkFillHoles).\n\t\t\nRecalculate the normal and the new centroid of the clipped mesh. Measure the volume and position of each clipped cancer cell for analysis. Volume is equivalent to the number of voxels the mesh fills of each single cell. Calculate the distance between the endothelial plane and position of each cancer cell.\nMeasure the cellular phenotype: Calculate the morphology of each cancer cell by factoring its shape, volume and position.",
    "Validate the measurements and save to a spreadsheet or plot. Run the notebook cell titled Check that centroids were measured accurately and a render will pop up showing the centroids identified on top of the imaged volume by cell type. After all the experiments are done export the complete data set as a single spreadsheet file by typing the experiments to be included by ID in the notebook cell titled Export the data as a single Data.XLSX file for the variables experiments replacing the given experiment IDs. If verify the completed data set, plot it using the notebook cell titled Distance extravasated strip plot. The plot will appear in the notebook environment and save to file.\n8. Analyze the related characteristics using Artificial Intelligence\nNOTE: Identify metastatic phenotypic features using artificial intelligence algorithms.\nPerform binary classification using Orange according to the scheme shown in Figure 5 and Supplemental File 3. Start Orange from a second Windows Command Prompt by typing “conda activate” followed by “python -m Orange.canvas” and click New from the prompt. Orange is a drag and drop based software, so arrange the functions by dragging each item from the left menu onto the canvas to match Supplemental File 3. After that is complete double click the File icon and select the Data.XLSX file.\nFilter the data to remove bad measurements, defined as those that failed a Boolean operation or giving parametric variable values outside of known bounds using the “Select Rows” icon. Double click the icon and set conditions that correspond to the filter such as “Sphericity is between 0 and 1”. Create conditions for 8.2.1, 8.2.2 and 8.2.3.\n\t\nFilter distance extravasated measurements to range from -100-200 µm.\nFilter sphericity measurements of cell shape to range from 0-1.\nFilter cancer cell volume measurements to range from 0-2000 voxels.",
    "Use all parametric variables (Table 1) to classify brain-metastatic MDA-MB-231-BR-GFP and non-brain metastatic MDA-MB-231-GFP. Double click Select Columns icon from the canvas. Using the > button to move Available Variables into either Features, Target Variables, or Meta Attributes. The only variable that should be a Target Variable is a Metastatic label which defines if cells in the data set are considered metastatic (1) or not (0). Experiment variables can be placed in the Meta Attributes section.\nSample the data into a training (80%) and test set (20%). Double click the Data sampler icon and select a Sampling type of Fixed proportion of data: set to 80% and select replicable and stratify check boxes. Stratify and cross-validate the training set using 10 folds against each model/classifier. Double click Test & Score and select Cross validation with Number of folds: set to 10 and Stratified checked. Set the target class to 1.\nIn this method, use Neural Networks and Random Forest learning algorithms as they are robust to the data. Within the Random Forest icon, choose the Number of Trees to be 50 and do not select any other options. Within the Neural Network icon choose Neurons per hidden layer: 100, Activation: ReLu, Solver: Adam, Alpha: 0.0001, and Max Iterations: 200. However, these settings will vary significantly by study and should be well understood before application.",
    "After setting up the canvas double click each icon from File to Sample Data and either hit Apply or Send Data. Double click Test & Score and the training data will begin to be used to develop a model using the algorithms. After training the machine learning model, re-open Test & Score and select Test on Test Data and close the popup window to score the performance of the model by classifying the cells in the chip according to the probability they are brain metastatic from 0 to 1.\nSave the machine learning model performance to a file (Table 2). Include the area under the curve (AUC) of the ROC, the accuracy and the F1 score. Save a second file that contains the individual metastatic indices and classification probabilities. Double click the Save icon and click Save As to write to file the classification probabilities. Similarly, the ROC curve can be viewed by double clicking ROC Analysis icon and the model performance can be calculated by double clicking the Confusion Matrix icon.\nSubscription Required. Please recommend JoVE to your librarian."
  ],
  "subjectAreas": [
    "Cancer Research"
  ],
  "bigAreas": [
    "Biomedical & Clinical Research"
  ]
}