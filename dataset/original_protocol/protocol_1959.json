{
  "id": 2073,
  "origin_website": "Cell",
  "title": "A computational pipeline to visualize DNA-protein binding states using dSMF data",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nIn a single command, you can visualize protein-DNA binding state of a region of your interest from raw sequencing data:\nsnakemake --snakefile cooperative_binding_analysis.smk\nplots/single_binding/suppressed_merged_demo_S2_to_example_spanning_lf_15_r\nf_15_extended_left_150_right_150_roi_peak_229.fp.pdf\nplots/single_binding/suppressed_merged_demo_S2_to_example_spanning_lf_15_r\nf_15_extended_left_150_right_150_roi_peak_229.methylation.pdf --configfile\nconfigs/config.yaml\nBelow we will discuss the steps executed by the pipeline to generate the final figures.\nCAUTION: This command will run relatively quickly because demo dataset has been used. If using full raw sequencing data, it will take around ∼10–15 h for the first run to prepare close to final datasets required for visualization. After that, for any regions of your interest it will take less than 5 min for visualization.\nAdapter trimming and alignment\nTiming: ∼5–10 h\nIn this step, we perform standard preprocessing of NGS data and alignment to the reference genome of interest. We use “Trim Galore” (see rule “trim_galore_pe” in snakemakes/trim_galore_pe.smk) for adapter trimming and “Bismark” (see rule “Bismark_align_pe” in snakemakes/Bismark_align_pe.smk) for bisulfite sequence alignment.\nSuppressing cytosine methylation in contexts other than CpG or GpC dinucleotides\nTiming: ∼1 h\nIn this step, we refine the methylation calls by Bismark based on the methyl-transferases used in the dSMF experiment.\nNote: We should only be considering methylation in CpG and GpC context based on the enzymes used in dSMF. To ensure this, we suppress methylation calls that are in other contexts (HCH; H: A,C,T) and (DGD; D: A,T,G).\nExtracting adjacent or overlapping bisulfite reads\nTiming: ∼1 h\nIn this step, we extract properly aligned paired-end reads based on their SAM flags (<read, mate>: <99, 147> or <83, 163>) from the merged alignment file (see step 1.3), and generate longer reads by concatenating mate to read in case of pair <99, 147> and vice-versa in the case of <83, 163> (for further details about the meaning of SAM flags, see https://broadinstitute.github.io/picard/explain-flags.html[href=https://broadinstitute.github.io/picard/explain-flags.html]).",
    "Note: In overlapping regions, information on the leftmost read is kept. We then extract all longer reads that are overlapping or adjacent in nature. These reads form “DNA molecules” on which we will map binding states. Standard Illumina paired-end sequencing with read lengths 150 bp leads to typically long enough (median length of 269 bp) “DNA molecules” (Rao et al., 2021[href=https://www.wicell.org#bib10]) to map transcription factor (TF) and nucleosomal binding.\nDefining footprints\nTiming: ∼1 h\nIn this step, we define footprints on individual DNA molecules.\nNote: It can be assumed that exogenous CpG and GpC methyltransferases reach saturation by methylating all accessible CpG and GpC dinucleotides. A footprint is called when one or more unmethylated cytosines are found between two methylated cytosines. We consider footprints of at least 10 bp long. If two footprints are separated by just one bp, we merge them to define a longer footprint. A DNA molecule with all unmethylated cytosines in CpG or GpC contexts, which results in no footprint is given special consideration because it could arise due to complete occlusion by nucleosomes, thus a footprint size of the whole DNA molecule length is assigned in this case.\nCritical: With Drosophila S2 cells dSMF data, in open enhancers, one should expect about 40%–50% of naked-DNA, about 15%–20% of TF-bound and about 30%–40% of nucleosomal DNA (Rao et al., 2021[href=https://www.wicell.org#bib10]). We imagine a similar distribution in other organisms based on the conservation of chromatin structure across eukaryotes.\nAssigning states on DNA molecules at single binding sites\nTiming: ∼1 h\nIn this step, we assign binding states on individual DNA molecules mapped to ROI listed in a bed file.",
    "Note: An example file is available at the GitHub repository “input_bed/example.bed”. The ROI coordinates are midpoints of the broader regions one is interested in. For TFs, we consider 15 bp upstream and downstream of the midpoint to be sufficient. We then apply conditions to assign a footprint as naked-DNA, TF, or nucleosomal: No footprint in ROI+-15 or footprint of length less than 10 bp is assigned as naked-DNA, footprints of length between 10 and 50 bp in ROI+-15 are assigned as TFs, and others are assigned as nucleosomal. We discard < 50 bp sized footprints on the edge of DNA molecules because we only know the starting point of the footprint in these cases and hence the real length of these footprints is unknown.\nAssigning binding states at a pair of binding sites\nTiming: ∼5 min\nIn this step, we assign co-binding states on individual DNA molecules that span a pair of TF binding sites. Prepare a bedpe formatted file (see .bedpe format description here[href=https://bedtools.readthedocs.io/en/latest/content/general-usage.html]: https://bedtools.readthedocs.io/en/latest/content/general-usage.html#bedpe-format[href=https://bedtools.readthedocs.io/en/latest/content/general-usage.html#bedpe-format]) to provide the centers of the two binding sites. For an example, see “input_bed/example_cobinding.bedpe”. This step can be executed by running the following command:\nsnakemake -np --snakefile cooperative_binding_analysis.smk\nplots/cobinding_bedpe/suppressed_merged_S2_to_example_cobinding_lf_15_rf_\n15_extended_left_300_right_300_roi_peak_110_4_and_peak_110_6.fp.pdf --\nconfigfile configs/config.yaml\nNote: Each TF binding site can have three states: naked or unbound, TF-bound, and nucleosome-bound. Thus, a pair of TF binding sites will have a total of nine states. States at individual sites are assigned as described in step 6. Additionally, a footprint spanning both sites that is <100 bp in length is labeled as co-bound.\nCritical: The bedpe file can only have the filename extension “.bedpe”."
  ],
  "subjectAreas": [
    "Genomics",
    "Molecular Biology",
    "Sequence Analysis",
    "Bioinformatics"
  ],
  "bigAreas": [
    "Molecular Biology & Genetics",
    "Bioinformatics & Computational Biology"
  ]
}