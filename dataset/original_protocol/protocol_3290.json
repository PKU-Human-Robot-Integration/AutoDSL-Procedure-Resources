{
  "id": 3484,
  "origin_website": "Cell",
  "title": "Integrated workflow for discovery of microprotein-coding small open reading frames",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nCycloheximide treatment & lysate preparation\nTiming: 45 min\nCells are treated with cycloheximide in the wash and lysis buffers to inhibit translation elongation and stall ribosomes.9[href=https://www.wicell.org#bib9]\nWash cells with 5 mL of ice-cold PBS containing 100 μg/mL Cycloheximide (CHX) for a 10 cm plate and immediately remove as much PBS as possible.\nNote: The longer incubations with CHX in the PBS wash can cause accumulation of ribosomes near the start site of ORFs, representing an artifact of the CHX treatment rather than native translation conditions. For suspension cell cultures, we recommend minimizing the incubation time with CHX by spinning down the cells in PBS with CHX for as short a time as possible, e.g., 3 min.\nAdd 400 μL of ice-cold lysis buffer to the plate and scrape cells off in the lysis buffer and collect the buffer and cells into a fresh tube.\nNote: Prepare lysis buffer on the day of harvesting samples. The lysis buffer volume can be adjusted in order to achieve the optimal concentration of lysate RNA for digests and will depend on the cell type and number of cells (troubleshooting 1[href=https://www.wicell.org#sec6.1]).\nVortex and/or pass your sample through a 26-gauge needle to homogenize the cells and let it incubate on ice for 10 min. Use of a probe sonicator is not recommended.\nClarify the lysate by spinning it at 15,000 × g for 10 min at 4°C.\nTransfer supernatant to a new RNase-free tube.\nCritical: RNA in cellular lysate is vulnerable to degradation and ribosome dissociation. Handle samples on ice and proceed with digestion the day of lysis if possible. Samples that need to be stored for later, they should be flash frozen in liquid nitrogen and stored at −80°C for up to one week.\nMicroSpin S-400 HR column preparation",
    "Timing: 1 h\nPrior to column purification of monosomes, the column resin is equilibrated with wash buffer. This step should be started just before the digest with RNase I.\nPrepare one S-400 HR column per 100 μL of lysate. For 60 μg of input RNA in 300 μL lysis buffer for RNase I digestion, three columns will be used for monosome isolation.\nRemove the cap and seal from each column and begin washing with 500 μL S-400 column wash buffer.\nDiscard the flow-through after each wash.\nPerform six washes per column for 3 mL total wash buffer per column.\nNote: Prepare column wash buffer on the day of digest. The wash buffer passes through the column very slowly with gravity. To facilitate faster flow-through of the buffer, push air through the top of the columns by pressing a gloved finger over the top of the column. Ensure that there are no bubbles in the column resin.\nCritical: On the last wash, allow enough buffer to pass through the column such that there is about 15% volume of buffer sitting on top of the resin bed.\nSpin the column at 600 × g for 4 min.\nCritical: Do not let the resin bed in the columns dry out during the wash steps. Doing so will result in low yields of RPFs. Ideally the column washes will be complete just prior to RNase I digest step.\nRNase I digest\nTiming: 1 h and 15 min\nPolysomes are subjected to RNase I digestion, which degrades unprotected RNA to yield monosomes containing RNA footprints that only span the width of the single ribosome.\nDilute 1 μL of supernatant with 9 μL of molecular grade H2O to measure RNA concentration.\nUse Qubit 2.0 Broad Range RNA assay to measure RNA concentration.",
    "Digest 40–60 μg of RNA in 200–300 μL of lysate with 0.375 U/μg of RNase I for 50 min at 20°C–25°C while rotating.\nNote: Optimal RNase I concentration needs to be determined for each cell or tissue type being studied (troubleshooting 2[href=https://www.wicell.org#sec6.3]).\nAfter completing the digest, add 10 μL of (200 U) of SuperaseIn Rnase Inhibitor and keep the samples on ice.\nMonosome isolation and acid Phenol:Chloroform extraction\nTiming: 2 h and 30 min\nDigested monosomes are separated from free digested RNA and unprotected RNA using a size exclusion spin column.\nMonosomes are isolated from free-digested RNA fragments in the cell lysate using MicroSpin S-400 HR columns. The small RNA RPFs are then extracted using acid phenol:chloroform (troubleshooting 3[href=https://www.wicell.org#sec6.5]).\nAdd 100 μL of digest in a dropwise manner directly to the resin of each spin column. Do not pipette the digest onto the walls of the column.\nCentrifuge the columns at 600 × g for 2 min.\nCollect ∼125 μL of monosomes from each column and combine the eluates from all columns per sample.\nNote: The extra ∼25 μL volume collected is from the remaining wash buffer in the column.\nAdd an equal volume of acid phenol: chloroform to each sample, vortex the samples, and then incubate for 5 min at 20°C–25°C.\nSpin the samples at >15,000 × g for 10 min at 4°C. Collect the aqueous phase from each sample after centrifuging while being careful not to pipette the interphase or organic phase (Figure 1[href=https://www.wicell.org#fig1]).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3059-Fig1.jpg\nFigure 1. Acid phenol:chloroform extraction of RPFs\nAcid phenol:chloroform extraction separates RPFs and other RNA molecules from proteins, lipids, and DNA. Retrieve RPFs from the aqueous phase that settles in the top layer.",
    "To each sample, add 1:10 volume of 3 M NaOAc, pH 5.2 and 2 μL of glycogen (15 mg/mL). Next, add 1 volume of ice-cold isopropanol. Crash out RPF RNA at −20°C for >2 h.\nNote: Glycogen is used as a carrier to trap nucleic acids during its precipitation, creating a more visible pellet.\nSpin down the RPF RNA samples at >15,000 × g for 15 min at 4°C to pellet the RNA. Decant the supernatant, being careful not to disturb the pellet.\nWash the pellet once with ice-cold 80% ethanol. Centrifuge the samples again at >15,000 × g for 10 min at 4°C.\nDecant the supernatant and allow the pellet to air dry for about 5–10 min. Do not over-dry the pellet while ensuring that the ethanol completely evaporates.\nResuspend the pellet in 15 μL of nuclease-free H2O. Use 1 μL of resuspended RNA to measure RNA concentration with a Nanodrop UV-Vis Spectrophotometer.\nPause point: Purified RNA can be stored for up to a week at −20°C or long-term at −80°C.\nrRNA depletion with siTOOLs Biotech riboPOOLs kit\nTiming: 1 h\nContaminating ribosomal RNA (rRNAs) are removed from the sample in order to improve the depth of RPF sequencing. While there are many rRNA depletion kits commercially available, we recommend the siTOOLs riboPOOLs rRNA depletion kit for ribosome profiling.\nrRNA probe hybridization\nAdjust the sample to a final volume of 14 μL containing 1–5 μg of RNA with water.\nAdd 1 μL of rRNA probe to the sample.",
    "Note: siTOOLs riboPOOLs rRNA depletion kits have been observed to contain a varying concentration of rRNA probes between lots. It is recommended to measure the concentration of the probe prior to usage. We have found that 1.2×–1.5× concentrations of probe to RPF RNA is optimal for depleting rRNA (troubleshooting 4[href=https://www.wicell.org#sec6.7]). Note that despite executing this step the majority of sequenced reads are likley to still be derived from rRNA sequences.\nAdd 5 μL of hybridization buffer (HB) and 1 μL of Promega RNasin Plus. Pipet up and down to mix well.\nIncubate sample(s) for 10 min at 68°C in a thermocycler to denature RNA and allow samples to cool at a rate of 3 °C/min to 23°C.\nBead preparation\nWhile your sample(s) are cooling down, resuspend the streptavidin-coated magnetic beads by vortexing them at medium speed.\nNote: For multiple samples, magnetic beads may be prepared by batch processing as in the manufacturer’s protocol.\nTransfer 90 μL of the bead suspension per sample into a fresh microcentrifuge tube and place the tube on a magnetic rack for 1 min.\nAspirate and discard the supernatant. Remove the tube from the magnetic rack and resuspend the magnetic beads in 80 μL of depletion buffer (DB). Place the tube back on the magnetic rack for 1 min. Aspirate and discard the supernatant.\nAdd 80 μL of DB to the magnetic beads and mix by pipetting. Do not place the tube back on the magnetic rack.\nrRNA depletion\nOnce your sample has cooled, add the 20 μL of sample into your magnetic bead suspension and pipette up and down several times to mix. Let sit at 20°C–25°C for 5 min. Place onto a thermomixer set to 37°C for 5 min. Skip the 50°C incubation step.",
    "Spin down droplets and place the tube on a magnetic rack for 2 min. Transfer the supernatant (∼85–90 μL) to a new tube.\nAdjust the volume of each sample to 100 μL with nuclease-free water and proceed to cleaning RPF RNAs using the Zymo RNA Clean and Concentrator kit.\nAdd 200 μL RNA binding buffer and 450 μL 100% ethanol to each RPF sample.\nLoad each column with the RPF sample, spin for 1 min at >10,000 × g and discard the flow-through.\nWash each column with 400 μL RNA prep buffer and spin at >10,0000 × g for 1 min and discard the flow-through.\nWash each column with 700 μL RNA wash buffer and spin at >10,000 × g for 1 min and discard the flow-though.\nWash each column with 400 μL RNA wash buffer and spin at >10,000 × g for 2 min and discard the flow-through. Transfer each column to a fresh, nuclease-free centrifuge tube.\nElute RPF RNA samples with 11 μL nuclease-free water and keep the samples on ice or store at −20°C for up to a week. Expect to recover ∼ 10 μL.\nPAGE purification of ribosome-protected fragments (RPFs)\nTiming: 3 h and 30 min\nRPF fragments corresponding to lengths between 27 and 30 nt are extracted from a denaturing polyacrylamide gel.\nPrepare the RPF sample(s), 20/100 oligo ladder, and RNA control marker (27, 30 nt) by mixing the following materials.\nAdd 10 μL of 2× TBE-urea dye to each RPF sample.\n20/100 oligo ladder: 1 μL 20/100 oligo ladder (0.1 μg/μL), 19 μL nuclease-free water, 20 μL 2× TBE-urea dye.\nRNA control marker: 1 μL 27 nt marker (10 μM), 1 μL 30 nt marker (10 μM), 18 μL nuclease-free water.",
    "Denature the samples, ladder, and RNA control marker by boiling them at 95°C for 5 min. Place the samples on ice immediately after.\nPrepare 800 mL of fresh 1× TBE buffer to run the gel.\nPrepare a 15% TBE-urea polyacrylamide gel by rinsing the wells with 1× TBE buffer and pre-running the gel for 5 min at 180 V prior to loading the samples.\nLoad 10 μL of the 20/100 oligo ladder, 10 μL of the marker, and 20 μL of each sample across two lanes (10 μL per lane).\nNote: It is recommended to load markers next to each sample to help with cutting the gel.\nRun the gel at 180 V for 65 min or until the bromophenol blue bands reach the bottom of the gel.\nStain each gel with 3 μL of SYBR gold and 30 mL of 1× TBE buffer on a shaker at 20°C–25°C for 20 min.\nCreate a hole in the bottom of a 0.5 mL tube using an 18-gauge needle. Place that 0.5 mL tube in a 1.5 mL tube. This will be used for shredding the gel.\nUsing the 27 and 30 nt marker bands on the gel as a reference, cut the 27–30 nt region for each sample and place the excised bands in a 0.5 mL tube that was prepared in the previous step (Figure 2[href=https://www.wicell.org#fig2]).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3059-Fig2.jpg\nFigure 2. 15% TBE-Urea Gel\n(A) Example RPF gel showing digested RNA post-rRNA depletion. 20 μL of sample is loaded across two lanes.\n(B) RPF gel with 27–30 nt regions cut out for Ribo-seq samples.\nCentrifuge the tube(s) at >15,000 × g for 2 min to shred the gel slices. Gel pieces should all be in the 1.5 mL microcentrifuge tube.",
    "Note: The gel slice may be cut up further into smaller pieces before centrifuging if you find that it does not pass through the 18-gauge hole in the 0.5 mL tube easily.\nRemove and discard the 0.5 mL tube.\nAdd the following components to each 1.5 mL microcentrifuge tube with gel pieces and rotate the samples for 2 h at 20°C–25°C to extract RPFs.\n400 μL nuclease-free water.\n40 μL 5 M ammonium acetate.\n2 μL 10% sodium dodecyl sulfate (SDS).\n1 μL Rnase inhibitor (Superasin).\nTrim the end of a 1 mL pipette tip with a fresh razor and use that tip to transfer the gel slurry to a centrifugal filter. Centrifuge the tube(s) at 2,000 × g for 3 min.\nTransfer the RNA solution to a fresh 1.5 mL microcentrifuge tube and add the following reagents to each tube.\n2 μL Glycoblue.\n700 μL 100% isopropanol.\nMix well and incubate for >2 h at −20°C.\nCentrifuge the tube(s) at 15,000 × g at 4°C for 20 min to pellet the RPF RNA.\nDecant the supernatant without disturbing the pellet.\nWash the pellet with 500 μL of ice-cold 80% ethanol and centrifuge at 15,000 × g at 4°C for 10 min.\nDecant the supernatant without disturbing the pellet and air dry for about 10 min.\nResuspend the pellet in 3.5 μL of nuclease-free water.\nPause point: Sample(s) can be stored at −20°C for up to a week.\nPre-adenylation of adapter\nTiming: 1 h and 30 min\nPrior to the ligation of the adapter to the RPF, the 5′ end of the 3′ adapter is adenylated to allow for ligation with RNA ligase.\nNote: In this protocol, we use the 3′ adapter sequence from McGlincy et al.,10[href=https://www.wicell.org#bib10] but do not include the barcode sequence.",
    "Combine the following components in a tube.\ntable:files/protocols_protocol_3059_3.csv\nIncubate the tube at 65°C for 1 h followed by heat-inactivation of the enzyme at 85°C for 5 min.\nAdjust the volume of each sample to 50 μL by adding 30 μL of nuclease-free water. Purify the sample(s) with the Zymo RNA Clean and Concentrator kit.\nAdd 100 μL RNA binding buffer and 150 μL 100% ethanol.\nLoad the column with the sample, spin for 1 min at >10,000 × g, and discard the flow-through.\nWash the column with 400 μL RNA prep buffer and spin at >10,0000 × g for 1 min, and discard the flow-through.\nWash the column with 700 μL RNA wash buffer and spin at >10,000 × g for 1 min, and discard the flow-though.\nWash the column with 400 μL RNA wash buffer and spin at >10,000 × g for 2 min, and discard the flow-through. Transfer the column to a fresh, nuclease-free centrifuge tube.\nElute with 7 μL nuclease-free water and keep the sample on ice or store at −20°C for up to a month. Expect to recover ∼6 μL.\nStore the adenylated adapter at −20°C.\nNote: Avoid repeated freeze-thaw of the adenylated adapter. Make aliquots prior to storing in the −20°C. Adapters should be prepared fresh after one month of storage at −20°C.\nEnd repair of RPFs\nTiming: 1 h\nThe 3′ phosphate at the end of each RPF is removed to allow for ligation with the adenylated 3′ adapter.\nAdd the following to the 3.5 μL RPF samples. Do not make a master mix and add each component individually.\ntable:files/protocols_protocol_3059_4.csv\nMix well and incubate the samples at 37°C for 1 h.\nPause point: Sample(s) can be stored at −20°C for up to a week.\nAdapter ligation\nTiming: 5 h and 15 min",
    "The end-repaired RPFs are ligated to the adenylated 3′ adapter. Leftover adapters are then removed using deadenylase and exonuclease.\nAdd 1 μL of adenylated adapter to each end repaired RPF sample and heat denature the sample(s) at 65°C for 2 min.\nNote: Hold the temperature at 4°C immediately after heat denaturation.\nAdd the following components to each heat-denatured sample. Do not make a master mix and add each component individually.\ntable:files/protocols_protocol_3059_5.csv\nNote: Allow 40% PEG-8000 to equilibrate at 20°C–25°C for about 20 min prior to adding it to the samples.\nCentrifuge briefly to consolidate the sample at the bottom of the tube(s).\nIncubate the sample(s) at 23°C for 3 h.\nPause point: Sample(s) can be stored at −20°C.\nAdd 1 μL of RecJ Exonuclease and 0.5 μL of Deadenylase to each sample and mix thoroughly by pipetting.\nIncubate the samples at 30°C for 2 h.\nPause point: Sample(s) can be stored at −20°C\nReverse transcription\nTiming: 1 h and 30 min\nConvert RNA samples into single-stranded cDNA using a reverse transcription (RT) primer that recognizes complementary sequences on the adapter-ligated to the RPFs in the previous step. Following reverse transcription, the RNA template is degraded.\nNote: We use the reverse transcription primer from McGlincy et al.,10[href=https://www.wicell.org#bib10] but do not include the first two random nucleotide sequences.\nPrepare the following mix for each sample:\ntable:files/protocols_protocol_3059_6.csv\nNote: Do not create a master mix. Prepare each mix individually per sample.\nAdd the 13 μL reverse transcription mix to each sample and mix well by pipetting.\nIncubate the sample(s) at 50°C for 30 min.\nAdd 1 μL of Exonuclease I to each sample and incubate at 37°C for 30 min followed by 15 min of incubation at 80°C. Hold samples at 4°C or place the samples on ice.",
    "Pause point: Sample(s) can be stored at −20°C\nAdd 1 μL Hybridase to each sample and incubate at 55°C for 5 min and hold at 4°C or place the samples immediately on ice.\nThe volume should now be 31 μL. Adjust the volume of each sample to 50 μL by adding 19 μL of nuclease-free water. Purify the samples with the Zymo RNA clean and concentrator kit.\nadd 100 μL RNA binding buffer and 150 μL 100% ethanol.\nLoad each column with the sample(s), spin for 1 min at >10,000 × g and discard the flow-through.\nWash each column with 400 μL RNA prep buffer and spin at >10,0000 × g for 1 min and discard the flow-through.\nWash each column with 700 μL RNA wash buffer and spin at >10,000 × g for 1 min and discard the flow-though.\nWash each column with 400 μL RNA wash buffer and spin at >10,000 × g for 2 min and discard the flow-through. Transfer each column to a fresh, nuclease-free centrifuge tube.\nElute cDNA samples with 11 μL nuclease-free water and keep the samples on ice or store at them −20°C. Expect to recover ∼ 10 μL.\nPause point: Sample(s) can be stored at −20°C.\nPAGE purification cDNA\nTiming: 3 h and 30 min\ncDNA fragments are extracted from a denaturing polyacrylamide gel to separate from potential side reaction products.\nPrepare the 20/100 oligo ladder and sample(s):\nAdd 10 μL 2× TBE-urea dye to each sample.\n20/100 oligo ladder: 1 μL 20/100 oligo ladder (0.1 μg/μL), 19 μL nuclease free water, 20 μL 2× TBE-urea dye.\nDenature the samples and ladder by boiling them at 95°C for 5 min. Place the sample(s) on ice immediately after.\nPrepare 800 mL of fresh 1× TBE buffer to run the gel.",
    "Prepare a 10% TBE-urea polyacrylamide gel by rinsing the wells with 1× TBE buffer and pre-running the gel for 5 min at 180 V prior to loading the sample(s).\nLoad 10 μL of the 20/100 oligo ladder or 20 μL of sample per lane.\nRun the gel at 180 V for 65 min or until the bromophenol blue bands reach the bottom of the gel.\nStain the gel with 3 μL of SYBR gold and 30 mL of 1× TBE running buffer on a shaker at 20°C–25°C for 20 min.\nCreate a hole in the bottom of a 0.5 mL tube using an 18-gauge needle. Place that 0.5 mL tube in a 1.5 mL tube. This will be used for shredding the gel.\nCut out the 85–105 nt bands using a fresh razor blade (Figure 3[href=https://www.wicell.org#fig3]).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3059-Fig3.jpg\nFigure 3. 10% TBE Urea Gel\n(A) Example cDNA gel. 20 μL of sample is loaded into one lane. Proceed with gel extraction regardless of whether a band is visible between 85–105 nt.\n(B) cDNA gel after extraction showing region cut.\nNote: The band near 70 nt corresponds to no insert reverse transcription products.\nNote: a band at this size range may not be visible due to the low amount of cDNA, but successful libraries can sometimes still be made in these cases.\nTransfer the slice(s) to the 0.5 mL tube(s) and centrifuge at 14,000 × g for 2 min.\nRemove and discard the 0.5 mL tube(s).\nTo each sample add the following components:\n400 μL nuclease-free water.\n40 μL 5 M ammonium acetate.\n2 μL 10% SDS.\nIncubate the sample(s) in a thermomixer at 37°C for 2 h at 900 rpm.",
    "Trim the end of a 1-mL pipette tip with a fresh razor and use that tip to transfer the gel slurry to a 1.5 mL centrifugal filter. Centrifuge the tube(s) at 2,000 × g for 3 min.\nTransfer the cDNA solution to a fresh 1.5 mL microcentrifuge tube and add the following to each tube.\n2 μL Glycoblue.\n700 μL 100% isopropanol.\nMix well and incubate the sample(s) for >2 h at −20°C.\nCentrifuge the tube(s) at >12,000 × g (4°C) for 20 min to pellet the cDNA.\nDecant the supernatant without disturbing the pellet.\nWash the pellet with 500 μL of ice-cold 80% ethanol and centrifuge (4°C) at >12,000 × g for 10 min.\nDecant the supernatant without disturbing the pellet and air dry for about 10 min.\nResuspend the pellet in 10 μL of nuclease-free water.\nPause point: Store the sample(s) at −20°C.\ncDNA circularization\nTiming: 2 h\nCircularize cDNA to flank both sides of the RPF cDNA with primer binding sites for PCR amplification.\nPrepare the following CircLigase mix for each sample:\ntable:files/protocols_protocol_3059_7.csv\nNote: Do not create a master mix. Prepare each mix individually per sample.\nAdd the 10 μL CircLigase mix to each sample and mix by pipetting. Centrifuge the sample(s) briefly.\nIncubate the sample(s) at 60°C for 2 h. Next, hold the samples at 4°C or immediately place them on ice.\nPause point: Sample(s) can be stored at −20°C\nPCR amplification of cDNA\nTiming: 50 min\nPCR amplify the circularized cDNA products to yield a dsDNA RPF library that is ready for Illumina sequencing.\nNote: Reverse primer sequences used at this step in the protocol are from the now discontinued Illumina TruSeq Ribo Profile kit.\nPick a unique index primer for each sample while considering the recommended combinations for optimal index color balancing.\ntable:files/protocols_protocol_3059_8.csv\ntable:files/protocols_protocol_3059_9.csv",
    "Prepare the following PCR mix for each sample.\ntable:files/protocols_protocol_3059_10.csv\nNote: Do not create a master mix, prepare each mix individually per sample.\nAdd 5 μL of the cDNA to the PCR master mix and mix thoroughly.\nPlace the tubes in a thermocycler and use the following program:\ntable:files/protocols_protocol_3059_11.csv\nNote: The number of PCR cycles can be raised to a maximum of 15 cycles.\nClean up PCR products with 1.8× Agencourt AMPure XP beads.\nAliquot 90 μL of the beads for each sample and allow them to reach 20°C–25°C.\nMix the PCR products with the beads thoroughly by pipetting at least 10 times. Incubate the bead and PCR mixture for 5 min at 20°C–25°C.\nPlace the tube(s) on a magnetic rack and wait 5 min.\nWhile keeping the tube(s) on the magnetic rack, remove the supernatant and add 200 μL of 80% ethanol to each tube. Wait 30 s and remove the ethanol.\nRepeat the ethanol wash for a total of two ethanol washes.\nAir dry the beads for up to 2 min until the ethanol in the tube evaporates.\nNote: Avoid over drying the beads as this may decrease the efficiency of the elution.\nRemove the tube(s) from the magnetic rack and resuspend the beads in 25 μL of nuclease-free water.\nIncubate the tube(s) at 20°C–25°C for 2 min.\nPlace the tube(s) back on the magnetic rack and wait 1 min.\nCarefully pipette the PCR products out of the tube(s) and transfer them to fresh tube(s).\nMeasure the DNA concentration of each sample using the dsDNA HS Qubit assay kit.\nSubmit the sample(s) for BioAnalyzer quality control.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3059-Fig4.jpg\nFigure 4. 8% TBE Gel\n(A) Example final library PCR product gel. 60 μL of sample is loaded across two lanes. RPF library migrates between 100 and 200 bp.",
    "(B) PCR gel after extraction showing region cut.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3059-Fig5.jpg\nFigure 5. Bioanalyzer profile of RPF library after PCR amplification and gel extraction cleanup\nThe final RPF library is 150–160 bp and is a clean single peak as expected.\nPause point: Sample(s) can be stored at −20°C\nPAGE purification of PCR products\nTiming: 3 h\nThe final dsDNA RPF library is extracted from a non-denaturing polyacrylamide gel to separate the library from unwanted side products such as adapter dimers (troubleshooting 5[href=https://www.wicell.org#sec6.9]). If the library is already a clean single peak of the correct library size, then skip this step and proceed to sequencing.\nPrepare the sample(s) and ladder:\nAdd 6 μL of 5× native TBE loading dye to each 25 μL of PCR products.\nUse 6 μL of the 100 bp–1 kb ladder.\nPrepare 800 mL of 1× TBE running buffer to run the gel.\nPrepare an 8% native TBE polyacrylamide gel by rinsing the wells with 1× TBE buffer and pre-running the gel for 5 min at 180 V before loading the sample(s).\nLoad 30 μL of each sample across two lanes (15 μL per lane) or load 6 μL of ladder in one lane.\nRun the gel at 200 V for 40 min.\nStain the gel with 3 μL of SYBR gold and 10 mL of 1× TBE running buffer on a shaker at 20°C–25°C for 20 min.\nCreate a hole in the bottom of a 0.5 mL tube using an 18-gauge needle. Place that 0.5 mL tube in a 1.5 mL tube. This will be used for shredding the gel.\nUsing a fresh razor blade, cut out the band at 140–160 bp and transfer it to the 0.5 mL tube(s) (Figure 4[href=https://www.wicell.org#fig4]).",
    "Centrifuge the tube(s) at 14,000 × g for 2 min. Discard the 0.5 mL tube(s) that was used for shredding the gel.\nTo each 1.5 mL tube, add the following components:\n400 μL nuclease-free water.\n40 μL 5 M ammonium acetate.\n2 μL 10% SDS.\nIncubate the sample(s) on a thermomixer at 37°C (900 rpm) for 2 h.\nTrim the end of a 1-mL pipette tip with a fresh razor and use that tip to transfer the gel slurry to a 1.5 mL centrifugal filter. Centrifuge the tube(s) at 2,000 × g for 3 min.\nTransfer the PCR product solution to a fresh 1.5 mL microcentrifuge tube and add the following to each tube:\n2 μL Glycogen.\n700 μL 100% isopropanol.\nMix each tube well and incubate >2 h at −20°C.\nCentrifuge the tube(s) at >12,000 × g (4°C) for 20 min to pellet the PCR products.\nDecant the supernatant without disturbing the pellet.\nWash the pellet with 500 μL of ice-cold 80% ethanol and centrifuge (4°C) at >12,000 × g for 10 min.\nDecant the supernatant without disturbing the pellet and air dry for about 10 min.\nResuspend the pellet in 25 μL of nuclease-free water.\nMeasure the concentration of PCR products using the Qubit dsDNA high-sensitivity kit.\nSubmit samples for BioAnalyzer quality control and sequencing (Figure 5[href=https://www.wicell.org#fig5]).\nPause point: Sample(s) can be stored at −20°C\nProcessing ribosome profiling sequencing data\nTiming: 4–5 h\nWe use an in-house integrated pipeline including RibORF 0.1, a software package used to score ORFs for translation based on Ribo-seq coverage. There are other ORF prediction tools that are newer than RibORF 0.1 that may also be used in addition or instead of RibORF.",
    "Note: It is recommended that users create a conda environment to manage the specific dependencies and tools needed to run the workflow. The pipeline will run optimally in a high-performance computing cluster environment. Users can create a conda environment using the following commands after installation of Anaconda or Miniconda.\nconda create -name Riboseq_env python=2.7.18\nconda activate Riboseq_env\nconda install -c bioconda star\nconda install -c bioconda homer\nconda install -c bioconda fastx_toolkit\nconda install -c bioconda samtools\nconda install -c bioconda bedtools\nObtain FASTQ files from the sequencer.\nNote: If the sample is paired end, then proceed with processing with the read 1 fastq file. The length of time for processing the sequencing files will depend on the size of the fastq file.\nInstall the required software tools of the pipeline and load the conda environment (see materials list above).\nDownload the fasta files for your reference genome. We will use the mouse mm10 reference genome for our example (https://hgdownload.soe.ucsc.edu/goldenPath/mm10/chromosomes/[href=https://hgdownload.soe.ucsc.edu/goldenPath/mm10/chromosomes/]).\nNote: We only include primary chromosomes in our alignments.\nDownload the gtf file for the reference annotation for your species. We will use the mouse GENCODE annotation in our example, which can be downloaded from the GENCODE website (https://www.gencodegenes.org/mouse/[href=https://www.gencodegenes.org/mouse/]).\nDownload the fasta files for the rRNA and tRNA sequences using the UCSC genome browser’s Table Browser tool to pull these sequences from the Repeat Masker tracks.\nDownload the RefSeq gene refFlat file and create a new file including only the coding genes annotated as “NM”. In our case we used the mouse mm10 version (http://hgdownload.cse.ucsc.edu/goldenPath/mm10/database/[href=http://hgdownload.cse.ucsc.edu/goldenPath/mm10/database/]).\nNote: Newer reference annotations may be used as available.\nGenerate the STAR index for both the reference genome annotation and the tRNA and rRNA files.\nSTAR --runMode genomeGenerate --genomeDir Reference output directory (mm10.star) --genomeFastaFiles input fasta --sjdbGTFfile gencode.gtf",
    "STAR --runMode genomeGenerate --genomeDir tRNA_rRNA output directory (mm10cont.star) --genomeFastaFiles tRNA_rRNA fasta --genomeSAindexNbases 7\nNote: A de novo transcriptome assembly can be used as an option in place of a reference annotation if there are RNA-seq samples sequenced in parallel with Ribo-seq data.\nFor Ribo-seq fastq processing, the first step is to trim the 3′ adapter sequence using the FASTX-toolkit. Untrimmed reads and reads less than 20 nt after trimming are discarded.\nzcat Sample.fastq.gz | fastx_clipper -Q33 -l 20 -n -v -c -a AGATCGGAAGAGCACACGTCTGAAC | fastx_trimmer -Q33 -f 1 2>> Sample.trimlog > Sample_trimmed_R1.fastq\npigz Sample_trimmed_R1.fastq\nThe trimmed reads are then aligned to rRNA and tRNA genes, which represent unwanted contaminants in Ribo-seq samples. Reads that align to these regions are discarded and the remaining reads are aligned to the entire genome. In these alignments we allow for multimapping reads for user flexibility, but later on we will filter out mutlimappers and use only uniquely aligned reads in our analyses.\nNote: STAR is our preferred splice-aware read alignment tool, but other similar tools can be substituted.\nSTAR --readFilesCommand zcat --outSAMstrandField intronMotif --outReadsUnmapped Fastx --genomeDir mm10cont.star --runThreadN 16 --readFilesIn Sample_trimmed_R1.fastq.gz --outFileNamePrefix Sample_trimmed_cont\nSTAR --outSAMstrandField intronMotif --genomeDir mm10.star --runThreadN 16 --readFilesIn Sample_trimmed_contUnmapped.out.mate1 --outFileNamePrefix Sample_trimmed_filtered --outFilterMismatchNmax 2 --outFilterMultimapNmax 4 --chimScoreSeparation 10 --chimScoreMin 20 --chimSegmentMin 15 --outSAMattributes All --outSAMtype BAM SortedByCoordinate\nThe resulting bam file Sample_trimmed_filteredAligned.sortedByCoord.out.bam is filtered for primary alignments using samtools to keep only the best scoring aligned multimappers.\nsamtools view -bS -F 0X100 Sample_trimmed_filteredAligned.sortedByCoord.out.bam > Sample_trimmed_filteredAligned.sorted.noSecondaryAlign.bam",
    "The resulting .bam file is used to generate bedgraphs through HOMER that can be uploaded and visualized in the UCSC genome browser or Integrative Genomics Viewer to look at Ribo-seq coverage. There are two bedgraph files that are generated. The Sample_trimmed_filtered_noSecondaryAlign.bedGraph file includes all reads from the .bam generated in step 143 including multimappers. The Sample_trimmed_filtered_noMulitMap.bedgraph file includes only the uniquely aligned reads.\nmakeTagDirectory tags_multi/Sample_trimmed_filtered_noSecondaryAlign Sample_trimmed_filteredAligned.sorted.noSecondaryAlign.bam -keepAll -totalReads all\nmakeUCSCfile tags_multi/Sample_trimmed_filtered_noSecondaryAlign -o Sample_trimmed_filtered.noSecondaryAlign.bedGraph -fragLength given -strand separate\nmakeTagDirectory tags_nomulti/Sample_trimmed_filtered_noMultiMap Sample_trimmed_filteredAligned.sorted.noSecondaryAlign.bam\nmakeUCSCfile tags_nomulti/Sample_trimmed_filtered_noMultiMap -o Sample_trimmed_filtered.noMultimap.bedGraph -fragLength given -strand separate\nAfter generating the bedgraph files, samtools is then used to remove the multimappers from the read file generated in step 143. This creates a read alignment file with only uniquely aligned reads and is used in the subsequent steps. Users can also choose to use the read alignment file that retains multimappers.\nsamtools view -bq 255 Sample.sorted.noSecondaryAlign.bam > Sample.sorted.noMultiMap.bam\nDetermine the RPF read length distribution (Figure 6[href=https://www.wicell.org#fig6]). One million reads are randomly sampled from the bam file and sorted by the read length.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3059-Fig6.jpg\nFigure 6. Length distribution plot of RPF reads\nRPF lengths peak around 28–29 nt as expected for fully digested ribosome footprints.\nNote: High quality Ribo-seq data should have the majority of the reads centered around 28–29 nt read lengths. You can plot the length frequency values in a graphing software tool such as R, Excel, or Prism to visualize the frequency distribution of the reads.\nsamtools view Sample.sorted.noMultiMap.bam | grep -E '(nM:i:0)|(ˆ@)'|awk -v v1=0.05 'BEGIN {srand()} !/ˆ$/ { if (rand() <= v1) print length($10)}' | head -n 1000000 | sort | uniq -c > Sample_alignedLengthHistogram.txt\nVisualize the aligned RPFs of each length relative to annotated CDS regions to choose the best offset correction such that the 5′ end of reads are aligned to ribosomal A-sites within coding regions.",
    "Note: A-site reads are defined by the first position of the codon located in the A-site of the RPF. For this example, we use the RefSeq coding gene refFlat file for our annotated coding regions. First, the .bam file from step 145 is converted to a .sam file using samtools. The pipeline will take the .sam file and run the readDist.pl script from the RibORF 0.1 software package to generate metagene plots to show the average read distributions from 30 nt upstream to 50 nt downstream of start sites and vice versa for stop sites. The step will generate plots for a given read length that the user selects. In the example below, an uncorrected metagene plot is generated for 30 nt reads. Repeat this step for all read lengths across the length distribution peak. For our example in Figure 6[href=https://www.wicell.org#fig6], we included read lengths 26–31 nt for visualization of metagenes.\nsamtools view -h Sample.sorted.noMultiMap.bam > Sample.sorted.noMultiMap.sam\nperl RibORF_v0.1/readDist.pl Sample.sorted.noMultiMap.sam mm10.RefSeq.coding.refFlat.txt Output File 30 30 50\nChoose the read lengths to include for offset correction based on the metagene plots generated in step 147. Only read lengths with good 3 nt periodicity should be included for offset correction. These will be the final set of reads used in smORF translation scoring.",
    "Note: During offset correct each, the number of bases to be shifted such that the 5′ end of the read aligns with the first position of the A-site codon is determined. For example, when analyzing high-resolution datasets, 28 nt foot prints usually require a 15 nt offset to align with the A-site. An offset parameters text file will need to be created as input into the offsetCorrect.pl script. The offset parameters file needs to be formatted into two columns separated by a tab. The first column is the read lengths to be offset corrected and the second column is the offset distance.\nperl offsetCorrect.pl Sample.sorted.noMultiMap.sam Sample.offset.correction.parameters.txt Sample.corrected.sam\nRun the readDist.pl script again using the corrected.sam file generated in step 148 to plot the corrected read locations of all lengths chosen by the user (Figure 7[href=https://www.wicell.org#fig7]). The read length should be set to 1 as all reads now represent the first position of the ribosomal A-site.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3059-Fig7.jpg\nFigure 7. Combined metagene plot of ribosome A-site offset corrected RPF reads\nMetagene plot shows good coverage and 3 nt periodicity within the translation initiation and termination sites. The different colored bars represent the three possible reading frames for translation. Red is reading frame 1 and is the coding frame for our metagene, blue is frame 2, and green is frame 3. RPM, reads per million.\nperl readDist.pl Sample_corrected.sam hg38.RefSeq.coding.refFlat.txt outputDirectory 1 30 50\nTranslate the reference transcriptome in all three reading frames using the GTFtoFasta Java script.",
    "Note: This script will parse all possible open reading frames, finding the most upstream canonical start codon and an in frame stop. If there is no canonical start codon, then the ORF will be defined by stop site to stop site. The output contains a .gtf file of all possible ORFs as well as peptide and nucleotide sequences for each ORF. Usage of the GTFtoFasta script is shown below using the GENCODE reference gtf.\njava GTFtoFasta gencode.annotation.gtf mm10.fa [MsOnly]\nUse the gtfToGenePred script from the UCSC tool collection to convert the ORFs gtf file generated in the previous step to a genePred file format. A custom python script is then used to convert the resulting genePred file to refFlat format.\ngtfToGenePred gencode.gtf gencode.gtf.genePred\npython2 genePred-to-refFlat-fixCoord.py gencode.gtf.genePred gencode.refFlat\nNote: The genePred-to-refFlat-fixCoord.py script shown below reformats the genePred to a refFlat format.\nimport sys\ninputfile1 = sys.argv[1]\noutputfile1 = sys.argv[2]\ninfile1 = open(inputfile1,'rU')\noutfile1 = open(outputfile1,'w')\nfor i in infile1:\n  split1 = i.strip().split('∖t')\n  outfile1.write(split1[0]+'∖t'+'.'+'∖t'+ split1[1]+'∖t'+ split1[2]+'∖t'+ split1[3]+'∖t'+ split1[4]+'∖t')\n  split[5] = split1[3]\n  outfile1.write(split1[5]+'∖t'+ split1[6]+'∖t'+ split1[7]+'∖t'+ split1[8]+'∖t'+ split1[9]+'∖n')\ninfile1.close()\noutfile1.close()\nRun the RibORF.pl script to score each ORF for translation using the offset corrected .sam file from step 148 and the ORF refFlat file from the previous step as inputs.\nNote: The R package required to be used with RibORF 0.1, e1071, is a support vector machine classifier that needs to be installed in the user’s PATH to run RibORF.pl. The resulting output file of predicted ORFs is the pred.pvalue.parameters.txt. We use an ORF length cutoff of 12 nt and a minimum read coverage cutoff of 10 reads.\nperl ribORF.pl -Sample_corrected.sam ORFs.refFlat outputDirectory 12 10",
    "Filter the ORF list for predicted translated smORFs by selecting for candidates that have a minimum p-value cutoff of 0.7 (based on the RibORF authors’ suggestion), maximum nucleotide length cutoff of 450 (representing ORFs of 150 codons and smaller), and a minimum read coverage cutoff of 10.\nawk '{ if ($15 >= 0.7 && $7 <= 450 && $8 >= 10) print $0 }' FS='∖t' OFS='∖t' pred.pvalue.parameters.txt > pred.pvalue.parameters.filtered.txt\nNote: The output pred.pvalue.parameters.filtered.txt file from step 153 is the list of smORFs that are predicted by RibORF to be translated. There are additional filtering steps that can be applied to remove smORFs that are already annotated or overlap with known coding genes. Additional tools that are recommended to be used are bedtools intersect and NCBI blast. The bedtools intersect tool can be used to filter out smORFs that are overlapping annotated coding regions. NCBI-blast can be used to filter out smORFs based on amino acid sequence similarity to annotated proteins."
  ],
  "subjectAreas": [
    "Genomics",
    "Rnaseq",
    "Sequence Analysis",
    "Bioinformatics",
    "Cell Culture",
    "Cell Biology",
    "Molecular Biology",
    "Gene Expression",
    "Sequencing"
  ],
  "bigAreas": [
    "Molecular Biology & Genetics",
    "Bioinformatics & Computational Biology",
    "Bioengineering & Technology"
  ]
}