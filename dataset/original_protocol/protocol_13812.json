{
  "id": 17638,
  "origin_website": "Jove",
  "title": "Human Fetal Blood Flow Quantification with Magnetic Resonance Imaging and Motion Compensation",
  "procedures": [
    "All MRI scans were performed with informed consent from volunteers as part of a study approved by our institutional research ethics board.\nNOTE: The methods described below have been used on a 3T MRI system. The acquisition is performed using a radial phase contrast MRI sequence. This sequence was prepared by modifying the readout trajectory (to achieve a stellate pattern) of the manufacturer's Cartesian phase contrast MRI. The sequence and sample protocols are available upon request through our C2P exchange platform. All reconstructions in this work were performed on a standard desktop computer with the following specifications: 32 GB memory, 3.40 GHz processor with 8 cores, and 2GB graphic card with 1024 compute unified device architecture (CUDA) cores. Image reconstruction was performed on MATLAB. Nonuniform fast Fourier transform (NUFFT)29 was performed on the graphics processing unit (GPU). Motion correction parameters were calculated using elastix30. Figure 1 depicts the protocol in a chronological order, tracking how the acquired velocity encodes (color coded in Figure 1) are processed with representative images at each stage of reconstruction. The reconstruction code is available at https://github.com/datta-g/Fetal_PC_MRI. While we provide the steps in the protocol here, most of these algorithm steps are automated in our pipeline.\n1. Subject positioning and localizer exams\nAssist the mother in positioning herself on the MRI table in her preferred comfortable position, usually supine or lateral decubitus positions, for the MRI exam.\nPlace the cardiac coil over the abdominal region of the mother.\nLoad the MRI table in the magnet bore and notify the mother that the scan is about to start.\nRun a localizer exam to locate the fetal body (resolution: 0.9 x 0.9 x 10 mm3, TE/TR: 5.0/15.0 ms, FOV: 450 x 450 mm2, slices: 6).",
    "Run a refined localizer exam to locate the fetal vasculature with the slice group centered on the fetal heart (resolution 1.1 x 1.1 x 6.0 mm3, TE/TR: 2.69/1335.4 ms, FOV: 350 x 350 mm2, slices: 10, orientation: axial to fetus).\nRepeat the refined localizers with sagittal and coronal orientations for a clearer view of the fetal vessels.\nRepeat the refined localizers in cases of gross fetal motion.\n2. Acquisition of fetal blood flow data\nLocate fetal vessels using the localizer exams. For example, the descending aorta is a long straight vessel near the spine in the sagittal planes. The ascending aorta and main pulmonary arteries can be identified as vessels leaving the left and right ventricles, respectively. The ductus arteriosus can be tracked as a downstream segment of the main pulmonary artery proximal to the descending aorta. The superior vena cava can be identified from axial planes near the base of the fetal heart as the vessel adjacent to the ascending aorta.\nPrescribe a slice perpendicular to the axis of the fetal vessel of interest. Rotate and move the slice guideline on the MRI console computer such that it intersects the target vessel perpendicularly.\nSet the scan parameters (acquisition type: radial phase contrast MRI, resolution: 1.3 x 1.3 x 5.0 mm3, echo time (TE)/ repetition time (TR): 3.25/5.75 ms, field-of-view (FOV): 240 x 240 mm2, slice: 1, velocity encoding: 100-150 cm/s depending on vessel of interest, velocity encoding direction: through plane, radial views: 1500 per encode, free breathing).",
    "Run the scan and verify the prescription based on the initial time-averaged reconstruction performed and displayed on the MRI console computer. Repeat the localizer and phase contrast scans if the target vessel is absent or unidentifiable from the initial reconstruction. Acquired raw data is represented in the schematic in Figure 1A with the velocity compensated and through plane acquisitions color coded as red and blue, respectively.\nRepeat the fetal blood flow data acquisition for each target blood vessel.\n\tNOTE: The acquired raw data (format: DAT files) must be transferred for offline reconstruction. For example, on Siemens scanners, this can be performed by running 'twix'. The acquired raw data is right clicked from the list acquisitions and \"copy total raid file\" is chosen.\n3. Motion correction of fetal measurements\nReconstruct real-time series (temporal resolution: 370 ms, radial views: 64) from the acquired data using CS with 15 iterations of a conjugate gradient descent optimization exploiting spatial total variation (STV, weight: 0.008) and temporal total variation (TTV, weight: 0.08) regularization as represented by the schematic in Figure 1B.\nSelect a region of interest (ROI) encompassing the vessel of interest from this first real-time reconstruction using a graphic user interface developed in MATLAB. In this step, the user must draw a contour that encloses the fetal anatomy, such as the target great vessels or the fetal heart.\nPerform rigid-body motion tracking with elastix30 (based on normalized mutual information with empirically optimized parameters: 4 pyramid levels, 300 iterations and translational transforms).\nReject tracked real-time frames that share low mutual information (MI) with all other frames (whereby MI is less than 1.5x the interquartile range from the mean MI). These frames are deemed to be represented through plane motion or gross fetal motion.",
    "Use the MRI data corresponding to the longest series of continuous real-time frames (without gaps) from the remaining frames as the quiescent period used for further reconstruction.\nInterpolate translational motion correction parameters from the temporal resolution of the real-time series (370 ms) to the TR of the quiescent acquisition (5.75 ms).\nApply interpolated parameters to the defined quiescent period of the MRI data by modulating the phase as in:\nimgsrc://cloudfront.jove.com/files/ftp_upload/61953/61953_eq01.png\n\twhere s' is the motion corrected data, kx and ky are the coordinates in k-space, s is the acquired uncorrected data, Δx and Δy are the tracked displacements in space, and j represents imgsrc://cloudfront.jove.com/files/ftp_upload/61953/61953eq2.jpg.\n\tNOTE: All numerical values of regularization coefficients in this work were optimized in earlier experiments. This was accomplished using a brute-force grid search to find the regularization coefficients that minimized the error between reconstructions of a highly sampled fetal reference dataset and retrospectively undersampled cases from the same dataset.\n4. Solving for fetal heart rate\nReconstruct a second real-time image series at a higher temporal resolution (temporal resolution: 46 ms, radial views: 8) using the acquired data using CS, again with 15 iterations of a conjugate gradient descent optimization with STV (weight: 0.008) and TTV (weight: 0.08) regularization as represented by the schematic in Figure 1C.\nRe-select an ROI encompassing the fetal vessel of interest.\nRun multiparameter MOG on the real-time series to derive the time-dependent fetal heart rate.\nBin motion corrected MRI data into 15 cardiac phases using the derived heart rate waveform. In this step, the temporal boundaries of the cardiac phases are computed using the heart rate from the previous step. For instance, the boundaries for the ith phase in the kth heartbeat are given by:\nimgsrc://cloudfront.jove.com/files/ftp_upload/61953/61953_eq1a.png\nimgsrc://cloudfront.jove.com/files/ftp_upload/61953/61953_eq1b.png",
    "where HR(K) is the time at which the kth heartbeat occurs. The timestamp of the nth radial acquisition is given by (n x TR). Data with timestamps falling within the boundaries of a cardiac phase are assigned to that phase.\n\tNOTE: MOG is a gating technique26 that comprises iterative binning of the acquired data based on a multi-parameter fetal heart rate model to create CINE images that optimize an image metric over a region of interest.\n5. Reconstruction of fetal CINEs\nReconstruct fetal flow CINEs using the binned motion corrected MRI data and CS with 10 iterations of a conjugate gradient descent optimization with STV (weight: 0.025) and TTV (weight: 0.01) regularization. Two CINEs are produced at this step: one for the flow compensated acquisition, CFC, and one with the flow encoded data, CFE, as represented in the schematic in Figure 1D.\nCompute the velocity image given by the phase of the elementwise product of CFE and the complex conjugate of CFC.\nApply background phase correction31 to correct for eddy current effects. Briefly, in this automatic step, a plane is fitted to the phase of static fetal and maternal tissues. The correction is performed by subtracting the plane from the velocity sensitive phase computed in 4.2.\nWrite reconstructed data into DICOM files.\nLoad DICOMs into flow analysis software, such as Segment v2.232.\nDraw an ROI encompassing the lumen of the blood vessel of interest using the anatomical and velocity sensitive images.\nPropagate the ROI to all cardiac phases and correct for changes in the vessel's diameter.\nRecord flow measurements.\nSubscription Required. Please recommend JoVE to your librarian."
  ],
  "subjectAreas": [
    "Medicine"
  ],
  "bigAreas": [
    "Biomedical & Clinical Research"
  ]
}