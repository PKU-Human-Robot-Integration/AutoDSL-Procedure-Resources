{
  "id": 1664,
  "origin_website": "Cell",
  "title": "Manipulating cellular microRNAs and analyzing high-dimensional gene expression data using machine learning workflows",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nMiRNA data analysis\nTiming: The time to run miRNA data analysis using Least Absolute Shrinkage and Selection Operator (LASSO) penalized regression and bootstrapping depends on the installed memory (RAM) of the computer, dataset size and the number of bootstraps. On a 16.0 GB RAM computer, to run a dataset of ∼90 samples and ∼750 independent variables with 1000 bootstraps requires approximately 15–30 mins.\nThis process of data analysis yields a set of miRNAs that are important in separating the two groups of samples (group A (0) or group B (1)). The miRNAs with higher bootstrap frequencies (ranked higher in importance) are then used for functional analysis using manipulation approaches described later.\nEnsure that your dataset looks like the example shown in Figure 1[href=https://www.wicell.org#fig1].\nOpen or paste our R script used for penalized regression and bootstrap analysis in Rstudio. It can be found through https://github.com/Isletbiology/Penalized-regression[href=https://github.com/Isletbiology/Penalized-regression].\nCritical: Make sure to keep the set.seed() the same and in the “dv” column all the samples in group A (“0”) are before group B (“1”) to produce a consistent output each time you run the script.\nSet up directory in setwd() function as indicated in the R script. Directory is the location of where your data (excel document) is located.\nNote: for the directory location entered in R, convert the “\\” to “/” at every instance.\nRead data (excel document) using read_excel() function (from readxl package).\nSet the number of independent variables (i.e., miRNAs) as mentioned in the R script to analyze in the following function:\nindep_var <- paste(“v”, 4:757, sep=””).",
    "Note: In this example, the independent variables are coded v4 to v757. However, these can be set to any start and end numbers as per your experimental variable numbers and the way data is entered in the excel file. In such case ensure that correct number is reflected in the script.\nProvide the number of bootstraps (iterations) as indicated in the R script in the following function:\nboot_num <- 1000.\nNote: In our case bootstrap set at 1000 times was sufficient. It can be increased up to 10,000 bootstraps and would require longer computational times for generating results. Bootstrapping through the glmnet R package, involves randomization by eliminating ∼37% samples and replacing them with the same number of samples selected randomly at each bootstrap from the remaining samples in the set. This approach is a renowned sampling method (Efron and Tibshirani, 1997[href=https://www.wicell.org#bib2]).\nCreate an output directory (i.e., the location of where the results will be exported into) and file name (for the results) as presented in the R script in the following function:\noutput <- \"../results/name_\".\nNote: In this case the “results” folder located in the output directory is the location for your results. The file name(s) will start with “name_” for the results that will be exported.\nRun the script.\nCheck the directory folder where the results would be exported to (after the run has completed). The script will produce three results document file:\nA PDF document (name__Lasso_PENALIZED_full_data.pdf), containing the penalized regression graph presenting the coefficient and lambda1 of the selected independent variables.\nA CSV document (name_select_var_using_entire_data.csv), containing the independent variables and their coefficient selected through penalized regression analysis.\nA CSV document (name_Lasso_IF_Lambda (min)_boot_n=1000.csv), containing the bootstrap results.",
    "Critical: If the results are not produced, check for errors presented in the run. The errors will be in red text on the Rstudio messages window. Often the results are not produced due to the excel document being in the incorrect format or the function in the script is incorrect (see Troubleshooting 1[href=https://www.wicell.org#sec6.1], 2[href=https://www.wicell.org#sec6.3], 3[href=https://www.wicell.org#sec6.5], and 4[href=https://www.wicell.org#sec6.7]).\nOpen and observe the pdf and csv document containing the penalized regression graph and independent variable coefficients.\nNote: The L-1 penalized regression approach (Goeman, 2010[href=https://www.wicell.org#bib4]) is generated using the “penalized” R package. The penalized regression graph presents on the x-axis the lambda (a tuning parameter determined/chosen by cross-validation) and on the y-axis the coefficients for the selected variables (miRNAs). In penalized regression analysis a penalty is applied to each independent variable (miRNA) as presented by the lambda (x-axis) and this value is increased until the coefficient (y-axis) obtained is 0. An optimum lambda is selected as a cutoff for identifying the most important/relevant variables. The variables (miRNAs) with coefficients not equal to 0 (right y-axis) at this optimum lambda are considered to be important contributors to the prediction model. Thus, the lambda represents a threshold for identifying the most important variables, the coefficients on y-axis present the weights of the variables selected and together, they inform the user of the contribution of each variable (relative weights) to the prediction model. The coefficients of the intercept and variables shown in csv document can be used to determine if a particular sample is in group A(0) or B(1), using the simple regression formula (Montgomery et al., 2021[href=https://www.wicell.org#bib16]).\nOpen and interpret the csv document containing bootstrap results (an example is shown in Figure 2[href=https://www.wicell.org#fig2]).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1126-Fig2.jpg\nFigure 2. Representative image of the output result",
    "Figure presents the frequency table produced by our penalized logistic regression with bootstrapping. The frequency table can be used to identify the most important discriminatory miRNAs. For example, v490 appears with >96% frequency, suggesting it is one of the most important miRNAs in discriminating dv “0” and dv “1”.\nNote: The document with the bootstrap results will contain the (independent) variable(s), sign, count, frequency and opposite_effect in columns A to E respectively. The “variable” column contains the coded variables representing a unique miRNA. The “sign” column identifies which group (A or B) the corresponding miRNA (variable) is higher in Ct- value. For example, miRNA with a sign of “−1” indicates that it has higher Ct-value in group A (i.e. 0). While if the miRNA has a sign of “1”, it has higher Ct-value in group B (i.e. 1). The “opposite_effect” column is used to check if the independent variable (miRNA) appears to be positive (“1” in sign column) in some iterations and negative (“−1” in sign column) in some other bootstrap iterations. When the opposite effect is “TRUE” that means that miRNA is higher (Ct-value) in group “0” for some iterations, while it is lower (Ct-value) in group “0” for other iterations. It will thus appear in the bootstrap table twice, one with a positive sign and another time with a negative sign. If the opposite effect is “FALSE” then that means the miRNA is always higher or lower in all iterations. The “count” column presents the number of times (in this case out of 1000 times(iterations)) the variable is selected to in the model. The “frequency” column reflects the count in percentage. MiRNAs with higher frequencies are of greater importance in our analysis.",
    "Use output results (Figure 2[href=https://www.wicell.org#fig2]) to prioritize the miRNAs based on counts (or % frequency) for over-expression/loss-of-function studies as described below.\nCritical: This R script used for penalized regression with bootstrap analysis is not suitable for a dataset with <10 samples.\nNote: In instances where unprejudiced workflows for the selection of multiple variables is desired, alternate machine learning approaches, such as Ensemble workflows using Random Forest or similar analytical tools can be used as described elsewhere (Wong et al., 2021b[href=https://www.wicell.org#bib24]).\nDerivation and propagation of human islet cells for transient miRNA knockdown\nTiming: prior to transfection\nSet water bath at 37°C.\nClean the biosafety cabinet with 80% v/v ethanol and allow 15 min UV sterilization.\nPrepare medium (CMRL-1066) supplemented with 1% GlutaMAX™, 10% fetal bovine serum, 1× of penicillin-streptomycin, and 10 ng/mL epithelial growth factor. Refer to table as described in materials and equipment[href=https://www.wicell.org#materials-and-equipment] section for human islet cells and islet-derived progenitor cells (hIPCs).\nAdd around 3500–5000 islet equivalents (IEQs) per T75 flask in CMRL serum-containing medium (as prepared in step #15). Detailed characterization of these islets to proliferating populations of hIPCs via epithelial-to-mesenchymal transition (EMT) (Joglekar and Hardikar, 2010[href=https://www.wicell.org#bib8]) is described (Gershengorn et al., 2004[href=https://www.wicell.org#bib3]; Joglekar et al., 2009b[href=https://www.wicell.org#bib11], 2016[href=https://www.wicell.org#bib12]; Joglekar and Hardikar, 2012[href=https://www.wicell.org#bib9]).\nWe observe that islets attach to the culture flasks in 1–3days (d), after which the islets flatten out with cells migrating out and then proliferating to form epithelial patches within 7-10d. We feed these islet-derived cells with fresh medium once they attach and then after every 3-4d.\nIn this study, we have used islet-derived cells at d8-10 for knockdown experiments. These cells continue to express insulin mRNA, protein and secrete insulin in response to glucose for up to 2 weeks (Joglekar et al., 2016[href=https://www.wicell.org#bib12]).\nKnockdown of miRNA expression\nTiming: 1 week",
    "MiRNA manipulation can be performed either by increasing or reducing their abundance, followed by testing their effect on potential targets. In this step, we detail the protocol for using Locked Nucleic Acids (LNA) power inhibitors to reduce miRNA expression in human islet cells. LNA power inhibitors are preferred since they are taken up by the cells without the need for any transfection agents. This significantly reduces adverse effects (including cell death) on primary cells such as islet cells. Transient transfection was performed to understand short term effect of selected miRNA(s).\nSet water bath at 37°C.\nClean the biosafety cabinet with 80% v/v ethanol and allow 15 min UV sterilization.\nReconstitute the miRNA LNAs from Qiagen (Qiagen, Hilden, Germany) at a concentration of 50 μM using sterile nuclease-free (NF) water. Aliquot into sterile tubes, each with 5 μL volume to avoid repeated freeze-thaw. Freeze and store the stock at −20°C.\nPrepare trypsin using the reagents as described in materials and equipment[href=https://www.wicell.org#materials-and-equipment] section.\nWarm culture media for islet cells (prepared in step #15) and trypsin at 37°C water bath.\nEnsure human islet cells at d8-10 (in culture) from the time of isolation are available at approximately 90%–95% confluency.\nRemove medium and add 5 mL trypsin and incubate for 3 min at 37°C in a 5% CO2 incubator.\nEnsure the cells are detached by observing them under the microscope. Add 2 mL serum-containing medium to stop further action of trypsin. Collect the cells and transfer them into a 15 mL tube and centrifuge at 500 × g for 3 min. Remove the supernatant.\nResuspend the cells in 4 mL of serum-containing medium.\nCount the cells and add 4×104 – 5×104 per well of a tissue-culture treated 24-well plate. Each well should have a final volume of 500 μL.",
    "Allow the cells to attach for 16–24 h.\nAdd miRNA LNA power inhibitor to each well to obtain a final concentration of 500 nM/well. See Troubleshooting 5[href=https://www.wicell.org#sec6.9]\nNote: To inhibit more than one miRNA at the same time, we recommend lowering the concentration of each LNA power inhibitor to keep the combined concentration to 500 nM. For example, in the case of inhibiting five miRNAs together, add 100 nM of each of the miRNA-specific inhibitor to the same well to obtain a total concentration of 500 nM.\nLeave the cells with miRNA LNA power inhibitor for 3-6d.\nHarvest cells for downstream analyses at d3 or d6 post-transfection. Cells can be harvested either as a cell pellet in a Eppendorf (1.7 mL) tube, following steps #25-26 or collected directly in 500 μL/well of TRIzolTM reagent (ThermoFisher scientific, United States).\nCritical: TRIzolTM reagent is harmful if inhaled, swallowed, or if it is in contact with the skin, and can cause severe skin burns and eye damage. Safety measures include wearing PPE and rinsing/washing affected area with water. It is recommended that this is handled in a fume cabinet and safely disposed as it is harmful to aquatic life.\nPreparation for miRNA stable overexpression\nTiming: prior to transduction",
    "MiRNA overexpression can be achieved via transfecting mature miRNAs with the help of transfection agents (Lahmy et al., 2014[href=https://www.wicell.org#bib14]; Lopez-Beas et al., 2018[href=https://www.wicell.org#bib15]; Poudyal et al., 2018[href=https://www.wicell.org#bib18]). To understand sustained overexpression of a single or combination of miRNAs, we selected an inducible system where miRNA overexpression is regulated by the presence of doxycycline. Other methods based on Cumate-vectors are reported (Mullick et al., 2006[href=https://www.wicell.org#bib17]; Poulain et al., 2017[href=https://www.wicell.org#bib19]). Doxycycline-inducible vectors were preferred since they were readily available. However, Cumate vectors are preferred in scenarios where pre-miRNA overexpression is desired. One has to be mindful of post-processing regulations as some miRNAs are present as pre-miRNAs (Joglekar et al., 2009a[href=https://www.wicell.org#bib10]).\nSet water bath at 37°C.\nClean the biosafety cabinet with 80% (v/v) ethanol and allow 15 min UV sterilization.\nPrepare medium (high glucose DMEM) supplemented with 1% GlutaMAX™, 10% fetal bovine serum, 1× of penicillin and streptomycin cocktail. Refer to table as described in materials and equipment[href=https://www.wicell.org#materials-and-equipment] section for PANC1 cells.\nWarm culture media for PANC1 cells (prepared in step #35) at 37°C.\nThaw one vial of third-generation doxycycline-inducible and puromycin-resistant SMARTvector™ shRNA (short hairpin RNA) lentiviral vectors (containing mature miRNA sequences and co-expressing either GFP or RFP) on ice with titers of approximately 1×108 TU/mL.\nCritical: Always work with lentiviral particles in a biosafety cabinet within PC2 facility while wearing recommended PPE. Ensure the protocol is approved by the institutional biosafety committee.\nCalculate the volume of the vector for a multiplicity of infection (MOI) of 0.2 for 1.25 X 105 number of cells. The following formula can be used\nV= (MOI × N)/T, where V=required volume of viral vectors in mL; MOI=multiplicity of infection; N=number of cells and T=titer of the viral vectors per mL.",
    "PANC1 cells (Hardikar et al., 2003[href=https://www.wicell.org#bib6]), obtained from Sigma Aldrich (or similar/ATCC) are recommended to be used at lower passages (up to 10 passages).\nNote: Alternatively, we have also applied methods described below on human islet-derived progenitor cells (hIPCs). For further details on hIPCs, please refer to our publications (Gershengorn et al., 2004[href=https://www.wicell.org#bib3]; Joglekar et al., 2009b[href=https://www.wicell.org#bib11], 2016[href=https://www.wicell.org#bib12]; Joglekar and Hardikar, 2012[href=https://www.wicell.org#bib9]).\nEnsure PANC1 cells or hIPCs are available at desired density for use.\nGenerating miRNA overexpressing PANC1 cell lines\nTiming: 4 weeks\nPuromycin dose optimization (week 1, d1-7)\nGrow PANC1 or hIPCs in the respective serum-containing medium in a T75 flask until they are approximately 90%–95% confluent.\nRemove medium and add 5 mL trypsin and incubate for 3 min at 37°C in 5% CO2 incubator.\nEnsure the cells are detached by observing them under the microscope. Add 2 mL serum-containing medium to stop further action of trypsin. Collect the cells and transfer into a 15 mL tube and centrifuge at 500 × g for 3 min.\nRemove the supernatant and resuspend the cells in 4 mL of serum-containing medium.\nCount the cells and add 4×104 – 5×104 per well of a tissue-culture treated 24-well plate. Each well should have final 500 μL volume.\nAllow the cells to attach for 16–24 h. Ensure that the wells are just 50%–60% confluent. See Troubleshooting 6[href=https://www.wicell.org#sec6.11]\nCritical: It is important to have just enough cells (50%–60%) at the time of puromycin addition. Higher cell density may lead to inappropriate puromycin dose calculation. A wrong dosage of puromycin in later stages of this experiment would kill untransduced as well as transduced cells thereby reducing the transduction efficiency.\nAdd different doses of puromycin per well, ranging from 0-10 μg/mL (Figure 3[href=https://www.wicell.org#fig3]). Change the medium in the wells with the same dose of puromycin after d3.",
    "imgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1126-Fig3.jpg\nFigure 3. Optimization for puromycin concentration\nUntransduced hIPCs with increasing puromycin concentrations (0–10 μg/mL) in the serum-containing medium. Cells were observed every day and imaged on d7. Images of cells with concentrations of >1 μg/mL are not shown since all cells were killed off. Scale bar 100μm.\nCritical: Puromycin has acute oral toxicity and is harmful if swallowed. Safety measures include washing hands thoroughly and rinsing the mouth with water if consumed.\nVisually inspect all wells at the end of d7 to determine the lowest concentration of puromycin that kills all the non-modified/untransduced cells (100%). In our experience, 8 μg/mL of puromycin was sufficient to kill all PANC1 cells or 2 μg/mL in hIPCs.\nTransduction of lentiviral vectors carrying miRNAs (week 2, d1-5)\nCulture and trypsinize PANC1 or hIPCs as described above for step 41 (a-d).\nCount the cells and add 1.25×105 per well of a tissue-culture treated 12-well plate. Each well should have final 1 mL volume.\nAllow the cells to attach for 16–24 h. Ensure that the wells are just 60%–70% confluent. Troubleshooting 6[href=https://www.wicell.org#sec6.11]\nCritical: It is important to know the cells you are working with, to understand their doubling time as well as cell size. These factors decide the number of cells to be added per well. Ideally, the cell density at this point should be 60%–70%, which allows these cells to grow and reach confluency in d3 post-transduction. The number of cells is also crucial to calculate the MOI. Each cell type has a different growth rate as well as the number/cm2 of a particular tissue culture surface area may differ.",
    "Add third-generation doxycycline-inducible and puromycin-resistant SMARTvector™ shRNA lentiviral particles (containing mature miRNA sequences and co-expressing either GFP or RFP) at a MOI of 0.2 along with 8 μg/mL polybrene to fresh culture medium. Replace the media in the wells with this freshly prepared medium pre-mixed with lentivirus and polybrene.\nNote: We did not observe higher cell death after transduction in a medium containing antibiotics in comparison to performing transduction in an antibiotic-free medium.\nIncubate the cells with viral vectors for 24 h and then change the culture medium with fresh serum-containing medium.\nAfter d3 post-transduction, trypsinize the cells and transfer them to 6-well plate. This ensures the desired lower density of cells before puromycin addition, as detailed in step #41.\nPuromycin selection of transduced cells (week 3, d1-7)\nAdd optimal concentration of puromycin as determined in step #41, for 7 days to kill off any untransduced cells.\nNote: After the d7, only transduced cells will survive since they harbor the puromycin-resistance gene. Afterwards, do not use puromycin for culturing/growing transduced cells.\nContinue culturing the puromycin-selected miRNA-vector transduced PANC1 cells in serum-containing DMEM medium for at least another week and transfer to larger culture flasks when they become confluent.\nOptimization of doxycycline concentration (week 4, d1-4)\nGrow transduced cells in the respective serum-containing medium until they are approximately 90%–95% confluent.\nTrypsinize the cells and add to tissue-culture treated 24-well plate at 60%–70% confluency.\nAdd doxycycline at concentrations of 0, 50, 200, 500 or 1000 ng/mL for 3 days to determine the optimal presence of fluorescent protein (GFP or RFP, inserted along with the miRNAs in the lentiviral vector backbone (https://horizondiscovery.com/-/media/Files/Horizon/resources/Technical-manuals/smartvector-inducible-lentiviral-shRNA-manual.pdf[href=https://horizondiscovery.com/-/media/Files/Horizon/resources/Technical-manuals/smartvector-inducible-lentiviral-shRNA-manual.pdf]) via fluorescent microscopy (Figure 4[href=https://www.wicell.org#fig4]).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1126-Fig4.jpg\nFigure 4. Transduced human islet-derived progenitor cells",
    "hIPCs transduced with doxycycline-inducible lentiviral vectors expressing green fluorescence protein (TurboGFP) in serum-containing medium with either no doxycycline (A and C) or 200 ng/mL doxycycline (B and D). Scale bar 200μm.\nCritical: Doxycycline is harmful if inhaled, swallowed, or if it is in contact with skin. Safety measures include wearing personal protective equipment (PPE) and rinsing/washing affected area with water.\nWe observe a dose of 1000 ng/mL doxycycline to induce fluorescence (an indirect measure of miRNA overexpression) in all PANC1 cells with the highest intensity and lowest cell death (or 200 ng/mL doxycycline in hIPCs).\nNote: MiRNA expression can be determined using real-time PCR (Wong et al., 2015[href=https://www.wicell.org#bib21]) and compared between untransduced and transduced cells (Hardikar et al., 2014[href=https://www.wicell.org#bib5]). To maintain miRNA expression in these cells, doxycycline should be added at every medium change. Considering the half-life of exogenously added doxycycline, we recommend media change every 3-days.\nThis puromycin-selected miRNA-vector transduced PANC1 or hIPCs can be continued to grow in serum-containing medium or can be cryofrozen based on experimental need."
  ],
  "subjectAreas": [
    "Bioinformatics",
    "Computer Sciences",
    "Cell Culture",
    "Molecular Biology",
    "Gene Expression"
  ],
  "bigAreas": [
    "Bioengineering & Technology",
    "Molecular Biology & Genetics",
    "Bioinformatics & Computational Biology"
  ]
}