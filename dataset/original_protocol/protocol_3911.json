{
  "id": 4115,
  "origin_website": "Cell",
  "title": "Chemical-genetic CRISPR-Cas9 screens in human cells using a pathway-specific library",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nPooled chemical-genetic CRISPR-Cas9 screen\nTiming: ∼3–4 weeks",
    "Before beginning the screens, it is important to estimate the amount of each reagent and plasticware that will be needed and order ahead of time, and these depend in large part on the desired sgRNA coverage. Picking an sgRNA coverage is a balance between maintaining the highest possible sgRNA coverage to obtain reliable data, and an sgRNA coverage that is feasible given a particular laboratory’s constraints. When using smaller, pathway-specific sgRNA libraries such as the UPS library, it should be feasible to maintain at least 1,000-fold coverage of each sgRNA throughout the screen. For genome-wide libraries, it is common practice to maintain 300-fold coverage. When conducting a screen to look specifically for resistance to a particular compound or treatment, less than 1,000-fold coverage is generally sufficient. Based on the desired sgRNA coverage, calculate how many 15 cm plates are needed for each of three replicates for each condition (untreated/vehicle, compound 1, compound 2, etc.). For one replicate of one compound and with the UPS sgRNA library in HAP1 cells, one 15 cm plate is more than enough to maintain over 1,000-fold coverage of each sgRNA throughout the screen, taking into account the number of cells per plate when the cell number is at its lowest (e.g., when splitting a plate and taking a fraction of it forward to seed a new plate). This also leaves enough cells to keep a fraction of a plate every two days as a sample to prepare for next-generation sequencing (e.g., T2, T4, etc. in Figure 1[href=https://www.wicell.org#fig1]). With two people and using the UPS sgRNA library and HAP1-Cas9 cells, it is possible to do three replicates of 20-30 different compounds/treatments (including untreated/vehicle), or a total of 60-90 plates, at one time.",
    "The replicates can be on the exact same timeline, or replicates can be staggered on alternating days such that replicates one and two are split on one day (40–60 plates) and replicate three is split on the next day (20–30 plates). It is not recommended to do the three replicates at completely different times as this will introduce more variability.",
    "Please refer to Figure 1[href=https://www.wicell.org#fig1] for an outline of the experimental timeline, where time point zero (T0) indicates the day cells are initially split into desired compounds (or other desired treatment is initiated). Time points before T0 are indicated with a minus sign, e.g., T-14, T-13, etc.\nT-14 through T-11: Generate sgRNA library lentivirus.\nUsing the results from the “determine optimal lentiviral titer” section, calculate how many 15 cm dishes of 293T cells are needed to infect three independent clones of HAP1-Cas9 (one for each replicate) at an MOI of approximately 0.3, and with enough HAP1-Cas9 cells that ≥1,000-fold sgRNA coverage will be maintained. Also take into account how many HAP1-Cas9 cells will be needed by T0 to split into each compound or treatment of interest (including the untreated/vehicle controls) and to collect some of each replicate as the “post-dox” samples. In our hands, two 15 cm dishes of 293Ts will produce enough UPS sgRNA library lentivirus to infect three 15 cm dishes of each of the three independent HAP1-Cas9 clones. Because HAP1-Cas9 grow quite quickly, there will be several opportunities to split and expand the cells between the infection on T-11 and the initiation of treatment on T0.\nOne to two days before transfecting 293T cells (T-14 or T-13), seed 293T cells in 15 cm dishes such that they will be ∼60% confluent on T-12.\nOne to two days before transfecting 293T cells (T-13 or T-12), seed three independent clones of HAP1-Cas9 cells (representing three replicates) in four 15 cm dishes each such that they will be ∼70% confluent on T-11. The fourth 15 cm dish of each HAP1-Cas9 clone will serve as un-infected/negative control dishes for later puromycin selection. Grow HAP1-Cas9 cells in blasticidin (10 μg/mL final) until the infection.\nOn T-12, transfect 293T cells.",
    "Check 293T cells and ensure they are healthy and ∼60% confluent.\nPre-warm transfection reagent (FuGENE HD) to RT (∼22°C).\nPre-warm 4–6 mL of serum-free media (e.g., Opti-MEM) to RT (∼22°C).\nAssemble transfection mix: first add the Opti-MEM and DNA, mix thoroughly by vortexing or pipetting, then add the FuGENE HD and mix gently by pipetting. These amounts work well using the UPS sgRNA library and HAP1-Cas9 cells, but this will likely need to be optimized for a different sgRNA library or cell line. Note that the transfer vector (UPS sgRNA library) to psPAX2 to pCMV-VSV-G ratio should be maintained if altering the total amount of DNA. Note that 3 μL of FuGENE HD should be used for every 1 μg of DNA.\ntable:files/protocols_protocol_880_10.csv\nIncubate transfection mix at RT (∼22°C) for 10 min.\nRetrieve two 15 cm dishes of 293T cells from incubator.\nIn hood, gently add transfection mix dropwise (2 mL per dish). Gently swirl dishes in a circular motion several times.\nReturn dishes to incubator.\n5–6 h after the transfection, replace the media on the 293T cells with pre-warmed IMDM (4 mM L-glutamine) + 10% FBS (normal growth media for HAP1 cells), using 10 mL per plate (1/2 the volume usually used for a 15 cm dish). Starting at this step, treat all materials as potentially contaminated with lentivirus.\nT-11 through T-5: Infect HAP1-Cas9 cells with sgRNA library and select for integration. Throughout the infection and selection process, check the functional titer of the virus (as described in “Determine optimal lentiviral titer”) to ensure that the MOI is close to 0.3.\nOn T-11, check 293T and HAP1-Cas9 cells to ensure the former are healthy and dense (∼80%–90% confluent), and the latter are healthy and ∼70% confluent.\n24 h after transfection on T-11, harvest the lentivirus from the 293T media:",
    "Using a 30 mL plastic syringe, slowly collect the media from the two 15 cm dishes of 293T cells (∼20 mL total).\nSlowly filter the lentiviral media with a 0.45 μm SFCA filter into a sterile, sealable bottle (≥200 mL capacity). This step should filter out any 293T cells that came off the plate.\nAdd pre-warmed IMDM (4 mM L-glutamine) + 10% FBS to bring the total volume to 120 mL. Note that the lentiviral dilution should be adjusted according to the results obtained in the “determine optimal lentiviral titer” section.\nAdd polybrene to 8 μg/mL final. Gently mix by inverting bottle several times.\nBleach and discard 293T dishes.\nFor each HAP1-Cas9 clone, gently aspirate the media from three of the 15 cm dishes. Gently pipette 10 mL of the diluted lentiviral media from (iv) onto the wall of each dish so as not to dislodge the HAP1 cells. Return dishes to incubator.\nOne dish of each HAP1-Cas9 clone will serve as the un-infected/negative control. For each negative control dish, gently aspirate the media and replace the media with 10 mL pre-warmed IMDM (4 mM L-glutamine) + 10% FBS. Return dishes to incubator.\nOn T-10, remove virus and change media.\nCheck HAP1-Cas9 cells. They should be more confluent than the day before (∼80%–90% confluent), but often grow slower in the presence of lentivirus than without. Some cell death may be observed due to the infection and/or polybrene. Use the un-infected/negative control dishes for comparison.\n24 h after infecting HAP1-Cas9 cells, gently aspirate the lentiviral media from each dish (or the negative control media), and add 20 mL fresh, pre-warmed IMDM (4 mM L-glutamine) + 10% FBS per dish.\nOn T-9, begin selection for sgRNA integration with puromycin day 1.\nCheck HAP1-Cas9 cells. They should be very confluent (∼90%–100% confluent).",
    "24 h after removing lentiviral media: split cells into puromycin (1 μg/mL final). Cells should be split quite dense (1/2 of cells split into a new 15 cm dish). If expansion is necessary at this point, use all of the cells and seed two new 15 cm dishes for every original 15 cm dish (or six 15 cm dishes per HAP1-Cas9 clone). Split the un-infected/negative control dishes in the same manner. Note that 1 μg/mL puromycin works well for HAP1-Cas9 cells in our hands, but the best dose should be determined empirically.\nOn T-8, begin puromycin day 2.\nCheck un-infected/negative control dishes. 24 h of puromycin treatment should begin to kill the negative control cells, indicated by many cells rounding up on the dish and some beginning to detach.\nCheck infected dishes. Observe the confluency and extent of rounded and detached cells. The infected cells should appear more resistant to puromycin than the negative controls, but significant cell death should occur in puromycin if MOI was close to 0.3.\nUn-infected/negative controls: change the media and give fresh puromycin (1 μg/mL final).\nInfected dishes: change the media and give fresh puromycin (1 μg/mL final).\nOn T-7, begin puromycin day 3.\nAs on T-8, observe confluency and observe number of cells rounding up on the dish and floating. The un-infected/negative controls should be very sparse at this point (∼5%–10% confluent) with many detached, floating cells. Infected dishes should be relatively dense (∼60%–90%) and have fewer floating cells than the negative controls.\nUn-infected/negative controls: change the media and give fresh puromycin (1 μg/mL final).\nInfected dishes: change the media and give fresh puromycin (1 μg/mL final).\nOn T-6, begin puromycin day 4.",
    "Observe confluency and observe number of cells rounding up on the dish and floating. The un-infected/negative controls should be almost completely dead at this point (<5% confluent) with some detached, floating cells. Infected dishes should be relatively dense (∼70%–100% confluent), depending on the precise MOI.\nUn-infected/negative controls: change the media and give fresh puromycin (1 μg/mL final).\nInfected dishes: split cells into puromycin (1/3 of cells split into a new 15 cm dish). If necessary, expand each infected HAP1-Cas9 clone by seeding more than one new 15 cm dish per starting dish.\nOn T-5, end puromycin selection.\nObserve confluency and observe number of cells rounding up on the dish and floating. The un-infected/negative controls should be completely dead at this point (if not, a higher puromycin dose is likely needed), indicating that puromycin selection is complete. Infected dishes should be very dense (∼80%–100% confluent).\nUn-infected/negative control dishes: discard.\nInfected dishes: split cells into media without puromycin (1/5 to 1/3 of cells split into a new 15 cm dish). If necessary, expand each infected HAP1-Cas9 clone by seeding more than one new 15 cm dish per starting dish. Note that one 15 cm dish (or enough to achieve ≥1,000-fold sgRNA coverage) per HAP1-Cas9 clone must be collected the following day (T-4) to serve as “pre-dox” samples for next-generation sequencing. The “pre-dox” samples are critical for analyzing the screen data as they represent the initial sgRNA distribution before treatment with compounds and before the deletion of essential genes begins to affect cell growth.\nT-4 through T-1: Collect “pre-dox” samples & induce Cas9 expression.",
    "On T-4, collect a “pre-dox” sample for each HAP1-Cas9 clone. Collect sufficient cells for ≥1,000-fold sgRNA coverage. One 15 cm plate of HAP1-Cas9 cells infected with the UPS sgRNA library is more than enough for 1,000-fold coverage since one ∼90% confluent 15 cm of HAP1-Cas9 cells has approximately 6 × 107 cells (6 × 107 cells/6,306 sgRNAs = 9,500-fold coverage). Collecting excess cells at this point is recommended since some loss may occur at later steps.\nPre-chill 1× PBS with 5 mM EDTA to 4°C.\nPre-chill 1× PBS to 4°C.\nPre-label “pre-dox” 15 mL conical tubes for sample collection.\nFill an ice bucket with ice.\nGently aspirate the media from the “pre-dox” plates to be collected.\nDispense 10 mL chilled PBS with 5 mM EDTA per plate.\nAllow to sit ∼2–3 min.\nGently collect cells by pipetting up and down across the dish surface several times. Note that HAP1 cells lift off of plates easily and do not require scraping or extended incubations. Transfer cells in PBS-EDTA to labeled conical tubes on ice.\nGently pellet cells at 800 × g for 5 min at 4°C.\nAspirate supernatant.\nAdd 5 mL chilled PBS to each pellet.\nGently pellet cells at 800 × g for 5 min at 4°C.\nAspirate supernatant.\nFlash freeze pellets and store at −80°C until ready to perform “genomic DNA extraction” step.\nAlso on T-4, begin Cas9 induction with doxycycline day 1.\nOn remaining HAP1-Cas9 dishes, change the media and add doxycycline hyclate to 1 μg/mL final.\nOn T-3 and T-2, continue Cas9 induction with doxycycline days 2 and 3.\nObserve confluency and number of cells rounding up and floating. Some cell death may begin to occur during treatment with doxycycline as essential genes are deleted by some sgRNAs in the library.",
    "If dishes are very confluent on T-3 or T-2 (≥80% confluent), split into new 15 cm dishes with doxycycline hyclate at 1 μg/mL final (1/4 to 1/3 of cells split into a new 15 cm dish). If necessary, expand each HAP1-Cas9 clone by seeding more than one new 15 cm dish per starting dish. As T0 approaches, keep in mind the number of cells that will be needed per replicate per compound (including untreated/vehicle controls). If desired, a “post-dox” sample can be collected for each replicate on T0, which would require having another 15 cm dish per replicate ready by T0.\nIf dishes are less confluent on T-3 or T-2 (<80% confluent), change the media and give fresh doxycycline hyclate (1 μg/mL final).\nOn T-1, end doxycyline induction of Cas9.\nObserve confluency and number of cells rounding up and floating. Some cell death may occur as essential genes are deleted by some sgRNAs in the library.\nIf dishes are very confluent (≥80% confluent), split into new 15 cm dishes (1/4 to 1/3 of cells split into a new 15 cm dish). If necessary, expand each HAP1-Cas9 clone by seeding more than one new 15 cm dish per starting dish.\nIf dishes are less confluent (<80% confluent), leave until T0.\nT0: Split cells into compounds to begin screen.\nPre-warm sufficient IMDM (4 mM L-glutamine) + 10% FBS, PBS, and trypsin.\nLabel new 15 cm dishes for all compounds (including untreated/vehicle) for each replicate.\nIf required, thaw aliquots of compounds to be used.\nPrepare reagents needed to collect “post-dox” samples for each replicate (optional) as described above for collecting “pre-dox” samples.\nObserve confluency for all plates of each HAP1-Cas9 clone.\nBased on confluency and earlier dosing experiments, seed cells in each desired compound plus untreated/vehicle control dishes.",
    "Remember to always maintain ≥1,000-fold sgRNA coverage for each compound for each replicate, taking into account the expected growth reduction and/or death caused by each compound or treatment. If using the UPS sgRNA library, seed ≥1 × 107 HAP1-Cas9 cells per dish.\nWhen adding compounds to dishes, be sure to mix thoroughly by gently swirling dish before placing in the incubator.\nWork in batches so that cells are not are out of the incubator for too long (≤20 min).\nIf collecting “post-dox” samples, follow the same protocol described above for collecting “pre-dox” samples. It is helpful to have a second person spin and wash the cell pellets while the first person continues splitting and seeding cells.\nT1: Check cells after one day in compounds/treatments.\nRecord confluency and other observations for all plates of each HAP1-Cas9 clone in each compound/treatment and untreated/vehicle controls.\nEffects should be similar to that observed during the dosing trial.\nT2, T4, and T6: Continue the screen.\nEvery second day (T2, T4, T6), observe confluency, death, and cell morphology for all plates of each HAP1-Cas9 clone in each compound/treatment and untreated/vehicle controls.\nBased on confluency, determine how to split and seed each dish to maintain sufficient sgRNA coverage. Each replicate for the same compound/treatment and untreated/vehicle control should be treated similarly to the other replicates.\nSplit and seed cells in fresh compound or untreated/vehicle control, working in batches so that cells are not out of the incubator for too long (≤20 min).",
    "Excess cells can be collected at T2, T4, and T6 for next-generation sequencing. Collect these samples in a similar manner to the “pre-dox” samples, with the following alteration: if collecting a subset of a 15 cm dish and using the rest to seed a new plate, transfer the excess trypsinized and quenched cells to pre-labeled 15 mL conical tubes on ice (no PBS+EDTA required), then proceed to pelleting and washing as described. It is helpful to have a second person spin and wash the cell pellets while the first person continues splitting and seeding cells.\nT8 or later: Complete screen & collect final samples.\nOn the final day of the screen (e.g., T8), record confluency and other observations for all plates of each HAP1-Cas9 clone in each compound/treatment and untreated/vehicle controls.\nCollect all remaining cells as T8 samples. Collect these samples in a similar manner to the T2, T4, and T6 samples, using trypsin to remove cells from dishes rather than PBS+EDTA.\nIf desired, screen can be continued for longer than eight days.\nCritical: Sufficient sgRNA coverage must be maintained throughout the screen when splitting and seeding cells, and sufficient sgRNA coverage must be maintained when collecting samples for next-generation sequencing. Note that data quality will be improved with higher coverage, so if possible, higher coverage is better. An advantage of working with a small sgRNA library is that maintaining higher coverage is feasible.\nCritical: Care must be taken throughout the screen to treat all replicates consistently and to prevent cross-contamination and bacterial or fungal contamination.\nCritical: “Pre-dox” and T8 (or other endpoint) samples must be collected for each replicate. “Post-dox” and T2, T4, and T6 samples are optional.",
    "Note: HAP1 cells are normally seeded much more thinly to account for their rapid growth and to avoid overcrowding. In contrast, during the screen where sgRNA coverage must be maintained throughout puromycin selection, Cas9 induction, and exposure to toxic compounds, HAP1-Cas9 cells should be seeded at a higher density.\nGenomic DNA extraction\nTiming: 1–3 days\nIn this step, genomic DNA is extracted from the cell pellets stored at −80°C. This genomic DNA will then be used as the templates for PCRs to amplify the integrated sgRNAs and to append Illumina sequencing adapters and indexes. Genomic DNA extraction is performed with a Nucleospin blood L midi kit (Macherey Nagel), using the following protocol adapted from the kit manual. Note that the following steps assume each cell pellet contains approximately 2-6 × 107 HAP1 cells, and adjustments must be made if using a different number of cells.\nBefore starting the genomic DNA extraction:\nPrepare all kit solutions according to manufacturer’s instructions (e.g., add anhydrous ethanol to Wash Buffer BQ2, and dissolve the lyophilized Proteinase K in Proteinase Buffer PB).\nPre-warm the elution buffer (Buffer BE) to 70°C.\nSet a water bath to 56°C.\nMidi kit columns should be stored at 4°C until use.\nUse a swinging bucket centrifuge that can reach the required speeds.\nPrepare a designated “pre-PCR” area and set of pipettes to conduct the genomic DNA extraction and to set up the subsequent PCRs (described in “next generation sequencing library preparation[href=https://www.wicell.org#sec2.3]” section). This area must be separate from any work done after sequencing library prep PCRs (denoted as “post-PCR” work). Thoroughly clean the area and pipettes with 10% bleach followed by 70% ethanol.\nUse filter tips and DNase/RNase free plastics.\nCare must be taken throughout to avoid cross-contaminating samples from different replicates and different compound treatments.",
    "Genomic DNA extraction using Nucleospin blood L midi kit.\nThaw cell pellets at RT (∼22°C).\nResuspend each pellet in 2 mL of PBS by gently pipetting up and down 5–10 times.\nAdd 150 μL of Proteinase K solution to resuspended cells. Mix by gently swirling tube.\nAdd 20 μL of a 20 mg/mL RNase A solution. Mix by gently swirling tube.\nAdd 2 mL of Buffer BQ1. Vortex for 10 s.\nIncubate in 56°C water bath for 15 min, vortexing twice during incubation. If sample is still very viscous at the end of the incubation, extend incubation time an additional 5–10 min at 56°C.\nPlace on ice for 5–10 min to cool samples to RT (∼22°C).\nAdd 2 mL anhydrous 96%–100% ethanol. Mix immediately by inverting tube 10 times.\nPlace nucelospin blood L column in provided collection tube and add 3 mL of the lysate solution. Avoid moistening the rim of the column.\nCentrifuge at 4,500 × g for 5 min at RT (∼22°C).\nRemove the column and discard the flow through. If some lysate remains in the column, centrifuge at 4,500 × g for an additional 5 min or until all of the lysate passes through the column. Discard the flow through.\nTo wash the silica membrane, carefully replace the column in the collection tube and add 2 mL of Buffer BQ2. Avoid moistening the rim of the column.\nCentrifuge at 4,500 × g for 2 min.\nRemove the column and discard the flow through.\nPerform a second wash by carefully replacing the column in the collection tube and adding 2 mL of Buffer BQ2. Avoid moistening the rim of the column.\nCentrifuge at 4,500 × g for 10 min.\nRemove the column and discard the flow through.",
    "To ensure the silica membrane is completely dry, perform another spin at 4,500 × g for 5 min.\nTransfer the column to a new collection tube.\nPipette 170 μL pre-warmed Buffer BE (70°C) directly onto the center of the membrane.\nIncubate for 5 min at RT (∼22°C).\nCentrifuge at 4,500 × g for 2 min.\nTo obtain a high yield of DNA, perform a second elution using the same column and collection tube. Pipette 170 μL pre-warmed Buffer BE (70°C) directly onto the center of the membrane, incubate for 5 min at RT (∼22°C), and centrifuge at 4,500 × g for 2 min.\nCollect flow through and transfer to a microcentrifuge tube.\nQuantify genomic DNA using a fluorometric assay (e.g., Qubit dsDNA assay).\nStore samples at −20°C or proceed directly to next generation sequencing library preparation PCR.\nNote: Using a Nanodrop or similar method to quantify genomic DNA concentration will vastly overestimate DNA yield due to contamination of carry-over RNA.\nNext generation sequencing library preparation\nTiming: 1–3 days\nIn this step, one round of PCR is used to amplify the sgRNAs integrated into the genome and to append Illumina sequencing adapters and indexes. Unlike typical PCRs, these reactions use a large quantity of template genomic DNA in order to maintain sufficient coverage of the sgRNA library. We found that with a small sgRNA library—such as our 6,306 sgRNA UPS library—and with approximately 2-6 × 107 HAP1 cells per sample only one round of PCR, rather than two sequential PCRs as described previously (Han et al., 2017[href=https://www.wicell.org#bib3]), is needed to prepare samples for sequencing. Larger libraries and/or more cells per sample may require two sequential PCRs to prepare samples for next generation sequencing, and whether one or two PCRs are needed may need to be determined empirically.",
    "Before assembling PCRs, determine the number of samples that can fit in one lane of the Illumina sequencer that you will use. This number depends on both the size of your sgRNA library and the desired sgRNA coverage (e.g., 1,000-fold). This number will dictate the number of unique Illumina indexes (and therefore unique 5′ adaptor primers) that you need. In this protocol, we use an Illumina HiSeq 4000 for sequencing, which yields an average of 3.9 × 108 pass-filter reads and 20,000 MB per lane. Typically, approximately 85% of the reads are useable and align exactly with the sgRNA library. With our UPS library of 6,306 sgRNAs we can combine up to 45 samples in one lane, with each sample amplified with a unique 5′ adaptor primer containing a unique hexamer barcode. This yields sequencing results with an average sgRNA coverage over 1,100-fold. For sufficient sequence diversity at the start of the reads, our sequencing core recommends sequencing about one half of the samples per lane in the opposite orientation. For a diagram explaining the two orientations and for the complete list of primers containing Illumina adapters and indexes used in this step, see Hundley et al. (2021)[href=https://www.wicell.org#bib8] Table S2.",
    "Critical: To avoid contamination of PCRs with highly concentrated amplified PCR products, PCRs must be set up in a designated “pre-PCR” area and using “pre-PCR” pipettes that are distinct from the “post-PCR” area and pipettes. Use filter tips, pre-PCR-dedicated reagents (e.g., ultra-pure water and PCR tubes), and clean all surfaces and pipettes with 10% bleach followed by 70% ethanol. Note that many labs routinely use various CRISPR-Cas9 plasmids, such as lentiGuide-Puro (a modified version of which was used to generate our UPS library), and these plasmids could also be contaminants when preparing the next generation sequencing library by PCR. To determine whether contamination is an issue, always include two types of negative control reactions when preparing a batch of PCRs for next generation sequencing: 1) no template control/no DNA sample, and 2) template from HAP1-Cas9 cells without integrated sgRNAs. Use at least one set of primers for the negative control reactions. The control genomic DNA samples (2) should yield no product. The no template control (1) may have a trace of a band, and this is the more stringent but less “accurate” control.\nCritical: To obtain valid and interpretable sequencing results, care must be taken throughout PCR set up to avoid cross-contamination of PCRs. Work with one template/sample at a time, and bleach surfaces and pipettes in between templates/samples. Gel purification should be performed with clean gel casting and running components and with fresh running buffer. A fresh razor blade or similar cutting implement should be used to excise each gel band from a unique pooled sample.\nPCR to append Illumina adapters and indexes.",
    "Determine how much input genomic DNA should be used as a template for the sequencing library preparation PCRs. A rough calculation can be performed as follows to estimate the amount of genomic DNA to use. Assuming 6 × 109 bases per diploid human genome and 660 Daltons per base, one human cell contains roughly 6.6 × 10-12 g or 6.6 pg of genomic DNA. For our UPS library containing 6,306 sgRNAs, to maintain at least 1,000-fold coverage of each sgRNA, use (6.6 pg genomic DNA per cell) × (6.306 × 106 cells) or 41.6 μg. Note that this calculation does not take into account mitochondrial DNA or genomic variations (e.g., ploidy) that may be present in different cell lines. Because this is a rough estimate, overcompensate and use 50 μg of genomic DNA as template for these PCRs.\nAssemble PCRs with the correct amount of template DNA and with the correct 3′ adaptor primer and 5′ adaptor primer with unique index. Use no more than 10 μg of genomic DNA per 100 μL reaction. For more details on potential primers and indexes that can be used, see Hundley et al. (2021)[href=https://www.wicell.org#bib8], Table S2. As described above, assemble at least two negative control reactions, one containing no DNA and the other containing template DNA from cells lacking integrated sgRNAs.\nMake a reaction master mix on ice containing all reagents except the variable 5′ adaptor primer and template genomic DNA. Mix gently by pipetting up and down several times.\ntable:files/protocols_protocol_880_11.csv\nAliquot master mix to PCR tubes on ice.",
    "Add the correct template genomic DNA and 5′ adaptor primer with unique index (and, if necessary, more ultra-pure water to 500 μL total). Mix gently by pipetting up and down several times. When using a thermocycler that fits 500 μL tubes, put no more than 100 μL in each tube, splitting one reaction up into five tubes.\nRun the PCRs using the following cycling conditions. Only a fraction of the PCR products will be sequenced, and it is important to avoid introducing bias. Therefore, it is best to use as few cycles as possible, and the optimal number of cycles should be determined empirically.\ntable:files/protocols_protocol_880_12.csv\nAgarose gel electrophoresis.\nOnce PCRs are complete, re-combine the five 100 μL reactions that amplified the same genomic DNA sample. Run a small fraction (e.g., ∼1%–3%) of each sample on an agarose gel to determine whether the reaction worked. A larger fraction of the negative control reactions should be run (e.g., ∼10%) for more sensitive detection of possible contamination. Run alongside a DNA ladder of known concentration to enable quantification of PCR product bands. See Figure 2[href=https://www.wicell.org#fig2] for an example.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/880-Fig2.jpg\nFigure 2. Example PCR products for sequencing library preparation\n1.4% agarose gel of a sub-set of PCR products from replicates 1 and 2 treated with one of several compounds (A-M) for 8 days. UT, untreated. Pre, pre-dox. Post, post-dox. Each lane has 5 μL of a 300 μL reaction that began with 30 μg of genomic DNA, and each was amplified with a unique 5′ adaptor primer with unique index. “No template control” and “Negative control DNA” lanes each contain 10 μL of a 100 μL reaction. “Negative control DNA” reaction used 10 μg of genomic DNA from HAP1-Cas9 cells not infected with the sgRNA library.",
    "If any reactions have substantially lower yield than the others, repeat and consider using a different 5′ adaptor primer with unique index if possible.\nPool PCR products for next generation sequencing.\nEstimate concentration of PCR products relative to DNA ladder of known concentration using Fiji or another gel quantification tool.\nIf reaction yields are within two-fold of one-another, proceed to pooling samples. If not, repeat and optimize reactions that were significantly less efficient before proceeding to pooling (see troubleshooting[href=https://www.wicell.org#troubleshooting] section for additional information).\nPool all samples that will be sequenced in one lane of an Illumina HiSeq 4000 (or similar). For samples with yields within two-fold of one-another combine an equal volume of each reaction into a low retention tube. For our UPS library, a 300 μL reaction generally contains approximately 10 μg of the 265 bp product which is about 3.5 × 1013 copies. To maintain 1,000-fold coverage and to account for potentially significant loss during gel purification, use approximately 20 μL of each 300 μL PCR (roughly 800–900 ng of DNA or 3 × 1012 copies) to make the pooled sample.\nGel purification of pooled PCR products.\nPrior to running the gel, ensure that all gel casting and running equipment is thoroughly cleaned and be sure to use fresh running buffer.\nRun the pooled sample in desired sample loading buffer on an agarose gel with large lanes to accommodate the large sample. Select the appropriate agarose percentage and gel run time to achieve good separation between the sgRNA cassette band and any background bands. TAE buffer is preferred over TBE for preparative gels.\nGel purify the pooled sample using the Macherey-Nagel NucleoSpin Gel and PCR clean-up mini kit (or another DNA gel purification kit).",
    "Prepare NucleoSpin kit components according to manufacturer’s instructions (e.g., add anhydrous 96%–100% ethanol to wash butter NT3).\nPre-warm the elution buffer (Buffer NE) to 70°C.\nSet a water bath to 56°C.\nUsing a clean razor blade, excise the gel band containing the sgRNA cassette. Remove as much excess gel as possible. Work as quickly as possible to limit UV damage to the sample.\nDetermine the weight of the gel slice(s) and record.\nAdd 200 μL Buffer NTI for every 100 mg of agarose gel (if using <2% agarose).\nIncubate sample for 30–60 min in a 56°C water bath with occasional vortexing to ensure the gel slice completely dissolves.\nAfter gel slice is completely dissolved, add 3M sodium acetate to 30 mM final. Mix by inverting tube several times.\nUse one NucleoSpin Gel column per 10 μg of starting DNA. With 44 pooled samples from our UPS library, we start with approximately 40 μg of DNA (∼900 ng per sample), so we split the sample over four columns. Place NucleoSpin Gel columns in provided collection tubes and load 700 μL of dissolved gel slice per column.\nCentrifuge at 11,000 × g for 30 s at RT (∼22°C).\nRemove the columns and discard flow through.\nReplace columns in collection tubes. Load 700 μL of dissolved gel slice per column and repeat spin.\nRepeat until all dissolved gel slice solution has been loaded onto the columns.\nTo wash the silica membranes, replace the columns in the collection tubes and add 700 μL of Buffer NT3.\nCentrifuge at 11,000 × g for 30 s.\nRemove the columns and discard flow through.\nPerform a second wash step by replacing the columns in the collection tubes, adding 700 μL of Buffer NT3 per column, and centrifuging at 11,000 × g for 30 s.",
    "Remove the columns and discard flow through.\nTo ensure the silica membrane is completely dry, replace the columns in the collection tubes and spin at 11,000 × g for 4 min.\nPlace the columns in new 1.5 mL collection tubes.\nPipette 30 μL of pre-warmed Buffer NE directly unto each column.\nIncubate for 5 min at RT (∼22°C).\nCentrifuge at 11,000 × g for 1 min.\nIf sample was split over several columns, combine eluates from same initial sample in a low retention tube (e.g., for a pool of 44 samples from our UPS library screens which were split over four columns, pool all four eluates for a final volume of approximately 110 μL).\nDetermine DNA concentration by NanoDrop or similar method.\nTo check for successful removal of background bands, run a small fraction of the pooled and gel purified sample on an agarose gel alongside a PCR product that has not been pooled or gel purified. See Figure 3[href=https://www.wicell.org#fig3] for an example.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/880-Fig3.jpg\nFigure 3. Example of pooled and gel-purified PCR products for sequencing\n1.4% agarose gel of two example individual PCR reactions (as in Figure 2[href=https://www.wicell.org#fig2]) and a pooled then gel-purified sample containing the products of 44 individual PCRs. Individual PCR reaction lanes contain 5 μL of a 300 μL reaction that began with 30 μg of genomic DNA. Pooled and gel purified lane contains 2 μL (or ~450 ng) of approximately 110 μL recovered from gel purification. Note that despite careful gel purification, bands at larger sizes begin to appear over time, possibly from annealing of PCR products. This does not seem to interfere with sequencing.",
    "Critical: When using a custom sgRNA library for the first time, you should also sequence the library itself using a unique Illumina indexing primer. This will enable evaluation of the library for relative sgRNA distribution, which may be unequal if the library was not amplified properly or may indicate unequal distribution in synthesized oligonucleotides from the oligo synthesis company (the latter of which is less likely to be a problem when ordering pooled oligonucleotides from a company that performs rigorous QC). When we sequenced our UPS library, 248 sgRNAs out of 6,306 (or ∼3.9%) had aligned counts below 100, while the average sgRNA coverage was 1,100 and the median was 1,063. These 248 sgRNAs were removed from later analysis, as is typically done in most CRISPR-Cas9 screen analysis pipelines.\nOptional: The pooled, gel purified sample can also be checked for concentration and size distribution by Bioanalyzer High Sensitivity DNA assay or similar. Some sequencing cores require this analysis prior to next generation sequencing. However, unlike whole genome sequencing and other related methods where sample shearing is involved and generates fragments of variable lengths, a pooled and purified PCR product from this type of CRISPR-Cas9 screen should yield DNA fragments of uniform length. Therefore, a diagnostic agarose gel is usually sufficient.\nNote: For more robust data analysis, it may be beneficial to sequence additional reactions of samples that form the basis for key calculations (e.g., untreated/vehicle and “pre-dox” samples). This can be accomplished by preparing multiple PCRs for these samples using several different 5′ adaptor primers, each with different indexes.\nSequencing & analysis\nTiming: ∼2–3 weeks (depending on length of queue at sequencing facility)",
    "Next generation sequencing is performed using an Illumina HiSeq 4000 with single end, 50 base reads, and using common 3′ and 5′ sequencing primers and an indexing primer provided by the core facility [UCSF Center for Advanced Technology (CAT)]. Alternative sequencing technologies can be used with adjustments.\nTo trim and align raw sequencing reads in Hundley et al. (2021)[href=https://www.wicell.org#bib8], we used Max Horlbeck’s Screen Processing code available on GitHub (Horlbeck et al., 2016[href=https://www.wicell.org#bib6]) and the Canpoy platform for Python. Note that Canopy has since been phased out and was replaced by Enthought Deployment Manager (EDM). Other methods exist to process raw sequencing reads from CRISPR-Cas9 screen data, including the MAGeCK pipeline and its derivatives (Li et al., 2014[href=https://www.wicell.org#bib9]). Several methods exist for downstream data analysis, including that presented in Hundley et al. (2021)[href=https://www.wicell.org#bib8], drugZ (Colic et al., 2019[href=https://www.wicell.org#bib2]), and BAGEL (Hart and Moffat, 2016[href=https://www.wicell.org#bib5]). The user should decide which method(s) to use based on the screen particulars, and note that adjustments to code may be necessary depending on sgRNA library, sequencing method, and other factors.\nSubmit samples for sequencing.\nDilute pooled and gel purified sample to 3–10 nM (∼1–3 ng/ μL) in 15 μL in a low retention tube.\nCombine 3′ and 5′ sequencing primers in 10 μL at 100 μM in a low retention tube.\n3′ sequencing primer: 5′-CGGTGCCACTTTTTCAAGTTGATAACGGACTAGCCTTATTTTAACTTGCTATTTCT AGCTCTAAAAC-3′\n5′ sequencing primer: 5′-TGCTTACCGTAACTTGAAAGTATTTCGATTTCTTGGCTTTATATATCTTGTGGAAA GGAC-3′\nSequencing core will likely provide the standard Illumina indexing primer.\nSubmit sample and 3′ and 5′ sequencing primer mixture.\nPreliminary analysis once raw sequencing reads are available from sequencing facility.\nInstall TextWrangler or similar on computer\nGo to: https://github.com/mhorlbeck/ScreenProcessing[href=https://github.com/mhorlbeck/ScreenProcessing]",
    "Follow directions in “ScreenProcessing_tutorial.pdf” to count sgRNAs in raw sequencing files (Step 1: fastqgz_to_counts.py) with necessary modifications for specific sgRNA library, cell line, etc. If processing a large number of files, do not run the code on all files at once as this will crash most standard computers.\nThe code will trim raw sequencing reads down to the 20 nucleotide sgRNA sequence (removing the rest of the 50 base raw reads).\nThe code will align trimmed raw sequencing reads to your RefLib and RefLib_revcomp files, which can be made in TextWrangler or similar.\nThe code will generate count files of the number of trimmed sequencing reads that align with the RefLib files, as well as counts of unaligned reads. These output files can be transferred from TextWrangler to Microsoft Excel or other spreadsheet software. Note that it is normal for ∼85% of reads to align with RefLib or RefLib_revcomp (and for ∼15% of reads to not align).\nFurther data analysis considerations including exclusion of sgRNAs with low counts, normalization, and statistical analysis is discussed in Hundley et al. (2021)[href=https://www.wicell.org#bib8]."
  ],
  "subjectAreas": [
    "High Throughput Screening",
    "Genetics",
    "Crispr"
  ],
  "bigAreas": [
    "Molecular Biology & Genetics"
  ]
}