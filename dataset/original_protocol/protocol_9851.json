{
  "id": 10262,
  "origin_website": "Jove",
  "title": "Measuring 3D In-vivo Shoulder Kinematics using Biplanar Videoradiography",
  "procedures": [
    "Prior to data collection, the participant provided written informed consent. The investigation was approved by Henry Ford Health System's Institutional Review Board.\nProtocols for acquiring, processing, and analyzing biplane radiographic motion data are highly dependent upon the imaging systems, data processing software, and outcome measures of interest. The following protocol was specifically designed to track the scapula, humerus, and the third and the fourth ribs during scapular-plane or coronal-plane abduction and to quantify glenohumeral, scapulothoracic, and humerothoracic kinematics.\n1. CT imaging protocol\nAsk the participant to lie supine onto the CT examination table with their arms at their sides. Depending on the participant's size, position them off center on the table such that the entire hemi-torso is available for imaging.\nTo acquire the scout images, the technologist ensures that the CT field of view includes the clavicle (superiorly), the distal humeral epicondyles (inferiorly), the entire glenohumeral joint (laterally), and the costovertebral and sternocostal joints (medially) (Figure 1).\nAcquire the CT scan with the following parameters: scan mode = helical; tube voltage = 120 kVp; tube current: 200-400 mA (auto); slice thickness = 0.66 mm; FOV = 34 cm.\nVerify the scan quality and the field of view.\nReformat the acquisition using an image matrix size of 512 x 512 pixels. Given the slice thickness and FOV, the acquisition results in an isotropic voxel spacing of approximately 0.66 mm.\nExport the images in DICOM format.\n2. Biplane X-ray motion capture protocol",
    "NOTE: The custom biplanar x-ray system used in this protocol is described in the Table of Materials. Data collection procedures will likely vary with different system components. The x-ray systems are arbitrarily termed \"green\" and \"red\" to distinguish procedures and resulting image sequences and are positioned with an approximately 50° inter-beam angle and a source-to-image distance (SID) of approximately 183 cm (Figure 2). A minimum of two research personnel are required for the data collection; one to operate the x-ray system and computer, and the other to instruct the research participant.\nCamera software setup\n\t\nSet the camera aperture to the default setting (f/5.6).\n\t\t​NOTE: This value depends on several factors, including camera, exposure time, ISO, and participant anthropometrics.\nOpen the camera software and load the study protocol to each camera (sampling rate: 60 Hz, exposure time: 1,100 µs).\n\t\tNOTE: The camera exposure time may vary depending on several factors, including camera, aperture setting, and radiographic exposure.\nSystem warmup\n\t​NOTE: The x-ray tube's anode may become damaged if high-powered exposures are produced when it is cold. Therefore, the tubes should be warmed up by a series of low-energy exposures based on the manufacturer's recommendations.\n\t\nOn both the x-ray generator control panels, select Vascular setting. The pre-programmed vascular settings produce low energy exposures appropriate for the system warm-up (per system manufacturer).\nSet the exposure time on the pulse generator to 0.25 s.\nOn the x-ray generator control panels, hold down the PREP buttons. Preparation Delay appears on the screen.\nOnce both the screens read Ready to Expose, simultaneously press and hold the EXPOSE buttons.\n\t\t​NOTE: This will not produce x-rays, but only arms the system. X-ray production only occurs by depressing the foot pedal or hand-held triggers.",
    "Depress the PREP and EXPOSE buttons on both the control panels, and simultaneously depress and hold the foot pedal (or hand-held) to trigger the x-ray generator to produce x-rays.\n\t\tNOTE: The x-rays are produced for the duration specified by the pulse generator (step 2.3.2) or until the pedal is released, whichever occurs first.\nRepeat the steps 2.2.2-2.2.5 until the x-ray tube's heat unit (HU) exceeds the level required by the manufacturer to acquire images (5% HU for our system).\nVerify the camera synchronization and image focus.\n\tNOTE: Verify the camera synchronization and focus by acquiring a set of test images of the distortion correction grid (see Table of Materials). Each image intensifier will be tested individually using the steps described below.\n\t\nPlace the distortion correction grid on the image intensifier.\nOn both x-ray generator control panels, select the Cardiac setting, which is programmed to the default radiographic technique (70 kVp, 320 mA, 2 ms, and focal spot = 1.0 mm).\n\t\tNOTE: The camera settings remain unchanged (sampling rate: 60 Hz, exposure time: 1,100 µs).\nSet the pulse generator to 0.25 s.\nInitiate the camera acquisition through the camera software and acquire x-ray images as described previously in the steps 2.2.3-2.2.5.\nPreview the resulting images and determine the elapsed time from the trigger pulse for each system. If the difference in elapsed time between cameras is more than 2 µs, determine which camera is firing late and specify a frame delay in the camera software to resolve the issue.",
    "Visually inspect the sharpness of the image to verify the camera focus. For objective assessment, analyze a profile line drawn across a bead within the distortion correction grid using image processing software (e.g., ImageJ). Specifically, inspect the slope of the pixel gray values along this profile line. A more negative slope ensures a sharper image (assuming radiographic image is inverted such that the bead is dark). If necessary, refocus the cameras and repeat the steps 2.3.3-2.3.6.\nResearch participant setup and positioning\n\t​NOTE: The research participant's positioning is highly dependent upon the bones being tracked and the motion being tested. Testing is typically performed with the research participant seated on a fixed chair (i.e., not swivel or wheeled) to minimize the potential for changes in their position that may cause the shoulder to move outside the 3D imaging volume.\n\t\nPosition the chair in the biplane imaging volume so that the shoulder to be tested is centered approximately where the biplane x-ray beams intersect. This is a preliminary position. Adjust it based on the participant's anthropometrics, the motion to be tested, and the bones to be tracked.\nAsk the participant to be seated in a comfortable upright posture with arms resting at his/her side.\nSecure a lead-lined protective vest across the participant's torso to cover their abdomen and the contralateral shoulder and chest.\nSet the preliminary height of the image intensifiers. To help inform this procedure, turn on the light within the system's x-ray source. Raise the system until the participant's shadow cast onto the image intensifier is at the level of their axilla.\n\t\t​NOTE: The source and image intensifier within each system are coupled to move together. Uncoupled systems will require additional alignment steps not described here.",
    "Establish the preliminary height of the image intensifiers. Gently move the participant on their chair within the biplane image volume while watching their shadow cast onto each image intensifier.\n\t\t​NOTE: A good initial guess is to have the participant positioned such that the acromioclavicular joint is approximately at the center of both image intensifiers. This position is a reasonable initial guess for the current protocol, which requires the visualization and tracking of the humerus, scapula, and two ribs during shoulder elevation.\nOnce the participant's position appears to be reasonable in both systems, keep the light source on and ask the participant to perform the motion to be tested. Ensure that the participant's shoulder remains within the radiographic field of view during the entire motion trial. If possible, collimate x-ray beams to reduce exposure.\nRepeat steps 2.4.5-2.4.6 until it appears that the participant's setup within the image volume is appropriate.\nResearcher #1: Return to the control room to run the x-ray control panels and cameras. Set the x-ray control panel to low power fluoroscopy mode (60 kVp, 3-4 mA) and the pulse generator to a 0.25 s acquisition.\nResearcher #2: Explain to the participant that an image will be taken so that their position can be verified in the images and describe the series of events that will happen. Warn the participant about the sounds the system makes (e.g., clicks, hums) to prevent any apprehension. Don a lead-lined protective vest, retrieve the hand-held trigger, and move as far away from the x-ray sources as possible to minimize exposure while still maintaining a clear line of sight and communication with the participant. If possible, stand behind a lead-lined shield with a window.",
    "Researcher #1 (in x-ray control room): Start the cameras and prime the x-ray control panel as described previously (steps 2.2.3-2.2.5). When the system is ready to expose, notify the researcher #2.\nResearcher #2 (in lab): Indicate to the participant about image acquisition. Trigger the radiographic image acquisition using the hand-held remote trigger. Inform the participant that an image was taken and excuse yourself to the control room.\nResearcher #1 and #2 (in x-ray control room): Inspect the images. Focus only on the participant's position and the visibility of all bones to be tracked. If necessary, repeat steps 2.4.5-2.4.12 until the participant's position is satisfactory.\nOnce the setup and positioning of the x-ray system is established, do not move the x-ray system during the data collection session unless new calibration and distortion correction images are collected for each configuration. Also, instruct the participant to move as little as possible for the duration of the data collection session to avoid having to repeat setup procedures.\nData collection: Static image acquisition\n\t\nResearcher #1 (in x-ray control room): Set the optimized radiographic technique on the x-ray control panel (based on preliminary testing). The radiographic protocol used here is 70 kVp, 320 mA, 2 ms, and focal spot = 1.0 mm, with the camera collecting at 60 Hz and an exposure time of 1,100 µs. Set the pulse generator to 0.25 s.\n\t\tNOTE: Inform the participant that the next image will be a formal image acquisition.\nResearcher #2 (in the lab): Inform the participant to sit upright with their arm resting at their side.\nAcquire an image as previously described (steps 2.4.8-2.4.11).",
    "Researchers #1 and #2 (in x-ray control room): Inspect the images. Focus on the image quality (i.e., brightness and contrast) and visibility of all necessary bones. If adjustments to the image quality are needed, determine the parameter to be modified (i.e., f-stop, camera exposure time, kVp, mA) and reacquire the static image.\n\t\t​NOTE: It is critical to always be mindful of how the dose is affected by the radiographic parameters.\nRepeat steps 2.5.1-2.5.4 until the image quality is acceptable, within the dose estimates approved by the IRB.\nOnce the image quality is acceptable, inspect the images for technical quality (e.g., corrupt frames).\nAfter an acceptable static trial image acquisition, save the trial from each camera (e.g., \"green_still.cine\", \"red_still.cine\").\nData Collection: Dynamic image acquisition\n\t\nResearcher #1 (in x-ray control room): Maintain the same radiographic parameters from the static trial image. Set the pulse generator to a 2.0 s exposure.\nResearcher #2 (in the lab): Teach the participant the motion to be performed, including the plane and timing of the motion. Verify that the chair and the participant's clothing and/or lead-lined vest do not interfere with the shoulder motion. Practice the motion trial with the participant. Use the verbal cue \"Ready…and…go\" paced so that it takes 2 s (i.e., the duration of the motion trial) to help the participant pace the initiation and completion of the motion.\n\t\t​NOTE: It is critical that the participant understands the procedures and can consistently perform the motion trial to avoid the unnecessary exposure associated with a failed trial.\nResearcher #2 (in the lab): After sufficient practice, retrieve the hand-held remote trigger. Move to a safe place in the lab with a clear line of sight and communication with the research participant.",
    "Researcher #1 (in x-ray control room): Reset the pulse generator to 2.0 s, start the cameras, and prime the x-ray control panel as described previously (steps 2.3.4-2.3.5). When the system is ready to expose, notify the researcher #2.\nResearcher #2 (in lab): Ask the research participant, \"Are you ready?\" [wait for the affirmative response] \"Ready…and…go.\" (paced, as before, so that it takes 2 s).\nResearcher #2 (in lab): Manually trigger the x-ray system when the participant initiates arm motion.\n\t\tNOTE: Although manually triggering based on visual motion risks omitting the onset of the motion trial, it prevents over-exposing the research participant in the event of a miscommunication or a delayed start.). Once the trial is complete, inform the participant that an image was taken and excuse yourself to the control room to inspect the images.\nResearchers #1 and #2 (in x-ray control room): Inspect the trial images for quality (i.e., brightness and contrast) and technical condition (i.e., any corrupt frames) (Figure 3). Save the motion trials from each camera (e.g., \"green_scapab1.cine\", \"red_scapab1.cine\").\nRepeat the steps 2.6.1-2.6.7 to collect all the motion trials within the approved radiation safety protocol.\nCollect calibration images\n\t​NOTE: Radiographic image calibration results in the definition of the laboratory-based coordinate system, the position and orientation of each x-ray radiographic system relative to laboratory coordinate system, and intrinsic parameters that allow for the generation of digitally reconstructed radiographs (DRRs), which are used in the markerless tracking process. The calibration calculations are described in the step 3.4.1.\n\t\nMaintain the same camera settings and radiographic technique settings used during the data collection.\nSet the pulse generator to a 0.5 s exposure.\nPosition the calibration cube (see Table of Materials) in the middle of the imaging volume.\nAcquire and save the cube images (e.g., \"green_cube.cine\", \"red_cube.cine\").",
    "Collect the images for distortion correction and nonuniformity correction.\n\t​NOTE: Radiographic image collected using an image intensifier are affected by intensity, nonuniformity63, and distortion. Consequently, images of a white-field and distortion correction grid are acquired on each radiographic system to determine the corrections needed. It is generally prudent to collect calibration images before distortion and nonuniformity correction images in case the image intensifiers are bumped while the distortion grid is being positioned.\n\t\nRemove all objects from the radiographic field of view.\nMaintain the same camera settings and radiographic technique settings used during the data collection. Set the pulse generator to a 0.5 s exposure.\nAttach the distortion correction grid (see Table of Materials) to the surface of the green image intensifier.\nAcquire the grid and white-field images.\nSave the images (e.g., \"green_grid.cine\", \"red_white.cine\").\nMove the grid to the red image intensifier and repeat steps 2.7.2-2.7.5, modifying the image filenames, as appropriate.\n3. Data processing protocol\nNOTE: Procedures for preparing the bony geometry, image pre-processing (i.e., distortion and non-uniformity correction and image calibration), and markerless tracking are highly variable and depend on the software used. The procedures described herein are specific to the proprietary software. However, the major data processing steps are likely translatable to any x-ray motion capture software package.\nProcessing CT scan\n\t​NOTE: The proprietary markerless tracking software used by the authors' lab optimizes the position and orientation of a DRR. Therefore, the procedures for processing the CT scan results in the creation of a 16-bit TIFF image stack. Other software packages may require the bony geometry to be represented in different formats or specifications.\n\t\nOpen an image processing program (e.g., Mimics, FIJI) and import the CT images.",
    "Segment the humerus from the surrounding soft tissues. For the ribs, create an extension that connects the anterior aspect of the rib to the manubrium to digitize the sternocostal joint later in step 3.2.6.\nPerform a Boolean operation on the finished mask with a black mask (i.e., all pixels are colored black) (operation: black minus bone). This results in an inverted mask of the bone in which all pixels are black except for those corresponding to the bone, which remain in CT grayscale.\nCrop the image stack along all three axes to eliminate the black (i.e., non-bone) pixels. Leave some black pixels at the edges of this 3D bounding box.\nSave the modified image stack in the TIFF format.\nRepeat the steps 3.1.1-3.1.5 for all the remaining bones.\nDefining anatomical coordinate systems and regions of interest (ROIs)\n\t​NOTE: This protocol orients anatomical coordinate systems as follows. For a right shoulder, the +X axis is oriented laterally, the +Y axis is oriented superiorly, and the +Z axis is oriented posteriorly. For a left shoulder, the +X axis is oriented laterally, the +Y axis is oriented superiorly, and the +Z axis is oriented anteriorly.\nImport the TIFF image stack for the bone to be processed. Convert the TIFF stack to a .RAW file and render a 3D bone model based on the known pixel dimensions and image spacing using the proprietary software.\n\t\tNOTE: The resolution of the model is based on the sampling of the CT volume (i.e., voxel spacing). Consequently, the average area of the mesh triangles is approximately 1.02 mm2 (±0.2 mm2) (step 1.3).\nDigitize the anatomical landmarks on the humerus as follows (Figure 4A).",
    "Geometric center of the humeral head: Determine the dimensions and position of a sphere that minimizes the distance between the sphere's surface and the humeral articular surface using a least-squares algorithm. Define the geometric center of the humeral head as the coordinates of the optimized sphere's center.\nMedial and lateral epicondyles: Located at the widest section of the distal humerus.\nDefine humeral head ROI as follows (Figure 5A).\n\t\t\nThe entire humeral articular surface and greater tuberosity.\nDigitize the anatomical landmarks on the scapula as follows (Figure 4B).\n\t\t\nRoot of the scapular spine: Located at the medial border along the scapular spine.\nPosterior acromioclavicular joint: Located at the posterior aspect of the clavicular facet on the scapular acromion.\nInferior angle: Located at the inferior-most point on the scapula.\nDefine scapular ROIs as follows (Figure 5B).\n\t\t\nAcromion: The undersurface of the acromion lateral to the spine of the scapula.\nGlenoid: The entire articulating surface of the glenoid.\nDigitize anatomical landmarks on the ribs as follows (Figure 4C).\n\t\t\nAnterior rib: Located at the medial-most portion of the rib extension.\nPosterior rib: Located at the superior/inferior midpoint of the posterior aspect of the facet on the head of the rib.\nLateral rib: Located at the lateral-most aspect of the rib when the anterior and posterior rib points are aligned vertically on the screen.\nImage pre-processing\n\t​NOTE: Image pre-processing is performed using proprietary software and involves converting the cine image files to TIFF stacks and correcting the images for distortion nonuniformity.",
    "Perform non-uniformity correction: The software averages the approximately 30 frames (i.e., 0.5 s of data) to produce a single, high-quality, bright-field image to minimize the effect of noise in any single frame. The bright-field image is used to calculate the true radiographic density along the ray from the x-ray source to each pixel of each frame of data. The sum of the radiographic density of all the matter penetrated by each pixel's ray is proportional to the logarithm of the bright field for that pixel minus the logarithm of the observation image for that pixel (i.e., log-sub processing).\nPerform distortion correction: The software averages the approximately 30 frames (i.e., 0.5 second of data) to produce a single image and reduces the effect of noise in any individual image. The distortion correction software creates an affine map from each triple of adjacent bead positions in the distortion grid image to the known (true) position of those three beads in the Lucite distortion correction grid. This collection of small affine maps is then used to resample each observed frame of the motion trial into the true coordinates represented by the orthogonal array of beads.\nApply distortion and non-uniformity corrections to all frames of each trial.\nBiplane imaging volume calibration.\n\tNOTE: Image calibration was performed using proprietary software. The software uses a nonlinear optimization algorithm to adjust the observed calibration object bead locations to their known 3D locations. This process is conducted for each set of biplanar calibration images. The result is a system that can digitally project two views of a bone volume and register them against radiographic images of the same bone collected during the data collection.\nMarkerless tracking\n\t​NOTE: Markerless tracking is performed using proprietary software. Software such as Autoscoper and C-Motion can also be used to complete this process.",
    "On the first frame of the motion trial, rotate and translate the DRR using the software controls until it appears to match well to the biplane x-ray images (Figure 6).\nSave the manual solution.\nApply the optimization algorithm.\nVisually inspect the solution determined to be optimal by the algorithm based on the initial manual solution. If necessary, adjust the solution and repeat steps 3.5.2-3.5.3 until satisfied with the optimized solution.\nRepeat steps 3.5.1-3.5.4 for every 10th frame across the motion trial.\n\t\tNOTE: This interval is dependent upon several factors, including frame rate, motion speed, and image quality. Smaller intervals may be required.\nOnce every 10th frame is tracked, perform an optimization to create interpolated preliminary solutions that are subsequently optimized.\nContinue to refine the solutions until all the frames of the motion trial are tracked well.\n4. Data analysis protocol\nNOTE: The proprietary markerless tracking software used in this protocol results in the raw and filtered trajectories of the anatomical landmarks that will be used to construct anatomical coordinate systems. These coordinates are expressed relative to the laboratory coordinate system defined by the calibration object during the calibration procedure. The following protocol describes, in general terms, the procedures for calculating kinematic outcome measures from these landmark trajectories such that they can be computed in any programming language (e.g., MATLAB). A second proprietary software is used to calculate kinematics and proximity statistics.\nCalculate kinematics and proximity statistics",
    "​NOTE: The primary kinematic outcome measures include joint rotations (i.e., Euler angles) and positions. The primary proximity statistics include the minimum gap, average gap, and weighted-average contact center, which are calculated for every frame of data. Collectively, these measures describe joint arthrokinematics, or surface interactions during a movement. Anatomical proximities that are aggregated across the motion trial include the average contact center, contact path, and contact path length.\n\t\nFor each bone and frame of motion, use the filtered anatomical landmark coordinates (i.e., output from the markerless tracking software) to construct a 16-element transformation matrix representing the bone's anatomical coordinate system relative to the laboratory coordinate system.\nCalculate the relative kinematics by relating the anatomical coordinate systems between relevant bones using the software.\nExtract the joint angles and positions using conventional methods64. Given the orientation of the anatomical coordinate systems, extract the glenohumeral kinematics using a Z-X'-Y'' rotation sequence, extract the scapulothoracic kinematics using a Y-Z'-X'' rotation sequence, and extract the humerothoracic kinematics using a Y-Z'-Y'' rotation sequence.\nMinimum gap: Calculate the smallest gap (i.e., distance) between the centroids of the nearest-neighbor triangle on the opposite bone using the software.\nAverage gap: Calculate the area-weighted mean of the minimum gap using the triangles that have the smallest gap to their nearest neighbor within a specified measurement area using the software. Define the measurement area as the triangles closest to the opposite bone whose areas sum to 200 mm2. Incorporate this measurement area in the calculation to ensure that only the surface that is reasonably near to the opposite bone is included in the average gap calculation.",
    "NOTE: The sizes of the measurement area (i.e., 200 mm2) was selected during initial algorithm development after it was found to consistently reflect subacromial space and glenohumeral joint proximities without being overly biased from distant surfaces. Use of this measure for broader surface interactions (e.g., tibiofemoral) may require a larger measurement area.\nWeighted-average contact center (i.e., centroid): Calculate the point on the ROI surface that minimizes the weighted distance to all other triangles within the measurement area (i.e., triangles closest to the opposite bone whose areas sum to 200 mm2) using the software. The weighting factor for each triangle in the measurement area is calculated as: triangle area / squared distance to nearest-neighbor centroid (i.e., inverse square weighting). In this way, the triangles that are weighted more heavily are larger (by a factor of 1) and closer to the opposite bone (by a factor of the squared minimum distance).\nAverage contact center: Calculate the average position of the contact center (i.e., centroid) across the motion trial using the software. Given contact centers represent joint arthrokinematics, the average contact center represents the center of surface interactions during a movement.\nContact path: Define by connecting the coordinates of the weighted-average contact center across the motion trial using the software.\nContact path length: Calculate the length of the contact path across the motion trial using the software.\nSubscription Required. Please recommend JoVE to your librarian."
  ],
  "subjectAreas": [
    "Bioengineering"
  ],
  "bigAreas": [
    "Bioengineering & Technology"
  ]
}