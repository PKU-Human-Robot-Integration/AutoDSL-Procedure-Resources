{
  "id": 1747,
  "origin_website": "Cell",
  "title": "Volumetric super-resolution imaging by serial ultrasectioning and stochastic optical reconstruction microscopy in mouse neural tissue",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nCollect and fix the tissue sample\nTiming: 4–5 h\nDuring the following steps, tissue will be dissected and prepared for IHC. Importantly, the region of interest is punched out creating a small disk of tissue which is easy to maneuver while minimizing mechanical damage. The small disk improves antibody penetration and allows the tissue to lay flat for embedding. Fixative solution and blocking buffer should be prepared before you begin.\nSee Figure 3[href=https://www.wicell.org#fig3].\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1201-Fig3.jpg\nFigure 3. Dissection protocol featuring YFP-expressing retinal neuron\nEuthanize mouse, enucleate eyes, and dissect retinae in room temperature 1× PBS (see videos in Claybon and Bishop, 2011[href=https://www.wicell.org#bib7]; Sondereker et al., 2018[href=https://www.wicell.org#bib24]).\nNote: These steps describe processing retinal tissue, but brain sections can also be used.\nFix tissue in room temperature 4% PFA for 10 min to 1 h.\nNote: Users should perform time-series fixation control experiments to empirically optimize their immunohistochemical labeling for conventional fluorescence imaging prior to performing STORM experiments (Buchwalow and Böcker, 2010[href=https://www.wicell.org#bib5]; Im et al., 2019[href=https://www.wicell.org#bib13]; Schneider Gasser et al., 2006[href=https://www.wicell.org#bib22]). The example data presented in Figure 10[href=https://www.wicell.org#fig10] were collected from retinal tissue fixed for 30 min at room temperature.\nWash retinae in 1× PBS for 2× 20 min, then place it in a clean petri dish filled with room temperature 1× PBS.\nPunch out a 500 μm diameter region of interest using a 25G blunt ended needle under stereoscope guidance.\nTransfer punch to a 24-well plate and incubate in blocking buffer for 3–4 h at room temperature with constant agitation. Continue on to IHC.\nImmunohistochemistry\nTiming: 4–5 days",
    "The following steps are performed to label antigen targets with primary and secondary antibodies. Target-specific staining is followed by a global neuropil stain using a WGA conjugate, which functions as an image alignment tool in later STORM data processing steps. Lastly, an aldehyde fixation establishes crosslinking to stabilize all molecular labels. Numbered steps are illustrated in Figure 4[href=https://www.wicell.org#fig4].\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1201-Fig4.jpg\nFigure 4. Immunohistochemistry protocol\nSee Figure 4[href=https://www.wicell.org#fig4].\nPrepare primary antibody solution by diluting 1 mg/mL antibody stocks to 1:100 in blocking buffer. Primary antibody dilution can be adjusted based on empirical testing. Transfer tissue punches to a new well containing primary antibody solution and incubate for 48–72 h at 4°C with constant agitation.\nTransfer tissue to a new well containing wash buffer and incubate at room temperature for 6 × 20 min washes with constant agitation.\nPrepare secondary antibody solution by diluting secondary antibody conjugate stocks to 1:100 in blocking buffer. Secondary antibody dilution can be adjusted based on empirical testing. Secondary antibodies should be custom conjugated to photoswitchable dyes compatible with STORM imaging ahead of this step (see section: prepare fluorescent dye conjugates for IHC[href=https://www.wicell.org#sec1.1]). Transfer tissue punches to a new well containing secondary antibody solution and incubate for 24 h at 4°C with constant agitation. Protect samples from light.\nTransfer tissue to a new well containing wash buffer and incubate at room temperature for 5× 20 min washes with constant agitation. Protect samples from light.\nPrepare wheat germ agglutinin (WGA) solution by diluting WGA conjugate stock 1:10 in 1× PBS. WGA should be custom conjugated to photoswitchable dyes compatible with STORM imaging ahead of this step (see section: prepare fluorescent dye conjugates for IHC[href=https://www.wicell.org#sec1.1]). Transfer tissue to a new well containing WGA solution and incubate at room temperature for 12–16 h (overnight) with constant agitation. Protect samples from light.",
    "Transfer tissue to a new well containing 1× PBS and incubate at room temperature for 2× 20 min washes with constant agitation. Protect samples from light.\nCritical: Tissue punches may stick to the inside of the pipette tip here. To avoid this, coat the inside of the pipette tip with blocking solution first, then transfer the tissue punches.\nTransfer tissue to a new well containing post-fixation solution (3% PFA, 0.1% GA) and incubate for 2 h with constant agitation. Protect samples from light.\nTransfer tissue to a new well containing 1× PBS and incubate at room temperature for 2× 20 min with constant agitation. Protect samples from light. Continue on to dehydration.\nDehydrate and embed samples in resin\nTiming: 1–2 days\nThe following steps plasticize the tissue punches to make them suitable for ultrasectioning. Refer to Figure 5[href=https://www.wicell.org#fig5] for a workflow illustration.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1201-Fig5.jpg\nFigure 5. Dehydration, resin infiltration, and embedding workflow\nSee Figure 5[href=https://www.wicell.org#fig5].\nPerform a graded alcohol dehydration:\nTransfer tissue into a clean Eppendorf tube and immerse in a 50% EtOH solution (100% EtOH diluted in ddH2O). Incubate at room temperature for 20 min with constant agitation and protect sample from light.\nRepeat with 70%, 90%, 100% and 100% EtOH.\nCritical: If tissue is not thoroughly dehydrated, the resin will not polymerize properly and crack or flake when taken out of the mold (troubleshooting 2[href=https://www.wicell.org#sec7.3]).\nPerform a graded resin infusion:\nTransfer tissue into a clean Eppendorf tube and immerse in a solution containing 2 parts 100% EtOH to 1 part resin. Incubate at room temperature for 2 h with constant agitation and protect sample from light.\nRepeat with 1:1 EtOH: resin, 1:2 EtOH: resin, 100% resin and 100% resin.\nPause point: If needed, tissue punches can be left in 1:2 EtOH: resin or 100% resin overnight (12–18 h).",
    "Transfer individual tissue punches into lids of embedding (Beem) capsules and gently center them under stereoscope guidance. Fit capsule body onto the lid and fill with 100% resin. Incubate samples at 70°C for 16 h.\nPause point: Polymerized tissue punches have long-term stability. Store them in their molds in a dark, dry place at room temperature and protect them from dust.\nUltrasectioning\nTiming: 1 day\nThe following steps describe the ultrasectioning and collection of serial ultrasections onto glass coverslips (Franke and Kolotuev, 2021[href=https://www.wicell.org#bib11]; Wacker et al., 2018[href=https://www.wicell.org#bib27]). For further technical troubleshooting and tips, see publications on array tomography and serial sectioning for electron microscopy (Harris et al., 2006[href=https://www.wicell.org#bib12]; Micheva and Smith, 2007[href=https://www.wicell.org#bib17]). Figure 6[href=https://www.wicell.org#fig6] provides an illustration supporting this workflow description.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1201-Fig6.jpg\nFigure 6. Assembling and using coverslip transfer rig\nThis instrument is designed to stabilize a coverslip in the bath of an ultrasectioning knife. The movement stage/micromanipulator allows the user to insert and retract the coverslip in a single, smooth motion.\n(A–I) Parts list: (A) Movement stage, Edmund Optics (53–384); (B) Right angle clamp, THOR Labs (RA90); (C) Antistatic, plastic, flat-end tweezers, Uxcell (99301); (D) ¼\"-20 set screws (2), THOR Labs (SH6MS16); (E) ½\" optical posts (2), THOR Labs (TR075); (F) Binder clip; (G) 1” optical post, THOR Labs (RS12); (H) Post clamp, THOR Labs (RM1C); (I) Switchable magnetic base, THOR Labs (MB175); NS, not shown) Flexure clamping base, THOR Labs (BA2F).\nTrim and cut resin to produce 70 nm-thick serial section ribbons. Expand sections using chloroform vapor.\nSecure gelatin coated coverslip in plastic forceps and guide it into the histo Jumbo diamond knife water bath (as illustrated in Figure 6[href=https://www.wicell.org#fig6]).",
    "Using an eyelash tool, guide sections onto the middle of the coverslip and slowly retract the coverslip from the water bath by turning the knob on the micromanipulator (as illustrated in Figure 6[href=https://www.wicell.org#fig6]).\nCaution: Leave sufficient space in the margins of the coverslip to accommodate the imaging objective.\nWarm coverslips with sections facing upward on a hot plate set to 60°C for 20 min.\nPause point: Coverslips can be stored long-term prior to imaging. Store them in a dark, dry place at room temperature and protect them from dust.\nEtch away resin and assemble imaging chamber\nTiming: 30 min\nThe following steps prepare tissue sections for optimal photoswitching during STORM imaging. Here, the resin surrounding individual sections is removed allowing fluorophore exposure to the thiol-containing STORM imaging buffer. Fluorescent beads are spotted on the coverslips which will serve later as fiducial markers. The imaging chamber is assembled, filled with STORM imaging buffer, and sealed with epoxy. Prepare 10 % sodium ethoxide before you begin; sodium ethoxide solution can be reused for multiple experiments but should be remade after 1 month. Refer to Figure 7[href=https://www.wicell.org#fig7] for a workflow illustration.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1201-Fig7.jpg\nFigure 7. Resin etching and imaging chamber construction\nSee Figure 7[href=https://www.wicell.org#fig7].\nImmerse the coverslip in 10% sodium ethoxide for 5 min.\nCritical: Following step 21, samples will be difficult to see. Note sample orientation on the coverslip.\nMeanwhile, clean a glass slide with EtOH and allow to dry completely, then apply two layers of double-sided tape to the long sides of the slide. Only cover ∼5 mm of the slide edge and shave off the overhanging tape using a razor blade.\nRemove the coverslip using forceps and immediately wash with 95% EtOH ∼30 s.\nWash coverslip by immersing in filtered H2O.\nDry coverslip using compressed/forced air.\nSpot beads onto coverslip:",
    "Make high density bead solution by mixing 1 μL bead stock to 9 μL 1× Dulbecco's PBS (DPBS). Vortex and spin down. Apply a small droplet (∼1 μL) to coverslip.\nMake low density bead solution by adding 750 μL DPBS to dense bead working stock. Vortex. Apply a small droplet (∼1 μL) to coverslip.\nCritical: Dulbecco's PBS must be used to prevent bead aggregation.\nCritical: High/low density bead spots MUST be placed away from the serial sections.\nImmediately wash coverslip using filtered H2O for ∼1 min.\nCritical: Allow water to flow in the direction away from sample so that beads do not wash into the sample.\nDry coverslip using forced air.\nPlace the dry coverslip tissue-side-down onto the slide with double sided tape. Use a pipette tip to apply pressure on the tape sides to seal the coverslip to the adhesive.\nPrepare STORM imaging buffer and mix by gentle pipetting. DO NOT vortex. Avoid forcing air into the solution.\nDraw up 160 μL of the STORM buffer into a pipette and slowly release it in the space between the coverslip and slide. Avoid creating bubbles by applying gentle pressure to the coverslip with a blunt object. Avoid cracking the coverslip when doing this.\nLay a piece of foil on the benchtop and push some epoxy out of the double-barrel syringe onto the foil. Mix with a pipette tip.\nApply a strip of epoxy to all sides of the coverslip (short sides first) to seal the imaging chamber. Place in a dark place to dry for ∼5 min.",
    "Test that the epoxy created a seal around the imaging chamber by applying gentle pressure with a pipette tip to the surface of the coverslip. If no buffer leaks, then the seal is good. If some buffer leaks, then patch the hole using more, freshly mixed epoxy.\nCritical: Be careful to not overapply epoxy and encroach on the sample area.\nApply a single strip of double-sided tape onto the short sides of the slide and trim off overhangs with razor blade. This is useful when securing slide to the STORM microscope. The preparation is ready for imaging.\nAcquire STORM and conventional imaging data\nTiming: 1–3 h to set up, 1–3 min per STORM movie (automated acquisition)\nThe protocol below describes the use of open-source software (“storm_control” v2019.06.28) for the collection of multi-color STORM images (https://github.com/ZhuangLab/storm-control[href=https://github.com/ZhuangLab/storm-control]). This software includes specific programs (hal4000.py, steve.py, dave.py) with graphical user interfaces (GUIs) for automated image acquisition (Figure 8[href=https://www.wicell.org#fig8]). The software should be installed on a local acquisition computer that controls the microscope instrumentation. All three packages are operated by the user simultaneously while setting up an imaging experiment. Briefly, hal4000.py is the main acquisition controller for the microscope stage, laser illumination, focus lock, emission filter wheel, and sCMOS camera (Figures 8[href=https://www.wicell.org#fig8]A and 8C–8E). Steve.py is an interface for image tiling and ROI selection for automated imaging (Figure 8[href=https://www.wicell.org#fig8]B). Dave.py is master control software (Figure 8[href=https://www.wicell.org#fig8]H) that passes automated image acquisition instructions to hal4000.py based on user-determined ROIs set using steve.py. Following the STORM and conventional image acquisition users should move on to the final section of this protocol paper (Process images to generate 3D volumes).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1201-Fig8.jpg\nFigure 8. Automated image acquisition",
    "(A) Screenshot of the hal4000.py user interface showing a ROI in the 561 nm channel (WGA) within a single ultrathin section of mouse retina.\n(B) Screenshot of the steve.py user interface showing low magnification (4×) tiling of sample ribbons and high/low density bead spots in the 561 nm channel.\n(C) Hal stage control panel.\n(D) Hal illumination control panel showing the 561 nm laser engaged.\n(E) Hal focus lock control panel.\n(F) Two consecutive ultrathin retina sections (from B) shown tiled at high magnification (60×) in the 488 nm channel (GFP). Tiling may be automated (3×3 array, left image) or performed manually (right image) prior to within-section ROIs selection (blue box in right image).\n(G) Screenshot of the dave.py user interface with a ‘master_run.xml’ file loaded.\nNote: The STORM acquisition software provided here is available as an open-source resource under the MIT license.\nAlternatives: Commercial instrumentation and software may be used in lieu of custom instrumentation and specific codebases we reference here (Albrecht et al., 2021[href=https://www.wicell.org#bib1]; Chang, 2015[href=https://www.wicell.org#bib6]; Tröger et al., 2020[href=https://www.wicell.org#bib26]).",
    "In the protocol below, we describe our approach for collecting three main types of imaging data: 1) serial section conventional, wide-field (diffraction-limited) 2) STORM data (TIRF configuration), and 3) fiducial marker images for correcting chromatic aberration and uneven illumination of the sample. The key steps are to 1) collect conventional images of all color channels in rapid succession for the ROI(s) in each physical section of the sample. This limits sample drift between color channels for conventional images in each ROI. During subsequent image postprocessing/alignment, STORM images will be correlated to their conventional image counterparts to correct for sample drift. 2) Collect STORM movies for ROI(s) across all physical sections. For each ROI, the red emitters (DY-749P1/Alexa647) are imaged first (sequentially within each ROI across the entire sample) as these dyes are susceptible to STORM buffer acidification (Dempsey et al., 2011[href=https://www.wicell.org#bib10]). Then, Cy3B and Atto488 emitters are imaged sequentially for each ROI in a second image pass across the sample. Sample drift that occurs during each STORM movie acquisition is corrected as part of the single-molecule fitting analysis by back correlating binned movie frames to the start of the movie. 3) Collect fiducial marker images that will later be used to correct chromatic aberration in conventional and STORM images. Once all acquisition processes are complete (time varies depending mainly on number of sections and colors imaged), we begin processing images for 3D reconstruction (steps for which are outlined in the final section of this protocol).\nSee Figure 8[href=https://www.wicell.org#fig8].\nPower on the microscope and lasers.\nPrepare objectives for imaging:\nClean the oil immersion objective. Apply 2–3 drops of 100% methanol to a folded piece of lens paper and gently wipe the surface of the objective.",
    "Rotate the turret to position the 4× objective in the light path. The 4× objective will be used first to collect a low-magnification tiled mosaic of the sample.\nSecure the imaging chamber in the stage holder.\nCritical: Sample should be immobile once loaded in the stage. Use a top-side clamping stage insert or double-sided tape applied to the glass slide (Figure 7[href=https://www.wicell.org#fig7]) to secure the specimen in the stage as described (previous section “Etch away resin and assemble imaging chamber”, step 35).\nLaunch hal4000.py acquisition software (hereafter referred to as Hal).\nLoad settings .xml files by dragging and dropping settings files into the main Hal interface (Figure 8[href=https://www.wicell.org#fig8]A) or selecting ‘File/load/settings’ and then selecting desired settings files.\nEngage the low magnification array setting in Hal.\nUse the ‘Illumination’ control panel (Figure 8[href=https://www.wicell.org#fig8]D) to engage the 561 nm laser, locate the bead fields on the coverslip and focus the objective.\nUse the ‘Stage Control’ panel (Figure 8[href=https://www.wicell.org#fig8]C) to zero the stage position.\nCreate a low-magnification mosaic of the bead fields and sample (serial sections):\nLaunch ‘Steve.py’ software (hereafter referred to as ‘Steve’) (Figure 8[href=https://www.wicell.org#fig8]B) and place cursor at or near the 0, 0 coordinates and press the spacebar to take an image. Cursor coordinates appear on the lower, right-hand side of the Steve interface (Figure 8[href=https://www.wicell.org#fig8]B, arrowhead).\nContinue taking images of the field in manual or semi-automated modes (Figure 8[href=https://www.wicell.org#fig8]F):\nmanual imaging mode: click on an ROI and press the spacebar to take an image.\nsemi-automated mode: click on an ROI and press keypad #3 or #9 for automated 3×3 or 9×9 image tiling, respectively. Press the spacebar to interrupt the sequence.\nNote: Adjust laser output power empirically to maximize the image intensity without saturating the image.",
    "Note: User may navigate the sample view in Steve.py by right-clicking on an ROI and selecting “Go to Position”.\nFinish mosaic and save. Adjust the stage position back to the sparse bead field.\nCreate a high-magnification mosaic of the bead fields and sample (serial sections):\nLower the 4× objective away from the sample by turning the focus knob on the microscope.\nRotate the turret to position the oil-immersion objective in the light path. The oil-immersion objective will be used throughout the rest of the image acquisition.\nPlace a droplet of immersion oil on the objective.\nFocus on the sparse beads:\nEngage the high magnification array setting in Hal.\nUsing the illumination control panel in Hal, turn on a visible imaging laser (488 nm or 561 nm) and bring the sample into focus.\nUse the ‘Focus lock’ control panel (Figure 8[href=https://www.wicell.org#fig8]E) to lock the focal plane.\nSet TIRF angle to maximize signal-to-noise at low illumination power.\nReimage selected regions (both sample and beads) of the low magnification mosaic at high magnification.\nNote: Steve allows users to correct offsets between low and high magnification by adjusting the mosaic positions within the ‘Objective Settings’ panel.\nSelect sample ROIs for automated imaging (manual) (Figure 8[href=https://www.wicell.org#fig8]F):\nUse mouse cursor to hover over an ROI in first physical section.\nRight click and select ‘Record position’.\nRepeat for each ROI across all serial sections.\nWhen all positions are selected, click ‘File’ and ‘Save positions’ to save a ‘positions.txt’ file.\nDelete all recorded positions in Steve.\nNote: Select ROIs in sequential order of physical sectioning to simplify downstream alignment processing. To prevent unwanted bleaching during acquisition of serial section images, select the order of ROIs to begin imaging the end of the sample ribbon at the furthest end of the coverslip in the direction of the TIRF beam.",
    "Select bead ROIs for automated imaging (manual):\nIn Steve, use the mouse cursor to hover over ROIs in bead fields.\nStarting in the sparse bead field, right click within a region away from the edge of the bead spot and select ‘Record position’.\nMove cursor to new position within the bead spot (away from the edge and the first position), right click and select ‘Record position’.\nMove cursor to center region of the dense bead field, right click and select ‘Record position’.\nWhen positions are selected, click ‘File’ and ‘Save positions’ to save a ‘bead_positions.txt’ file.\nPrepare illumination power settings for conventional image acquisition to ensure that images are not dim/saturated:\nEngage the ‘Conv’ setting in Hal.\nFocus on a representative ROI within the sample.\nAdjust laser powers using the illumination control panel for each channel to be imaged.\nCritical: Avoid saturating dense bead images. Ensure sufficient illumination intensity to use the full dynamic range of the camera.\nPrepare illumination power settings for sparse bead field image acquisition to ensure that images are not dim/saturated:\nEngage the ‘Regbeads’ setting in Hal.\nFocus on a representative ROI within the sparse bead field.\nAdjust 750 nm laser power using the illumination control panel to visualize IR beads in 750 and 647 channels.\nAdjust 488 nm laser power using the illumination control panel to visualize visible beads in the 647, 561, and 488 nm channels.\nCritical: Avoid saturating sparse bead images.\nPrepare illumination power settings for dense bead field image acquisition to ensure that images are not dim/saturated:\nEngage the ‘FFCbeads’ setting in Hal.\nFocus on a representative ROI within the dense bead field.\nAdjust 750/647/561/488 nm imaging laser powers using the illumination control panel to visualize dense beads in 750/647/561/488 nm channels, respectively.",
    "Critical: Avoid saturating dense bead images. Ensure sufficient illumination intensity to use the full dynamic range of the camera.\nPrepare illumination power settings for STORM image acquisition to optimize photoswitching and minimize movie length:\nEngage the ‘750STORM’ setting in Hal.\nFocus on a representative ROI within the sample.\nUsing the illumination control panel, adjust the 750 nm laser power to maximum and the 405 nm laser to minimum.\nIn Hal, change the directory filename to ‘750storm’ and set the working directory to ‘Acquisition\\create_xml\\powertest\\’.\nSet 'Mode’ to ‘Run_til_abort’.\nClick ‘Record’ to begin manual STORM movie acquisition.\nNote: Each wavelength specific .xml file calls a preset shutter file that engages the appropriate imaging (750/647/561/488 nm) and activation (405 nm) lasers.\nManually ramp 405 nm laser power using the illumination control panel to reactivate fluorophore switching to maintain optimal emitter density.\nPressing 'Stop’ ends the movie recording and saves the power progression file.\nRepeat steps 16 (a-h) for 647 nm, 561 nm, and 488 nm STORM movies. Change the directory filenames for each movie according to wavelength using the format specified above.\nNote: Cy3B (561 nm) and Atto488 (488 nm) probes do not require 405 nm illumination for reactivation.\nAlternatives: The above steps 51 (a-i) describe the setting of custom ‘power progression’ files to control illumination settings during STORM movie acquisition. Hal also allows users to engage linear or exponential power ramping using the ‘Progressions’ control panel.\nBegin automated image acquisition of all conventional, bead, and STORM files:\nIn main Hal interface, set working directory to a local storage drive.",
    "Critical: Ensure local storage drive has sufficient capacity for image acquisition. Alternatively, users should set up automated transfer routine to relocate files following acquisition. Overfilling the drive will cause the acquisition control software to crash. See “limitations[href=https://www.wicell.org#limitations]” section below for a discussion on raw data sizes.\nAdjust desired imaging parameters (e.g., number of frames, frame rate, focus lock position, illumination control, etc.) for multi-channel acquisition in a ‘master.xml’ file.\nLaunch ‘Master_xml_generator.py’.\nSelect the desired ‘master.xml’ file from Step B above (.xml format) containing imaging parameters.\nChange file name and save out final ‘master_run.xml’ file.\nLaunch ‘Dave.py’ software (Figure 8[href=https://www.wicell.org#fig8]G).\nClick ‘File/load’ and select the ‘master_run.xml’ file for automated imaging.\nClick ‘Validate’ to confirm the proper function of the automated image acquisition.\nSelect ‘Start’ to begin automated imaging.\nOutput includes .dax files, which will be used in step 57 below.\nAlternatives: Use commercial instrument with automated image acquisition software to set imaging parameters for selected ROIs. Alternative open-source software may also be used.\nNote: Adjust the total laser output power as needed to ensure optimal image quality during image acquisition. For conventional image acquisition this may require reducing laser output while for STORM movie acquisition power output should be increased to achieve sufficient density at the sample plane (1–3 kW/cm2).\nProcess images to generate 3D volumes\nTiming: 1–7 days (largely automated)",
    "The following section discusses the transformation of serial-section 2D STORM and conventional imaging data into aligned 3D imaging volumes (Figure 9[href=https://www.wicell.org#fig9]). The first step in the pipeline is to identify single molecule positions within STORM movies using single-molecule fitting software (Figure 9[href=https://www.wicell.org#fig9]A). The data generated in this protocol were fit using 3D-DAOSTORM (Version 2.1, Key Resources; Babcock et al., 2012[href=https://www.wicell.org#bib2]), which is one of many open-source solutions for single-molecule detection (Sage et al., 2019[href=https://www.wicell.org#bib20]). Once molecules have been identified and corrected for drift that occurs during STORM image acquisition, single molecule positions and emitter PSF information are used to generate STORM image files.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1201-Fig9.jpg\nFigure 9. Volumetric STORM data processing to generate 3D volumes\n(A) The workflow for STORM image generation is shown for a single ROI containing YFP-expressing retinal ganglion cell neurites imaged in the 488 nm channel. Single molecules in STORM movies are localized and drift corrected across each movie and localization information for all molecules is exported to a final reconstructed image file. Left to right: first frame of STORM movie, last frame of STORM movie, 3D-DAOSTORM SMLM fitting result for last frame of STORM movie, and the final STORM image.\n(B) ROI (from A) shown before and after STORM-conventional drift correction (left panel) and chromatic aberration correction (example shown for fiducial bead 561 nm emitters mapped to the 647 nm channel, right panel).\n(C) ROI (from A) shown before/after rigid (left panel) and elastic alignment (right panel) to an adjacent serial section.\n(D) Screenshot of “STORMpro”, our open-source graphical user interface (GUI) for automated volumetric STORM data processing. Operation of the interface (steps i-iv) is described within the text and a readme.txt file accompanying the GUI (see key resources table[href=https://www.wicell.org#key-resources-table]).",
    "During serial-section imaging there is a temporal offset between the collection of STORM movies that introduces XY drift between images collected in different color channels for the same ROI. To correct for this lateral movement, conventional images of all colors are acquired in rapid succession for each ROI to eliminate the impact of drift (see section acquire STORM and conventional imaging data[href=https://www.wicell.org#sec3.6]) and image correlation is used to align each STORM image to its corresponding conventional image (Figure 9[href=https://www.wicell.org#fig9]B).\nA separate imaging distortion, chromatic aberration, creates nanoscale offsets between the color channels that must be corrected in multi-color super-resolution imaging. Here, images of fiducial beads (fluorescent nanospheres) acquired across all color channels are used to create polynomial warping transforms that map all color channels to a shared coordinate system (Figure 9[href=https://www.wicell.org#fig9]B). These corrections are applied to all conventional and STORM images for each ROI.\nFollowing drift and chromatic aberration corrections, images of physical sections must be aligned in three dimensions. This is accomplished by matching image features between adjacent ROIs and applying rigid/elastic registration algorithms to shift/warp sections into alignment across the image series (Figure 9[href=https://www.wicell.org#fig9]C).\nTo help users accomplish these tasks, we have packaged these steps into an open-source graphical user interface (GUI) (Figure 9[href=https://www.wicell.org#fig9]D) named “STORMpro” that automates the entire pipeline in Python (key resources table[href=https://www.wicell.org#key-resources-table]). Below, we describe the use of the interface, which is accompanied by documentation to assist users. The underlying source code is also available to users who may wish to modify aspects of the pipeline for custom processing. Links to repositories hosting all analysis code are listed in the ‘Software and algorithms’ section of the key resources table[href=https://www.wicell.org#key-resources-table].\nSee Figure 9[href=https://www.wicell.org#fig9].\nDownload and install “STORMpro” custom GUI for volumetric STORM image processing (see key resources table[href=https://www.wicell.org#key-resources-table]).",
    "Download and Install FIJI (Schindelin et al., 2012[href=https://www.wicell.org#bib21]).\nDownload and install FIJI Z-align macros (https://github.com/SpeerLab/STORM-UI/tree/main/analysis_scripts/macros[href=https://github.com/SpeerLab/STORM-UI/tree/main/analysis_scripts/macros]) and XML files (https://github.com/SpeerLab/STORM-UI/tree/main/ex_pipeline/XMLs[href=https://github.com/SpeerLab/STORM-UI/tree/main/ex_pipeline/XMLs]).\nOpen STORMpro and load the path to the data for analysis (Figure 9[href=https://www.wicell.org#fig9]i).\nLoad any chosen .dax STORM file into the visualizer. This enables interactive visualization of the raw STORM data using keyboard entries and mouse control to scroll through the movie. Full instructions are specified in the Readme.txt file accompanying the Storm-Analysis software.\nNote: .dax files may be dragged/dropped into the visualizer to load.\nSelect all appropriate “STORM channels” corresponding to the data collected (Figure 9[href=https://www.wicell.org#fig9]ii).\nSelect the appropriate “Alignment channel”, which is the imaging channel to be used for Z-section alignment (Figure 9[href=https://www.wicell.org#fig9]ii).\nSelect the appropriate “Number of processes” to run concurrently during the STORM fitting analysis. This number is limited by the total threads available for computation on the analysis machine.\nSet 3D-DAOSTORM fitting parameters and test the fit quality (Figure 9[href=https://www.wicell.org#fig9]iii):\nSelect “Set test parameters” to load the multichannel XML files specified fitting parameters.\nAdjust start/end frames in the corresponding channel of the selected .dax file to analyze a small sample portion of the selected STORM movie. Typically, 10–20 frames are selected in the middle or near the end of the .dax STORM movie.\nAdjust 3D-DAOSTORM SMLM fitting parameters (e.g., frame range, background, sigma, drift correction, etc.) in .xml files by manually inputting desired values. Guidance for determining these parameters is available (https://storm-analysis.readthedocs.io/en/latest/parameters.html[href=https://storm-analysis.readthedocs.io/en/latest/parameters.html]).\nSelect “Save XMLs” to save the selected parameters to the XML directory.\nSet “Movie for fitting evaluation” to desired .dax file for analysis.\nSelect “Fit Parameters\" to run test fits on the chosen .dax movie.\nLoad the output .hdf5 single-molecule localization list by dragging/dropping into the visualizer or selecting “Load localization 1” to select the desired .hdf5 file.",
    "Inspect the fit quality by visualizing the fit beacons (green circles in Figures 9[href=https://www.wicell.org#fig9]A and 9D) to determine if single-molecules are over-fit (fits with no single-molecule PSFs present) or under-fit (raw PSFs present with no corresponding fits).\nBased on the fit quality determined in step 64, repeat steps 61–64 to optimize the fitting parameters.\nInspect raw .dax STORM movies in renderer software to determine the frame range for full .dax file single molecule fitting. Select “Set Frame Range” and enter the start and end frames for full STORM movie analysis (Figure 9[href=https://www.wicell.org#fig9]iv).\nNote: The selected start frame for full STORM analysis should be set to a number where the majority of single molecules have begun to photoswitch.\nSelect “Multifit Analysis” to process the entire 2D dataset to a 3D volume (Figure 9[href=https://www.wicell.org#fig9]iv):\nWhen the first FIJI subprocess launches, input rigid registration parameters to continue the alignment. Information on rigid alignment in FIJI is found here: https://imagej.net/imaging/registration[href=https://imagej.net/imaging/registration].\nA Python subprocess opens displaying the compressed final image field. Drag cursor within the displayed image to set a sample ROI for cropping the image stack. Release the cursor to identify the ROI. Close the window and press “Escape” on the keyboard to crop the dataset.\nWhen the second FIJI subprocess launches, input elastic registration parameters to continue the alignment. Elastic alignment is implemented in TrakEM2 based on the original publication (Saalfeld et al., 2012[href=https://www.wicell.org#bib19]). Information on elastic alignment parameters is found here: https://imagej.net/plugins/elastic-alignment-and-montage[href=https://imagej.net/plugins/elastic-alignment-and-montage].\nAlternatives: Single molecule fitting – a list of available renderers and single-molecule fitting algorithms is referenced in the ‘Software and algorithms’ section of the ‘key resources table[href=https://www.wicell.org#key-resources-table]’. Use commercial or preferred open-source software to interact with raw SMLM data, generate SMLM localization lists, and convert these to image files.",
    "Alternatives: Drift/aberration correction – use commercial or other open-source software to correct sample drift for each ROI by cross-correlating each individual STORM image to its conventional image counterpart. Use fiducial bead imaging data to generate a non-linear warping transform that registers beads across color channels to correct chromatic aberration. Apply the resultant transform to all conventional and STORM images for each ROI.\nAlternatives: Serial stack alignment – use alternative commercial or open-source software to perform 3D serial-section alignment.\nNote: We continue to develop this software to improve functionality, ease of use, and open-source accessibility. Updates will be made available on GitHub (see ‘Software and algorithms’ section of the key resources table[href=https://www.wicell.org#key-resources-table])."
  ],
  "subjectAreas": [
    "Cell Biology",
    "Neuroscience",
    "Microscopy"
  ],
  "bigAreas": [
    "Biomedical & Clinical Research",
    "Molecular Biology & Genetics",
    "Bioengineering & Technology"
  ]
}