{
  "id": 13000,
  "origin_website": "Jove",
  "title": "Experimental Assessment of Mouse Sociability Using an Automated Image Processing Approach",
  "procedures": [
    "The protocol for the ease of explanation has been divided into 2 parts: 1) Experimental procedure and 2) Automated analysis. All animals were treated according to the Guide for the Care and Use of Laboratory Animals15, and all procedures were approved by the Institutional Animal Care and Use Committee.\n1. Experimental Procedure\nSet up the cage, which is a black non-reflective Plexiglas rectangular box (52 x 25 x 23 cm3) divided into three compartments: social, nonsocial, and a neutral middle compartment (Figure 1). Place inverted wire cups in each of the end compartments during sessions I and II (discussed below) and house the stimulus mouse during session II.\nSet up the camera in such a manner that the cage fills the field of view. Since lighting can interfere with mouse behavior, maintain a luminance of no more than 3.5 lux inside the cage, coming from indirect light from an incandescent light bulb and measured on the cage floor in upward direction. Also use an infrared light source, which mice cannot sense but the camera can detect. Record all movies in 720 x 480 standard definition.\nRecord a single frame of an empty cage for later image processing (called the “reference frame”) and save as a grayscale image.\nSession I: Introduce test mouse into the cage and wave hand over the cage, indicating the start of session (compare Automated Analysis). Record movie for 10 min. At the end of 10 min, put the mouse back into its original cage.\nSession II: Put the stimulus mouse under one of the inverted cups (counterbalanced).\nUse the “Social left” or “Social right” button to select whether the stimulus mouse is in the inverted cup on the left or in the inverted cup on the right.",
    "NOTE: The inverted cup with the stimulus mouse is called the “social cup”, whereas the other cup the “nonsocial cup”. The compartment in which the social cup is located is called the social compartment, the compartment with the nonsocial cup is the nonsocial compartment, and the middle compartment is the “neutral compartment”.\nIntroduce the test mouse into the cage. Wave hand over the cage to indicate the start of the session. Record movie for 10 min. Importantly, keep mice in the sociability apparatus before removing the inverted cups to begin Session III.\nSession III: Remove the inverted cups, release both mice and allow the test and stimulus mice to interact freely with each other. Wave hand over the cage to indicate the start of the session. Record movie for 10 min. At the end of 10 min, put both mice back into their respective cages.\n2. Automated Analysis\nNOTE: The commands in section 2 are issued via a graphical user interface (see Figure 2) that controls our software. Here we explain the step-by-step processing that our software allows; the software is also capable of performing the analysis in batch mode without user input.\nFor every movie, execute the following processing steps:\n\t\nLoad movie (click Load button).\nSelect cage configuration, which tells the analysis program the location of cage boundaries, compartment boundaries, and cup locations. Select one of four saved configurations or manually adjust all coordinates.\n\t\tNOTE: The configuration usually does not change from one experiment to the next and can therefore be reused.\nFor each frame of the movie, perform the following processing steps (2.1.3.1-2.1.3.6).\n\t\t\nConvert the frame to grayscale by clicking the “Grayscale” button.",
    "Digitally subtract the grayscale reference frame (see step 1.3) by clicking the “Subtract” button. NOTE: The goal of this step is to make the pixel values of the frame very close to zero everywhere except for the mouse position.\nBinarize the frame by setting all pixels below a certain threshold level to black, all pixels above that level to white (click the “Binarize” button).\n\t\t\tNote: The idea is that since the mouse pixels generally have higher values than the remaining pixels, the mouse pixels will become white and all other pixels black. The optimal threshold level depends on the lighting condition and can be determined by assessing the mouse shape throughout a movie. If the threshold is chosen too low, the mouse appears too large, and pixels that do not belong to the mouse can be colored white. If the threshold is too high, the mouse becomes small and can disintegrate into disconnected pieces. In the recorded movies, the optimal threshold was always between 20 and 35 (on a scale from 0 to 255).\nErode13 the binarized picture e times, then dilate13 2e times, then erode again e times, by pushing the button “Erod/Dil”.\n\t\t\tNote: The purpose to this procedure is to remove the tail. For the resolution (720 x 480) that was used, e = 3 worked in all circumstances.",
    "Note: The software checks automatically for the presence of a hand in the picture (during the recording of movies, hands are waved through the picture to indicate the beginning of a session). If a hand is present, there will be unusually many white pixels in the binarized frame because the hand is much larger than a mouse. The condition for the presence of a hand is that there are more than 10,000 white pixels in the binarized frame. The software determines the beginnings of sessions I, II, and III, by detecting the range of frames in which hand movements occur.\nIn sessions I and II, continue as follows:\n\t\nDetect the largest connected component of the set of white pixels (Click “LComp”). Note: The purpose of this step is to eliminate white pixels that do not belong to the mouse, e.g., caused by the motion of the stimulus mouse in session II. The largest connected component is in almost all frames the mouse.\nDetermine the two most distant white pixels (called the “ends” of the mouse) by clicking “Find Ends”.\n\t\tNote: The software establishes the continuity of the two ends, i.e., for each of the ends in the first frame to which of the ends in the subsequent frames they belong. The general idea is that since frames are recorded at high rate, the ends cannot travel far from one frame to the next, so that for the correct continuation of the ends from one frame to the next is that which minimizes the sum of the distances that the ends move. See the Discussion for more detail.\nDetermine which end of the mouse is the nose.",
    "Determine the direction in which a mouse moves by observing how the center of gravity (COG) changes from frame to frame (the COG’s motion is the motion of the sum of all mouse pixels).\n\t\t\tNote: The COG of a set of pixels p1, ... , pn  with coordinates x1, .. , xn   is defined by:\nimgsrc://cloudfront.jove.com/files/ftp_upload/52508/52508eq1.jpg\n\t\t\tMice usually move forward (i.e., towards their nose). In a section of several hundred frames, there is always very high confidence in the head/tail detection.\n\t\t\tNote: The software automatically determines towards which of the detected ends the mouse is moving; this end is identified as the nose and marked with a red circle in the movie. When the detected nose is marked with a red circle in every frame, the user can check the quality of the detection.\nIn session III, continue as follows:\n\t\nDetect two largest components of white pixels.\n\t\t\nIf both are of acceptable size for a mouse and their centers of gravity (COGs) are compatible with the mouse COGs of the previous frame, consider these two components the two mice.\nConsider mouse sizes acceptable if they have not changed by more than 20% since the previous frame, and consider COGs of two consecutive frames as compatible if their difference is not larger than the distance a mouse can travel in the time between frames (this distance follows from the maximum mouse speed, which can be determined as part of the preparations of an experiment series by analyzing the motion of several individual mice (as in sessions I and II).",
    "Note: If the two largest components are not acceptable sizes for a mouse, or the COGs are too different from those in the previous frame, the software automatically increases the binarization threshold until the two largest components are of acceptable size and their COGs are compatible with those of the previous frame.\nClick the test mouse in the first frame. Use the analysis in 2.3.1 to identify both test and stimulus mouse in every frame of session III.\nIdentify the frames in session III in which the one mouse socially approaches the other. Note: The software implements this step by automatically checking that the distance between the mice is less than the typical interaction distance of mice (we use 2 cm).\nWhen the software plays a short segment of the movie with the detected approach to the user, click a button to indicate whether this approach qualifies as a social approach by the test mouse, social avoidance by the test mouse, or neither.\n\t\tNote: Step 2.3.4 can be automatized if it is known which mouse is the test mouse. Since this information gets lost when the mice get too close to each other (or climb on top of each other), and since we have not yet found a way to label the mice in a way that can be detected reliably by our software AND does not affect their behavior, we have reverted to manual classification for now.\nTo evaluate processed movies, load movie using Load button.\n\t\nClick on Start Session 1 to display the first frame of session 1 (or Start Session 2 to display the first frame of session 2).\nClick on Play/Stop to play and stop movies.",
    "Note: The processed movies will display mouse with head and tail marked with differently colored circles. All sociability measures are displayed on the screen and updated as the movie plays.\nExport sociability data in Excel format by clicking “Export”.\nClick on “Compile Data” to compile all the data of all movies in a folder into a single excel file.\nSubscription Required. Please recommend JoVE to your librarian."
  ],
  "subjectAreas": [
    "Behavior"
  ],
  "bigAreas": [
    "Ecology & Environmental Biology"
  ]
}