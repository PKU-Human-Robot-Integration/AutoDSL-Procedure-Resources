{
  "id": 3624,
  "origin_website": "Cell",
  "title": "Protocol for single-molecule labeling and tracking of bacterial cell division proteins",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nSample preparation\nTiming: 1 day\nThe purpose of this step is to culture E. coli cells expressing the FP/HaloTag-fused POI to the log phase for subsequent SMT imaging.\nPrepare cell cultures in the log phase in a suitable growth medium, such as M9 or EZRDM, from frozen stocks.\nStreak cells from a frozen stock onto fresh LB plates with the appropriate antibiotics. Incubate the plates at 30°C or 37°C for 15–24 h.\nUsing inoculating loops or pipette tips, pick up several single colonies from the LB plates and inoculate them into separate tubes containing 3 mL of growth medium. Allow the cells to grow with shaking at 220 rpm at 25°C for ∼15 h (in M9) or ∼5 h (in EZRDM).\nNote: Ensure the plate with single colonies is freshly prepared within one week.\nNote: The choice of growth medium and temperature can be adapted to suit the specific bacteria and experimental requirements. The growth time must be adjusted for bacterial division studies to maintain cells in the liquid culture during the early log phase (OD600 = 0.1–0.3).\nNote: It is recommended to select multiple colonies to increase the likelihood of successful growth in the subsequent step.\nMeasure the OD600 of cultures to check their growth stages. If the OD600 is between 0.1 and 0.3, the culture is ready for step 2 (POI-HaloTag) or step 4 (POI-FP). If the OD600 is higher than 0.3, re-inoculate a small portion of the culture into a fresh growth medium to OD600 ∼0.05. Monitor the OD600 every 30 min or 1 h until it reaches 0.1 to 0.3.",
    "Note: The vector (pCH) used in this protocol (key resources table[href=https://www.wicell.org#key-resources-table]) and Yang et al.1[href=https://www.wicell.org#bib1] does not require IPTG induction in M9 medium to achieve a sufficiently low single-molecule level expression. For other vectors or media, however, induction may be necessary (we used 10 μM IPTG in the EZRDM medium). Users should inspect the expression level using fluorescence images and determine the optimal induction condition accordingly.\nHaloTag labeling (For HaloTag fusion proteins only):\nAspirate 1 mL of cell culture from step 1c to a 1.5 mL EP tube and add 0.1–10 μL of 1 μM JF646 (or JFX650) Halo ligand to a final concentration of 0.1–10 nM. Vortex the culture gently for a few seconds to ensure thorough mixing.\nNote: The ligand concentration requires optimization according to the labeling result. The final labeling density should be approximately one or two molecules per cell for effective single-molecule tracking. Typically, we maintain the same labeling time while adjusting the ligand concentration to achieve the desired single-molecule labeling density.\nCover the tube with alumina foil. Incubate the cells for 30 min at 25°C with gentle rocking.\nWash the cells three times using 1 mL or 500 μL of the imaging medium or buffer (e.g., M9). Incubate the cells at 25°C for 5 min with gentle rocking during each wash. Pellet the cells with a bench-top spinner or centrifuge at ∼8000 g for 2 min.\nNote: The washing step could be further optimized depending on the specific bacterial species used. For instance, we have found that the 5-min incubation is unnecessary for labeling FtsW-HaloTag in Caulobacter crescentus cells.3[href=https://www.wicell.org#bib3] Readers can assess the efficiency of the washing step by imaging WT cells following the same treatment. WT cells lacking the HaloTag fusion proteins should not exhibit observable fluorescence signals.",
    "Resuspend the cell pellet from the final wash in ∼50 μL fresh culture medium (M9 or EZRDM) or other fresh media used for cell growth for imaging. Measure and adjust the OD600 of the final culture to fall within the range of 1–3.\nWhile preparing the cell culture, make a gel pad for imaging (Methods video S1[href=https://www.wicell.org#mmc1], related to steps a-d).\nGently mix ∼10 mg of SeaPlaque GTG low melting temperature Agarose in ∼500 μL of M9 or EZRDM to achieve a final concentration of 2% (W/V).\nHeat the mixture at 70°C in a metal heat block or water bath for half an hour. The melted agarose gel can be stored at 50°C for up to 5 h.\nPlace the microaqueduct slide (from the FCS2 chamber) on the benchtop with a 0.75-mm thick gasket. Apply 50–100 μL of the melted agarose gel to the center of the slide. Gently cover the droplet of gel with a pre-cleaned cover glass immediately.\nAllow the gel to solidify at 25°C for at least 30 min.\nCritical: To minimize potential drifting of the gel pad during SMT imaging, it is recommended to prepare the gel pad 2–5 h before imaging and store it in a humidified box (e.g., an empty tip box filled with water) near the microscope to avoid abrupt temperature fluctuations. Start imaging 20–30 min after the sample or the imaging chamber has been assembled and settled on the microscope.\nApply the cell culture from step 1c or 2d onto the gel pad prepared in step 3 (Methods video S1[href=https://www.wicell.org#mmc1], related to steps a-d).\nCarefully peel the cover glass from the agarose gel pad using a razor blade.\nImmediately apply 0.5–1 μL of the sample onto the top of the gel pad.",
    "Wait 2–3 min, and cover it with a new, clean, dry glass.\nAssemble the FCS chamber according to the manufacturer’s instructions (https://bioptechs.com/product/fcs2-chamber/[href=https://bioptechs.com/product/fcs2-chamber/]).\n    Your browser does not support HTML5 video.\n  \n      Methods video S1. Preparing bacteria samples for single-molecule imaging experiments, related to steps 3–4\n    \nSingle-molecule imaging\nTiming: 1–2 h\nThe purpose of this step is to detect single molecules of interest and track their movement in living bacteria cells.\nSecurely position the sample chamber on the microscope stage. Visualize cells in bright-field mode to ensure they are appropriately settled on the gel pad and display the expected morphology.\nNote: If cells exhibit abnormal morphologies, stop the single-molecule tracking experiment and specify the underlying causes. Only proceed to the imaging experiment when cell grow and divide in predicted phenotypes.\nNote: Make sure that cells do NOT move or drift on the gel pad! Accurate tracking of single molecules is not possible in moving cells. Take the time to search around the gel pad to find a field of view where cells remain still. If a suitable region cannot be located, consider preparing a new gel pad by carefully adjusting conditions in step 3–5, such as the size of the gel pad and the drying time for the topped cell culture. We have observed that a larger gel pad generally reduces cell movement. Adjust the time after applying cell culture based on the environment temperature and humidity; excessively wet or dry conditions may lead to cell movement or clumping on the gel pad.\nMeasure the laser power and calculate the power density.\nSwitch the illumination mode to Epi, which allows the laser beam to pass through the sample perpendicularly.\nSet the laser output power to a range of 10–100 mW and measure the laser power at the top of the sample.",
    "Capture a snapshot of the sample, identifying the illumination region as the portion of the image with a high background.\nThe power density is then calculated by dividing the laser power by the area of the illumination region.\nAdjust the excitation power density by tuning the laser output or adding a neutral density filter (DNF1) in the excitation optical path (Figure 2[href=https://www.wicell.org#fig2]).\nNote: It is essential to measure and adjust the excitation power density to 1) achieve a good signal-to-noise ratio for single-molecule detection and localization and 2) avoid rapid photobleaching. Our previous studies used 1–2 W/cm2 excitation power density for TagRFP-T or JF646 with 0.5–1 second exposure time. Increase the laser power if the molecules move faster, as a shorter exposure time is required. For example, an exposure time of 50 ms may require an excitation power density of 100–500 W/cm2.\nTake streaming SMT movies.\nSwitch the illumination to HILO mode by laterally moving the stage until the incident angle of the laser beam reaches 60°–70°.\nNote: TIRF illumination mode is not utilized in this application because proteins within highly constricted septa cannot be observed with the shallow excitation field of TIRFs.\nFocus at ∼200 nm above the bottom of cells (about a quarter of an E. coli cell or half of a C. crescentus cell).\nCapture images continuously with an exposure time of 0.5–1 s for 3–5 min.\nTake bright-field images before and after fluorescence imaging and compare the positions of the cells from the bright-field images. Cells with apparent movement or drifting are excluded from further data processing steps.\nFor 3D-SMT, Z-position calibration is performed by imaging 1:500 diluted TetraSpeck fluorescent microspheres with an average diameter of 0.1 μm. Capture 100 Z-stacks around the spheres with a step size of 20 nm8.",
    "Note: The width of E. coli cells (∼1 μm) exceeds the depth of field of most high NA objectives (∼600–700 nm). The top and bottom of the cell will be blurry if the focus is set in the middle of the cells. To obtain more trajectories moving in the lateral X-Y plane, which provides a higher resolution than the vertical Z-direction, we focus near the cell's bottom (or the top). For small bacteria such as C. crescentus (∼500 nm cell width), we focus on the mid cell to monitor all molecules across the septum.3[href=https://www.wicell.org#bib3]\nNote: A longer exposure time (or slower frame rate) helps track molecules with slow movement and filter out molecules diffusing rapidly along the cylindrical part of the cell body, such as FtsI outside the divisome (∼0.04–0.1 μm2/s).16[href=https://www.wicell.org#bib16]\nSingle-molecule tracking analysis I: Localization\nTiming: 2–4 h\nThe purpose of this step is to detect single-molecule signals in each frame and accurately determine the central position of each molecule. The resulting coordinates of molecules will be used in subsequent steps.\nThe first step of single-molecule analysis is to localize each molecule with a high spatial resolution in either 2D or 3D. The input of this step is the multi-frame .tif or .tiff files generated from the single-molecule imaging step (Figure 3[href=https://www.wicell.org#fig3]).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3189-Fig3.jpg\nFigure 3. A step-by-step demonstration of the single-molecule tracking data analysis procedure",
    "Steps 1 and 2 correspond to Single-molecule tracking analysis I-II, while steps 3 and 4 are discussed in section Single-molecule tracking analysis III. Steps 5 and 6 are described in Motion state classification and speed calculation I and II. The “App or Code” column showed the main code used in each step. The “Data format” column presents the input and output data or files for every step. The representative outlooks are shown on the right. A detailed user video for the code (Step-by-step Single-Molecule Tracking analysis) can be found here: https://doi.org/10.5281/zenodo.4306645[href=https://doi.org/10.5281/zenodo.4306645]. Scale bar, 1 μm. Reprinted with permission from Yang et al., Nature Microbiology (Copyright 2021).1[href=https://www.wicell.org#bib1] Permission to reuse this figure has been obtained from Springer Nature.\nFollow the video (Methods video S2[href=https://www.wicell.org#mmc2]) to customize the ImageJ macro file (FtsW-RFP-singleMoleculeLoc-Macro.txt) to run the ThunderSTORM plugin. It is necessary to specify camera setup parameters (such as the EM gain, pixel size, etc.) and localization parameters (such as intensity threshold and fitting method).\nNote: Detailed descriptions of all the parameters can be found in the help file of the tutorials of the ThunderSTORM plugin[href=https://github.com/zitmen/thunderstorm/wiki/Processing-3D-data-with-astigmatism].\nNote: Enabling the multi-emitter detection algorithm is unnecessary, given the relatively low molecule density.\nNote: The maximum likelihood estimator can enhance localization accuracy but significantly reduce computing speed.\nNote: We use the ThunderSTORM plugin developed in the Hagen lab in this protocol. Alternative algorithms or software (such as SMAP32[href=https://www.wicell.org#bib32]) can also generate spatial coordinates of single molecules, especially when the images are captured by sCMOS cameras. These images exhibit pixel-dependent noise, unlike EMCCDs, which have a uniform noise distribution.33[href=https://www.wicell.org#bib33] The user, however, would need to convert the output list of molecular coordinates into a format similar to ThunderSTORM (Figure 3[href=https://www.wicell.org#fig3], a .csv file with head labels such as ‘id,’ ‘frame,’ etc.).",
    "Prepare directories on the computer for batch-processing using ThunderSTORM.\nCreate a separate folder to store all the single-molecule images (.tif files) from experiments conducted under the same conditions.\nCreate another folder to save the resulting localization lists.\nFor 3D-SMT data, generate the calibration curve using the Z-stack images of the TetraSpeck fluorescent microspheres from step 7e, following the tutorials of the ThunderSTORM plugin[href=https://github.com/zitmen/thunderstorm/wiki/Processing-3D-data-with-astigmatism].\nIn the ImageJ menu, click Plugin>Macros>Install. Select the modified macro file.\nClick the button with the name of the macro file appearing at the bottom of the Plugin>Macros. a. Select the folder with .tif files (step 9).\nSelect the second folder to save the results, which will be saved as .csv files.\nNote: Depending on the data size and computer speed, the process will initiate and may take several hours on a personal computer.\nPause point: Step 12 may take several hours, up to one night, to complete the analysis for large data sets.\n    Your browser does not support HTML5 video.\n  \n      Methods video S2. Analyzing single-molecule tracking data, related to steps 8–46\n    \nSingle-molecule tracking analysis II: Tracking\nTiming: 1–2 hours\nThe purpose of this step is to link localizations from the same molecules to construct single-molecule trajectories.\nSome frames may contain more than one molecule; hence, the coordinates of the same molecule moving in different frames must be identified and linked to generate single-molecule trajectories. To achieve this goal, we implement the nearest-neighbor-finding algorithm.34[href=https://www.wicell.org#bib34] After the linkage step, we systematically filter out mis-linked trajectories that do not meet specific criteria, such as not residing within a cell, exhibiting dramatic intensity fluctuations between frames, or failing to occupy anticipated positions (e.g., the septum for divisome proteins). The process of this section is demonstrated in Methods video S2[href=https://www.wicell.org#mmc2], related to steps 13–26.",
    "Launch MATLAB and change the current directory to the folder containing all the result .csv files from step 12.\nRun spotsLinking.m.\nSet the Spatial Threshold to ∼300 nm, slightly exceeding the size of the microscope point spread function (PSF).\nNote: The Spatial Threshold value represents a molecule's maximum allowable distance between consecutive frames. Any spot appearing above this threshold will be treated as a different molecule. Molecules moving too fast will be blurred out and cannot be detected in the Single-molecule tracking analysis I: Localization step due to the long exposure time.\nSet the Time Threshold to a large value (i.e., 30 or 50 frames). \\\nNote: This threshold represents the maximum permissible dark interval (in frame numbers) for linking two molecules, provided they are also sufficiently close in space (i.e., < Spatial Threshold). Initially, set a high value to characterize the off-time distribution under the current imaging condition. This threshold value will be adjusted in step 19.\nSet the Weight of Z to 0 (for 2D imaging) or 1 (for 3D imaging) according to the experimental setup.\nClick Load Coordinate files and select all the .csv files for analysis.\nNote: This step may take a few minutes and generate a distribution of the off-time (dark frame number) between two localizations in proximity. The average off-time will be displayed as the “Mean Lifetime” at the top of the window.\nBased on the calculated average off-time, readjust the Time Threshold to a reasonable value (2–3 times the average off-time is suggested, e.g., five frames for our FtsW-TagRFP-T tracking and eight frames for our HaloTag-JF646-FtsN tracking).\nNote: Other reasonable thresholds can be used. Maintain consistency across all files of the same experiment.\nSet the Minimal Trace length to an appropriate value, which determines the shortest trajectory length.",
    "Note: In our work, we employed a 10-frame threshold, twice the length of our shortest segment (5 frames).\nNote: The code saves all trajectories and those exceeding the designated thresholds in two separate sets of files. You may choose either one for subsequent data processing.\nClick Link the spots and Save file. The GUI will use the current parameters on the panel to process all loaded files and save linked trajectories from each file in a new file.\nNote: The localizations will be saved in .mat format named “Coord-∗.mat”. Linked trajectories (those longer than the Minimal Trace length) will be saved in .mat files called as “Long-∗.mat”.\nOptional: If you possess data in multiple folders, you can process each folder individually. Afterwards, click “Combine files” to merge those data structures into one. Alternatively, you can perform this combination at the end of the Single-molecule tracking analysis III: Cell envelope unwrapping section.\nRun TraceRefine.m in MATLAB. A new GUI will appear to assist in the interactive removal of “bad trajectories”. Change the Pixel Size according to the microscope setting for precise bright-field image and trajectories overlay.\nClick Load BF/FL image and Load trace to load the bright-field image and its corresponding trajectory file from step 19 (“Long-∗.mat”).\nNote: Single-molecule traces are color-coded in time and superimposed on the bright-field image (Figure 4[href=https://www.wicell.org#fig4]A, Methods video S2[href=https://www.wicell.org#mmc2]). The histogram of the average intensity of each trajectory is automatically calculated and displayed on the right panel.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/3189-Fig4.jpg\nFigure 4. Demonstration of the SMT data analysis GUI",
    "(A–C) The GUI of TraceRefine.m. (A) Color-coded traces superimposed on the bright-field image. Scale bar, 3 μm. (B) A histogram of the average intensity of each trajectory, which can be adjusted to filter out overly bright or dim molecules. (C) A hand-drawn polygon is used to enclose trajectories within ROI. Scale bar, 3 μm.\n(D) Screenshot from RegionCrop_unwrap.m: (i) A cropped rectangular ROI containing an entire cell in the center, with sufficient space around it. (ii) The selected cell and its associated trajectories are displayed in a new window. (iii) The “Rotate Image” option allows users to specify an angle in degrees (positive values indicate a counterclockwise rotation) to align the cell’s long axis vertically. (iv) The “Select Center” function enables users to click and point out the center of the septum. (v) The “Generate Unwrap Coords” option allows users to define the width of the cell (or the septum). Users click on the cross points of the red scanline and the left plateau first (indicated by blue arrows), followed by the cross point on the right side (indicated by green arrows). The GUI marks these selected cross points on the line and the bright-field image using blue and green lines. Scale bars, 1 μm.\nTo filter out trajectories with high intensity (likely from aggregates) or low intensity (likely from noise), drag the Max and Min bar to adjust the intensity thresholds. Then click Intensity Refine to remove all too bright or dim molecules (Figure 4[href=https://www.wicell.org#fig4]B, Methods video S2[href=https://www.wicell.org#mmc2]).\nClick Select ROI. The GUI will enable you to draw polygons that enclose trajectories in the regions of interest (ROI) (Figure 4[href=https://www.wicell.org#fig4]C, Methods video S2[href=https://www.wicell.org#mmc2]).\nClick Save Selected Traces to save the chosen trajectories. Optional: click Save image to save the current GUI interface.",
    "Note: “Bad trajectories” refer to trajectories of background objects (such as dust particles outside cells), molecules not in the septum region of the cell (for divisome proteins), or multi-molecule aggregations (displaying high intensity).\nPause point: Steps 22–26 should be applied to all result files. You may pause at step 26 as long as the trajectories are saved.\nSingle-molecule tracking analysis III: Cell envelope unwrapping\nTiming: 1–4 h\nThe purpose of this step is to flatten the trajectories along the curved cylindrical surface of a cell.\nIn typical imaging setups (except for the micropillar setup9[href=https://www.wicell.org#bib9],16[href=https://www.wicell.org#bib16],35[href=https://www.wicell.org#bib35]), bacterial cells lie flat on the cover glass. As single molecules traverse the cell membrane, which is a curved surface, the motion of divisome proteins like FtsW and FtsI may be underestimated. To address this curvature effect, we calibrated the diameter of the cell (or the septal ring) using the bright-field image.1[href=https://www.wicell.org#bib1] In 2D tracking, the “real trajectories” can be back-calculated geometrically using the position of the cell center and its diameter. In this step, we also decompose (or project) the trajectories onto two orthogonal axes: the long and short axes of the cell. In 3D-SMT, we fit the trajectories onto a circle determined by the cell center and diameter as those in the 2D scenario. We have observed comparable SMT results for membrane proteins in both 2D and 3D modes. However, if the protein is not localized on the cell envelope and does not exhibit membrane-bound movement, 3D-tracking should be the preferred technique.\nFor 2D-tracking (steps 27–31)",
    "Run RegionCrop_unwrap.m to initiate a new GUI. Adjust the PixelSize if necessary. Enter the date of the experiment or data processing to replace the YYYYMMDD at the top of the GUI. Then click Load BF and Load Traj to input the bright-field image and its trajectory file from step 26.\nNote: The trajectories will be superimposed on the bright-field image, each displayed in a distinct color.\nClick Select ROI. The GUI will prompt you to crop a rectangular ROI. Click on a specific cell’s top-left and bottom-right corners, ensuring it encompasses an entire cell in the center with surrounding empty spaces of approximately 1–2 cells (Figure 4[href=https://www.wicell.org#fig4]D (i), Methods video S2[href=https://www.wicell.org#mmc2]).\nNote: The chosen cell and its associated trajectories will be displayed in a new window (Figure 4[href=https://www.wicell.org#fig4]D (ii), Methods video S2[href=https://www.wicell.org#mmc2]).\nClick Rotate Image and input an angle in degrees (positive numbers mean counter-clockwise rotation) to align the cell’s long axis vertically (Figure 4[href=https://www.wicell.org#fig4]D (iii), Methods video S2[href=https://www.wicell.org#mmc2]).\nClick Select Center and then click on the center of the septum on the bright-field image as accurately as possible (Figure 4[href=https://www.wicell.org#fig4]D (iv), Methods video S2[href=https://www.wicell.org#mmc2]).\nNote: A smoothed profile of the bright-field image along the short axis through the center will appear in the top-right panel (in red).\nOptional:  Choose Left Side Region and Choose Right Side Region are tools for calculating the bright-field image's left- and right-side plateau. They are used for visualization in the subsequent step.\nUnwrap and save the coordinates:\nClick Generate Unwrap Coords.\nClick on the cross points of the red scanline and the left plateau first, followed by the cross point on the right side. The GUI will mark the selected cross points on the line and also on the bright-field image (in blue and green lines) (Figure 4[href=https://www.wicell.org#fig4]D (v), Methods video S2[href=https://www.wicell.org#mmc2]).",
    "Repeat this step if the selection appears unsatisfactory.\nClick Save the Structure, and the data will be saved, returning the GUI to its main interface.\nFor 3D-tracking (step 32–39):\nRun RegionCrop_unwrap3D.m to initiate a new GUI.\nAdjust the PixelSize if necessary.\nEnter the date of the experiment or data processing to replace the YYYYMMDD at the top of the GUI.\nClick Load BF and Load Traj to input the bright-field image and its filtered trajectory file from step 24. The trajectories will be superimposed on the bright-field image, each displayed in a distinct color (Figure 4[href=https://www.wicell.org#fig4]A) (similar to step 25).\nClick Select ROI. The GUI will prompt you to crop a rectangular ROI. Then click on a specific cell’s top-left and bottom-right corners, ensuring it encompasses an entire cell in the center with surrounding empty spaces of approximately 1–2 cells (Figure 4[href=https://www.wicell.org#fig4]D (i)).\nNote: The chosen cell and its associated trajectories will be displayed in a new window (Figure 4[href=https://www.wicell.org#fig4]D (ii)).\nClick Rotate Image and input in an angle in degrees (positive numbers mean counter-clockwise rotation) to align the cell’s long axis vertically (Figure 4[href=https://www.wicell.org#fig4]D (iii)).\nClick Select Center of Ring and then click on the center of the septum on the bright-field image as accurately as possible (Figure 4[href=https://www.wicell.org#fig4]D (iv)).\nNote: A smoothed profile of the bright-field image along the short axis through the center will appear at the top-right panel (in red).\nOptional:  Choose Left Side Region and Choose Right Side Region are tools for calculating the bright-field image's left- and right-side plateau. They are used for visualization in the subsequent step.",
    "Click Generate Ring Diameter. Click on the cross points of the red scanline and the left plateau first, followed by the cross point on the right side. The GUI will mark the selected cross points on the line and also on the bright-field image (in blue and green lines) (Figure 4[href=https://www.wicell.org#fig4]D (v)). Repeat this step if the selection appears unsatisfactory.\nClick Select Center of Cell and then click on the center of the non-constricted cell cylinder on the bright-field image as accurately as possible. A smoothed profile of the bright-field image along the short axis through the center will appear at the top-right panel (in red).\nOptional:  Choose Left Side Region and Choose Right Side Region are tools for calculating the bright-field image's left- and right-side plateau. They are used for visualization in the subsequent step.\nClick Generate Cell Diameter. Click on the cross points of the red scanline and the left plateau first, followed by the cross point on the right side. The GUI will mark the selected cross points on the line and the bright-field image (in yellow and black lines). Repeat this step if the selection appears unsatisfactory.\nClick Save the Structure, and the data will be saved, returning the GUI to its main interface.\nNote: We estimate the cell width (diameter) from the cross points with a correction coefficient measured from PALM images of the Z-ring in our lab.8[href=https://www.wicell.org#bib8] It might introduce some bias when using different illumination modes, such as phase contrast. However, the unwrapping procedure to correct trajectories generally produces results closer to the “truth” than the raw data.\nRepeat steps 27–31 for 2D-tracking or steps 32–39 for 3D-tracking until all cells with trajectories are processed.",
    "Note: To redo the unwrapping step for a specific cell, left-click the item in the region list on the right panel and click Delete trace to remove it.\nClick Save Data to auto-save all the rotated trajectories with the cropped bright-field images in the data structure. Click Delete all to clear the workspace before processing the next file. The data structure should be saved as “YYYYMMDD-TraceInfo-∗.mat”.\nPause point: This step completes single-molecule trajectory processing. The next section is specific for trajectory segmentation, classification, and directional speed calculation of divisome proteins.\nMotion state classification and speed calculation I: Trajectory segmentation\nTiming: 1–3 days\nThe purpose of this step is to segment the trajectories based on their motion properties.\nWhen using a long exposure time (0.5–1 s), most freely diffusing molecules become blurred and cannot be localized. We have developed an analysis pipeline to segment the trajectories and differentiate between stationary and progressively moving molecules. Initially, an unwrapped trajectory along the septum is plotted against time. Users can visually inspect the shape of the trajectory and select the most distinct segment with a unique motion state. The algorithm then calculates the probability of this segment representing directional movement based on experimental and simulated displacements of various moving states (see details in the Methods part and Figure S3 in Yang et al.).1[href=https://www.wicell.org#bib1] Users can then determine whether the segmentation is reasonable (proceed to the next segment) or not (redo the segmentation). This section can be performed iteratively to approach optimal segmentations.\nGenerate a simulated set of stationary trajectories with varying lengths using Section 0 of the statesSegP.m file.",
    "Note: The results of this section will be saved as “SimuFtsW.mat”. The variable filenameSimu in line 21 can be customized according to individual experiments. These simulated trajectories will be used in step 46 to calculate the likelihood of a segment being stationary (confined diffusion) or directional motion (Methods video S2[href=https://www.wicell.org#mmc2]).\nNote: Given a segment of a trajectory, we fit its position against time using a linear function and calculate the overall displacement. To distinguish segments indicating directional movement from those of stationary state (confined diffusion), we primarily assess whether the displacement exceeds random fluctuations attributable to diffusion and localization uncertainty. As these fluctuations are stochastic in nature, we can only calculate the distribution of these fluctuations and estimate the probability of a segment to be stationary or directional moving. Therefore, we initiate a simulation involving a set of confined diffusion segments to establish the displacement distribution for these stationary molecules. More details of the statistical test are described in the supplementary discussion in Yang et al.1[href=https://www.wicell.org#bib1]\nNote: We fix the diffusion coefficient and confinement size to simplify the simulation. The parameters in the MATLAB code have been optimized for our study of cell division proteins FtsW, FtsI, and FtsN in E. coli. Specifically, we used the diffusion coefficient (D) of 0.0005 μm2/s, based on FtsZ’s D,12[href=https://www.wicell.org#bib12] a confinement size (B) of 200 nm, reflecting the size of FtsZ clusters (200 nm7), and a localization error (L_err) of 15 nm in consideration of the single-molecule localization precision. The frame-to-frame time interval, ExpT, should be adjusted according to the specific experimental setup (measured in seconds).",
    "Note: Users can modify these parameters according to their unique biological systems and experimental conditions. We recommend initiating with stringent requirements, such as a low diffusion coefficient and short confinement length, for an initial simulation (or utilizing our current settings). Subsequently, employ these simulated trajectories to perform segmentation in steps 43–46 on a small portion of the data to identify all “stationary” segments. These initial segments can then be used to determine the actual D, B, and L_err values from real data, as outlined in step 41. Subsequently, rerun the simulation using the experimental D and L_err values. We have found this approach to be highly effective and robust for segmentation.\nPause point: The simulation can be time-consuming, potentially taking over 10 h on a personal laptop. A small sample size (N_traj = 100 or 200) can expedite the computation.\nInteractively configure additional parameters for trajectory segmentation based on experimental data.\nIn Section 1 of statesSegP.m, edit the “Experiment” variable to “2D_Tracking” or “3D_Tracking” according to the experiment.\nAdjust “ExpT” (time interval in seconds) and “PixelS” (pixel size, in nm) if necessary.\nRun Section 1 and select all trajectory files from step 41 (of the same experimental condition). A window will appear, allowing users to examine the distribution of the fluorescence intensity of individual localizations.\nClick anywhere in this figure and input a number, A. All localizations with intensity greater than     M o  I  + A ·  σ I    will be removed.     M o  I    is the statistical mode of the intensity and    σ I    is the standard deviation of the intensity. In our FtsW tracking studies, A was set to be 2.1[href=https://www.wicell.org#bib1]\nNote: High-intensity localizations could indicate abnormal aggregation or multiple molecules in the same frame. The code removes these localizations while retaining other points in the trajectory.",
    "The script will then calculate the MSD curves in the X-axis (short axis of the cell) and Y-axis (long axis of the cell) for all trajectories. Click anywhere on the MSD plot to continue. The code will prompt users to input two parameters. The noise level of X provides guidelines for segmentations in step 46. This number should be similar to or ∼ 10%–20% larger than the first point of the MSD in the X-axis, aiding in determining if a molecule has moved too far from its previous position.\nNote: FtsZ clusters confine molecules in the division site or septum. Large displacements suggest a transition to another state or location, indicating the trajectory segmentation at that time point.\nNote: The Confinement of Y estimates the width of the septum. This parameter is critical as points outside the septum will be removed. Set this number to be similar to the plateau of the MSD in the Y-axis or the known Z-ring width, for example, 100 nm in WT E. coli cells.\nSave the refined and combined data structure.\nRun Section 2 of statesSegP.m to prepare for segmentation. Confirm that Input_Params.ExpT and Input_Params.PixelS are correct according to the exposure time and pixel size used in the experiment. The Input_Params.TimeRange should cover the maximum length of the trajectories.\nSelect the experimental dataset from step 43 and the simulation dataset from step 42 in the pop-up window.\nNote: A new variable called IndTrack, which contains all trajectory information, should be generated in the workspace. The length of IndTrack corresponds to the number of trajectories.\nChange the Index from 1 to the length of IndTrack and run Section 3 of statesSegP.m.",
    "Note: For each trajectory (Index), a GUI will appear, displaying the bright-field image of the cell with a color-coded trajectory (from blue to red, indicating the beginning to the end) in the top-left corner. Users can segment the trajectory state-by-state following the instructions provided in the pop-up box (Methods video S2[href=https://www.wicell.org#mmc2]):\nSelect one part of the trajectory located on the septum (or a position of interest) by clicking Okay in the pop-up box and then clicking on the two ends of the region you want to choose. If the entire trajectory is correctly localized in the septal region, click Useall, and the code will use all the positions for calculation. If the trajectory is not in the area of interest (out of the septum), click Bad Trajectory to exit and continue analyzing the next one.\nNote: The trajectory along the short axis will be displayed in the upper right region. Examine the trajectory by eye and approximately pinpoint the intervals characterized by a consistent speed, or uniform slope.\nClick on the tentative start and end positions of one interval. Click “No” in the pop-up window if the segmentation looks unreasonable and redo this step.\nNote: The linear fit will be displayed on top of the trajectory. The code will automatically calculate the probability distribution of R by bootstrapping and display it with that of the simulated stationary segment from step 42 on the bottom left region. Users can inspect the speed (V), R-value, and the probability of the segment being directional (P_processive). For more details on these parameters, refer to Yang et al.1[href=https://www.wicell.org#bib1]\nClick “Yes” to proceed to identify the next possible segmentation with a uniform slope. Repeat steps a-c until the entire trajectory is segmented.",
    "Critical: We strongly recommend declassifying trajectories from different experiments before proceeding to step 46. By doing so, the user will not know which experiment or condition the trajectories originate from. For instance, one user could create separate folders to store the IndTrack structures, while another can conduct the segmentation and identification process. This strategy mimics a double-blind test, effectively mitigating potential human bias.\nPause point: Step 46 may take a long time (ranging from hours to days) depending on the size of the dataset. The code automatically saves the IndTrack variable to the same file each time you run Section 3. Therefore, you can stop at any index of the trajectories and resume the analysis by reloading the IndTrack file.\nMotion state classification and speed calculation II: Post-processing\nTiming: 1–4 hours\nThe purpose of this step is to analyze the speed, lifetime, and percentage of different motion states.\nTo further reduce potential human bias, we apply the same criteria to re-classify all segments of the same protein fusion from different experimental conditions. For instance, our FtsW tracking experiment maintains consistency in threshold values for R and P_processive across all conditions, including WT or FtsZ mutant strains, drug treatments, and varying growth conditions.\nOpen the DwellSpeedCalc.m file; adjust the segmentation parameters; then run the code.",
    "Note:  Rmax1 and Pmin are key parameters: any segment with R smaller than Rmax1 and P_processive greater than Pmin will be classified as directionally moving. Some directionally moving segments with a long lifetime but slow speed may generate a small P_processive. Therefore, we also classify all segments with R smaller than Rmax2 as directionally moving. Set the number of bins (Nbin) and the region of speed (LowB to HighB) for speed distribution plotting. We recommend using predefined parameters, specifically Pmin = 0.75, Rmax1 = 0.5, and Rmax2 = 0.2. These parameters can be adjusted in cases of noticeable mis-segmentation. A higher Pmin can reject more segments from the moving state. It is crucial to maintain parameter consistency across all experimental conditions.\nSelect segments classified from step 46 (the user can choose multiple files from the same condition). Save the variables containing the apparent moving speed and lifetime of each segment.\nNote: The segments are now classified as directional and non-directional. The speeds of directional segments are saved in Vx. The lifetimes are saved in Dtx and Dtf, respectively.\nNote: The classification result (R and P scattered plot), speed distribution (in logarithm scale), and dwell time distribution (for both stationary and moving states) will be plotted and saved.\nPerform non-linear fitting of the speed distribution. Different division proteins can move in single- (FtsN) or multiple- (FtsW/I) modes.\nWe fit the cumulative probability density function (CDF) of the speed to a single or double log-normal distribution in our work using cdfFitting2pop.m. This MATLAB script uses the Vx variable from step 48 with a customized bin number and speed region, which could be the same or different from step 47.\nIn Section 2 of this code, the CDF of the directional speed is calculated and fit to single- or double log-normal functions.",
    "The standard errors of the fitting parameters are estimated by bootstrapping in Section 3. (Additionally, users can also implement the Jacobian of fitting to estimate fitting errors using functions log1CDFfit and log2CDFfit_free).\nThe histogram in the log scale of the experimental data and fitting curves are generated in Section 4. All the results are combined to save in a variable named Result (Table 2[href=https://www.wicell.org#tbl2]).\ntable:files/protocols_protocol_3189_4.csv\nNote: The log-normal distribution is chosen empirically as it describes the experimentally observed distribution well. Users can use other models and their application/code to analyze the speed dataset. The single- and double-log-normal functions we use to fit the data are:\nCDF\nsingle\n=\nA\n·\n[\n1\n+\nerf\n(\n−\nln\nx\n−\nμ\nσ\n2\n)\n]\nand,\nCDF\ndouble\n=\nP\n1\n·\n[\n1\n+\nerf\n(\n−\nln\nx\n−\nμ\n1\nσ\n1\n2\n)\n]\n+\n(\n1\n−\nP\n1\n)\n·\n[\n1\n+\nerf\n(\n−\nln\nx\n−\nμ\n2\nσ\n2\n2\n)\n]\nwhere erf is the Gauss error function. The median and mean of the speed can be estimated by   exp  ( μ )    and   exp  (  μ +   σ 2  2   )   .\nCalculate and fit MSD curves to obtain the diffusion and confinement information using MSDCalc.m. The corresponding results, including diffusion coefficient and confinement length, will be saved in variables listed in Table 2[href=https://www.wicell.org#tbl2]. Customized data analysis tools can be used to extract more information from these single-molecule trajectories."
  ],
  "subjectAreas": [
    "Single-Molecule Assays",
    "Microscopy",
    "Microbiology"
  ],
  "bigAreas": [
    "Molecular Biology & Genetics",
    "Bioengineering & Technology"
  ]
}