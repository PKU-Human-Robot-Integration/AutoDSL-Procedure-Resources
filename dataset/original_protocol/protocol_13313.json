{
  "id": 17139,
  "origin_website": "Jove",
  "title": "A Workflow to Quantitatively Determine Age-Related Macular Degeneration Lesion-Specific Variations in Fundus Autofluorescence",
  "procedures": [
    "The study was conducted in accordance with the Declaration of Helsinki and approved by the Ethics Committee of the University of Bonn (protocol code 305/21). Written informed consent was obtained from all subjects involved in the study. We required all participants in the video to sign release forms granting us permission to use their likeness and personal information in the creation of an online video.\n1. Quantitative autofluorescence (QAF) image acquisition\nFor accurate image acquisition with the QAF device, ensure that the participant is seated comfortably in front of the device. Have the participant press their chin and forehead against the chin- and headrest. Adjust the height of the chinrest until the lateral eyelid angle is at the same height as the red marking.\nEnsure that the image is focused in the near-infrared modus by rotating the wheel on the recording device until the small vessels are in focus. Zoom in on the eye by moving the camera forward until the corners of the image are evenly illuminated. As a rule of thumb, adjust the focus to the spherical equivalent. Reduce the focus prior to QAF imaging by one or two diopters, as blue QAF uses a shorter wavelength, and switch the modus of the QAF device from the near-infrared to the QAF mode.\nReadjust and upscale the illumination and fine-tune the focus of the image until the small vessels closest to the fovea are in focus and the image is brightly illuminated without red dots (indicating over-illumination). Bleach the photopigment by waiting at least 30 s in the QAF mode prior to image acquisition to allow the continued blue light excitation to bleach the photoreceptor pigment in the field of view of the camera settings.",
    "To capture images, press image acquisition on the touch pad of the imaging device; be sure to capture more than one QAF image in case of blinking or sudden eye movements during acquisition.\n\t​NOTE: The workflow also requires spectral domain optical coherence tomography (SD-OCT) images. OCT image acquisition is explained elsewhere, as it is widely used in clinical practice25.\n2. Image export\nFor this analysis pipeline, ensure that the QAF and OCT images are in the Extensible Markup Language (XML) file format. In the HEYEX viewer, right-click on a desired QAF/OCT image and select Export | as XML from the drop-down menu.\n3. Open-source plug-ins for QAF analysis-installing the pipeline\nNOTE: The presented QAF software is an open-source plug-in named \"Spectralis pipeline\" created for the open-source software ImageJ (FIJI expansion)26.\nTo access the plug-in, open FIJI, select Help then Update from the drop-down menu, then click on Manage Update Sites to add the Creative Computation Update Site \"https://sites.imagej.net/CreativeComputation/” to the preexisting update sites.\nDownload the plug-ins and then restart FIJI. Now, the Spectralis Pipeline is installed. The different Spectralis plug-ins are located under the drop-down menu Plugins | Spectralis or Plugins | SpectralisBatch.\n4. Setup - data storage\nNOTE: To allow a seamless workflow, it is recommended to set up the folder structure as follows. First, set up a folder for each study subject. Oculus dexter (OD) and oculus sinister (OS) refers to the right and left eye, respectively, and these abbreviations are used throughout this workflow.\nFor each examined eye of each study subject, set up one folder for an OCT, named OD_OCT and OS_OCT, respectively. Let the Spectralis pipeline automatically store its output from the \"Mark_BScans_OCT\" plug-in as tab-separated values in these folders.\nFor the QAF images, create two folders named OD_QAF and OS_QAF.",
    "Create additional folders if other multimodal imaging modalities are used. Ensure that the resulting folder structure resembles the structure listed below:\n\tCASE_ID\n\tOD_OCT\n\tOD_QAF\n\tOD_other_imaging_modality\n\tOS_OCT\n\tOS_QAF\n\tOS_other_imaging_modality\n5. Conversion of the QAF XML file into a QAF image (plug-in used: QAF_xml_reader)\nThe Spectralis QAF XML Export files are stored in red-green-blue (RGB) format, limited to a scale from 0 to 255 (representing measured AF values) and including \"standard\" and \"black\" calibration regions. The \"QAF_xml_reader\" plug-in produces a QAF image. For this, open the plug-ins drop-down menu, select Spectralis | QAF_XML_Reader, and discard the opening screen.\nA new window appears showing the prompt Choose a directory containing a Spectralis XML QAF Export:. Select the directory and click Select.\nEnter the reference calibration factor (RCF) of the QAF device (included in the image information of the QAF image) and the age of the patient at the time the image was taken.\nThe next window is called QAF Parameters. If the patient is pseudophakic at image acquisition, select age 20 instead (this has the effect of applying no age correction). After clicking OK, when a pop-up labeled Map to 8bit appears, enter the minimum QAF (qafMin) value and maximum QAF (qafMax) value for a color-coded QAF-image. In case qafMin and qafMax are unknown, use the default settings, click OK, and observe the original image labeled Raw QAF Data that appears, as well as the 32-bit QAF and 8-bit color-coded QAF image.\n\t​NOTE: The color-coded QAF image is solely used for illustrative purposes; the 32-bit QAF image with actual QAF values is utilized for further analysis.\n6. Registering QAF images with the OCT image (plug-in used: Register_OCT_2)",
    "NOTE: This step is needed to accurately align the OCT image with the QAF image, so that lesions in the QAF images and OCT BScans are aligned.\nAccess the plug-in through the drop-down menu Plugins | Spectralis, or create a hotkey to access the different plug-ins used. To achieve this, select Register_OCT_2 under Plugins | Shortcuts | Add Shortcut and choose the desired hotkey.\nAfter opening the plug-in, click OK on the first window that appears. Next, a window containing the prompt: Choose a directory containing the Spectralis OCT XML export: will appear in the main ImageJ window. Select the folder containing the Spectralis OCT XML Export and click on Open.\n\tNOTE: The OCT will now load, which depending on the processing power of the computer being used might take up to 2 min.\nNext, wait for a window containing the prompt Save registered images to: to pop up. Select the directory where the EnFaceStack (aligned image file) will be stored and click Open.\nWait for a pop-up window containing the prompt Choose an image to add to the EnFaceStack: to appear, select the 32bit QAF image to align the image with the SD-OCT, and click on Open. If all necessary images in this EnFaceStack are included, select Cancel.\nWhen the next window asks the user to select a label for the EnFaceStack, select the premade QAF label; alternatively, enter the desired name of the modality in the Other box. Select OK to register the image.\n\tNOTE: Do not include spaces or other punctuation in the Other field.",
    "Observe the three windows that pop up. The first one is labeled Localizer and displays the SD-OCT as a left eye (OS) image. The second window is named QAF or one of the other modalities selected earlier as the original left (OS) or right (OD) eye. The last window is called Landmarks, which asks to select one to three landmarks in each image.\nAlign the two images by selecting one to three landmarks per image-vessel bifurcations or other characteristics located on both modalities. Zoom in (use the \" +\" keyboard character to zoom in and \" -\" to zoom out) prior to selecting the landmark. Ensure that the selected landmarks are spread out both vertically and horizontally in the image. Once all the landmarks are annotated, select OK on the Landmarks tab and Cancel on the next prompt.\nWhen a window prompting Do you want to see the results appears, select Yes to check whether the image has been aligned correctly. Do this by zooming in on a small vessel and placing the cursor beside it, then scroll up or down to check how much the vessel moves in relationship to the cursor. If the alignment is not precise, delete the \".tiff\" file in the OD_QAF directory and restart the process from the start of step 2.\n\t​NOTE: Since the markings on Mark_BScans_OCT must be precise, the alignment between the SD-OCT and QAF image also has to be very accurate. Pixel-perfect alignment can be achieved on most images, although in some cases alignment is limited to an accuracy of three or four pixels.\n7. Creating an averaged QAF image for comparison (plug-in used: StandardRetina/BatchStandardRetina)",
    "NOTE: QAF values are strongly dependent on the retinal location (e.g., central shadowing caused by macular pigment). Therefore, the QAF values of drusen should be compared to standard QAF values of the same region. As a prerequisite for analysis, the StandardRetina creates an enface map of averaged QAF images (for example, from an aged-matched control cohort). The resulting enface map shows a pixel-by-pixel map of an average QAF value for the central retina.\nThere are two ways of creating standard retinas within the Spectralis pipeline: the first, AddToStandardRetina_OCT, allows one new case at a time to the enface map, while the second, BatchStandardRetina, adds multiple cases at once.\n\t\nTo add one image at a time, select Plugins | Spectralis | AddToStandardRetina_OCT and dismiss the opening screen. When a window pops up displaying the text Choose a directory containing a Spectralis OCT XML export, select the folder and click Select to open the BScan.\nWhen a new window appears displaying the prompt Choose a directory containing registered EnFace images:, select the appropriate folder and click Select.\nObserve the three windows that pop up, one labeled EnFaceStack that displays the Stacked images from the folder selected in the second step, the second one labeled Bscan Stack displaying the OCT BScan, and a third window appearing in the middle labeled Choose Modality. Select a modality from the EnFaceStack.\nSelect a modality and observe the new window that pops up with the prompt Choose a directory containing the StandardRetina. If a directory containing a StandardRetina does not already exist, select an empty folder to create a new StandardRetina.",
    "Examine the new StandardRetina, scroll up and down, and move the cursor to view the mean and standard deviation for that specific location. Click on the button Accept? To either add the latest photo to the StandardRetina or discard it.\nTo add multiple images at a time, use Batch_QAF_StandardRetina.\nFirst, prepare a \"manifest.txt\" file in the same folder as the case IDs and ensure that it lists the relative path from the location of the .txt-file to the OCT and the EnFaceStack. Separate the two by a tab space and ensure that there is no additional whitespace in front of and behind the names. The file should resemble this setup:\n\t\tpathToOCT_1>pathToEnFaceStack_1>001/OD-OCT>001/OD-QAF\n\t\tpathToOCT_2>pathToEnFaceStack_2>002/OD-OCT>002/OD-QAF\nCreate the file in spreadsheet software and save it as a txt file. Ensure that all the paths contain the slice (character letters) QAF for the manifest file to function properly. The plug-ins are located under the drop-down menu Plugins | SpectralisBatch-Batch | QAF_StandardRetina.\nDismiss the opening screen and wait for a new window to open displaying the prompt Select the initial Standard Retina. Either select a folder with a preexisting StandardRetina or select an empty folder to create a new StandardRetina.\nLook for a prompt labeled Select Modality to appear; the default is QAF. Ensure that the file name of the respective modality exactly matches the filename for a slice in every EnFaceStack named in the manifest file. Next, when a window opens up prompting the user to choose a manifest file (described previously), click Cancel if no other manifest file is to be added to this StandardRetina or select another manifest file. Examine the new StandardRetina in a new window labeled Accept?, and decide whether to add the latest batch to the StandardRetina or discard the latest batch.",
    "NOTE: The process of combining all the QAFs to a StandardRetina may take a while.\n8. Annotating regions of interest for analysis (plug-in used: Mark_BScans_OCT)\nTo mark lesions (such as drusen), open Plugins | Spectralis | Mark_BScans_OCT and dismiss the opening prompt. Look for a new window labeled Choose a directory containing a Spectralis OCT XML export to appear. Pick the folder that has the desired OCT and click OK.\nAfter FIJI has loaded the OCT, observe the new window with the label Choose a directory containing registered en face images to appear. Select the directory containing the EnFaceStack and click Select.\nThree new windows now appear, one labeled EnFaceStack, one labeled BscanStack, and one named User Parameters.\n\t\nThe User Parameters window prompts the user to enter the following parameters: Case ID, which will then appear in the name of the output csv-file, bandwidth in mm, the enface line width, the BScan line width, and the region mask opacity.\n\t\t\nThe parameter bandwidth in mm determines the width of each iso-hull in millimeters (mm). Use Enface line width to change the line width of marked lesions on the window labeled EnFaceStack.\nThe BScan line width determines the line width on the window Bscan Stack. Note that setting this parameter to 1 is the best line width setting for most cases.\nChoose between an En Face Mask or a Distance Map displayed in a separate window to decide whether inside bands should be colored in. Afterward, click done in the Mark in BScan window in the plug-in.",
    "Next, when asked to select a preexisting StandardRetina, select the folder containing the StandardRetina and click Select. Note that if a StandardRetina is selected, the output Mark_BScans_OCT will select the mode z-score (of a measured QAF value compared to StandardRetina). If the raw QAF value is preferred, click on Cancel and wait for a new window labeled Message that warns results will be raw values, not z scores.\nLook for a new window to pop up prompting Choose a directory containing the saved state with the saved data. If a save file exists, click on the directory containing the slices | Select. In case progress is not to be saved, select cancel. Look for a new window labeled Mark in BScan, and out of a drop-down menu, select save, ignore, done, and mark.\n\t\nMark: Start annotating the regions of interest in the BScan, with similar commands as in the \"Register_OCT_2\" plug-in explained above. To mark a region, select start by right-clicking and dragging the mouse cursor to the end of the lesion, make sure mark is selected in the Mark in B-Sscan window, and click OK. The region of interest is now marked in this BScan.\nIgnore: Select Ignore in the Mark in BScan window and click on OK to ignore the marking.\nSave: Select save in the Mark in BScan window and click OK to make a new window appear, containing the prompt select a directory to save state. Select an already existing folder or create a new one. Open already existing files by starting \"Mark_BScans_OCT\" and select the directory containing the save state when the Choose a directory containing the saved state window appears.",
    "NOTE: Multiple save states cannot be stored in one directory; save states from one locale to another cannot be switched easily (e.g., GERMAN to USA).\nDone: Select done in the Mark in BScan window and click on OK to make a new window with the label choose modality appear.\nWhen a prompt labeled bring the correct modality on top of the enface stack appears, bring the modality called QAF on top, which was aligned using \"Register_OCT_2\". Do this either by scrolling through the EnFaceStack, selecting the En face Stack window, or clicking on the left or right arrow. Note that the name of the modality is displayed in the top left corner.\nTo better inspect and mark the lesions, zoom into the Bscan window. Click on the B-Scan window, point the mouse in the direction to zoom in, and press the + key; to zoom out, press the - key.\nScroll through the BScan stack by scrolling up or down on the mouse, dragging the bar at the bottom to the left or right to move through the scan, or by selecting the B-Scan frame and clicking on the left and right arrow keys on the keyboard. Note that an overview of the current area in the BScan stack is provided by the red line on the EnFaceStack window, and on the top left of the BScan window where the BScan number (e.g., 31/120) is displayed.\nClick on OK to create a new .tsv file in the corresponding \"OD_OCT\" or \"OS_OCT\" folder. Note that the .tsv file name will be composed of \"Mark_Bscans_OCT\" plus the case ID that was entered, the laterality, and the modality that was chosen in the last step of Mark_Bscans_OCT. Additionally, color-coded \"iso-hulls\" of the drusen will now be displayed in the EnFaceStack."
  ],
  "subjectAreas": [
    "Medicine"
  ],
  "bigAreas": [
    "Biomedical & Clinical Research"
  ]
}