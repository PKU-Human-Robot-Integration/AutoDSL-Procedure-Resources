{
  "id": 3829,
  "origin_website": "Cell",
  "title": "Kinematic analysis of sensorimotor behavior during variable ladder rung walking in short-tailed opossums (Monodelphis domestica)",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nConduct behavioral testing\nTiming: 5–10 days per animal\nIn this major step, animals are tested on the ladder rung apparatus. Animals should undergo no more than ten trials per day and should be tested over multiple days to address variability. Animals should be habituated to the ladder apparatus prior to testing variable patterns. For at least the first day, all trials should consist of standard (2 cm) rung spacing (Figure 1[href=https://www.wicell.org#fig1]B). This allows the animal to habituate to the apparatus. It is possible more habituation days are required if the animal does not willingly cross the apparatus on Day 1. You may choose the number of habituation days or use an accuracy criterion score on the 2 cm spacing before beginning testing on variable patterns. Note that the effects of training may alter the effect of studying naturalistic behavior. On variable testing days, use 2–3 trials of standard rung spacing prior to testing variable patterns to re-habituate animals to the task. During test trials, the rungs are spaced at irregular intervals, requiring the animal to make new sensory discriminations to determine the location of future rungs. We suggest using a random pattern generator to determine these patterns. Variable patterns can either be used once, or the same variable pattern be run multiple times to study how animals learn variable patterns. Importantly, you must choose a single study design to use before testing and limit the total number of trials per animal per day to ensure animals are attending to the task and do not get fatigued.",
    "To begin a single test trial or habituation trial, place a clean start cage on top of the upside-down start cage and place the animal’s home cage on top of the upside-down end cage (Figure 1[href=https://www.wicell.org#fig1]A). The placement of the home cage at the end of the ladder apparatus encourages ladder crossing without requiring a food reward.\nBegin recording video for the trial. Make note of the run, test day, and variable or standard pattern.\nVideo should be recorded using a linear wide-field lens. We recommend using the GoPro Hero 6 and above. Video should be recorded at 120 frames per second or above (240 fps recommended). Troubleshooting 1[href=https://www.wicell.org#sec6.1]\nGently remove the animal from their home cage and place the animal in the start (neutral) cage. Troubleshooting 2[href=https://www.wicell.org#sec6.3]\nWe recommend using a transfer cup or box, so that the animal is never directly handled. This reduces stress for the animal, which can impact performance.\nIf the animal is too small to climb out of the cage and onto the ladder apparatus, we recommend placing a plastic block in the start cage that the animal can use as a step. Alternatively, the neutral cage can be placed upside down, and the animal can be set on top of the cage.\nAfter placing the animal in or on the start cage, step away from the apparatus and out of the animal’s field of view. It is key that the animal’s attention remains on crossing the apparatus.\nStop recording after the animal has reached the home cage. Again, a plastic block can be used to assist the animal in stepping off the apparatus.",
    "Videos can be scored manually, or by adapting the provided Jupyter notebooks to count instances where limb trackers broke the ladder threshold. For scoring measures see Metz and Whishaw, 2002[href=https://www.wicell.org#bib4], 2009[href=https://www.wicell.org#bib3].\nCritical: Do not place the animal directly on the ladder apparatus or place a hand near the apparatus to encourage the animal to cross. It is critical for performance measures that the animal enters the apparatus on its own.\nTrack body position using deeplabcut\nTiming: 24 – 48 h (labeling + training)\nIn this major step, the researcher trains DeepLabCut to track the tail, snout, and limbs.\nFollow the protocol for training videos in DeepLabCut (Mathis et al., 2018[href=https://www.wicell.org#bib2]), providing sample videos from multiple trials.\nLabel the tail, snout, and limbs during the labeling step. We recommend labeling ∼200 frames, and training for ∼400,000 iterations. Troubleshooting 3[href=https://www.wicell.org#sec6.5]\nRun the analyze videos function in DeepLabCut for all trials.\nSave DeepLabCut output comma-separated value sheets (csv’s) for all trials. If h5 files are used in lieu of csv’s, you must change the file variable in step 9 to the correct path.\nOptional: You can choose to label and track additional parts of the body as well (such as multiple points along the tail). If so, Jupyter notebooks must be amended to include the additional trackers.\nAnalyze single run data\nTiming: 10 min per trial\nIn this major step, data is processed from raw data output (from DeepLabCut) to kinematic waveforms.\nRun the pre-process code notebook (Data S1[href=https://prod-shared-star-protocols.s3.amazonaws.com/protocols/551-Mmc1.pdf]).\nEnter the name of the DeepLabCut output file in cell #2.\nLooking at the output of cell #2, ensure that the columns of the new data-frame match the original file.\nEnter the name you wish to save the pre-processed file as in cell #3",
    "In cells #4–7, test plots are generated, showing all values (cell #4), only values above your chosen p-cutoff (cell #6), and values below the p-cutoff (#7). This visualization shows the location of low p-cutoff values (and possible bad tracking). Troubleshooting 4[href=https://www.wicell.org#sec6.7]\nOpen Single_Trial_Code_Notebook.ipynb and follow workflow. Troubleshooting 5[href=https://www.wicell.org#sec6.9] During this step you can also refer to the Single Trial Code Notebook PDF (located in GitHub folder).\nIn cell #1, enter the required trial information, scale (x pixels = 1 mm), and read in a single trial pre-processed csv (csv name chosen during step 9). Run cell #1.\nIf you did not place a scale in the video initially, one can be retrieved by measuring the inter-rung distance in the video and comparing this to the real inter-rung distance (1 cm).\nladder_position is equal to the vertical position of the ladder (in pixels) in the analyzed video. If the camera was held constant for each trial, and all videos were cropped similarly, this will be a constant number, else it will vary depending on how videos were cropped.\nheight_of_video is equal to the height of the entire video in pixels.\nRun cell #2. This will plot the waveform of the right forelimb over time (Figure 2[href=https://www.wicell.org#fig2]A).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/551-Fig2.jpg\nFigure 2. Screenshots of output from Analyze Single Run Data (steps 9–21) Single_Trial_Code_Notebook\n(A) Lineplot of the right forelimb Y-component across time. Each waveform represents an individual forelimb ‘strike’ in which the animal lifted its limb from one ladder rung and attempted to place it on another rung.\n(B) Lineplot of peaks chosen for further analysis. Peak detection is decided by user input.\n(C) Lineplot of individual strikes chosen for analysis. Here, the x-axis denotes the actual x-distance traveled.",
    "(D and E) (D) Individual strikes are then aligned by peak and (E) averaged to create a single correct strike waveform for an individual trial.\nThe positions of all other body parts are also recorded during this time. ‘Time’ can be adjusted by the frame rate at which the videos were captured.\nIn cell #3, peak detection is accomplished. Enter the height threshold and inter-peak distance thresholds chosen for your desired analysis (Figure 2[href=https://www.wicell.org#fig2]B).\nOnly peaks that are detected in this step will be used for further analysis.\nRun cell #3.\nObserve the output of cell #3. Adjust peak height/distance and re-run cell #3 if output is not as desired.\nRun cell #4. This will print the location of peaks detected in cell #3.\nIn cell #5, remove waveforms you do not wish to analyze by typing in their peak location (as printed in cell #4).\nRun cell #5 only after you have removed undesirable waveforms.\nThe output of cell #5 is a plot of the waveforms chosen for analysis (Figure 2[href=https://www.wicell.org#fig2]C).\nIn cell #6, choose a p-cutoff value and run.\nThe output of cell #6 is a list of values that fall below the chosen p-cutoff.\nCell #7 runs a 1-dimensional interpolation, removing datapoints below the p-cutoff, and creating a new column ‘RFLy_disp_interp’ which contains interpolated values.\nRun Cells #8 and #9. The output of these cells shows scatterplots of values before (#8) and after (#9) interpolation. Notice that they are the same for the example notebook, as no values fell below the p-cutoff.\nRun cell #10.\nThe output of cell #10 is a line plot of all forelimb waveforms aligned by peak (Figure 2[href=https://www.wicell.org#fig2]D.)\nRun cell #11.\nThe output of cell #11 is an average line plot of all waveforms of the right forelimb y-component (Figure 2[href=https://www.wicell.org#fig2]E).",
    "At this stage, any other body part can be plotted and viewed by changing “y=RFLy_disp” to a different body part.\nIn cell #12, adjust the name of the csv to reflect the current trial and animal number you wish to save this current data as. Run cell #12.\nOptional: This major step can be completed multiple times if desired, saving output csv’s of correct placements or misses, or for data centered around a body part other than the forelimb.\nNote: The data for all body parts is now centered on the movement of the right forelimb. If the user desires other centering, they must change RFLy_disp to another body part.\nAverage data and perform clustering\nTiming: 2 min per trial\nIn this major step, data across trials is aggregated into a single data-frame by loading csv files of all trials. Cross-group comparisons and clustering are also accomplished in this step.\nOpen and run the ‘Combine_Files.ipynb’ or the ‘Combine_Files_Your_Data.ipynb’ file. During this step you can also refer to the Combine Files PDF code notebook (Data S3[href=https://prod-shared-star-protocols.s3.amazonaws.com/protocols/551-Mmc3.pdf]).\nEnter the name of your csv files in cell #1 with respect to subject. Run cell #1, importing packages and loading csv files.\nIn cell #2, enter a chosen scale value such as shoulder height (or body weight) to normalize your dataset for animals of different sizes.\nIt is preferable to choose a scale related to kinematics such as arm length or shoulder height.\nIf you chose to use interpolation, change ‘RFLy_disp’ to ‘RFLy_disp_interp’ or add a separate column for ‘RFLy_disp_scale_interp’ (or any other interpolation you accomplished in the previous major steps). It is important for concatenation that the column names match across all animals/trials. Thus, if interpolation is used, it must be used similarly across animals/trials.\nRun cell #2.",
    "Concatenate data-fames by inputting imported data-frame names by category/condition in cell #3.\nThis step determines what data you will aggregate. Examples are biological sex, correct placements, incorrect placements, etc.\nRun cell #3.\nThe output of cell #3 is the number of strikes by condition multiplied by the number of frames per strike.\nIn cell #4, an aggregated output plot is generated using Seaborn (Figure 3[href=https://www.wicell.org#fig3]A). Select which factors and from what dataset to compare in this visualization.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/551-Fig3.jpg\nFigure 3. Screenshots of output from Average Data and Perform Clustering (steps 22–32) Combine_Files Jupyter Notebook\n(A) Average lineplots of forelimb displacement across experimental condition; eb: early blind, ebwt: early blind whisker-trim, sc: sighted control, scwt: sighted control whisker-trim.\n(B) Average lineplots of miss trajectories for early blind (blue) and sighted (red) opossums.\n(C) Violin plots of average snout displacement during forelimb motions.\n(D) Lineplot showing the level of distortion associated with each cluster number.\n(E) Automatically clustered waveforms of forelimb displacement showing two stereotypical correct strikes, and two stereotypical misses.\nNote that the example notebook chooses to plot the average early blind (eb) and sighted (sc) forelimb trajectory Y-component before and after whisker trimming (ebwt, scwt).\nRun cell #4.\nThe next five cells give examples of other body parts or aspects of the collected data that can be analyzed (e.g., X-component trajectories, Hindlimb Trajectory, Snout Trajectory).\nExplore your data by running cells #5 – #9 (Figures 3[href=https://www.wicell.org#fig3]B and 3C).\nBegin clustering.\nIn cell #10, input the name of the data-frames you would like to concatenate for clustering or use a data-frame you aggregated previously in this notebook.",
    "Note that we are re-indexing our data. Since each forelimb strike is 100 frames, we are indexing by 100 to re-number the strikes. If you adjusted this number in the previous notebook, it must also be adjusted here.\nRun cell #10.\nCell #11 runs a basic principal component analysis with K-Means clustering for cluster visualization purposes. Run cell #11 and observe the distribution of your data.\nCell #12 uses the elbow point method to visualize the distortion level of different numbers of clusters. Input the number of desired clusters to test as x in: K = range(1, X).\nRun cell #12.\nObserve both the printed distortion values and line plot (Figure 3[href=https://www.wicell.org#fig3]D). For your analysis, choose the cluster that follows the end of exponential decay.\nCell #13 calculates the silhouette coefficient for different cluster numbers (Zhou and Gao, 2014[href=https://www.wicell.org#bib6]).\nRun cell #13.\nChoose the cluster number with the highest silhouette coefficient.\nIf there is a mismatch between the elbow point and silhouette coefficient, incorporate both cluster numbers in your analysis or choose one based on a tertiary measure.\nCell #14 clusters all waveforms into the chosen number of clusters.\nEnter the number of clusters you would like and run cell #14 (Figure 3[href=https://www.wicell.org#fig3]E).\nSave datasets as csv files by entering the name of the chosen dataset and save file name (Cell #15)."
  ],
  "subjectAreas": [
    "Bioinformatics",
    "Neuroscience",
    "Model Organisms",
    "Behavior"
  ],
  "bigAreas": [
    "Biomedical & Clinical Research",
    "Molecular Biology & Genetics",
    "Ecology & Environmental Biology",
    "Bioinformatics & Computational Biology"
  ]
}