{
  "id": 4183,
  "origin_website": "Cell",
  "title": "A modified CUT and RUN protocol and analysis pipeline to identify transcription factor binding sites in human cell lines",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nStep 1: Cell nuclei purification\nTiming: 1.5 h\nThis step allows for maximized binding of antibodies to nuclear factors and will result in cleaner CUT&RUN signal compared to protocol using whole cells\nCell collection and swelling\nCollect 2∗106–2∗107 cells of interest by either scraping or centrifugation. We successfully used this protocol on SNU398, K562, and NB4 cell lines.\nResuspend in 5 mL of cold PBS and spin at 2,500 rpm at 4°C for 15 min\nMeasure the packed cell volume (PCV) of the cell pellet and add 5× PCV of 1× Buffer A (10× Buffer A contains 100 mM HEPES, 15 mM MgCl2, 100 mM KCl, adjust pH to 7.9 with 10M KOH)\nVortex on high for 2s\nIncubate on ice for 20 min to swell the cells\nNuclei collection\nSpin cell pellet at 2,500 rpm for 10 min\nMeasure PCV again (should be slightly larger), add 2× PCV (original) of 1× Buffer A containing fresh protease inhibitor (Sigma complete protease inhibitor cocktail, 11697498001), 1 mM PMSF, 1 mM benzamidine, and 1 mM DTT; keep on ice\nDounce with a 1 mL, prechilled glass douncer to break up the cell pellet, 7 strokes; alternatively, pass the cell lysate through a 25G needle 10×\nIncubate on ice for 10 min, transfer to 1.5 mL tube\nSpin down at 6,000 rpm at 4°C for 20 min\nTake out supernatant (cytoplasmic portion) for testing if needed; keep the pellet containing the nuclei\nEither flash freeze in liquid N2 or move directly to the CUT&RUN experiments\nNote: Each CUT&RUN reaction requires 2∗106 equivalent of cell nuclei.\nStep 2: Antibody binding\nTiming: 1.5 h to Overnight (16–18 h)",
    "Resuspend nuclei in 1 mL room temperature (20°C–25°C) Wash Buffer (20 mM HEPES pH7.5, 150 mM NaCl, 0.5 mM Spermidine) supplemented with fresh protease inhibitor\nPrepare Concanavalin A beads (Bangs Laboratories BP531)\nTake out enough beads for 10 μL/condition, can process together in one 1.5 mL low-binding microcentrifuge tube until protocol step 2.4.g\nAdd 1.5 mL Binding Buffer (20 mM HEPES pH7.9, 10 mM KCl, 1 mM CaCl2, 1 mM MnCl2)\nPlace in a magnetic stand to clear for between 30 s to 2 min\nRemove from the stand and add 1.5 mL Binding Buffer, mix by inversion\n5s spin at 500 rpm\nPut the tube back to the stand to clear\nRe-suspend with 1:1 volume of Binding Buffer (i.e., 10 μL for 10 μL of beads) and aliquot into corresponding CUT&RUN low-binding tubes\nWhile gently vortexing prepared Concanavalin A beads, add the nuclei in wash buffer from protocol step 2.3\nRotate at room temperature (20°C–25°C) for 10 min\nPlace on magnetic stand to clear (may take up to 1 min)\nTake tubes off of the stand, add 50 μL of Antibody Buffer (Wash Buffer supplemented with fresh protease inhibitors, 2 mM EDTA, and 0.02%–0.1% Digitonin, exact concentration as determined in Preparation Two)\nTo each condition, add the appropriate amount of antibody or corresponding normal isotype IgG control (typically 2.5 μg of each, but exact concentration should be determined experimentally)\nIncubate 1 h to overnight (16–18 h) with rocking at 4°C\nCritical: If you are running CUT&RUN for the first time, include a histone mark antibody for the quality control step.\nStep 3: ProteinA-Mnase binding and Mnase digestion\nTiming: 2 h\nQuick spin the tubes at 500rom and place on magnetic stand to clear\nAdd 1 mL of Dig-Wash buffer (Wash Buffer with Digitonin, important: NO EDTA)",
    "Mix by inversion, place on magnetic stand to clear\nTo each tube, add 50 μL of Dig-Wash containing 700 ng/mL of proteinA-MNase (concentration as determined in Preparation One, step 4)\nRotate for 1 h at 4°C\nQuick spin the tubes at 500 rpm and place on magnetic stand to clear\nAdd 1 mL of Dig-Wash buffer\nRepeat protocol steps 1, 3.16, and 3.17 for a total of 2 washes\nAdd 100 μL of Dig-Wash buffer along the sides to dislodge the beads\nPlace tubes in heat block sitting on wet ice (should be around 0°C)\nWhile gently shaking each tube, add 2 μL of 100 mM CaCl2\nIncubate for 10–30 min (start with 30 min, if too long, then decrease the incubation, see Quality Control in step 5.47)\nAdd 100 μL of 2× Stop Buffer (0.34M NaCl, 20 mM EDTA, 4 mM EGTA, 0.02% Digitonin, 50 μg/mL RnaseA, 50 μg/mL glycogen, and 20 pg/mL heterologous spike-in purified DNA from yeast or bacteria)\nGently vortex\nIncubate at 37°C for 10 min to release fragmented DNA\nCentrifuge at 16,000 g for 5 min at 4°C\nPlace on magnetic stand to clear\nSave clear supernatant containing DNA to a new tube\nStep 4: DNA purification\nTiming: 2.5 h to Overnight (16–18 h)\nTo each tube (∼200 μL total), add 2 μL of 10% SDS (final concentration 0.1%), 2.5 μL of proteinase K (20 mg/mL)\nMix by inverting and incubate for 10 min at 70°C\nAdd 300 μL of phenol:chloroform:isopropanol (25:24:1) to each tube\nVortex for 2s\nTransfer mixture to a phase-lock tube (Qiagen MaXtract, prepared by pre-spinning at 13,000 rpm for 30 s to settle the resin)\nCentrifuge at 16,000 g for 5 min at room temperature (20°C–25°C)\nTake out the top aqueous layer and transfer to a tube",
    "Add 2 μL of glycogen (2 mg/mL, Thermo catalog number R0561)\nAdd 750 μL of cold 100% ethanol\nMix by inversion, incubate for at least an hour (up to overnight (16–18 h) at −20°C\nCentrifuge at 16,000 g for 10 min at 4°C\nPour off liquid and dry on a piece of tissue\nRinse the pellet once with 950 μL of 100% ethanol\nCentrifuge at 16,000 g for 1 min at 4°C\nPour off the liquid and drain on tissue\nAir dry for 3 min\nDissolve the pellet in 25 μL of 1 mM Tris-HCl (pH8) and 0.1 mM EDTA (i.e., 0.1× TE)\nStep 5: Quality control\nTiming: 1 h\nQuantify 1 μL of purified DNA by Qubit HS DNA kit (ThermoFisher Q32851) following manufacturer’s instructions\nExample amounts of DNA recovered\nHistone mark: 15–20 ng/μL\nTF: 10–15 ng/μL\nIgG isotype control: <10 ng/μL\nRun control histone mark CUT&RUN DNA on the 2100 Bioanalyzer system (Agilent)\nTranscription factor CUT&RUN DNA are typically around 50–150 bp and may not show up on bioanalyzer, proceed to library amplification and size-selection\nNote: Transcription factor CUT&RUN DNA may not show up on the bioanalyzer electropherogram if run prior to amplification. This is due to the low concentration of DNA present. To asses protocol efficacy, it is recommended to run, in parallel, a control CUT&RUN with an antibody against a histone mark.\nCritical: If running a control histone mark CUT&RUN, should see mono-, di-, and tri-nucleosomes in the Bioanalyzer traces (Figure 1[href=https://www.wicell.org#fig1]).\nTroubleshooting 2[href=https://www.wicell.org#sec5.3]\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/944-Fig1.jpg\nFigure 1. Expected Bioanalyzer electropherogram for CUT&RUN with an antibody against an histone mark\nWhen running a histone mark CUT&RUN in parallel to your transcription factor of interest as quality control, one should expect to see small peaks representing mono-, di-, and tri-nucleosomes, which indicate successful proteinA-Mnase digestion.\nTroubleshooting 3[href=https://www.wicell.org#sec5.5]",
    "Step 6: Library construction (with NEBNext ultra II DNA library Prep, NEB 7103, for transcription factor CUT&RUN DNA\nTiming: 3 h\nNote: For histone mark CUT&RUN library preparation, see Skene et al., 2018[href=https://www.wicell.org#bib20].\nNote: This step is based on the protocol (https://dx.doi.org/10.17504/protocols.io.bagaibse[href=https://dx.doi.org/10.17504/protocols.io.bagaibse]) and publication (Liu et al., 2018[href=https://www.wicell.org#bib11])\nDilute CUT&RUN DNA (6 ng) into 25 μL with water, add 1.5 μL NEBNext Ultra II End Prep enzyme mix and 3.5 μL of NEBNext Ultra II End Prep reaction buffer (30 μL total)\nMix well and place in thermocycler, with heated lid set to >60°C: 30 min at 20°C, 60 min at 50°C, hold at 4°C\nDilute the adapters supplied by the NEBNext kit from the original 15 uM to 3 uM\nCombine End repair mix from protocol step 6.50 with 15 μL of Ligation mater mix, 0.5 μL enhancer, 1.25 μL diluted adapter (∼47 μL total)\nIncubate for 15 min at 20°C in a thermocycler with no heated lid\nAdd 1.5 μL of USER enzyme to the mix\nMix well and incubate for 15 min at 37°C with heated lid set to >47°C\nVortex Ampure beads (Beckman A63880) and bring up to room temperature (20°C–25°C) for at least 30 min\nAdd 80 μL of beads (∼1.75× volume) to the DNA mix from protocol step 6.55\nPipette 10 times to mix, incubate for 5 min at room temperature (20°C–25°C)\nPlace on magnetic stand for less than 5 min or until clear\nRemove and discard the supernatant while the tube in the on the stand, leave the beads\nWhile on the stand, wash twice with 200 μL of freshly made 80% ethanol, each time with incubation for 30 s at room temperature (20°C–25°C)\nRemove all trance of ethanol with a p10 pipette tip",
    "Air-dry the beads up to 5 min (don’t over dry)\nRemove the tubes from the stand and add 14 μL of 0.1× TE (same as protocol step 6.45)\nMix well or gently vortex\nIncubate for 2 min at room temperature (20°C–25°C)\nPlace on the magnetic stand for 5 min\nRemove and save 13 μL of supernatant containing DNA\nPause point: Can store at −20°C before PCR amplification\nSet up PCR by combining 13 μL of DNA from protocol step 6.68, 15 μL NEBNext Ultra II Q5 Master Mix, 1 μL Index primer, and 1 μL Universal PCR primer (30 μL total)\nRun PCR:\nCycle 1: 98°C for 30 s\nCycle 2: 57°C for 10 s, repeat 12 times total (Low Tm for transcription factor libraries)\nCycle 3: 65°C for 5 min\nHold at 4°C\nVortex Ampure beads and bring up to room temperature (20°C–25°C) for at least 30 min\nRemoving DNA products of >350 bp: add 24 μL (0.8×) Ampure beads to the PCR reaction and mix well, incubate for 5 min at room temperature (20°C–25°C), place the tubes on the magnetic stand for 5 min or until clear, carefully transfer the supernatant containing small DNA into a new tub3e\nKeep DNA products of <150 bp: add 12 μL (1.2×) of re-suspended Ampure beads to the supernatant (so the effective bead to DNA ratio is 2×) from protocol step 6.72, mix 12 times, incubate for 5 min at room temperature (20°C–25°C), place the tubes on the magnetic stand for 5 min or until clear, remove and discard the supernatant\nWash twice with 200 μL of freshly made 80% ethanol, incubate for 30 s each time at room temperature (20°C–25°C)\nAir-dry the beads for up to 5 min, do not over dry",
    "Remove the beads from the magnetic stand and elute the DNA from the beads by adding 15 μL of 0.1× TE\nMix well and incubate for 2 min at room temperature (20°C–25°C)\nPlace the tubes back on the magnetic stand for 5 min or until clear\nTransfer 13 μL of supernatant containing the library into a new PCR tube\nCheck size distribution on the 2100 Bioanalyzer system (Figure 2[href=https://www.wicell.org#fig2])\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/944-Fig2.jpg\nFigure 2. Expected Bioanalyzer electropherograms following library construction for nuclear DNA\nFollowing library amplification, the bioanalyzer electropherograms should show sharp peaks at the size of the fragmented DNA with adapters as shown. Transcription factor CUT&RUN samples tend to show a smaller peak if following the described protocol\nPause point: Store the libraries at −20°C until sequencing\nCritical: Do not discard supernatant from protocol step 6.72 which contain the desired DNA library, discard the Ampure beads from this step which contain larger DNA fragments.\nStep 7: Sequencing with MiniSeq (illumina): 4 h\nUp to 24 barcoded quantified libraries can be mixed at equal molar ratio\n(Optional) Remove PCR dimers with Pippin prep size selection according to the manufacturer’s instructions\nPerform paired-end sequencing (2 × 42 bp) on MiniSeq (Illumina) 5 million reads per library are sufficient\nStep 8: Data analysis with CnRAP – time – hours to a couple of days depending on computer hardware, sequencing depth, and the number of samples to be processed\nThe bioinformatics pipeline written for this analysis consists of three essential scripts and three optional scripts. Each of the essential scripts performs a required function in processing the sequencing files in order to call the Cut&Run peaks while the optional scripts perform the peak annotation and motif enrichment analysis once the peaks are called. Briefly, the scripts perform the following functions:",
    "Script 01 – Read quality trimming and alignment to reference genomes\nScript 02 – Generation of bedgraph files and normalization\nScript 03 – Peak calling using SEACR\nScript 04 – (Optional) Annotate called peaks using ChIPSeeker\nScript 05 – (Optional) File preparation for HOMER motif enrichment analysis\nScript 06 – (Optional) File preparation for MEME motif enrichment analysis.\nIn this section, we will outline the function and purpose of each script, as well as outline how to call and use said script. Additional details can also be found on the GitHub page.\nFor those wishing to follow this analysis, the dataset analyzed in our original publication (Kong et al., 2021[href=https://www.wicell.org#bib8]) is referenced in the Data Availability section. Users can download the raw and processed data from GEO and compare their results with the published findings.\nNote: Before beginning, it is important to note that for each sample sequenced, there should exist a pair of de-multiplexed fastq files corresponding to both read directions. These typically contain R1/R2 in the filename to denote read direction. Both files are needed per sample.\nNote: Ensure that you have followed preparation 3 in the “Before You Begin” section before proceeding. Next, the configured conda environment must be activated prior to attempting to run any of the following commands. See the GitHub repository for additional details.",
    "The first step in running the analysis pipeline is to run CnRAP script 01 on each sample separately. Note, each sample will consist of 2 read files, R1 and R2, corresponding to the reads in both directions. This script takes care of performing all the necessary quality trimming steps required on the sequenced reads and alignment to the reference genomes. Firstly, trimmomatic is run to remove poor quality bases from both the start and the end of the reads while also removing any potential adapter sequences that might be found. Following this, the kseq_trimming tool is run to remove any additional barcode sequences. Once the reads are cleaned up, alignment to the reference genomes is performed using BWA followed by Stampy. In this protocol, reads are aligned to both the human (hg) and saccharomyces cerevisiae (sacCer) genomes. Alignment to hg is because the cell line used (SNU-398) is a human cell line, while alignment to the sacCer genome enables utilizing the spike-in DNA for normalizing. BWA and Stamy were chosen for alignment as they were found to result in improved alignment performance when benchmarked (Thankaswamy-Kosalai et al., 2017[href=https://www.wicell.org#bib21]). Following alignment, unmapped reads are removed; bam files are sorted, indexed and alignment statistics are calculated.\nTo run script 01, use the following command.\n> python3 01_cut_n_run_pairedReads_filter_align.py <sample_name> <read1_fq_gz> <read2_fq_gz> <num_cores> <aligned_folder>\nWherein:\n> <sample_name> defines the prefix corresponding this sample;\n> <read1_fq_gz> is the full path location of the read1 fastq file;\n> <read2_fq_gz> is the full path location of the read2 fastq file;\n> <num_cores> defines the number of processor cores to use for processing;\n> <aligned_folder> is the folder where all output will be saved.",
    "Following the above python3 call, a bash script will be generated 01_cut_n_run_pairedReads_filter_align.sh which can simply be run in the terminal to perform the required steps for this stage of analysis.\nOptional: Following genome alignment, some users may wish to assess the degree of PCR duplication present in their data. Marking and removal of PCR duplicates can be performed by Picard tools as well. Such an analysis can be performed using the following code. For additional information on interpreting the output of Picard, refer to the official documentation on the Broad website.\nOptional: Following the generation of the aligned bam files, users can optionally run the tool “plotFingerprint” on the sample and IgG control bam files to check whether they see greater enrichment as expected in their sample. An example of such a figure can be found in Figure 3[href=https://www.wicell.org#fig3], wherein users can see a separation between the IgG and sample curves.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/944-Fig3.jpg\nFigure 3. Example Enrichment fingerPrint plot following genome alignment\nFollowing alignment to the human genome, users can optionally generate a global enrichment fingerPrint plot to assess the extent of enrichment observed in their sample over control. The sample curve (blue) should be closer to the bottom right corner than the control IgG curve (orange). The greater the separation between the curves the greater enrichment observed, which will likely result in more peaks being called at the peak calling step.\nOptional: Following genome alignment, some users may wish to assess library complexity before proceeding. For this, Picard tools is an ideal and commonly accepted toolkit to do so. Such an analysis can be performed using the following code. For additional information on interpreting the output of Picard, refer to the official documentation on the Broad website.\n> java -jar picard.jar EstimateLibraryComplexity I=input.bam O=estimated_library_complexity_metrics.txt",
    "> java -jar picard.jar MarkDuplicates I=input.bam O=marked_duplicates.bam M=marked_duplicates_metrics.txt\nThis command will simply mark the duplicate reads and not remove them. If you wish to remove duplicate reads, the MarkDuplicates command has two flags that can use utilized REMOVE_DUPLICATES and REMOVE_SEQUENCING_DUPLICATES. For full details on how to incorporate these flags into the afore mentioned command, refer to the official documentation on the Broad website.\nNote: Be sure to set the same output <aligned_folder> for all samples as subsequent scripts will process all samples contained in given folders. Only script 01 is to be run separately per sample.\nTroubleshooting 4[href=https://www.wicell.org#sec5.7]\nTroubleshooting 5[href=https://www.wicell.org#sec5.9]\nNext, CnRAP script 02 needs to be run on the output folder of script 01 which is supposed to contain the aligned bam files of all samples processed with script 01. Script 02 first takes the aligned bam files for each sample and converts them to bedgraph files. Next, the hg bedgraph files are normlized to the sacCer spike-in controls. For this, a normalization factor is calculated for each hg-sacCer file pair which is calculated as follows\n  n o r m a l i z a t i o n _ f a c t o r =    10,000,000     m a p p e d _ r e a d s _ p e r _ s a c C e r _ g e n o m e   2    \nThis normalization ensures that peak heights are adjusted correctly prior to peak calling in the next step.\nTo run script 02, use the following command.\n> python3 02_cut_n_run_bamToBed_normalize_SEACRPrepv1.py <aligned_bams_folder> <normalized_beds_folder> <chrom_sizes_txt>\nWherein:\n> <aligned_bams_folder> defines where the aligned bams, the output of script 01, are saved;\n> <normalized_beds_folder> is the folder where the normalized bed files will be saved in preparation for running SEACR, the peak calling algorithm for Cut&Run;",
    "> <chrom_sizes_txt> is a text file defining the base-pair size of each chromosome. This is required when converting the aligned bam files to bedGraph files. This file can be downloaded from UCSC directly.\nFollowing the above python3 call, a bash script will be generated 02_cut_n_run_bamToBed_normalize_SEACRPrepv1.sh which can simply be run in the terminal to perform the required steps for this stage of analysis.\nNext, run CnRAP script 03 is required to be run over the normalized bedgraph files. This script proceeds to first make bigWig coverage files for all normalized bedgraph files (for viewing in IGV or on UCSC) and then calls peaks using SEACR in both “stringent” and “relaxed” modes.\nTo run script 03, use the following command\n> python3 03_cut_n_run_SEACR_peakProcess_v1beds.py <seacr_location> <normalized_beds_folder> <output_folder> <chrom_sizes_txt>\nWherein:\n> <seacr_location> defines where the Cut&Run peak caller SEACR is saved;\n> <normalized_beds_folder> is the folder where the normalized bed files have been saved;\n> <output_folder>is the folder where the called peak files will be saved;\n> <chrom_sizes_txt> is a text file defining the base-pair size of each chromosome. This is required for bedGraph file manipulation.\nFollowing the above python3 call, a bash script will be generated 03_cut_n_run_SEACR_peakProcess_v1beds.sh which can simply be run in the terminal to perform the required steps for this stage of analysis.",
    "Once peaks are called, users will likely want to annotate them although this is not essential. As such, script 04, is considered as an optional script to be run. If users wish to annotate their called peaks, script 04 can be utilized which will annotate called peaks using the R package, ChIPSeeker. In addition to annotating the called peaks, ChIPSeeker will also generate summary plots which may be of relevance to users. Script 04 will only annotate using ChIPSeeker. Alternatively, users may wish to annotate their called peaks using the HOMER annotatePeaks function. No script is provided as part of CnRAP to use HOMER though. For details on how to annotate your peaks using HOMER, refer to the official documentation.\nOptional: Once peaks are called, users may wish to perform motif enrichment analysis to investigate the presence of characteristic motifs. For this, users can use script 5 and/or script 6. Script 05 script, processes the called peaks and generates the required script to run motif enrichment analysis using the HOMER toolkit. Once generated, the corresponding bash script can be run in the terminal to perform said analysis. This script is optional as, depending on the experimental design, motif enrichment analysis may not be required. It is evident from user forums however that some users prefer to use the MEME-Suite of tools in preference to HOMER for motif discovery. As such, we have also provided script 06 which will prepare the required files for performing motif enrichment analysis using the MEME-Suite. The choice for which toolkit to use will be up to the users and their experiment. For the results generated using this protocol, both HOMER and MEME results were compared to ensure reproducibility in the called motif."
  ],
  "subjectAreas": [
    "Genomics",
    "Sequence Analysis",
    "Cell Separation/Fractionation",
    "Bioinformatics",
    "Antibody",
    "Cell Biology",
    "In Situ Hybridization",
    "Molecular Biology",
    "Sequencing"
  ],
  "bigAreas": [
    "Biomedical & Clinical Research",
    "Molecular Biology & Genetics",
    "Bioinformatics & Computational Biology",
    "Bioengineering & Technology"
  ]
}