{
  "id": 9974,
  "origin_website": "Jove",
  "title": "A Computational Modeling Approach to Investigate the Influence of Hyperthermia on the Tumor Microenvironment",
  "procedures": [
    "1. Build the model of a bipolar radiofrequency system\nPreliminary steps to set the interface\n\t\nLaunch COMSOL Multiphysics and click on Model Wizard.\nSelect 3D as Space Dimension.\nSelect AC/DC Physics module | Electric Fields and Currents | Electric Currents.\nSelect Heat Transfer module | Heat Transfer in Solids.\nSelect Mathematics module | PDE interfaces | Coefficient Form PDE.\nSelect Study | Time-dependent. Click on Done.\nOnce the Comsol working space appears:\n\t\t\nSelect Multiphysics | Electromagnetic Heating. With this step, the electromagnetic power loss density is automatically coupled as the heat source for the bioheat transfer equation.\n\t\t\tNOTE: If Multiphysics does not appear automatically, manually specify the electromagnetic heat source (shown in COMSOL as Volumetric loss density). For more details on how to add the heat source, see 'Physics' section, step 2 'Setup for the thermal problem'.\nSelect Study from the top ribbon | Study Steps | Frequency Transient.\nDefine the geometries. From the top ribbon, select Geometry, then:\n\t\nDefine two cones with the dimensions listed in Table 2.\nPosition the cones at the distance indicated in Table 2 (spaced dinter-el apart). These two cones will model the two hypodermic needles used for building the bipolar RF system.\nDuplicate the two previous cones to model the insulation of the needles; modify the size of the cone according to the dimensions reported in Table 2.\nSelect a cylinder (height, hm, and diameter dm) to model the bulk of muscle placed at z = - 9 mm (x = 0, y = 0). The values of each dimension are listed in Table 2.\nSelect a cylinder (height, hs, and diameter ds) to model the thin layer of skin placed at z = 4 mm (x = 0, y = 0). The values of each dimension are listed in Table 2.",
    "Select a sphere (diameter, dt) to model the subcutaneous tumor placed at z = -0.5 mm (x = 0, y = 0). The size of the tumor is listed in Table 2.\nTo facilitate the selection of the geometries in the following steps of the protocol, we recommend the following:\n\t\t\nFrom the Geometry ribbon, select Virtual operations | Form Composite Domains.\nSelect all domains related to the electrically conductive part of the needles to create a composite geometry.\nRepeat the same procedure to create composite domains for the needle insulation geometries.\nDefine the properties of the biological tissue models.\n\tNOTE: The following steps describe the procedure to implement the mathematical expressions described by Equations (2)-(7).\n\t\nFrom Component node, right-click to select Definitions.\nUnder Functions, select Analytic.\n\t\t\nSpecify the name of the Function (e.g., k_muscle or sigma_muscle) and type the mathematical expression consistent with Eq. 2).\nSpecify temperature (T) as argument.\nSpecify the Units of the function: S/m in the case of electrical conductivity.\nRepeat the previous steps from 1 to 3 to implement Eq. 3, modifying the unit accordingly (i.e., W/(m·K) for thermal conductivity).\nSpecify the unit for the argument: K (kelvin) for the temperature. In Plot Parameters, specify the range of values of the function argument (i.e., temperature). To follow this protocol, use a range of 33-100 °C (306.15-373.15 K).\nRepeat the previous steps from 1 to 5 to add the temperature-dependent functions of electrical (Eq. 2) and thermal conductivities (Eq. 3) for each tissue model (i.e., muscle, skin, and tumor) using the nominal values listed in​ Table 1 (normal tissue refers to both muscle and skin).\nUnder Functions, select Piecewise to implement Equations (4)-(7):\n\t\t\nSpecify the name of the function.\nSpecify temperature (T) as the argument of the function.",
    "Type the mathematical expression for each temperature interval consistent with Equations (4)-(7).\nRepeat the previous steps from 1 to 3 to add the temperature-dependent functions of blood perfusion and vascular pressure for each tissue model using the nominal values listed in Table 1 (normal tissue refers to both muscle and skin).\nAssign material properties to the geometry components.\n\t\nFrom the component node, select Materials.\nSelect blank materials to include normal tissue, tumor tissue, blood, PTFE, and stainless steel.\nEnable manual selection and select the geometric entity corresponding to the specified material.\n\t\t\nNormal tissue is associated with geometries modeling muscle and skin.\nTumor and blood tissues are associated with the tumor geometry.\nPTFE material is associated with the geometries modeling the needle insulator.\nStainless steel material is associated with the cone geometries modeling the ground and the active needles.\nFor the temperature-dependent electrical and thermal conductivities23, type the chosen name of the function and the related argument (i.e., T) that appears in the Definitions node.\nFor the material properties not depending on temperature, refer to the baseline values27 listed in Table 1.\n\t\tNOTE: We rely on the poroelastic theory to calculate the pressure16,17,26. The following steps show how the properties of a porous material can be assigned to a specific domain.\nFrom Materials, select More Materials | Porous Material.\nRight-click on Porous Material to select Fluid and Solid components. Select Fluid node and under Fluid properties, select Blood (defined in the previous steps). Select Solid node and under Solid properties, select Tumor (defined in the previous steps). In the Solid node, specify the volume fraction defined as θS (Table 1).\nEnable manual selection and select the geometric entity corresponding to the specified material. To follow this protocol, assume that only the tumor region is a poroelastic domain.\nMeshing",
    "Under Mesh node, select Size and select a predefined Finer mesh.\nAdd Free Tetrahedral feature under Mesh node. This step allows for a refined mesh in the critical areas.\n\t\tNOTE: For this model, we identified the edges of the tumor and the distal end of the hypodermic needle models as critical areas.\nSelect the geometries of interest and customize the maximum (0.25 mm) and minimum element size in a way that the smallest component (e.g., the tip of the needle) is discretized by at least four meshing elements (complete mesh consists of 1,487,828 elements).\n2. Physics\nSetup for the electrical problem\n\tNOTE: The following steps provide information on how to set the parameters to calculate the electric field distribution (Figure 2, block 1) that will provide the radiofrequency heat source (Q).\n\t\nRight-click on the Electric Currents node.\nFor the electrical boundary conditions shown in Figure 3A, select Terminal and Ground as boundaries.\n\t\t\nFor Terminal, manually select the proximal end (on the top) of one of the two needles. The identified needle will provide the input power.\nUnder Terminal, select Power and specify the value according to the desired energy protocol. To follow this protocol, select 0.5 W for mild hyperthermia based on preliminary ex vivo experiments20.\nSelect Ground and manually select the proximal surface of the second needle. This needle will act as a return electrode for the returning path of the electrical current.\nApply electrical insulation to the remaining external surface of the model.\nSetup for the thermal problem\n\tNOTE: The following steps show how to include the temperature-dependent blood perfusion functions (Equations 4 and 5) in the bioheat transfer equation to model the heat sink caused by the blood flow.\n\t\nSelect Heat Transfer in Solids node and specify 33 °C as the initial value of the temperature.",
    "To model the heat-sink effect due to the blood flow, right-click on Heat Transfer in Solids, add the Heat source domain, and select the geometry where the heat sink effect should be considered (i.e., tumor and normal tissue). Select General Source | User defined where the expression for the heat sink can be typed.\nFor the thermal boundary conditions shown in Figure 3B, right-click on Heat Transfer, add Heat Flux as a boundary condition, and specify the external surfaces to which the heat flux is applied. Select Convective heat flux as the flux type. For the heat transfer coefficient, use h = 15 W/(m2 ·K) to model the mechanism of natural heat exchange between the skin and the air28. Specify the external temperature. Use T = 20 °C to model the ambient temperature in the laboratory environment.\nSetup for the fluid-dynamics problem\n\tNOTE: The following steps describe how to implement the conservation of mass equation illustrated in Figure 2 (Block 3) and how it can be linked to the variation of the temperature.\n\t\nSelect Coefficient Form PDE node and specify Pressure as the dependent variable. At this stage, the unit Pascal (Pa) is automatically assigned.\n\t\tNOTE: Once the simulation is computed, the results can be displayed and/or exported using the unit of choice. We present the results using mmHg unit for consistency with the literature (see the representative results section).\nSpecify Fluid conductance unit 1/s as source term quantity.\nDefine the name to identify the variable (Pi, interstitial fluid pressure in this study).\nRight-click on Coefficient Form PDE node and select the Coefficient Form domain. Specify the geometrical entity to which the equation refers (tumor). Repeat the same steps and select the remaining tissue (normal tissue) to which a different PDE will be applied.",
    "For the tumor model, specify the following coefficients and terms to obtain the conservation of mass equation (Figure 2 block 3): diffusion coefficient Ki of the tumor (Table 1); damping coefficient imgsrc://cloudfront.jove.com/files/ftp_upload/65870/65870eq11.jpg ); source term imgsrc://cloudfront.jove.com/files/ftp_upload/65870/65870eq12.jpg . For the tumor model, neglect the contribution of the lymphatic system. Set all other coefficients equal to zero.\nFor the normal tissue model, specify the following coefficients and terms to obtain the conservation of mass equation (Figure 2 block 3): diffusion coefficient Ki of the normal tissue (Table 1); damping coefficient imgsrc://cloudfront.jove.com/files/ftp_upload/65870/65870eq13.jpg ; source term imgsrc://cloudfront.jove.com/files/ftp_upload/65870/65870eq14.jpg . To consider normal tissue as a normal functioning tissue, consider the contribution of the lymphatic system. Set all other coefficients equal to zero.\nTo create the link with the electromagnetic-thermal simulation, express the vascular pressure Pv as a function of the temperature (by means of the blood perfusion variable, see Equations 6 and 7).\nRight-click on Coefficient Form PDE and select Initial Values. Select the geometrical domain (tumor) and repeat the same step for the normal tissue model (normal tissue). Specify Pi0 for tumor and normal tissue according to the values listed in Table 1.\nFor the boundary conditions related to the fluid-dynamic study, shown in Figure 3C, right-click on Coefficient Form PDE and select Dirichlet Boundary conditions. Select the external surface of the normal tissue domain and assign the Pi0 value corresponding to the normal tissue (Table 1).\n3. Run the simulations and display the results\nNOTE: As a final step before computing, specify the time (simulating the duration of the procedure) and the operating frequency:\nSelect Frequency-Transient from the Study node.\n\t\nSpecify the time unit (s).\nFrom Output Times, select range (on the right side) and specify 0 s as start, 5 s as step, and 900 s as stop.",
    "Set the Frequency as 500e3 Hz.\nSelect Compute to run the simulations.\nFor the visualization of the results, select Datasets under node Results.\n\t\nRight-click to select a cut plane to define the plane to use to visualize 2D distributions (e.g., zx-plane at y = 0).\nRight-click to select a cut point in the 3D volume to display the variation of a parameter across time.\nFrom Results on the top ribbon,\n\t\nSelect 2D plot group to visualize the two-dimensional distribution of a variable (e.g., temperature) on one of the planes identified in the steps above.\nSelect 1D plot group to visualize 1D results (e.g., pressure across the time) at the point or multiple points identified in the steps above.\n\t\tNOTE: The time to run the simulations with the settings described in this protocol is approximately 2.5 h.\nSubscription Required. Please recommend JoVE to your librarian."
  ],
  "subjectAreas": [
    "Bioengineering"
  ],
  "bigAreas": [
    "Bioengineering & Technology"
  ]
}