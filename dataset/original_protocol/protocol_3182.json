{
  "id": 3371,
  "origin_website": "Cell",
  "title": "Calculating RNA degradation rates using large-scale normalization in mouse embryonic stem cells",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nGrowing mouse ESC\nTiming: 3 days\nThis section describes how to grow mouse embryonic stem cells (ESCs).\nNote: Use an appropriate number of replicates. Treat each biological replicates independently changing tips for each well.\nNote: We use 6-well plates; all the volumes described here are relative to this size of well.\nNote: All the 2i medium should be warmed up to 37°C in a water bath, before adding to the cells. Prepare the volume of 2i medium required for the experiment before starting the experiment.\nAlternatives: This protocol is for mouse ESC but other types of adherent cells can be used, as well as in different conditions.\nSeeding day.\nWash each well of the ESC plate with 1 mL of 1× PBS, and aspirate.\nTo detach the cells from the plate, add 0.5 mL Trypsin and incubate the cells for 5 min at 37 °C at 5% CO2.\nDeactivate the Trypsin by adding 4× the volume added of Trypsin with 2i medium. Then collect the cells in a centrifuge tube.\nCentrifuge the cell suspension for 5 min at 400 g.\nDiscard the supernatant and resuspend the cells with 5 mL of 2i medium.\nCount the cells with a cell-counter and prepare the cell suspension of 1.5 × 10⁵ cells/well to seed for the experiment.\nNote: Make sure you have sufficient replicates for the four time-points (0 h, 2 h, 4 h, 8 h) of α-amanitin-inhibition treatment which will be done on the harvest day (day 3).\nCoat new plates with 0.2% gelatin for 5–10 min at RT and aspirate.\nSeed 1.5 × 10⁵ cells/well onto gelatin-coated plates, add up to 2 mL of 2i media to each well and rock the plates to distribute the cell suspension evenly.",
    "Incubate the cells 10–12 h in a humidified incubator (5% CO2; 37°C).\nDay 1-day 2: Check the cells under the light microscope and change the medium with fresh 2i medium.\nNote: Medium change is done by removing the old medium and adding another 2 mL of fresh pre-heated (37°C) 2i medium in each well.\nα-amanitin treatment and harvesting\nTiming: approximately 10 h\nThis section describes how to perform transcriptional inhibition using α-amanitin.\nNote: Check your cells under microscope and try to estimate the confluence of your plates. Should be around 70%–80% plate coverage. As the colonies begin to merge the chances for differentiation increase.\nα-amanitin treatment:\n1–2 h before the treatment, change to fresh 2i medium your control cells only (time-point 0 h).\nPrepare 2i medium with 2 μg/mL α-amanitin enough for all the plates, except your controls (without α-amanitin).\nChange to fresh 2i medium with α-amanitin added to your cells (2 h, 4 h and 8 h time-points, Figure 1[href=https://www.wicell.org#fig1]A).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2954-Fig1.jpg\nFigure 1. Cell treatment with α-amanitin and RNA-seq\n(A) Treatment of cells with α-amanitin to inhibit transcription, followed by temporal samples (0 h, 2 h, 4 h, 8 h).\n(B) RNA is extracted from each temporal sample.\n(C) RNA is used for preparation of mRNA-seq library and sequencing. Resulting sequencing reads are aligned to the genome.\n(D) Expression levels of genes between temporal samples are estimated from alignment by calculating TPM values.\nIncubate the cells with 2i+α-amanitin medium at 37°C at 5% CO2.\nNote: Proceed immediately to the next step to harvest the control cells (time-point 0 h).\nHarvesting: (0 h, 2 h, 4 h and 8 h).\nWash the cells with 1× PBS.\nAdd trypsin in each well and incubate for 5 min at 37°C.",
    "Deactivate the trypsin by adding 4× the volume added of trypsin with 2i medium. Resuspend the cells very gentle and collect them to centrifuge tube.\nCentrifuge the cells suspension for 5 min at 400 g.\nDiscard the supernatant and resuspend the cells with 1 mL of PBS, transfer the cell suspension to a new collection tube (1.5 mL).\nNote: Incomplete removal of the cell-culture medium will inhibit lysis and might dilute the lysate, both effects may reduce the RNA yield.\nCentrifuge the cells for 5 min at 400 g. and discard the supernatant.\nAdd buffer RLT (lysis buffer from QIAGEN kit) and snap freeze the cells.\nStore the cells at −80°C until all the samples will be harvested and you will be ready to proceed.\nRNA extraction and library preparation\nTiming: approximately 2 days\nThis section describes how to extract and sequence RNA from temporal samples.\nRNA extraction:\nIf frozen, remove samples from −80°C and thaw on ice.\nIn order to homogenize the cells, you can use a syringe with a needle. Pass the lysate through a 20-gauge needle for at least 5–10 times or until a homogeneous lysate is achieved.\nProceed with the purification of total RNA (Figure 1[href=https://www.wicell.org#fig1]B) by performing the protocol from RNeasy Mini Kit (QIAGEN).\nNote: We used the purification of total RNA from Animal cells using spin technology and the on-column DNase digestion in order to eliminate genomic DNA contamination, using RNAse-Free DNase set (QIAGEN).\nTo quantify the amount of RNA and assess the quality of total RNA in each sample, use NanoDrop-2000 (Thermo Fisher Scientific), or equivalent. Dilute all samples to the minimal concentration obtained (typically around 100–250 ng/μL), and use 500 ng of each sample for library preparations.",
    "Alternatives: The concentration of RNA could also be determined by measuring the absorbance in a spectrophotometer. Agilent bioanalyzer or fluorometric quantification can also be used.\nPause point: RNA extracts can be stored at −80°C until further use.\nLibrary preparation, sequencing and data processing.\nPrepare the indexed RNA libraries from 500 ng of total RNA extracted and purified at step 5. Note that while we used 500 ng, the starting amount can range from 100 ng to 4 μg of total RNA.\nUse KAPA Stranded mRNA-Seq kit by Kapa Biosystems, and follow according to the manufacturer’s instructions (https://rochesequencingstore.com/wp-content/uploads/2022/07/KAPA-Stranded-mRNA-Seq-Kit-Technical-Data-Sheet.pdf[href=https://rochesequencingstore.com/wp-content/uploads/2022/07/KAPA-Stranded-mRNA-Seq-Kit-Technical-Data-Sheet.pdf]).\nAlternatives: Other types of RNA-seq kits for library preparation can be use, for instance, Illumina Stranded mRNA prep.\nDetermine the average size of the libraries by Tape Station (Agilent Technologies).\nPool all samples and sequence on Illumina NextSeq500 sequencer or other equivalent instrument.\nData processing (Figures 1[href=https://www.wicell.org#fig1]C and 1D):\nInitial quality control (QC) checks can be done with FASTQC software. Each sample will generate a QC report, and you should examine the data for low per base quality, for unusual sequence content, if the sequences contain reads of uniform or variable lengths, then decide whether to trim the reads or not. Trimmomatic can be used to remove low-quality reads, trim adaptor sequences, and eliminate poor-quality bases.\nAlign the reads with STAR alignment pipeline or another preferred aligner. We used STAR (Spliced Transcripts Alignment to a Reference), version 2.7.1a. Aligning reads using STAR is a two-step process, which involves creating a genome index and mapping reads to the genome. As reference genome we used GRCm38/mm10. The following command can be used:\n> STAR-2.7.1a/bin/Linux_x86_64/STAR--runThreadN4--genomeDir/ems/elsc-labs/meshorer-e/lab-shared/star_index_mouseN--readFilesIn$file.fastq--quantModeGeneCounts--outFileNamePrefix ./${file} --outSAMtype BAM SortedByCoordinate",
    "Note: We excluded the mitochondrial chromosome from the alignment, to avoid possible biases due to different drug activity on mitochondrial RNA polymerases. In case drug used is expected to act similarly on mitochondrial RNA polymerases, then mitochondrial RNAs could be retained in the analysis.\nThe result of STAR alignment is an output folder containing read counts and bam file containing sequence alignment. You will see counts.csv, which are counts for all of your samples in a tab delimited file and tpm.csv which are normalized by TPM table. We used gencode.vM24.primary assembly.annotation.gtf.\nAlternatives: You can choose to normalize your values by FPKM, which will only control for the number of sequencing reads per sample, but not total expression. By our experience, predicted degradation rates based on FPKM normalization are highly similar, but could result in slight biases in estimating highly stable genes, and lead to a larger number of control genes (see below).\nLarge-scale normalization of a-amanitin treatment time course\nTiming: approximately 1 h\nThis section describes how to select control genes and normalize temporal samples.\nSelect a subset of stable genes for normalization.\nFit an exponential decay model to TPM values relative to time of sample collection (Figure 2[href=https://www.wicell.org#fig2]A).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2954-Fig2.jpg\nFigure 2. Temporal sample normalization and degradation analysis\n(A) Left: example of fitted regression models (dashed lines) to raw TPM data (y-axis; log(TPM)) in temporal samples (x-axis; hours) of stable control genes (blue) and degraded mRNAs (yellow, orange). The slope fitted to the control genes is < 0.05, showing their stability. Right: raw TPM data (y-axis) in temporal samples (x-axis; hours) of 349 control genes selected for normalization of undifferentiated mouse ESCs.",
    "(B) Left: example of normalized expression (y-axis) in temporal samples (x-axis; hours) after normalization by control genes (blue). The slope of the control genes is ∼0 after normalization. Right: normalized expression (y-axis) in temporal samples (x-axis; hours) of 349 control genes of undifferentiated mouse ESCs.\n(C) Left: example of fitted regression models (dashed lines) to normalized expression (y-axis; log(TPM)) in temporal samples (x-axis; hours) of stable control genes (blue) and degraded mRNAs (yellow, orange). The slope fitted to each gene estimates its degradation rate (shown as half-life). Higher values represent faster degradation. Right: distribution of all degradation rates (x-axis; log2) fitted to genes in undifferentiated mouse ESCs. Blue: all 5,294 expressed genes. Red: only 3314 genes with r-squared value > 0.5 for the fitted regression model.\n(D) Volcano plot showing the effect size (difference in the standard mean of each of the two distributions, x-axis) and p-value (-log10(p-value), Kolmogorov-Smirnov FDR < 1% , y-axis; -log) for the association of short 5–8 nucleotide sequences with differences in degradation rates of genes. Negative effect size values (left side of plot) represent sequences associated with stable genes, while positive effect size values (right side of plot) represent sequences associated with unstable genes. Colors represent density (yellow = high density; dark blue = low density). P-value threshold (horizontal line) is 10−11. Effect size threshold (vertical lines) is plus/minus 0.2. Significant sequences are marked in light blue and annotated on plot. All identified sequences are associated with unstable genes in undifferentiated mouse ESCs.\nSet a minimal expression threshold on TPM values (we used a minimal value of 1e-2).",
    "For each gene, use linear regression to estimate a gene-specific slope, which describes the change in expression levels over time, under the assumption of (1) an exponential decay model (first order reaction) and (2) a constant slope value (over time).\nUnder these assumptions, we can write:\nd\nX\nd\nt\n=\n−\nβ\nX\n→\nX\nt\n=\nX\n0\n·\ne\n−\nβ\nt\n→\nlog\nX\nt\n=\n−\nβ\nt\n+\nlog\nX\n0\nWhere X is RNA level of a gene (TPM values), t is time of sample collection (after α-amanitin treatment) and β is the slope.\nTo find β, we fit a generalized linear regression model (matlab glmfit function) to TPM values, which assumes a poisson distribution of the response variable (TPM values) and a logarithmic link function.\nAlternatives: fit a standard linear regression to log-transformed TPM values, which should produce equivalent results. This analysis assumes a normal distribution of the response variable (logTPM values).\nSet lower and upper bounds on estimated slopes (β). We used a lower bound of −1.5 and an upper bound of 1.5 (maximal degradation; equivalent to a half-life of 28 min). Positive values represent a decrease in expression, while negative values represent an increase in expression.\nCalculate a standard r-squared value (coefficient of determination) for the fit between model predictions and measured TPM values.\nR-squared calculation is done using the following formula:\nR\n2\n=\n1\n−\nS\nS\nr\ne\ns\ni\nd\nu\na\nl\nS\nS\nt\no\nt\na\nl\n=\n1\n−\n∑\ni\n(\nlog\nT\nP\nM\nt\n−\n(\n−\nβ\nt\n+\nlog\nX\n0\n)\n)\n2\n∑\ni\n(\nlog\nT\nP\nM\nt\n−\nlog\nT\nP\nM\n¯\n)\n2",
    "Where TPMt is the TPM value of the gene at time t, β and   log   X 0    are fitted by the regression model, and     log  T P M  ¯    is the average of all temporal TPM values for the gene.\nSelect a subset of control transcripts with a minimal degradation rate in wild-type examples by requiring:\n(\ns\nl\no\np\ne\n<\n0.05\n)\nA\nN\nD\n(\nlog\n2\n(\nX\n0\n)\n>\n1\n)\nA\nN\nD\n(\nr\n−\ns\nq\nu\na\nr\ne\nd\n>\n0.5\n)\nThese transcripts represent a subset of genes with a significant initial expression but minimal decrease in their mRNA levels during the course of the α-amanitin treatment, and will be used for normalization.\nNormalizing the TPM values by the stable genes control set.\nFor each time point, calculate the average logTPM value across the set of control genes, and subtract that value from all logTPM values of all genes, and add an arbitrary non-zero value (we used 2, Figure 2[href=https://www.wicell.org#fig2]B).\nThe final formula for a gene X, at time t is:\nn\no\nr\nm\na\nl\ni\nz\ne\nd\nl\no\ng\nT\nP\nM\nx\n,\nt\n=\nl\no\ng\nT\nP\nM\nx\n,\nt\n−\nl\no\ng\nT\nP\nM\nc\no\nn\nt\nr\no\nl\ns\n,\nt\n+\n2\nmRNA decay analysis\nTiming: approximately 1 h\nThis section describes how to calculate mRNA degradation rates from normalized RNA-seq data.\nCalculate degradation rate based on normalized TPM values.\nFit an exponential decay model to normalized TPM values relative to time of sample collection (Figure 2[href=https://www.wicell.org#fig2]C).\nFor each gene, use linear regression to estimate a gene-specific slope, as described above (step 7.i.ii).",
    "Slope directly relates to degradation rate and half-life:\nd\ne\ng\nr\na\nd\na\nt\ni\no\nn\nr\na\nt\ne\n=\nβ\nh\na\nl\nf\nl\ni\nf\ne\n=\nlog\n⁡\n(\n2\n)\nβ\nResulting rate (1/time) and half-life (time) are given in the same time units as the input times. In this example, times are given in hours, and therefore half-life is given in hours and degradation rate in 1/h.\nSet lower and upper bounds on estimated degradation rate (β). We used a lower bound of 0.01 (minimal degradation; equivalent to half-life of 69 h) and an upper bound of 4 (maximal degradation; equivalent to a half-life of 10 min).\nOptional: Calculate a standard r-squared value for the fit between model predictions and normalized TPM values. This value will estimate the percent of variation in a gene’s normalized TPM values that is explained by the model. The higher the value the better the model explains the data.\nNote: Download our degradation rate package, and run the following code from a linux/unix terminal to perform the analysis in steps 7–9:\n> make run_dg_estimate TPM_FILE=example_ko_tpm.txt OUTPUT_DIR=example_ko\nTPM_FILE is a tab delimited text file containing TPM values, where each row represents a gene and each column represents a sample (times 0, 2, 4 and 8 and replicates). First column should include gene ids followed by TPM values as numbers. First row should include the time value for each column as numbers. The resulting half-life values will be given in the same time unit as the column titles in this file. We provide two matrices as example within the code distribution.\nThe results will be placed in the OUTPUT_DIR directory within the run folder.\nAssociating short 3′ UTR sequences with mRNA decay rates\nTiming: approximately 1 h",
    "This section describes how to calculate associate short 3′ UTR sequences with differences between genes in calculated mRNA degradation rates.\nPrepare a reference set of 3′ UTR sequences.\nDownload mouse 3′ UTR sequences. We used the ensembl biomart GRCm38, version 99.4[href=https://www.wicell.org#bib4]\nFor each gene, filter the annotated 3′ UTRs to keep a single longest annotated 3′ UTR sequence. Remove from the analysis 3′ UTR sequences which are shorter than 10 nucleotides.\nIdentify short sequences that are over-represented within the 3′ UTR sequences of genes with either faster or slower degradation rates.\nCalculate the set of all short sequences between 5–8 nucleotides long (k-mers). We used the ape and k-mer R packages.\nFor each k-mer,\nFind the set of all genes with this k-mer in their 3′ UTR (positive set). It is recommended to include only genes with r-square > 0.5 for the fitted degradation model in this set.\nFind the set of all genes without this k-mer in their 3′ UTR (negative set). It is recommended to include only genes with r-square > 0.5 for the fitted degradation model in this set.\nUse a one-sided Kolmogorov-Smirnov test to calculate p-values for two hypotheses: (1) degradation rates in the positive set are larger than the negative set, and (2) degradation rates in the positive set are smaller than the negative set. Select the minimal p-value.\nCalculate an effect size by the standardized mean difference, defined as:\nθ\n=\nμ\n1\n−\nμ\n2\nσ\nwhere    μ 1    is the mean of the first population,    μ 2    is the mean of the second population and   σ   is the standard deviation (based on both populations).\nUse a False Discovery Rate correction of all p-values (2 p-values per k-mer) and set a threshold for significance (e.g., corrected p-value < 0.05).",
    "Set a threshold for significance on the absolute value of the effect size (we require a minimal absolute effect size of 0.2).\nSelect k-mers with a p-value below the significance threshold and an effect size above the significance threshold as candidate regulatory sequences (Figure 2[href=https://www.wicell.org#fig2]D).\nNote: Download our degradation rate package, and run the following code from a linux/unix terminal to perform the complete analysis in steps 7–11:\n> make run_complete_analysis input_tpm_file=example_ko_tpm.txt out_dir=example_ko ensembl_organism=mmusculus_3UTR_ensembl99\nTPM_FILE is a tab delimited text file containing TPM values calculated in step 6. The name of the organism should be specified in order to correctly analyze 3′ UTR sequences. Our package contains 3′ UTR sequence information for the mouse, human and zebrafish genomes.\nThe results will be placed in the out_dir directory within the run folder.\nNote: You can also run the k-mer analysis (step 11) separately. Download our k-mer analysis package, and use the following code to perform the analysis in this section from a linux/unix terminal:\n> make run_ks_test_job path_to_kmer_matrices=3utr/kmer_matrices PARAMETERS_FILE=parameters.tsv output_path=3utr/kmer_out term=half_life\n> make ks_tests_plots ks_test_output_folder=3utr/kmer_out term=half_life output_path=3utr/kmer_out/plots\nThe kmer_matrices directory contains 3′ UTR sequence information of the relevant organism. Our package contains 3′ UTR sequence information for the mouse, human and zebrafish genomes. Instructions for adding information of other organisms are provided online. Parameter file contains the half-life estimations from step 9.\nThe results will be placed in the output_path directory within the run folder."
  ],
  "subjectAreas": [
    "Rnaseq",
    "Stem Cells",
    "Cell Culture",
    "Cell Biology",
    "Cell Differentiation",
    "Molecular Biology"
  ],
  "bigAreas": [
    "Biomedical & Clinical Research",
    "Bioengineering & Technology",
    "Molecular Biology & Genetics"
  ]
}