{
  "id": 7027,
  "origin_website": "Bio",
  "title": "Reference-free Association Mapping from Sequencing Reads Using k-mers",
  "procedures": [
    "The overview of the procedure of association mapping from sequencing reads with k-mers using HAWK is shown in Figure 1. The steps are described in more details below. More information on the process is available at https://github.com/atifrahman/HAWK/blob/master/README.md[href=https://github.com/atifrahman/HAWK/blob/master/README.md].imgsrc:https://en-cdn.bio-protocol.org/attached/image/e3815/bioprotoc-10-21-3815-g001.jpgFigure 1. Overview of association mapping from sequencing reads with k-mers using HAWK Counting and sorting k-mersCount k-mers in each sample by running Jellyfish or Jellyfish 2. To do this, modify the example scripts available at https://github.com/atifrahman/HAWK/tree/master/supplements[href=https://github.com/atifrahman/HAWK/tree/master/supplements].countKmers_jf2 or countKmers_jf1 can be used to count and sort k-mers using Jellyfish 2 or Jellyfish respectively when the reads from each sample are in a separate folder whereas countKmers_jf2_sra or countKmers_jf1_sra can be used when reads first need to be downloaded from the sequence read archive (SRA).The scripts will write the names of the sorted k-mer count files in 'sorted_files.txt' and the total k-mer counts in each sample in 'total_kmer_counts.txt'.Running HAWKCreate a file named 'gwas_info.txt' containing three columns separated by tabs in each row giving a sample ID, male/female/unknown denoted by M/F/U and Case/Control status of the sample for each sample.Copy the files 'sorted_files.txt' and 'total_kmer_counts.txt' into a folder as well as the file 'gwas_info.txt'Copy the scripts 'runHawk' and 'runAbyss' into the folder, edit the variables hawkDir, eigenstratDir and isDiploid, and run ./runHawkThis will complete the following steps:Identifying k-mers associated with cases and controls. This will be done by running ‘hawk’ and will generate the initial lists of k-mers associated with cases and controls in files ‘case_out_w_bonf.kmerDiff’ and ‘control_out_w_bonf.kmerDiff’ respectively as well as the files to be used by Eigenstrat to determine population structure.Determining population structure. Population structure will be detected by running Eigenstrat. Optionally, the population structure can be investigated by running the R script pca_plot.R. This will read the ‘gwas_eigenstrat.evec’ file generated by Eigenstrat and output the principal component analysis (PCA) plot in ‘pca_plot.eps’.",
    "Adjust the variables PC1 and PC2 to select along which principal components the data will be plotted.Correcting for population structure. The p-values for the k-mers identified in Step B3a will be adjusted for confounding factors such as population structure, total number of k-mers and sex. The k-mers found significantly associated with cases and controls will be in files 'case_kmers.fasta' and 'control_kmers.fasta'. Additional information about the k-mers will be in ‘pvals_case_top_merged.txt’ and ‘pvals_control_top_merged.txt.’Assembling k-mersEdit the variable ‘abyssDir’ in the script ‘runAbyss’ and run ./runAbyssThis will assemble the k-mers to generate one sequence for each associated region and the sequences associated with cases and controls will be in ‘case_abyss.25_49.fa’ and ‘control_abyss.25_49.fa’ respectively.Downstream analysisOnce the k-mers or the assembled sequences are obtained, they can be analyzed in a number of ways.To obtain summary stats such as average p-values, average counts of constituent k-mers and average number of times they are present in cases and controls edit the HAWK directory, input filename, and whether the sequences are from case or control in the script ‘runKmerSummary’ (at https://github.com/atifrahman/HAWK/tree/master/supplements[href=https://github.com/atifrahman/HAWK/tree/master/supplements]) and run ./runKmerSummary (see https://github.com/atifrahman/HAWK[href=https://github.com/atifrahman/HAWK] for details).If no reference genome is available, BLAST (         Altschul et al., 1990        ) the sequences to check for hits to sequences in related organisms and analyze the matched sequences.If a reference genome is available, the k-mers can be mapped to the reference using a tool such as Bowtie 2 (Langmead and Salzberg, 2012) and their positions and p-values can be visualized using Manhattan plots. Edit the shell script ‘runBowtie2’ and the R script ‘manhattan_plasmid.R’, available at https://github.com/atifrahman/HAWK/tree/master/ecoli_analysis[href=https://github.com/atifrahman/HAWK/tree/master/ecoli_analysis] to align the k-mers to a reference and generate Manhattan plots respectively."
  ],
  "subjectAreas": [
    "Molecular Biology",
    "Systems Biology"
  ],
  "bigAreas": [
    "Molecular Biology & Genetics"
  ]
}