{
  "id": 7807,
  "origin_website": "Bio",
  "title": "Fast Detection and Quantification of  Interictal Spikes and Seizures in a  Rodent Model of Epilepsy Using an  Automated Algorithm",
  "procedures": [
    "In the following sections, we describe the procedures for electrode implantation, EEG acquisition, and analysis of interictal spikes and seizures. For more information on electrode implantation and EEG acquisition procedures, we direct readers to the original articles (Puttachary et al., 2015; Sharma et al., 2018 and 2021).Surgical preparation and electrode implantation Clean surgical equipment with 5% Haemo-Sol solution for 48–72 h and dry at room temperature prior to autoclaving. On the day of surgery (electrode implantation), shave each mouse’s head (under anesthesia), and clean the surgical site in an onion shell pattern with 70% ethanol and a chlorhexidine scrub. Administer analgesic (Meloxicam, 1–2 mg/kg, subcutaneous) and eye ointment prior to surgery. Using a scalpel, make a small midline incision at the mid-dorsal aspect of the head and neck. Insert a transmitter into the flank region, by tunneling between the skin and the fascia using blunt dissection. Then, drill bilateral holes into the skull of each hemisphere, and place electrodes epidurally into the cerebral hemispheres. Completely cover and secure the electrodes in place using dental cement. Close the incision using sterile surgical sutures (Puttachary et al., 2015; Sharma et al., 2018 and 2021).A video of the electrode implantation protocol has been provided (Video 1).<p>imgsrc:https://bio-protocol.org/javascript:;</p> Video 1. Mouse electrode implantation procedureEEG acquisition and setup PhysioTelTM radio telemetry devices (transmitters) use oscillators controlled by voltage that convert biopotentials into high-frequency signals. All PhysioTelTM HD radiotelemetric devices are equipped with serial numbers. Once turned on, these devices send signals to receiver pads that record the serial number from the implanted device. These high-frequency signals are then transferred to the data exchange matrix that forwards output signals to the computer. Eight receiver pads can be connected to a single data exchange matrix, and multiple video-synchronized EEG traces can be monitored simultaneously through Ponemah Software 6.",
    "51, with a sampling frequency of 1,000 Hz. All information regarding the receiver pads, animal identification number, transmitter serial number, jack location in the data matrix, signal strength, and transmitter information, such as EEG and temperature calibration, are recorded to each matrix under hardware settings in the acquisition window. The acquisition of the EEG signal is performed at a sampling rate of 1,000 Hz, filter cutoff at 100 Hz, and full scale at 10 mV, by the Ponemah Acquisition Software. The frequency range of the telemetry transmitter is 1–100 Hz. Shortly after the implantation of the transmitters, start EEG recording to obtain baseline activity tracings for each animal. Approximately 5 GB of video (at 20 frames/s) and EEG data can be collected per day from eight animals simultaneously (Puttachary et al., 2015; Sharma et al., 2018). Once data acquisition is complete, export the EEG data as EDF files, to be used within MATLAB.Installation of MATLAB and toolboxes MATLAB can be installed from the MathWorks product webpage for Windows, Linux, and Macintosh operating systems (OS). For our purposes, a Windows OS was used, and the following instructions pertain to installation of MATLAB on a Windows 64-bit OS. However, additional information regarding MATLAB installation on a Linux OS can be found in the Notes section. First, create a MathWorks account and navigate to https://www.mathworks.com/products/matlab.html[href=https://www.mathworks.com/products/matlab.html] to view available products. Select the version of MATLAB you wish to download and click “Download for Windows.” Open the installation file by double clicking on it once it has downloaded. Sign in to your MathWorks account when prompted and follow the on-screen instructions to finish installation. During installation, select the MathWorks Signal Processing Toolbox and install the supplemental software package when prompted, to select add-on applications.",
    "Manual EEG Analysis Electrographic spikes and seizures are first detected manually using Neuroscore 3.3 software, which is commercially available from DSI. Spikes are analyzed using the “spike train protocol,” which identifies epileptiform spikes and spike duration, using dynamic and absolute threshold values. Dynamic thresholding allows a user to define a threshold based on a multiplication of the root mean square value of the EEG signal approximately one minute prior to the time point being analyzed, while the absolute threshold allows the user to define a fixed amplitude threshold (voltage) that is applied in both the positive and negative directions. Dynamic threshold values include threshold ratio as well as maximum and minimum ratios for epileptiform spike detection–criteria, which prevent false positives from being detected in low noise settings. The absolute threshold values include minimum and maximum amplitudes for EEG spikes, which are kept between 200 and 1,500 μV. Therefore, all spikes above 200 μV are considered epileptiform spikes. These parameters are specified to extract epileptiform spikes from the raw EEG data. These parameters also consider the minimum and maximum time interval between spikes, which is used to determine possible members of a spike train. Lastly, the duration of a spike train is also used to filter true epileptiform activity from background noise. Once the settings are finalized, load the raw EEG data via the EDF file, and specify the required signals (power bands and activity counts). Once complete, the raw EEG file can be analyzed (Puttachary et al., 2015). Interictal spikes and seizures are differentiated based on the EEG spike characteristics, such as amplitude, inter-spike interval, duration, and power spectral analysis. Manually remove EEG signals associated with mouse behavior (exploratory and grooming) and electrical artifacts, so they do not interfere with the analysis.",
    "These behavioral activities can be verified via video EEG recordings (Tse et al., 2014; Puttachary et al., 2015).For seizure analysis, we set the duration for seizures (CS) at >10 s. CS episodes can last from 10–120 s, with inter-spike intervals of 100–300 ms. Spike amplitude often varies from 500–1,500 μV, with a spike frequency/min of 180–720 within an episode (Puttachary et al., 2015). Additionally, the power band spectrum is known to be a reliable measure for the detection of seizures (Puttachary et al., 2015; Sharma et al., 2018). The power spectrum varies with the type of seizure, and the spectrum frequently changes within stage-specific seizures (Tse et al., 2014; Puttachary et al., 2015).Algorithm-based (automated) EEG analysis File path and data import (Block 1)The MATLAB EEG algorithm was programmed using three grouped blocks of code. The first block of the algorithm establishes a file path to the working folder and imports all the EDF files present within that folder using the edfread function. This allows the user to extract every EDF file using a single button click. Once imported, the EEG data from the EDF files is stored within cell arrays, using the default units of seconds and microvolts (μV). The algorithm then converts the EEG amplitude values into millivolts (mV). Then, the recording date is converted into a date-number format, while the time values are converted from a frequency value to a whole number in seconds.Baseline EEG activity determination (Block 2)The second block of code contains the data processing elements, allowing the algorithm to autonomously locate and record the location of interictal spikes and seizures. First, the algorithm calculates the baseline EEG activity value via a “running while” loop.",
    "This is done by iterating from a set minimum of 100 μV by increments of 5 μV, until 97% of the baseline EEG data points in the first hour of data are less than the value of the current iteration. Once this condition is satisfied, the algorithm saves the current amplitude iteration, outputs the value on-screen to the user, and proceeds with the calculation of the upper and lower spike thresholds. The time window (default ~1 h) for determining baseline activity can be readily changed from 1 h to any value that is suitable for the user, as long as it is shorter than the total length of the EEG tracing. This modification allows users to analyze EEG traces that are less than 1 h long and provides the opportunity to achieve a more accurate baseline by extending the time window beyond 1 h, if needed.Lower threshold and upper threshold determination (Block 2)The lower threshold variable incorporated in the algorithm is the value at which a true interictal spike is differentiated from background EEG noise and normal baseline activity. Relevant literature has revealed that a lower threshold of twice the baseline activity value is often sufficient for differentiating true interictal activity from the baseline EEG signal (Anjum et al., 2018). After determining baseline EEG activity, as described in the previous section, the algorithm calculates the lower threshold for interictal differentiation by doubling the baseline activity value. Thus, the lower threshold value for interictal spiking is not fixed, but rather depends on the baseline activity value of each individual EEG tracing. The upper threshold for interictal spiking is also pre-specified, to differentiate true interictal spikes from background electrical noise or animal movement.",
    "As reported in the literature, an upper threshold value of 1,500 μV often accurately captures true interictal activity, while removing EEG artifacts due to noise and animal behavior (Tse et al., 2014; Puttachary et al., 2015; Casillas-Espinosa et al., 2019). The upper threshold value is fixed, for every EEG trace, but can be readily adjusted as needed.Interictal spike detection (Block 2)Following determination of these key parameters, the remainder of the second block of code detects interictal spikes and seizures. The algorithm detects EEG spikes using the findpeaks function that is part of the MathWorks Signal Processing Toolbox, alongside a variety of associated input arguments used to clarify interictal activity. The minimum distance between interictal spikes, MinPeakDistance, is set at a value of 100 ms, to ensure that poly-spikes and other abnormal spiking patterns are not counted as multiple spikes (Puttachary et al., 2015). The minimum peak prominence, MinPeakProminence, better described as relative peak amplitude, is set at a value of 200 μV, which is also used to reduce the detection of poly-spikes and abnormal activity, such as grooming and mouse movement. Minimum peak amplitude, MinPeakHeight, is specified at the lower threshold value to ensure that only spikes with twice the baseline activity value are counted as interictal spikes. Lastly, a maximum peak width, MaxPeakWidth, of 200 ms is specified to reduce quantification of abnormal spikes and EEG artifacts. As with other quantification parameters, all these values are easily modified to filter the EEG trace being analyzed. After completing interictal spike detection, the algorithm records the date, time, and amplitude of every interictal spike that has met all the prespecified constraints, and provides the option to generate on-screen figures, as in Figure 1.",
    "Then, the algorithm removes any spike that fails to meet all the specified criteria (Table 1) from further quantification.imgsrc:https://en-cdn.bio-protocol.org/attached/image/e4632/bioprotoc-13-06-4632-g001.jpgFigure 1. Representative example of interictal spikes determined using the automated algorithm. (A) MATLAB-generated output showing interictal activity detection (positive and negative spikes marked by red circles). The blue horizontal lines represent the automatically determined baseline activity value and the red horizontal lines represent the lower threshold value (2X baseline activity). (B) An enlarged image of an individual inter-ictal spike.Table 1. Criteria for determining the presence of interictal spikes for algorithmic analysis table:",
    "﻿Interictal Spike Classification Criteria,Unnamed: 1\nLower Detection Threshold,2X Baseline Activity Value\nUpper Detection Threshold,\"≤1,500 μV\"\nMinimum Peak Prominence,≥200 μV\nMaximum Peak Width,200 mS\nInter-spike Interval,≥100 mS\n Seizure detection (Block 2)The last section of code in the second block contains the seizure detector, which analyzes the EEG trace subsequent to the interictal spike quantification process described in the previous section. Seizures are defined as an electrographic seizure with high amplitude frequency discharges, lasting for at least 10 seconds (Guo et al., 2013; Goodrich et al., 2013), with three times the baseline activity value, and an inter-spike interval of less than 5 seconds (Puttachary et al., 2015). The criteria for quantifying seizures are based on published literature quantifying spike clusters and grouped ictal activity for the evaluation of epileptogenesis (Tse et al., 2014; Puttachary et al., 2015; Anjum et al., 2018; Casillas-Espinosa et al., 2019). First, using the data from the previous section of code, the algorithm calculates the time elapsed between adjacent electrographic spikes. The algorithm then determines the starting and ending points of clusters of spiking activity. Any interval that is greater than the prespecified 5-second inter-seizure interval will break the chain of spiking activity, and automatically restart quantification of the next cluster of activity. Once complete, the code processes each spike cluster and removes any cluster that fails to meet the predefined seizure criteria (Table 2). If all the criteria are met, the algorithm stores these ictal activity clusters as well as the corresponding date, time of onset, duration, and number of ictal spikes within the cluster, which can be plotted for on-screen analysis (Figure 2).Table 2. Criteria for determining the presence of a seizure during algorithmic analysis table:\n﻿Seizure Classification Criteria,Unnamed: 1\nMinimum Spike Amplitude,3X Baseline Activity Value\nMaximum Spike Amplitude,\"≤1,500 μV\"\nMinimum Seizure Duration,>10 s",
    "Maximum Inter-Spike Interval,<5 s",
    "imgsrc:https://en-cdn.bio-protocol.org/attached/image/e4632/bioprotoc-13-06-4632-g002.jpgFigure 2. Visual representation of spike and seizure detection within MATLAB. (A) Segment of the EEG trace showing interictal events and seizures on day 21 post-injury. Three episodes of spontaneous seizures were observed on the same day in one mouse (shown in rectangular blocks marked with triangles). (B) Expanded EEG trace of one of the seizures from 'A'. (C) Increased EMG activity is shown below the seizure trace. (D) Further expanded EEG trace of the seizure shown in C. Abbreviations: IIE, interictal events; EEG, electroencephalogram; EMG, electromyogram; SRS, spontaneous recurrent seizures.Data Processing and Export (Block 3)The third and final block of code is responsible for terminal data processing, and exporting compiled data to Microsoft Excel, for further data manipulation or comparison. First, there are instructions for plotting data so the data can be viewed on-screen, if desired. To reduce the computational workload and promote time savings, the plotting instructions are suppressed by default. However, in the semi-automated version of the code, plotting is displayed on-screen, allowing the user to manually review each interictal spike and seizure. The remaining code creates individual data tables containing the interictal spike data and seizure data for each EEG file present in the current working folder. Thus, when the code terminates, the interictal spike counts and seizure quantification data for all EEG traces are written to separate Excel files and stored within the current folder. This allows the user to rapidly process multiple EEG traces and have the data readily available for further review, or further analysis outside the MATLAB programming environment. Figure 3 provides a simplified, graphical representation of the various algorithm blocks and processing steps.imgsrc:https://en-cdn.bio-protocol.org/attached/image/e4632/bioprotoc-13-06-4632-g003.jpgFigure 3. Schematic diagram outlining the processing steps of the autonomous MATLAB algorithm created for the detection of interictal spikes and seizures.",
    "Block 1 of the algorithm is dedicated to data import and unit conversion. Block 2 contains the logic statements that quantify interictal spikes and seizures using the inclusion criteria highlighted in red. Block 3 is responsible for finalizing data, plotting figures, and exporting finalized spike and seizure data."
  ],
  "subjectAreas": [
    "Neuroscience"
  ],
  "bigAreas": [
    "Biomedical & Clinical Research"
  ]
}