{
  "id": 10315,
  "origin_website": "Jove",
  "title": "A MRI-Based Toolbox for Neurosurgical Planning in Nonhuman Primates",
  "procedures": [
    "All animal procedures were approved by the University of Washington Institute for Animal Care and Use Committee. Two male rhesus macaques (monkey H: 14.9 kg and 7 years old, monkey L: 14.8 kg and 6 years old) were used.\n1. Image acquisition\nTransport the monkey to a 3T MRI scanner and place the animal in an MR-compatible stereotaxic frame (Table of Materials).\nRecord the standard T1 (flip angle = 8°, repetition time/echo time = 7.5/3.69 s, matrix size = 432 x 432 x 80, acquisition duration = 103.7 s, Multicoil (Table of Materials), number of averages = 1, slice thickness = 1 mm) anatomical MR images.\n\tNOTE: For successful skull isolation, use the MRI acquisition parameters applied here to maximize separation between skull and brain.\n2. Brain extraction\nIn the MR imaging software for brain extraction select Open | Open Image. Load the T1 Quick Magnetization Prepared Rapid Gradient Echo (MPRAGE) scan acquired in step 1.2 into an MR imaging software (Table of Materials).\nTo extract the brain, under the Plugins dropdown menu select Extract Brain (BET). Extract at an intensity threshold around 0.5− 0.7 and set the threshold gradient value to 0. Repeatedly use the extraction function at successively lower intensity thresholds until the scan contains only the cortical anatomy (Figure 1B).\n\tNOTE: This is an iterative process because the software is not designed for NHP brains and extraction is not precise",
    "Under the region of interest (ROI) menu select Threshold to ROI and select the option for Shrink Wrap and 3D in order to create a bitmap of the brain. This will convert the volume to binary bits from a gradient, which streamlines future model generation processes. Choose a threshold (usually around 600) to isolate the brain from the surrounding tissue. This threshold can be found by hovering over the gray matter. Select OK to form the bitmap.\nTo create a surface, select Build Surface under the image menu and input the threshold used to extract the brain in step 2.3. Then select OK. The resulting surface can be used as a reference for adjusting the threshold value to produce the highest quality representation of the targeted anatomy (Figure 1C).\nUnder the file tab select Save or Save as, and save the extracted brain ROI as a .nii or .nii.gz file for use in creating the model of the brain.\n3. Brain modeling\nSelect Load Data | Choose Files to Add and load the extracted brain saved in the .nii or .nii.gz file type in medical image processing software (Table of Materials).\nHover over the welcome to slicer drop down menu in the modules toolbar and move to all modules. From that menu select the Editor functionality. Click OK on the popup warning.\nFrom the Editor module menu, select Threshold Effect and adjust the threshold range sliders so the portion of the bitmap containing the brain is highlighted in all three slices. When loading a bitmap, adjusting both sliders to a value of 1 selects the whole brain. Select Apply.",
    "Open the model maker module, and in the input volumes dropdown menu select the bitmap file generated in step 3.3. Under Models, select Create New Model Hierarchy. After assigning the name of the model to the hierarchy, select Apply to create the volume.\nSave the file in the .stl format.\nTo further modify the brain model, load the .stl file as a graphics body in computer aided design software (Table of Materials)\n\tNOTE: This may take a while, as the imported mesh brain surfaces are often quite complex.\nOnce the file is imported, in the feature tree on the left side of the screen click on the children of the Graphic body and suppress unnecessary Graphic features until only the features containing the brain are remaining in the file. Save the remaining file as a .prt for further manipulation and as a .stl for 3D printing. Save the remaining file as a .prt for further manipulation and as a .stl for 3D printing.\n4. Brain molding\nLoad the extracted brain model from section 3 to the computer aided design software by opening the .prt file. Under the features section of the insert menu, select Convert to Mesh body. Select the Graphic body of the brain and convert it.\nCreating a right and left mold of the full brain\n\t\nClick the Sketch button and select the top plane as the sketch plane. Draw a rectangle containing either the entirety of the right or left hemisphere of the brain. Select the extrude boss/base feature while in the sketch and extrude a cubic rectangle to contain the top part of the brain.",
    "NOTE: The cube may have to be extruded in two directions in order to contain the entire hemisphere. This is because the zero point, where the plane of extrusion is located, may fall inside the brain model. Extruding in both directions ensures that the mold will encompass the whole volume of interest.\nUnder the features section of the ‘insert’ menu, select Convert to Mesh body. Select the extruded cube in the Solid bodies folder and convert it. To create the negative space, subtract the model of the brain from the newly extruded cube using the Combine feature and selecting the subtract option.\nRepeat steps 4.2.1 and 4.2.2 for the other hemisphere of the brain (left or right) and save the resulting files as a .stl for 3D printing and a .prt for further manipulation.\nCreating a right and left mold of the upper half of the brain.\n\t\nCreate a sketch in the top plane and draw a rectangle containing either the entirety of the right or left hemisphere of the brain. Select the extrude boss/base feature while in the sketch and extrude with the Offset from Plane feature selected. Offset the extrusion up to a distance where there are no overhanging contours in the brain anatomy, capturing just the upper anatomy. Under the features section of the ‘insert’ menu, select Convert to Mesh body. Select the extruded cube in the Solid bodies folder and convert it.\nTo create the negative space, subtract the model of the brain from the newly extruded cube using the Combine feature and selecting the subtract option.\nCreate a sketch plane on the dorsal side of the mold and select Convert Entities and then select the sketch from step 4.3.1.",
    "Select the extrude boss/base feature while in the sketch and, with the blind extrude option selected, extrude the solid body approximately 5 mm to completely enclose the subtracted brain anatomy in the mold.\nRepeat steps 4.3.1−4.3.4 for the other hemisphere of the brain (left or right) and save the resulting files as a .stl for 3D printing and a .prt for further manipulation.\nBy changing the dimensions and location of the cube and following the same protocol (steps 4.1 and 4.2), create molds that contain different parts of the brain.\nFor 3D printing, use ~70% infill density and increase the thickness of the outer shell of the print in order to minimize leakage of the molding material. If there are gaps or defects in the print, fill them using nail polish or another binding agent.\n5. Skull modeling\nImport the QUICK MPRAGE MRI from step 1.2 into the matrix manipulation software as a DICOM file. The DICOM file may be in separate 2D frames. If this is the case, combine all frames into a 3D matrix. Ensure that each 2D frame of the matrix is displaying a coronal slice.\nCreate a binary mask by thresholding the 3D matrix using a greater than operator for individual pixel values. Adjust the threshold such that the skull anatomy is being captured by the mask (see Supplemental coding file CalibrateMask).\n\tNOTE: The mask will contain four distinct layers. From the outside in, they will be referred to as “outside”, “musculature”, \"skull”, and “brain”. At this stage, “outside” and “skull” are 0’s in the mask, and “musculature” and “brain” are 1’s.\nTo remove the “musculature” layer, process each frame from the 3D mask separately by iteratively grabbing a 2D slice from the mask (i.e., 3D_Mask(:,:,1)).",
    "For each frame, select 0 pixels from the corners of the frame in the “outside” layer as the “seed”. Then search neighboring 0’s until you encounter a 1 pixel. Continue searching until no more 0’s can be found. Convert all connected 0’s to 1’s. This is done using the Matlab function “imfill”, with the inputs and outputs being [MASK2] = imfill(MASK1,LOCATIONS,CONNECTIVITY), where MASK1 is your original mask, and MASK2 is the filled in mask (see Supplemental coding file FillExterior).\nSome skull information will be lost during the removal. To mitigate the information loss, perform step 5.3 in all three dimensions of the data, and keep them separate.\n\tNOTE: Now both “outside” and “musculature” are 1’s, and will be considered as “outside”. The mask now contains three distinct layers, “outside”, “skull”, and “brain”. “Outside” and “brain” are 1’s, and “skull” is 0’s.\nInvert the values of the mask using the ~ operator (i.e., MASK2 = ~MASK1). Now “skull” is 1’s and “outside” and “brain” are 0’s.\nThe 1’s that are touching each other in each mask can be considered “objects”. Create an index of all objects in each mask using the Matlab function “bwconncomp”, with the inputs and outputs being [CC] = bwconncomp(MASK), where MASK is the 3D mask matrix, and CC is a structural object containing the index values of for each object, the number of objects and the size of the matrix. For each mask, remove all objects except for the largest one containing the most voxels by setting the values of the smaller objects to 0’s (see Supplemental coding file RemoveNoise).\nAdd the masks created from each pass together (see Supplemental coding file MergeMasks).\nScale the brain to a consistent resolution.",
    "From the DICOM header, compare the step size between each frame of the MRI to the dimensions of each pixel.\nIf these values are different, define a scale factor to compensate for the difference in resolution between step size and pixel size for each voxel. For example, if each frame is 1 mm apart, and the pixel dimension is 0.33 mm x 0.33 mm, the scale factor will be 3.\nAdd additional empty voxels to the 3D mask until the lowest resolution dimension of the mask is larger by a factor defined by the scale factor (see Supplemental coding file “ScaleMask”).\nLinearly interpolate values in the mask until the mask fills the new space.\nExport skull as an .stl file or similar filetype for 3D printing.\n6. Craniotomy creation in the 3D skull model\nUsing the MRI file from step 5.1, manually identify the approximate location of the craniotomy from anatomical landmarks found in the macaque brain atlas (e.g., central sulcus)19.\n\t\nView an individual slice of the 3D matrix (Similar to step 5.3).\nManually scan forward or backward through the 3D matrix until recognizable anatomical landmarks are located.\nSave the frame number as the z coordinate (i.e., 3D_Mask(:,:,z)\nUse a data selection tool to save the x and y coordinates of a single point on this frame for the craniotomy to be centered on using the Matlab function “getpts”, with the inputs and outputs being [x,y] = getpts. “getpts” opens up a user interface, click on the desired frame (see Supplemental coding file LocateCraniotomy).\nConvert the radius of the intended craniotomy from mm to voxels using the information in the DICOM header.",
    "Using the point specified in step 6.1 as a centerpoint, set all voxels within the radius defined in 6.2 to zero in the mask from step 5.8.4 using Supplemental coding file Craniotomy, where the inputs and outputs are [craniotomyMask] = Craniotomy(mask, x, y, z, radius, X, Y, Z, resolution)where cranitomyMask is a 3D matrix with a the craniotomy removed, mask is the initial 3D matrix, x,y,z are the centerpoint coordinates of the craniotomy, radius is the radius of the craniotomy, X,Y,Z are grid vectors of the 3D matrix, and resolution is your radius defined in step 6.2 (see Supplemental coding file Craniotomy).\nFor multiple craniotomies, repeat steps 6.1−6.3 for each unique craniotomy.\nExport skull as an .stl file or similar filetype for 3D printing.\n7. 3D printing\nNOTE: Two types of 3D printers for physical prototypes (Table of Materials) are used. For the following specifications, all 3D printer and printing software settings should be default unless otherwise mentioned.\nIn order to print the prototypes and molds, use a standard PLA printer (Table of Materials) and create the G-Code with the following printer and software settings: inner density >50% (this is especially important for the molds as they must hold liquid), fast honeycomb internal fill pattern, rectilinear external fill pattern, plate temperature = 50 °C, and extruder temperature = 230 °C.\nIn order to print higher fidelity models of the brain and skull use an industrial-grade printer to make a combined print of acrylonitrile butadiene styrene (ABS) for the model and a dissolvable support material (Table of Materials). Then create the G-Code and with the following printer settings: fill style Sparse - High Density. All other settings will be automatically set to the appropriate default setting.\n\t\nDissolve the model in support solvent (Table of Materials) for ~12 h.",
    "After implementing the appropriate printer settings, press Start and watch the first layer of the print to ensure that the base layer is clean and even.\nAfter 3D printing the molds, patch any visible holes with nail polish (Table of Materials) to guarantee a tighter seal.\n\tNOTE: The 3D printed brain and skull models can be combined by inserting the brain model into the open bottom of the skull. Removing the eye anatomy can ease the placement of the brain model without losing important information. When placed inside the skull, the brain naturally aligns to the anatomically correct position.\n8. Preparation of agarose\nMix the agar powder (Table of Materials) and locust bean gum powder (Table of Materials) in a 1:4 ratio by mass.\nCombine the powder mixture with 1x phosphate buffered solution (Table of Materials) to a 0.6% concentration solution in an Erlenmeyer flask.\n\tNOTE: Concentrations used by other labs falls in a range of 0.5%-0.6%20,21.\nSet the microwave to max power and place the flask containing the solution in the microwave for 2 min.\nObserve the solution. When the solution begins to bubble, stop the microwave and timer, remove the flask, and swirl vigorously. Set the flask back in microwave and resume the microwave and timer.\n\tNOTE: The purpose is to heat the solution without reducing the volume significantly due to evaporation during boiling.\nRepeat step 8.4 until the two minutes is complete.\nRemove the flask and maintain swirling to prevent the solution from setting in the flask.\nRun cold water on the outside of the flask to cool the solution while swirling. Cool the solution until the outside of the flask is hot to the touch, yet tolerable and safe, to prevent the solution from deforming the plastic mold in the following steps.",
    "Swirl the flask while transporting the solution to the mold to avoid premature hardening.\n9. Agarose molding\nNOTE: The agarose molding process outlined below is the same for the full hemisphere and upper half hemisphere molds\nPour the agarose solution into one of the brain molds until full. Continue to swirl remaining solution in the flask.\nMonitor the level of solution in the mold for leaks. Refill the mold as necessary since the setting agarose will seal any leaks in the mold.\nAllow the solution in the mold to sit unperturbed at room temperature until the solution has set and hardened into a solid.\n\tNOTE: While wait times may vary depending on the volume of solution and other factors, 2 h is found to be a reliable wait time.\nUse a spatula to gently remove the gel model from the mold. Be strategic with the location of spatula insertion into the mold in order to prevent potential deformations to the surface of the mold.\nTo slow the natural evaporation process and exposure to biological agents, place the gel model in a sealed container in a refrigerator.\n10. Injection into agarose gel model\nPrepare the pump for infusion and fix it in a stereotaxic arm on a stereotaxic frame (Table of Materials). Position the pump to the correct injection trajectory and location normal to the surface of the gel model from section 9.\nFill a 250 µL syringe (Table of Materials) with DI water. Mount the syringe onto the pump (Table of Materials).\n\tNOTE: Before drawing any dye, DI water should fill the injection cannula (Table of Materials) completely. That way when the dye is drawn up through the cannula there is no compression or expansion of air by the plunger that might impact the injection volume.",
    "Use the pump driver (Table of Materials) to withdraw the food coloring (Table of Materials) into the syringe to the target volume for injection. Inject the food coloring slowly until a small bead forms at the tip of the cannula to prevent air bubbles from being injected into the gel. Dry the bead off the tip of the cannula.\nPosition the gel model under the cannula. Lower the cannula until the tip touches the surface of the gel model. Note the measurements on the stereotaxic arm.\nLower the cannula into the gel model quickly and smoothly to the target injection depth and ensure that the surface of the gel has sealed around the cannula.\nRun the pump and observe the spread of the food coloring until the target volume is injected. Start with a flowrate of 1 µL/min and increase to 5 µL/min with 1 µL/min steps every minute. The spread of the food coloring in the gel is an approximation of the spread of a viral vector in the brain.\nRemove the cannula from the gel quickly and smoothly.\nCapture images of the spread of the food coloring with a photographic device (Table of Materials) and physically measure the dimensions of the embolism in order to calculate the ellipsoid volume of the injection. This approach is possible due to transparent nature of the gel.\nSubscription Required. Please recommend JoVE to your librarian."
  ],
  "subjectAreas": [
    "Bioengineering"
  ],
  "bigAreas": [
    "Bioengineering & Technology"
  ]
}