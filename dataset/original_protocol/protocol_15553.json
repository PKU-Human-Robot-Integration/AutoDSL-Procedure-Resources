{
  "id": 19379,
  "origin_website": "Jove",
  "title": "Closed-Loop Neurostimulation for Biomarker-Driven, Personalized Treatment of Major Depressive Disorder",
  "procedures": [
    "This protocol has been reviewed and approved by the University of California, San Francisco Institutional Review Board.\n1. Device setup for patient at-home recordings\nWork with a representative from the device company to set four configured channels for acquisition, two from each implanted lead.\n\tNOTE: Each channel records a bipolar recording. Configured channels may use adjacent (e.g., 1-2, 3-4) or interleaved (e.g., 1-3, 2-4) electrode contacts. When leads with 10 mm spacing are implanted, adjacent contacts are typically used. When leads with 3.5 mm spacing are implanted, either adjacent or interleaved contacts are used. This is determined by examining the reconstruction of electrode implant location relative to anatomical targets and examining the amplitude of signals. If adjacent contacts produce low amplitude signals, interleaved contacts are preferable. Each contact can only be used in the montage once.\nEnsure the patient has fully recovered from surgery following the implantation of the device with cortical and/or depth leads (see24 for additional information on implantation technique).\nConnect the telemetry wand to the programmer (clinician tablet) and have the patient hold the wand over their INS or attach it to a tethering hat (custom-made, not part of the device system; see Figure 1).\nUsing the programmer, log on to the patient data management system (PDMS; https://pdms.neuropace.com/login.php), navigate to the correct patient, and select Programming and then Change ECoG Capture. Set the Capture Window to the maximum of 240 s for the four configured channels using the dropdown selection.\n\tNOTE: The device sampling rate is 250 Hz.\nOn the same settings page, set Reserve Space for magnet reservations to two and to zero for all other trigger types using the dropdown selections. This allows for prioritized saving of two recordings triggered by magnet swipes.",
    "NOTE: Scheduled storage can also be enabled, for automatic and non-prioritized saving of neural recordings at set times of day. These recordings will not be used for determining a biomarker but may be useful for other purposes.\nSynchronize the newly programmed settings with the patient's INS by selecting the Review & Program button, confirming changes shown in the presented table, and selecting the Confirm Programming button.\n\t​NOTE: Detection and Stimulation should both be set to Disabled.\n2. Symptom collection during patient at-home recordings\nPrepare the web-based survey for the patient symptom report (e.g. REDCap25), including sliders for VAS-D, VAS-A, VAS-E, and selection responses for each question of the HAMD-6. Ensure the time of survey start and completion is logged.\nProvide the patient with the unique URL generated by REDCap to access the symptom surveys either via text message or email\n3. Procedure for concurrent at-home symptom reports and neural recordings\nInstruct the patient to set up the equipment, including a remote monitor (patient laptop) and wand, magnet, and device for completing survey (e.g. smartphone, tablet, or computer) (Figure 1). Steps 3.2-3.8 are performed by the patient.\n\tNOTE: Most patients quickly learn this procedure. In-person training sessions while the patient is still in the hospital following device implantation are helpful for familiarization with the components. After the patient has returned home, a video call while the patient is doing an at-home recording can serve as a useful refresher.\nTurn on the remote monitor and interrogate the device using the wand, downloading electrocorticography (ECoG) recordings that have occurred since the last interrogation to the remote monitor.\nSwipe the magnet over the INS to trigger a magnet recording.",
    "NOTE: The magnet swipe triggers a recording with a 2:1 before:after the swipe ratio. In the case of an ECoG capture that is programmed to 240 s, this means that 160 s of data prior to the swipe and 80 s following the swipe will be stored.\nStart a timer. Use the unique URL to complete a symptom survey.\nAfter 4 min have elapsed or the patient finishes the survey (whichever happens later), swipe the magnet over the INS again to trigger another recording.\nAfter at least 80 s, use the wand to interrogate the device again, transferring the data from the two magnet swipes to the remote monitor.\n\tNOTE: Due to the limited on-board memory of the INS (up to 53 channel-minutes of data, depending on configuration13), it is desirable to immediately transfer these ECoG recordings to the remote monitor so that they are not overwritten by subsequent recordings.\nComplete steps 3.1-3.6 at least twice daily.\nAt least once daily, connect the remote monitor to the internet via ethernet and select Transfer Data and Synchronize on the remote monitor to send data to the cloud.\nimgsrc://cloudfront.jove.com/files/ftp_upload/65177/65177fig01.jpg\nFigure 1: Patient equipment for at-home recordings. A remote monitor, wand tethered to a hat, magnet, and smartphone with REDCap survey. Inlaid images show right OFC (blue) and right SGC (orange) electrode implant locations superimposed on a white-matter nulled 1 mm isotropic T1 sequence from the preoperative magnetic resonance imaging (MRI). The depicted coronal slice is in the plane of the deepest contact, so the other contacts may not be centered on this exact slice (due to the fact that the electrode trajectory is not in the coronal plane). Please click here to view a larger version of this figure.[href=https://www.jove.com/files/ftp_upload/65177/65177fig01large.jpg]\n4. Determining a personalized biomarker",
    "Create a dataframe of self-reported symptom survey responses (e.g. JOVE.PR03_Symptoms.pkl).\nCalculate spectral power profiles for each channel of ECoG recording by convolving ECoG activity with a family of Morlet wavelets (40 kernels, 12 cycles, log-spaced between 1-120 Hz), creating a new dataframe (e.g., JOVE.PR03_NeuralPower.pkl).\nAssociate ECoG recordings with symptom reports that occurred within a time window spanning 5 min before to 5 min after initiation of the symptom report, using the trial_id field in the NeuralPower dataframe.\nIdentify symptom states (Figure 2)\n\t\nUsing Python 3.10, install requirements listed in the requirements.txt file (Supplementary Folder 1) to a new environment. This can be done using pip install -r requirements.txt.\nOpen JOVE-Symptom_State_and_Biomarker_Analysis.ipynb (Supplementary Folder 1) using the Jupyter Notebook.\nVerify the kernel is set to the environment into which requirements.txt were installed and run JOVE-Symptom_State_and_Biomarker_Analysis.ipynb.\n\t\tNOTE: JOVE-Symptom_State_and_Biomarker_Analysis.ipynb calculates the statistical similarity between scores on patient surveys using the cosine similarity metric, which ranges from 0 (no similarity) to 1 (identical) and constructs a symptom state graph by aggregating the similarity values across all possible pairs of at-home patient symptom reports. Spectral power features for each symptom state are calculated by aggregating spectral power profiles associated with each inferred symptom state; this procedure yields a distribution of spectral power profiles linked to each symptom state (Figure 3).\nIn scenarios where more than two symptom states are identified, the distributions of spectral power corresponding to the most severe symptom state and the least severe symptom state are statistically compared.\nUse a cluster-based permutation t-test to identify spectral frequencies in which the spectral power of the severe symptom state is significantly greater than the spectral power of the least severe symptom state. The range of contiguous spectral frequencies that differentiate the symptom states is considered as a single candidate biomarker.\nimgsrc://cloudfront.jove.com/files/ftp_upload/65177/65177fig02.jpg",
    "Figure 2: Schematic of the methodological approach for measuring symptom states, showing results from a representative example. Patient self-reported surveys are obtained and itemized symptom scores are normalized to a range between 0 and 1 (darker colors reflect lower symptom severity and brighter colors reflect higher symptom severity). (1) Each completed survey represents a snapshot in time of the patient's symptoms and is represented as a point (black) in high-dimensional space. (2) Time points are linked together in a symptom survey graph, which relates the cosine similarity between survey reports (lines between points). (3) Graph community detection assigns each time point to a community or symptom state (colored points and lines) based on the pattern of graph connections. (4) Symptom severity scores are averaged according to state assignment and provide a general symptom phenotype for each state. (5) The occurrence of each state may be tracked over time as a raster plot (vertical lines reflect a symptom report assigned to one state). Please click here to view a larger version of this figure.[href=https://www.jove.com/files/ftp_upload/65177/65177fig02large.jpg]\n5. Programming device detector settings\nUsing the programmer, log on to the PDMS and select the correct patient, Programming, and Change Detection.\nBased on the selected personalized biomarker, select the correct channel for detecting activity.\n\t\nWhen creating a Pattern for the first time, first select an ECoG by clicking on one from those shown below, a channel chosen from that ECoG, and a time period highlighted.\nWhen creating a pattern from a preexisting one, change the channel by clicking on Pattern and selecting the Change Channel button.\nFor Detect, select Rhythmic Activity, which connotes a bandpass detector.",
    "Click More Controls and Adv Settings. Select the desired minimum frequency and maximum frequency. Ensure the settings are as follows: Bandpass: On; Line Length: Off; Area: Off; Inversion Logic: Not Inverted.\nProgram the Min Amplitude and Minimum Duration for the detector. Start with a minimum amplitude of 0.8% and a minimum duration of 0.64 s (equivalent to a Bandpass Threshold of five and Detect Analysis Window Size of 1280 ms).\n\tNOTE: Min Amplitude is a percentage of the total signal amplitude that the detected activity must exceed. Only amplitudes above this threshold can be used for detection. Minimum Duration is how long the high amplitude signal must be sustained. This is tracked as a count of fixed-duration time bins. Specifically, x of y 128 ms time bins must meet these criteria, where x is Bandpass Threshold and y is [Detect Analysis Window Size/128], as displayed in Technical Parameters. An episode (i.e. triggering of the detector) must be exited before a subsequent trigger can occur. Some settings may be too sensitive and result in staying in one episode indefinitely, thereby preventing subsequent triggers.\nOnce all the detector settings are selected, click Done to close all the programming windows.\n\tNOTE: Multiple detectors can be programmed; detection can be triggered based on AND/OR logic between these detectors. Start with one detector to understand the behavior before introducing a second detector.\nWith the wand placed over the patient's INS, select Review & Program and click through the confirmation messages to initialize this detector setting.\n6. Titrating device detector settings",
    "After the device detector has been programmed and initialized on the device, conduct test recordings to assess if the sensitivity of the detector should be adjusted to achieve the desired triggering frequency. This can be achieved using Live ECoGs or the interrogation report. Adjustments to the sensitivity of the detector are determined empirically based on patient symptom reports, side effects, and outcomes. These adjustments may be needed throughout the course of treatment. Per day, 30 min of stimulation can be used as a conservative starting point to assess the clinical efficacy while also preserving battery life.\nLive ECoGs\n\t\nWith the wand placed over the patient's INS, select Live ECOGs on the programmer.\nDuring the live recording, count the number of detections that occur for the duration of the recording. This provides an indication of how often the detector will trigger.\n\t\tNOTE: Some detectors may be state-dependent, particularly detectors set to low frequencies (e.g., more active during periods of sleep or drowsiness). Thus, live recordings have limitations for estimating how often a detector may trigger. Live recordings may also suffer from electromagnetic interference (e.g., line noise) or poor wand positioning.\nInterrogation report\n\t\nMinutes to hours after setting the detector, place the wand over the patient's INS to interrogate the device.\nIn the PDMS, navigate to Activity, select Event List, and click on Initial Interrogation from the time of the recording. The table at the bottom provides a list, with times, of all the detection events. This document can be exported in pdf format and parsed for quantification.",
    "Based on the number of detections per unit time recorded versus the desired density of stimulation, adjust the detector duration and amplitude parameters if needed. Be sure to click on Review & Program after each set of changes to initialize these on the patient's INS.\n7. Programming device stimulation settings\nUsing the programmer, log on to the PDMS and select the correct patient, Programming, and Change Stimulation.\nSelect the desired lead contacts or Can (INS) to be anode(s) and cathode(s). Select the desired stimulation current, pulse width, duration, and frequency.\n\tNOTE: Up to five stimulation therapies can be programmed; each therapy comprises two bursts of stimulation, which can be programmed to be the same or different. A given detector trigger can lead to a variable number of stimulation therapies, depending upon the sustained duration of the episode. Only program Therapy 1, with both bursts having the same parameters, which will lead to a consistent duration of stimulation being delivered each time the detector is triggered. In this configuration, the total duration of stimulation delivered when the detector is triggered will be the sum of Stim 1 Burst 1 and Stim 1 Burst 2. If multiple therapies are programmed and delivered, a maximum of five therapies can be delivered during a given episode. The episode must be exited and a new episode triggered in order for subsequent stimulation to be delivered.\nIf desired to limit the total amount of stimulation delivered per day, select a value for Therapy Limit per Day and a Therapy Limit Reset Time.\n\tNOTE: The Therapy Limit Reset Time timezone is set to the patient's primary center. If patients have relocated, this may be different than the patient's home time zone.",
    "Specifically, if no overnight stimulation is desired, set the Therapy Limit per Day and Therapy Limit Reset Time such that the detector achieves the therapy limit between the reset time and the patient's bedtime.\nWith the wand placed over the patient's INS, select Review & Program and click through the confirmation messages to initialize the stimulation settings.\nSubscription Required. Please recommend JoVE to your librarian."
  ],
  "subjectAreas": [
    "Neuroscience"
  ],
  "bigAreas": [
    "Biomedical & Clinical Research"
  ]
}