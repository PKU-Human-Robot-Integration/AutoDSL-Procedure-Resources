{
  "id": 1787,
  "origin_website": "Cell",
  "title": "Generation of RNA sequencing libraries for transcriptome analysis of globin-rich tissues of the domestic dog",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nFigure 1[href=https://www.wicell.org#fig1] shows the schematic overview of the method.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1238-Fig1.jpg\nFigure 1. Overview of the library preparation with the required primers\nTemplate RNA is mixed with ERCC Spike-in RNA, which is added equally to each sample for normalization, and with globin-LNA primers, which hybridize to the sequence adjacent to poly-A+ tail of globin mRNA thus blocking its’ transcription. First-strand cDNA synthesis occurs using an oligo(dT) primer with the addition of 3-6 cytosines. Oligo TSO-8UMI promotes template switching, which introduces UMIs into the cDNA. The cDNA is amplified, and the well specific barcodes are introduced at the 5′end. The samples are then pooled and ligated to an adapter cassette. The 5′end is further amplified for sequencing. QC1 to QC3 show the steps where a sample is taken for quality control.\nGlobin-Lock® and reverse transcription with template switching\nTiming: 2 h\nBefore starting, get your cycler ready for the STRT-GL reaction at 80°C.\nMix 2 μL RNA 20 ng/μL (47 samples) and 2 μL Buffer A-GL Master mix on each sample well on VersiPlate.\nFor negative control, mix 2 μL H2O with 2 μL buffer A-GL Master mix.\nSeal the plate and spin drops down (1 min at 1500 × g).\nProceed to the RNA denaturation step and leave the plate at 40°C on hold, until you are ready with step 6.\nPrepare RT mixture of 90 μL Buffer B-GL Master mix and 30 μL Buffer C Master mix per one library (48 wells) and add 1 μL Spike-In (1:100 dilution) per one library.\nAdd 2 μL RT mixture to each well on 40°C. Total volume in each well is now 6 μL. Mix by pipetting up and down several times.\nContinue with STRT-GL reaction.\ntable:files/protocols_protocol_1238_11.csv\nSpin down (1 min at 1500 × g).",
    "Note: To avoid evaporation of the small reaction volume, we recommend using low-profile VersiPlates. However, you need to check the compatibility of the plates with your thermocycler. We are using Bio-Rad T100 Thermal Cycler with PCR plate Pressure Pad to ensure tight sealing of the lid.\nIntroduction of barcodes and full transcript amplification\nTiming: 2 h\nKeep the reaction plate on ice and add 2 μL well-specific barcoded primer (10 μM) to each sample.\nMake the following PCR master mix.\ntable:files/protocols_protocol_1238_12.csv\nPipette 13 μL PCR Master mix to each well in the reaction plate and mix by pipetting up and down several times.\nSeal the the plate and move to post-PCR area.\nStart the PCR program STRT-P1.\ntable:files/protocols_protocol_1238_13.csv\nSample pooling and purification\nTiming: 30 min\nSpin the plate (1 min at 1500 × g). Pool the samples from all the wells into one 1.5 mL LoBind tube.\nPurify the content with PCR Clean-up column (NucleoSpin Gel and PCR Clean-up/Macherey-Nagel) according to manufacturer’s instructions. https://www.mn-net.com/media/pdf/02/1a/74/Instruction-NucleoSpin-Gel-and-PCR-Clean-up.pdf[href=https://www.mn-net.com/media/pdf/02/1a/74/Instruction-NucleoSpin-Gel-and-PCR-Clean-up.pdf]\nAlternatives: You can also use equivalent kit for clean-up from other suppliers; however, we have not tested the impact of alternatives on protocol performance.\nElute with 32 μL elution buffer from the kit into a clean 1.5 mL LoBind tube.\nTake 2 μL aside for TapeStation (HS D1000) for first quality control (sample QC-1).\n30 μL is left for the next step.\nKeep the QC-1 sample on ice or at −20°C until you are ready with your QC-2 sample (step 26) and analyze them simultaneously.\nPause point: The sample can be stored at −20°C up to 1 month.\nFragmentation of full-length cDNA\nTiming: 30 min",
    "Mix AMPure XP beads well. (You should have homogenous brown solution and no bead precipitates. It is recommended to take an aliquot of 200–500 μL into a 2 mL tube and mix by vortexing before each use.)\nAdd 24 μL AMPure XP beads to the 30 μL cDNA tube (from step 18). Mix well by vortexing and keep 10 min at 20°C–22°C.\nPlace the tube on the magnetic stand for at least 3 min or until the supernatant is clear and discard the supernatant.\nRemove the tube from the magnetic rack and re-suspend the beads in 100 μL EB. Wait for at least 1 min.\nCapture the beads on a magnet and transfer the supernatant (100 μL, containing the cDNA) into a clean 1.5 mL LoBind tube.\nShear the amplified cDNA with Covaris Focused ultrasonicator (or compatible), using 130 μL microtubes. Set the parameters to produce 300 bp fragments according to the manufacturer’s protocol. https://www.covaris.com/protocols/?sku=500295[href=https://www.covaris.com/protocols/?sku=500295]\nPurify and concentrate the fragmented product with PCR Clean-up column (NucleoSpin Gel and PCR Clean-up). Elute with 32 μL elution buffer from the kit into a clean 1.5 mL LoBind tube.\nTake 2 μL aside for TapeStation for the second quality control step (sample QC-2). 30 μL is left for the next step.\nPause point: The sample can be stored at −20°C for up to 1 month.\nAnalyze the QC-1 (from step 18) and QC-2 samples (from step 26) with Tape Station before proceeding with the protocol. See Figure 2[href=https://www.wicell.org#fig2] for expected analysis results. Typical concentrations are:\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1238-Fig2.jpg\nFigure 2. Library quality control with TapeStation",
    "In QC1, after amplification of the full-sized cDNA, you should see variation of transcript sizes (from about 200 bp to >2000 bp). In QC2, the cDNA has been fragmented to size around 300 bp. In QC3 after further amplification, size selection and purification, sharper peak around 300 bp should be visible.\nQC-1: 5–50 ng/μL\nQC-2: 2–20 ng/μL\nIf the analysis results are as expected, proceed to the next step. Troubleshooting 1[href=https://www.wicell.org#sec7.1] and 2[href=https://www.wicell.org#sec7.3].\nEnd-repair, adapter ligation and 5′end amplification\nTiming: 4 h\nCritical: In the following enzymatic steps, incubations are performed with cDNA bound to beads; gentle mixing of the reaction tube is required to avoid sinking of the beads to the bottom of the tube. We have used Eppendorf ThermoMixer C, but equivalent thermal mixer from other suppliers can also be used.\nAlternatives: If you do not have a thermal mixer, the mixing can be done manually by pipetting at 10 min intervals to disperse the beads.\nWash Dynabeads MyOne C1 Streptavidin beads as follows:\nTake 12 μL MyOne C1 Streptavidin beads in a 1.5 mL LoBind tube.\nCapture the beads using a magnet, and withdraw the supernatant from the tube.\nRemove the tube from the magnetic rack and re-suspend the beads in 200 μL 2×BP buffer. Capture the beads and remove the supernatant.\nRepeat step 28c. once more.\nRe-suspend the beads in 30 μL 2×BP buffer.\nMix the washed beads (30 μL) and the fragmentized cDNA (30 μL, from step 26) in a 1.5 mL LoBind tube. Final concentration of the binding buffer will be now 1xBP.\nIncubate 20 min on 500 rpm in thermal mixer at 20°C–22°C.\nPlace the tube on a magnetic rack until the beads clearly separate from the liquid (1–3 min). Discard the supernatant and remove the tube from the magnetic rack.",
    "Add 200 μL of EB buffer. Re-suspend the beads thoroughly by pipetting, and then place the tube again on a magnetic stand (1–3 min).\nDiscard the supernatant and re-suspend the beads in 16 μL buffer EB.\nAdd the following reagents:\ntable:files/protocols_protocol_1238_14.csv\nIncubate 20 min in a thermal shaker on 500 rpm at 20°C–22°C.\nPlace the tube on a magnetic rack for 1–3 min and withdraw the supernatant from the tube. Remove the tube from the magnetic rack and re-suspend the beads in 200 μL EB.\nRepeat step 36 once more.\nPlace the tube on a magnetic rack for 1–3 min and withdraw the supernatant.\nRe-suspend in 17 μL EB. Add the following reagents:\ntable:files/protocols_protocol_1238_15.csv\nIncubate 20 min in a thermal shaker on 500 rpm at 37°C.\nPlace the tube on a magnetic rack for 1–3 min and withdraw the supernatant from the tube. Remove the tube from the magnetic rack and re-suspend the beads in 200 μL EB.\nRepeat step 40 once more.\nPlace the tube on a magnetic rack for 1–3 min and withdraw the supernatant.\nRe-suspend in 18 μL EB. Add the following reagents:\ntable:files/protocols_protocol_1238_16.csv\nMix gently by pipetting. Do not vortex. Incubate 60 min at 20°C–22°C and mix every 15 min during the incubation by pipetting gently up and down.\nPlace the tube on a magnetic rack for 1–3 min and withdraw the supernatant from the tube. Remove the tube from the magnetic rack and re-suspend the beads in 200 μL EB.\nRepeat step 46 twice more.\nPlace the tube on a magnetic rack for 1–3 min and withdraw the supernatant.\nRe-suspend the beads in 20 μL EB.\nTransfer the solution with the beads into a 0.2 mL PCR tube. Add the following reagents and start the KIN-P2 program.\ntable:files/protocols_protocol_1238_17.csv\ntable:files/protocols_protocol_1238_18.csv",
    "Transfer the reaction into a 1.5 mL LoBind tube and capture the streptavidin beads. Collect the supernatant, 50 μL in volume, which now contains the PCR product, and transfer it into a clean tube.\nAdd 45 μL AMPureXP beads. Mix well by vortex.\nIncubate 10 min at 20°C–22°C and place the tube on the magnetic stand for at least 3 min or until the supernatant is clear.\nDiscard the supernatant. Spin 10 s on a mini-centrifuge (or 11,000 × g on a table top centrifuge) to collect drops.\nPlace back on magnet and remove all the traces of supernatant.\nResuspend the beads in 20 μL EB.\nWait for 1–3 min and place on magnet.\nTransfer the clear supernatant (ready library) to a clean 1.5 mL LoBind tube.\nTake 2 μL for TapeStation for final quality control (sample QC-3).\nStore the ready library at −20°C.\nPause point: The ready library can be stored at −20°C for up to 6 month.\nLibrary quality control and concentration\nTiming: 2 h\nAnalyze the QC-3 sample (from step 59) with TapeStation D1000 ScreenTape system. See Figure 2[href=https://www.wicell.org#fig2] for expected analysis results.\nDetermine the concentration of the library with the KAPA Library Quantification Kit. (https://pim-eservices.roche.com/eLD/api/downloads/ca670ceb-fb38-eb11-0291-005056a71a5d?countryIsoCode=pi[href=https://pim-eservices.roche.com/eLD/api/downloads/ca670ceb-fb38-eb11-0291-005056a71a5d?countryIsoCode=pi]).\nThe typical concentration for the ready library is 2–30 nM. Troubleshooting 3[href=https://www.wicell.org#sec7.5].\nCritical: Accurate molar concentration of the library is required to determine how much to load for sequencing. You can determine the concentration from the QC3 sample with TapeStation, however, we have measured it also using KAPA Library Quantification Kit. If there is a difference between the two measurements, we have relied on the result from the KAPA Kit.\nSequencing\nWe have sequenced the libraries with NextSeq 500 using High Output v2 kit, 75 cycles. Sequencing was done with custom primer STRT2seq (Table 1[href=https://www.wicell.org#tbl1]).",
    "Library loading concentration was 2.0 pM and we have added PhiX to 20%.\nSequence data processing\nTiming: typically up to 1 day, depending on the sequencing depth and size of the library\nThis section describes the bioinformatics pipeline processing the STRT sequencing data from Illumina Base Call Format (.bcl), including demultiplexing, mapping, quality check, and quantification. For a detailed analysis process and settings, the pipeline can be accessed at: https://github.com/my0916/STRT2[href=https://github.com/my0916/STRT2].\nInstall the STRT2 pipeline from the GitHub repository. Type the following command in the terminal window and hit the enter key.\ngit clone https://github.com/my0916/STRT2.git[href=https://github.com/my0916/STRT2.git]\nInstall the dependencies.\nMandatory software are listed below. The following versions were used by the authors in preparing this protocol, while different versions may work correctly.\nPicard (v2.23.4)\nHISAT2 (v2.2.1)\nSAMtools (v1.10)\nBedtools (v2.29.2)\nSubread (v2.0.0)\nR (v4.0.0)\nRuby (v2.6.2)\nSoftware required for the optional tools are listed below. The following versions were used by the authors in preparing this protocol, while different versions may work correctly.\nStringTie (v2.1.4)\nFastQC (v0.11.8)\nMultiQC (v1.9)\nAlternatively, conda environment can be created from condaEnv.yml with the following commands. Please make sure that Anaconda or Miniconda is installed.\nconda env create -f condaEnv.yml\nconda activate STRT2_env\nFor Swedish UPPMAX (https://www.uppmax.uu.se/[href=https://www.uppmax.uu.se/]) users, these software are available through the module command in the scripts (STRT2-UPPMAX.sh, STRT2-TFE-UPPMAX.sh, and fastq-fastqc-uppmax.sh).\nPrepare the index and dictionary before running the pipeline. Details are described in https://github.com/my0916/STRT2#How-to-build-HISAT2-index[href=https://github.com/my0916/STRT2]. Here we describe the case for the dog genome canFam3.\nObtain the genome sequences of reference and ERCC spike-ins.\nwget http://hgdownload.cse.ucsc.edu/goldenPath/canFam3/bigZips/canFam3.fa.gz[href=http://hgdownload.cse.ucsc.edu/goldenPath/canFam3/bigZips/canFam3.fa.gz]\nunpigz -c canFam3.fa.gz | ruby -ne ‘$ok = $_ !∼ /ˆ>chrUn_/ if $_ =∼ /ˆ>/; puts $_ if $ok’> canFam3_reference.fasta\nwget https://www-s.nist.gov/srmors/certificates/documents/SRM2374_putative_T7_products_NoPolyA_v2.FASTA[href=https://www-s.nist.gov/srmors/certificates/documents/SRM2374_putative_T7_products_NoPolyA_v2.FASTA]\ncat SRM2374_putative_T7_products_NoPolyA_v2.FASTA >> canFam3_reference.fasta",
    "Extract splice sites and exons from a GTF file using the Python scripts implemented in HISAT2 (v2.1.0) (Kim et al., 2019[href=https://www.wicell.org#bib5]). Here Ensembl transcript map (canFam3.transMapEnsemblV4.gtf.gz) was downloaded from the UCSC Table Browser.\nunpigz -c canFam3.transMapEnsemblV4.gtf.gz | hisat2_extract_splice_sites.py - | grep -v ˆchrUn> canFam3.ss\nunpigz -c canFam3.transMapEnsemblV4.gtf.gz | hisat2_extract_exons.py - | grep -v ˆchrUn> canFam3.exon\nBuild the HISAT2 index of the reference genome and ERCC Spike-in RNAs with the hisat2-build function, which outputs a set of files with the suffix ‘.ht2’.\nhisat2-build canFam3_reference.fasta --ss canFam3.ss --exon canFam3.exon canFam3_reference\nCreate the sequence dictionary for the reference and Spike-in sequences with Picard (v2.23.4) (http://broadinstitute.github.io/picard/[href=http://broadinstitute.github.io/picard/]) CreateSequenceDictionary.\njava -jar picard.jar CreateSequenceDictionary R=canFam3_reference.fasta O=canFam3_reference.dict\nRun the STRT2 pipeline with the following command. Please make sure that barcode sequence with barcode name (Table 2[href=https://www.wicell.org#tbl2]) is prepared as barcode.txt.\n./STRT2.sh -o {output} -g {reference_genome} -a {annotation}\\\n-b {path/to/BaseCalls} -i {path/to/index} -c {Sequencing_center}\\\n-r {Run_barcode}\nWherein: {output} defines the prefix of output files. {reference_genome} is the reference genome such as canFam3. {annotation} is the gene annotation used for quality check and counting. For canFam3, ref (RefSeq) or ens (Ensembl) can be chosen. See also the GitHub repository’s README.md file for details. {path/to/BaseCalls} is the path to the Illumina basecalls directory. {path/to/index} is the directory and basename of the HISAT2 index for the reference genome. {Sequencing_center} is the name of the sequencing center that produced the reads. {Run_barcode} is the barcode of the run. Prefixed to read names.\nNote: In this case, set the parameters ‘--genome canFam3’ and ‘--annotation ens’. In the default settings, the annotation for quality check and quantification is set to RefSeq.\nDetails of the pipeline are as follows.\nThe raw base call (BCL) files are demultiplexed with Picard ExtractIlluminaBarcodes and IlluminaBasecallsToSam to generate unaligned BAM files based on the well-specific barcodes (Table 2[href=https://www.wicell.org#tbl2]).",
    "The unaligned BAM files are converted to FASTQ files with Picard SamToFastq and aligned using HISAT2 to the dog reference genome (canFam3) and ERCC Spike-in RNAs (SRM 2374) [NIST SRM 2374 Certificate of Analysis, https://www-s.nist.gov/srmors/certificates/2374.pdf[href=https://www-s.nist.gov/srmors/certificates/2374.pdf], 2013.] with the Ensembl transcript map provided by UCSC (transMapEnsemblV4) as a guide of exon junctions.\nThe aligned BAM files are merged with the original unaligned BAM files to create a unique molecular identifier (UMI)-annotated BAM files by Picard MergeBamAlignment.\nThe UMI-annotated BAM files corresponding to each sample derived from 4 lanes are merged using Picard MergeSamFiles, and potential PCR duplicates are marked with Picard Markduplicates.\nFor quality check, the resulting BAM files per sample are indexed, and then all the qualified reads, reads without potential duplicates, and total mapped reads are counted based on SAM flags using SAMtools (v1.9) (Li et al., 2009[href=https://www.wicell.org#bib7]). In addition, reads mapped to protein-coding genes and Spike-in RNAs, as well as 5′-ends of them, are counted using BEDtools (v2.29.2) (Quinlan and Hall. 2010[href=https://www.wicell.org#bib10]). Values of i) log10 of total mapped read counts, ii) mapping rates, iii) log10 of Spike-in RNA read counts, iv) ratios of total mapped read counts versus Spike-in RNA read counts, v) 5′-end capture rates of Spike-in RNAs, and vi) 5′-end capture rates of protein-coding genes are plotted with the R (v4.0.0) (R core Team, 2020[href=https://www.wicell.org#bib11]) package ggplot2 (v3.3.3) (Wickham and Grolemund 2016[href=https://www.wicell.org#bib13]), marking the outlier samples with the barcode numbers. In Figure 2[href=https://www.wicell.org#fig2], globin mRNA rates were calculated by dividing the reads mapped to hemoglobin alpha and beta (HBA and HBB) genes by all the qualified reads per sample.",
    "For quantification, Subread featureCounts (v2.0.0) (Liao et al., 2014[href=https://www.wicell.org#bib8]) is used to assign the reads to 5′-end of genes with parameters ‘-s 1 --largestOverlap --ignoreDup --primary’. Here, uniquely mapped reads within the 5′- UTR or 500 bp upstream of the protein-coding genes and the first 50 bp of Spike-in sequences are counted.\nOptional: In addition, one can perform TFE (transcript far 5′-end)-based analysis originally developed in Töhönen et al. (2015)[href=https://www.wicell.org#bib12], by running STRT-TFE.sh or STRT2-TFE-UPPMAX.sh. Here, TFEs are defined as the first exon (5′-end region) of assembled STRT reads mapped to the genome using StringTie (v2.1.4) and assigned with unique IDs. TFE-level reads are also quantified as described above. Details are described in the GitHub repository’s TFE-README.md.\nNote: If TFE-based analysis is planned, add the option ‘--dta’ (downstream-transcriptome-assembly) for STRT2.sh or STRT2-UPPMAX.sh, which is required in the HISAT2 mapping process, that helps the transcript assembly by StringTie.\nOptional: After running the pipeline above, one can generate fastq files for each sample from the output BAM files in the fastq directory by running fastq-fastQC.sh or fastq-fastQC-UPPMAX.sh. These fastq files (without duplicated reads) can be submitted to public sequence databases. FastQC files are also generated for each fastq file in the fastqc directory. Based on the FastQC results, MultiQC report (MultiQC_report.html) is generated."
  ],
  "subjectAreas": [
    "Genomics",
    "Rnaseq",
    "Sequence Analysis",
    "Bioinformatics",
    "Molecular Biology",
    "Gene Expression",
    "Sequencing",
    "Model Organisms"
  ],
  "bigAreas": [
    "Molecular Biology & Genetics",
    "Bioinformatics & Computational Biology"
  ]
}