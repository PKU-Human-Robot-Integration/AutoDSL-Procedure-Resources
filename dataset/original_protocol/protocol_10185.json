{
  "id": 10596,
  "origin_website": "Jove",
  "title": "Outer-Boundary Assisted Segmentation and Quantification of Trabecular Bones by an Imagej Plugin",
  "procedures": [
    "Procedures involving animal subjects were conducted in accordance with the Guide for the Care and Use of Laboratory Animals (NIH publication, 8th edition, 2011), and have been reviewed and approved by the Institutional Animal Care and Use Committee of Wuhan University.\n1. Software Installation\nInstall ImageJ software. Download the Windows version of the ImageJ (version 1.51p) software bundled with 64-bit Java from https://imagej.nih.gov/ij/. Extract the downloaded software into a folder, which will be subsequently referred to as the \"ImageJ Directory\".\n\tNOTE: Trabecular analysis plugins require 64-bit java run time (version 1.8) and a 64-bit windows operating system, preferably a 64-bit Windows 7 operating system.\nInstall trabecular analysis plugins. Request trabecular analysis plugins from http://www.bomomics.com, and unzip the contents into ImageJ's plugins directory, which is \"ImageJ Directory/plugins\".\n\tNOTE: The plugin can be obtained either as a free version, where the measurements for 5 specified adjacent slices are reported, or as a commercial version, where a range of slices can be specified and measured.\n2. Prepare 3D Dataset for Trabecular Analysis\nScan rat femurs with a micro-CT machine following the standard scanning protocol5 and then save the data in a format that can be imported into ImageJ, e.g., tiff format. If multiple bone samples were scanned simultaneously in a single sample tube, first import the data into ImageJ, and then separate each individual bone by cropping off other samples using ImageJ's image processing tools. Subsequently, save the resulting image in a format that can be imported into ImageJ later.\n\tNOTE: A representative sample image file used in the analysis is included (Supplementary File 1).\nSimulate standard 2D and 3D objects.",
    "Open ImageJ software. Under the Plugins | BoMomics | Simulate Objects menu, click the Circle button, and enter 200 as the diameter in the popup window, then click OK to generate the simulated circle with a diameter of 200 pixels (Figure 3B). Save the generated circle in tiff format.\nOpen ImageJ software. Under the Plugins | BoMomics | Simulate Objects menu, click the Square button, and enter 200 as the side length in the popup window, then click OK to generate the simulated square with a side length of 200 pixels (Figure 3B). Save the generated square in tiff format.\nOpen ImageJ software. Under the Plugins | BoMomics | Simulate Objects menu, click the Rectangle button, and enter 200 as the width and 100 as the height in the popup window, then click OK to generate the simulated rectangle with a width of 200 pixels and a height of 100 pixels (Figure 3B). Save the generated rectangle in tiff format.\n\t\tNOTE: A circle (diameter: 200 pixels), a square (side length: 200 pixels), and a rectangle (width: 200 pixels; height: 100 pixels) are saved for the subsequent analyses.\nOpen ImageJ software. Under the Plugins | BoMomics | Simulate Objects menu, click the Cube button, and enter 30 as the side length in the popup window, then click OK to generate the simulated cube. Finally, click the Plugins | 3D | Volume Viewer to view the generated cube and save it in tiff format (Figure 3C).",
    "Open ImageJ software. Under the Plugins | BoMomics | Simulate Objects menu, click the Cuboid button, and enter 80 as the length, 40 as the width, and 30 as the height in the popup window, then click OK to generate the simulated cuboid. Finally, click the Plugins | 3D | Volume Viewer to view the generated cuboid and save it in tiff format (Figure 3C).\nOpen ImageJ software. Under the Plugins | BoMomics | Simulate Objects menu, click the Sphere button, and enter 30 as the diameter in the popup window, then click OK to generate the simulated sphere. Finally, click the Plugins | 3D | Volume Viewer to view the generated sphere and save it in tiff format (Figure 3C).\nOpen ImageJ software. Under the Plugins | BoMomics | Simulate Objects menu, click the Cylinder button, and enter 30 as the diameter and 100 as the height in the popup window, then click OK to generate the simulated cylinder. Finally, click the Plugins | 3D | Volume Viewer to view the generated cylinder and save it in tiff format (Figure 3C).\n\t\tNOTE: A sphere (diameter: 30 pixels), a cube (side length: 30 pixels), a cuboid (length: 80 pixels; width: 40 pixels; height: 30 pixels), and a cylinder (diameter: 30 pixels; height: 100 pixels) are saved for the subsequent analyses.\n3. Profiling Analysis Parameters\nOpen ImageJ software and open or import a scanned image.\nSlide the bottom scrollbar to choose one slice, then click the Image | Adjust | Threshold button. In the popup Threshold window, adjust the minimum and maximum threshold values by manual inspection to ensure that bones are well separated from the background, and record the minimal threshold value as the cortical bone threshold value.",
    "NOTE: As different micro-CT manufacturers use different scaling factors for storing X-ray attenuation coefficients in the images, the actual threshold value should be determined empirically either by manual inspection or following the specific manufacturer's recommendations. In our practice, setting the minimum threshold for ISQ files produced by micro-CT machines to 6,000-7,000 can reliably separate bones from the scanning background.\nClick the Plugins | BoMomics | Trab Param Profiling button. In the popup window, set Slice Index to the position of the representative slice, and set the cortical bone (\"Cort Bone\"), range (\"Range\"), and step (\"Step\") values for calculating a set of cortical thresholds for profiling segmentation parameters, where the cortical bone threshold value is acquired by step 3.2 (Figure 1). The default range and step values of 2,000 and 400 work for most micro-CT images. Set the Slice Index to 5 for the example dataset, and keep the default values for other settings.\n\tNote: \"Cort Bone\" is the threshold for cortical bones, and the threshold value used for parameter profiling changes from the lowest threshold value to the highest threshold value with the increment of Step value, where the lowest threshold value is the value of Cort Bone - Range, and the highest threshold value is Cort Bone + Range. If the set values for Cort Bone, Range, and Step are 6,000, 1,000, and 500, respectively, then the lowest threshold value for cortical bones is 6,000-1,000=5,000, the highest threshold value is 6,000+1,000=7,000, and the thresholds used in the analyses are 5,000, 5,500, 6,000, 6,500, and 7,000.",
    "Set noise diameter (\"Noise Dia.\"), step (\"Step\"), and range (\"Range\") values for specifying a set of noise values in the analyses, and the hole diameter (\"Hole Dia.\"), step (\"Step\"), and range (\"Range\") values for calculating a set of hole values. In general, the default setting works for most micro-CT bone samples, where noise, step, and range are 5, 5, 2, respectively, and hole diameter, step, and range are 15, 5, 2, respectively. Keep the default settings for the example dataset.\n\tNote: \"Noise Dia.\" is the diameter for the noise suppression filter, and the \"Hole Dia.\" is the diameter for holes within the cortical bones. The noise and hole values used for parameter profiling can be calculated similarly as cortical threshold values described above, using the specified noise/hole, range, and step values. Due to the variations in scanning parameters when acquiring the images, noise and hole parameters should be determined empirically according to the image quality, as no general ranges of noise and hole parameters are good for all scans. The lowest value for threshold, noise, or holes must be greater than or equal to 0, and if the calculated lowest value is negative using the supplied parameters, the specific lowest value is set to 0.\nClick OK to perform parameter profiling. Visually check the segmentation results in the Parameter Profiling Results window, and select a slice layer so that the bone outer boundary is outlined quite accurately (Figure 1B). Subsequently, retrieve the profiling parameters from the entry in the Parameter Profiling Results table corresponding to the chosen slice layer (Table 1).\n4. Trabecular Analysis\nSegmentation of trabecular bones\nOpen ImageJ software, then open or import a scanned image.",
    "Click the Plugins | BoMomics | Trab Segmentation button, and fill in appropriate analysis parameters. Set \"Start\", \"Outline Boundary\", \"Trab. Bones\", \"Noise Reduction Dia.\", \"Hole Filling Dia.\", and \"Cortical Thickness Dia.\" to 5, 7,200, 7,000, 6, 12 and 25, respectively.\n\t\tNOTE: \"Start\" and \"End\" specify the selected slice range for segmentation of trabecular bones, \"Outline Boundary\" is corresponding to the profiled \"Cort Bone\" parameter, \"Noise Reduction Dia.\" to \"Noise Dia.\" Parameter, and \"Hole Filling Dia.\" to \"Hole Dia.\" parameter. \"Cortical Thickness Dia.\" is the specified thickness for excluding the outer cortical bones. \"Trab. Bones\" is the threshold for extracting trabecular bones (Figure 2), where the settings are determined using profiling analysis parameters command as described in step 3.5.\nClick OK to perform trabecular segmentation. Visually check the segmentation results in the Trab Segmentation Results window (Figure 2B). Save the extracted trabecular bones shown in the Segmented Trabecular Bones window in a tiff format (Figure 2B), which can be further analyzed by other software.\nAnalysis of trabecular bones.\nOpen ImageJ software, then open or import a scanned image.\nClick the Plugins | BoMomics | Trab Analysis button, and fill in appropriate analysis parameters, such as \"Start\", \"Outline Boundary\", \"Trab. Bones\", \"Noise Reduction Dia.\", \"Hole Filling Dia.\", and \"Cortical Thickness Dia.\" as described above (Figure 3A), where the settings are determined using the profiling analysis parameters command as described in step 3.5. Set \"Start\", \"Outline Boundary\", \"Trab. Bones\", \"Noise Reduction Dia.\", \"Hole Filling Dia.\", and \"Cortical Thickness Dia.\" to 5, 7,200, 7,000, 6, 12 and 25, respectively.\n\t\tNOTE: In the free version of the plugin, five adjacent slices starting from the specified \"Start\" slice index are selected for measurement, while in the commercial version, an arbitrary number of slices can be specified by the user.",
    "Select one or more choices in Results Reporting section for the parameters to be measured, where the trabecular bone volume (BV), total volume (TV) of the selected region, and thicknesses measured either two-dimensionally (2D) or three-dimensionally (3D) are available for selection through three checkboxes, namely \"BV TV Only\", \"2D\", and \"3D\". Select the checkboxes \"2D\" and \"3D\", then click \"OK\" to perform trabecular analysis (Figure 3A, Table 2).\n\t\tNOTE: When \"BV TV Only\" is checked, regardless of the selection statuses of \"2D\" and \"3D\", raw measures of BV, TV, and Intensity are reported, and the segmented trabecular bones are extracted and displayed in a new window, which can be saved and further analyzed by other software. When \"2D\" is checked, raw measures of BV, TV, Intensity, and thicknesses measured two-dimensionally at each slice level using the plate model are reported. If \"3D\" is checked, three-dimensional thickness for each voxel is calculated directly without any model assumption, then raw measures of BV, TV, Intensity, and three-dimensional thicknesses sampled at each slice level are reported. However, if no checkbox is selected, trabecular bones are segmented using the above set of parameters, but no measurement is reported.\n5. Quantifying Simulated Objects\nOpen ImageJ software, then open a simulated image. Here, open the simulated sphere with a diameter of 30 pixels as an example.\nSelect the Plugins | BoMomics | Trab Analysis button and fill in appropriate analysis parameters as described previously. Keep the default values for \"Start\", \"End\", \"Outline Boundary\", \"Trab. Bones\", and set \"Noise Reduction Dia.\", \"Noise Reduction Dia.\", \"Hole Filling Dia.\", and \"Cortical Thickness Dia.\" to 0 (Figure 3).",
    "Note: For simulated objects, there is no unintended signal noise, and there may be no corresponding cortical shells. Therefore, parameters for such values should be set appropriately (default settings are to zero). For 3D quantifications, 30 slices before and after the specified \"Start\" slice are processed using the free version of the plugin, while only slices in the range specified by \"Start\" and \"End\" slices are analyzed by the commercial version of the plugin.\nIn the Results Reporting section, select \"2D\" and \"3D\" for the parameters to be measured, and click OK to perform trabecular analysis for the simulated object (Table 3).\n6. Calibration of Trabecular Measures and Data Presentation: Profile the Distributions of Trabecular Measures in the Selected Analyzing Region\nGet the calibration information from the scanned dataset, according to the micro-CT vendor's instructions.\n\tNOTE: Only raw measures of BV, TV, Intensity, and thicknesses are reported by the plugin. To get measures comparable to reports generated by other software, result calibration is desired.\nOpen Microsoft Excel, and open the reported results table. Calculate calibrated bone volume (BV), total volume (TV), bone mineral content (BMC), bone volume fraction (BV/TV), and bone mineral density (BMD) in new excel columns using the reported raw BV, TV, and Intensity values according to the following expressions.\nNOTE: Scanning resolution (resolution, µm), gray scaling (scaling), density units (mg HA/cm3), density slope (slope), and density intercept (intercept) can be extracted from the scanned micro-CT image or meta files, such as the Scanco ISQ file. Therefore, the calibrated measures are calculated as follows:\nSuppose BV, TV and Intensity are raw measures, BVc and TVc are calibrated values, resolution, scaling, slope, intercept are from calibration files of micro - CT images.\n\tBVc = BV × resolution3 [μm3]\nTVc = TV × resolution3 [μm3]",
    "BV / TV = BV ÷ TV\n\tBMC = (Intensity ÷ scaling × slope - BV × intercept) × resolution3 × 10-12 [mg HA]\nBMD - BMC ÷ TVc × 1012 [mg HA / cm3]\nCreate an XY (Scatter) plot for calibrated measures (Y) against slice layers (X) using Microsoft Excel software (Figure 4).\nSubscription Required. Please recommend JoVE to your librarian."
  ],
  "subjectAreas": [
    "Bioengineering"
  ],
  "bigAreas": [
    "Bioengineering & Technology"
  ]
}