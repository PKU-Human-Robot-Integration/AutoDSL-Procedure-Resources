{
  "id": 1692,
  "origin_website": "Cell",
  "title": "Computational generation of proteins with predetermined three-dimensional shapes using ProteinSolver",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nGeneration of amino acid sequences using ProteinSolver\nTiming: 1 h\nProteinSolver (Strokach et al., 2020[href=https://www.wicell.org#bib21]) is a graph convolutional neural network capable of generating amino acid sequences that fold into proteins with pre-determined geometric shapes. ProteinSolver takes as input a reference structure or a sparse distance matrix, listing distances between pairs of residues that are within 12 Å of one another, and a protein sequence, where one or more residues to be optimized are masked. The outputs of ProteinSolver are filled sequences, where masked residues are replaced with amino acids deemed to be best suited for their respective positions in the protein. ProteinSolver can be used for computational generation of new proteins with a predetermined three-dimensional shape as well as for computational optimization of existing proteins that maintains their shape.\nNavigate to the ProteinSolver web server, accessible at https://design.proteinsolver.org[href=https://design.proteinsolver.org]. In some cases, the web server may take up to several minutes to load, as system resources are provisioned in proportion to demand.\nClick the “Load structure” button to load the structure of a protein with the reference topology (Figure 1[href=https://www.wicell.org#fig1]A). Alternatively, click the “Load distance matrix” button to load the distance matrix describing the reference topology (Figure 1[href=https://www.wicell.org#fig1]B).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1151-Fig1.jpg\nFigure 1. Screenshot of the ProteinSolver design web server (http://design.proteinsolver.org[href=http://design.proteinsolver.org])\n(A) The user can upload the structure of a reference protein whose geometry will be used to restrain the space of generated amino acid sequences. The user can also select one of four example proteins.\n(B) Alternatively, the user can upload a sparse distance matrix describing the topology of the target protein (see materials and equipment[href=https://www.wicell.org#materials-and-equipment]).\n(C) The structure preview panel shows the structure of the reference protein uploaded by the user.",
    "(D) The topology preview panel shows the distance matrix of the target topology specified by the user.\n(E) The user can explicitly fix one or more amino acids in the generated sequences to specific residues.\n(F) The user can control the number of sequences generated in each run by changing the value in the “Number of sequences:” field.\n(G) The user can control the temperature factor used to generate sequences by changing the value in the “Temperature factor:” field.\n(H–L) (H) When the user clicks the “Run ProteinSolver” button, a background ProteinSolver process starts generating sequences matching the specified geometric and amino acid constraints. The progress of the ProteinSolver process can be monitored by looking at the progress bar and the sequence logo displayed to the right of the “Run ProteinSolver” button (I), while GPU utilization can be monitored by looking at the status bars displayed below the “Run ProteinSolver” button (J). Once a sufficient number of sequences have been generated, the user can click the “Generate download link” button (K), at which point a download link will appear (L), allowing the user to download the generated designs.\nA valid distance matrix, corresponding to CATH domain: 1n5uA03, is provided as an example above the “Load distance matrix” button.\nIf you provide the structure of a reference protein by clicking the “Load structure” button, that structure should appear in the structure preview panel (Figure 1[href=https://www.wicell.org#fig1]C).\nThe distance matrix corresponding to the target topology should appear in the distance matrix preview panel (Figure 1[href=https://www.wicell.org#fig1]D).",
    "If you want to pre-assign certain amino acids to certain positions in the target protein, click the “Target residue picker” button (Figure 1[href=https://www.wicell.org#fig1]E). Then, use the drop-down menus for each position that you want to constrain to select the desired amino acid. Your changes should be reflected in the “Target sequence:” panel above the “Target residue picker”. This feature is especially useful in cases where you know a priori that certain residues are essential for a specific protein function, such as catalytic activity and binding to other molecules, that you wish to preserve.\nSelect the number of sequences that you would like ProteinSolver to generate (Figure 1[href=https://www.wicell.org#fig1]F). We recommend generating between 100 and 5000 sequences per round. If more sequences are required, you can run ProteinSolver multiple times, as different random seeds are used for each run.\nSelect the “temperature factor” that you would like to use when generating sequences (Figure 1[href=https://www.wicell.org#fig1]G). The temperature factor controls how likely ProteinSolver is to sample low-probability sequences relative to high probability sequences. With a temperature factor of 1, ProteinSolver will use probabilities that achieved the lowest loss during training. With a higher temperature factor, ProteinSolver will be relatively more likely to select low-probability amino acids, while with lower temperature factor, ProteinSolver will be relatively less likely to select lower probability amino acids. We recommend using a temperature factor of 0.01 when you aim to generate a small number of high confidence sequences, and a temperature factor of 0.1 to 1 when you aim to generate a large number of sequences that will be filtered and refined in subsequent steps.",
    "Click “Run ProteinSolver!” (Figure 1[href=https://www.wicell.org#fig1]H) to start generating sequences. The panel on the right (Figure 1[href=https://www.wicell.org#fig1]I) should show a live preview of the sequences that are generated and their corresponding sequence logo. The GPU monitoring panel (Figure 1[href=https://www.wicell.org#fig1]J) should show increased GPU usage.\nOnce ProteinSolver stops running, click “Generate download link” button (Figure 1[href=https://www.wicell.org#fig1]K) to generate a “Download sequences” link (Figure 1[href=https://www.wicell.org#fig1]L) that will allow you to download a FASTA file listing generated sequences.\nNote: The header of every entry in the FASTA file has the following format: >{sequence_index}|{unique_name}|{sequence_identity}|{avg_logprobability}. The sequence_index field is a monotonically increasing index of the sequence in the FASTA file. The unique_name field is a unique name assigned to each sequence in the FASTA file. The sequence_identity field lists the sequence identity between the generated sequence and the sequence of the reference protein, if provided. The avg_logprobability field lists the average log-probability assigned by ProteinSolver to amino acids in the generated sequence.\nExample FASTA file produced by the ProteinSolver web server\n    >0|gen-00001|0.28875115513801575|-1.845043659210205\n    FFGYDFLREDAHAFLANRFPYASQAHIAKITACETECCNCCNERDLKSCTDCKNTLAQEICKNRERFSEEIGNCCENPPH\n    IIAECLAQVKHR\n    >1|gen-00002|0.29804882407188416|-1.976570963859558\n    FAGLKDDLKKALERLRNRFPSAAKDEVDELTNMEATVVKCCTDDDTSECISCELALAEYVCSNEYLLADELGACCKQPGE\n    EYTSCLKRLSTK\n    ...\n  \nCritical: The quality of the sequences generated by ProteinSolver will ultimately depend on the quality of the reference protein structure or distance matrix that you provide. If the generated sequences do not match your expectations, double check the provided structure or distance matrix for irregularities or typos.",
    "Critical: It may be advisable to try setting different values for the “temperature factor” and, based on the logos of the generated sequences, to select the temperature factor that produces sequences with the desired level of diversity. Conceptually, the temperature factor is analogous to the temperature term in a Boltzmann distribution and controls the probability that a system (in our case, a protein) will occupy a given state (in our case, the assignment of amino acids) given the energy of that state (in our case, the predictions of the ProteinSolver neural network). More concretely, the final layer of the ProteinSolver neural network is a softmax function which converts raw output values (z) into probabilities (p) of each amino acid being present at each position in the protein, and the temperature factor (T) scales the raw output values (z), thereby modifying the resulting probability distributions over the amino acids (i.e., pi = exp(zi / T) / Σj exp(zj / T)). A large temperature factor will make the resulting distributions more flat, increasing the likelihood that residues with relatively low output values (z) will be selected, while a small temperature factor will make the resulting distributions more narrow, decreasing the probability that residues with relatively low output values (z) will be selected.\nComputational validation of the generated amino acid sequences using sequence-based tools\nTiming: 1 day\nIn this step, we discuss sequence-based approaches for validating and filtering sequences generated using ProteinSolver. These approaches do not require structural models of the proteins and are especially useful in cases where it is difficult to generate a protein structure corresponding to the target topology.\nUse PSIPRED (Jones, 1999[href=https://www.wicell.org#bib9]) to predict the secondary structure of the generated sequences.\nPSIPRED can be accessed through a web server (http://bioinf.cs.ucl.ac.uk/psipred/[href=http://bioinf.cs.ucl.ac.uk/psipred/]) or by installing locally (see materials and equipment[href=https://www.wicell.org#materials-and-equipment]).",
    "Remove sequences where the predicted secondary structure does not match the secondary structure of the target protein.\nUse ProtParam (Gasteiger et al., 2005[href=https://www.wicell.org#bib8]) to predict physicochemical properties of the generated sequences.\nProtParam can be accessed through a web server (https://web.expasy.org/protparam/[href=https://web.expasy.org/protparam/]) or using the Bio.SeqUtils.ProtParam module in BioPython (see materials and equipment[href=https://www.wicell.org#materials-and-equipment]).\nViable protein sequences that do not aggregate under experimental conditions would generally have an Instability Index (II) less than 40 and a GRAVY coefficient between –0.5 and 0.5.\nUse external protein structure prediction tools, such as I-TASSER (Yang et al., 2015[href=https://www.wicell.org#bib28]) and QUARK (Xu and Zhang, 2012[href=https://www.wicell.org#bib26]) to predict structures (with and without protein templates) of generated sequences.\nUse the I-TASSER web server (https://zhanglab.ccmb.med.umich.edu/I-TASSER/[href=https://zhanglab.ccmb.med.umich.edu/I-TASSER/]) to create homology models for several sequences with the highest ProteinSolver log-probability value.\nUse the QUARK web server (https://zhanglab.ccmb.med.umich.edu/QUARK/[href=https://zhanglab.ccmb.med.umich.edu/QUARK/]) to create ab-initio models for several sequences with the highest ProteinSolver log-probability value.\nWe recommend predicting structures for only several of the highest-scoring designs, since structure prediction tools are computationally expensive.\nThe distance matrix that was provided as input to ProteinSolver can, optionally, also be provided as input to I-TASSER. This can improve the quality of the generated structures, especially in the case of de novo design.\nStructural models that are produced should have distance matrices that match the distance matrix of the target topology that was provided as input to ProteinSolver.\nComputational validation of the generated amino acid sequences using structure-based tools\nTiming: 1 day\nIn this step, we discuss structure-based approaches for validating and filtering the generated sequences. In order to use these approaches, we need the structure of a reference protein with the target topology, as this structure is used to construct homology models of all generated sequences. Those homology models are then evaluated using various measures of protein stability.",
    "Create and evaluate homology models of the generated sequences using MODELLER (Webb and Sali, 2002[href=https://www.wicell.org#bib25]).\nGenerate alignment files in PIR file format mapping the generated sequences to the sequence of the reference protein.\nCreate homology models of the generated sequences following MODELLER’s basic modeling tutorial: https://salilab.org/modeller/tutorial/basic.html[href=https://salilab.org/modeller/tutorial/basic.html].\nObtain assessment scores for those homology models, including the GA341, DOPE, DOPE-HR and normalized DOPE scores.\nEvaluate the stability of homology models using Rosetta (Alford et al., 2017[href=https://www.wicell.org#bib1]).\nRelax the structures using Rosetta protocol FastRelax, as described on the Relax application page: https://www.rosettacommons.org/docs/latest/application_documentation/structure_prediction/relax[href=https://www.rosettacommons.org/docs/latest/application_documentation/structure_prediction/relax].\nObtain a Rosetta Energy Unit score for each structure using the ref2015 scoring function.\nUse the obtained scores to prioritize generated sequences for more in-depth computational and experimental validation.\nSelect one or more sequences that score best according to each of the metrics.\nSelect one or more sequences that score best according to an average of all metrics. In order to give equal weight to each metric, before calculating the average, the scores should be normalized to have a mean of 0 and a standard deviation of 1.\nComputational validation of select amino acid sequences using molecular dynamics\nTiming: 5 days\nMolecular dynamics (MD) is arguably the least biased computational approach that can be used to evaluate the stability of de novo designed proteins. We suggest using MD to probe the stability of a handful of selected sequences before proceeding to experimental validation\nRun molecular dynamics simulations using homology models constructed for to the best-scoring designs.\nRemove all water and ion atoms from the homology models.\nSolvate the structures by adding a 12 nm3 box of explicit water molecules, TIP3P, using the solvatebox program in AMBER16 (Case et al., 2005[href=https://www.wicell.org#bib5]).\nAdd Na+ and Cl- counter-ions to neutralize the overall system net charge using the solvatebox command in AMBER16.",
    "Generate coordinate and topology files using the tleap command (Case et al., 2005[href=https://www.wicell.org#bib5]). We recommend specifying the AMBER ff14SB force field (Maier et al., 2015[href=https://www.wicell.org#bib12]) when running tleap.\nApply periodic boundary conditions using the sander command.\nMinimize, equilibrate, and heat the structures over 800 ps to 300 K, while progressively removing the positional restraints.\nRun the molecular dynamics simulations. We recommend using a 2 fs timestep, constraining hydrogen bonds using SHAKE (Ryckaert, Ciccotti and Berendsen, 1977[href=https://www.wicell.org#bib18]), and treating long-range interactions using the particle mesh Ewald algorithm (Toukmaji et al., 2000[href=https://www.wicell.org#bib22]). The simulations should be carried out for at least 30 ns and preferably more than 100 ns.\nStructures of the designed proteins should maintain their general topology throughout the simulations. Proteins that begin to unfold or show large per-residue RMSD values are not likely to be stable under experimental conditions.\nNote: While we use Amber16 in this protocol, other molecular dynamics packages can be used in its stead, including Gromacs and OpenMM.\nExperimental validation of select amino acid using circular dichroism\nTiming: 5 to 9 days\nThe ultimate test for the stability and activity of the generated sequences is experimental validation. Here, we describe how to obtain circular dichroism (CD) spectra for a handful of selected designs.\nGenerate a DNA sequence and clone it into an His-tagged expression vector for E. coli purification.\nReverse translate the selected amino acid sequences into DNA sequences. Make sure that the codons are optimized for E. coli and that a stop codon is added.\nAdd restriction sites at the 5’ and 3’ ends of the reverse translated sequence for downstream cloning.\nObtain the sequences commercially synthetized as a dsDNA fragment. At least 100 ng of dsDNA can be expected for each sequence. Resuspend the dsDNA to a final concertation of 10–20 μg/μl.",
    "Insert the dsDNA fragments into a His-tag expression vector by standard ligation.\nExpress the proteins. Transform the vectors containing the selected amino acid sequences into a chemically competent E. coli cells for protein expression.\nPlate the transformed cells into LB plates containing the appropriate antibiotic for selection.\nFor each protein, inoculate a small spread of colonies into 15 mL of 2xYT media containing the appropriate antibiotic at 37°C, 220 rpm until the optical density (O.D.) is 0.6–0.8.\nInduce the cell cultures with IPTG (0.5 mM) for 3 h at 37°C.\nExtract the soluble protein with BugBuster Master Mix (Millipore) and purify the soluble protein with Ni-NTA agarose beads (Perez-Riba and Itzhaki, 2017[href=https://www.wicell.org#bib17]).\nPellet the cells by centrifugation at 3000 × g (4°C, 10 min). Resuspend the pellets in 1 mL of BugBuster Master Mix (Millipore).\nIncubate the lysate mixtures for 20 min in a rotating shaker.\nSeparate the soluble fraction by centrifugation at 16000 × g at 4°C for 1 min.\nPrepare 200 μL of Ni-NTA Agarose beads by pre-washing it in Phosphate-buffered saline (PBS) to remove the storage Ethanol.\nMix the lysate supernatant with the washed beads into a 1.5 mL tube. Incubate the mixture for 20 min at 4 C in a tube rotator.\nSpin down the beads at 600 × g to remove the unbound fraction. Wash the beads with 1 mL of PBS 30 mM Imidazole.\nRepeat the washing step twice.\nAfter removal of the last washing step, elute the samples by addition of 1 mL of PBS, 300 mM Imidazole. Spin down at 600 × g to pellet the beads and keep the supernatant with the eluted protein.\nDialyze the eluted sample against 5 L of fresh PBS buffer for 16 h at 4°C.",
    "Note: 1 mL of BugBuster Master Mix in our hands homogenizes a 15 mL culture of untransformed E. coli cells into a transparent solution. After centrifugation, some proteins may be present in both the soluble and insoluble fractions, and any white precipitate should be the recombinant protein in inclusion bodies. These inclusion bodies can be resuspended in Gdm HCl 6 M and further purified by Ni-NTA affinity (Perez-Riba and Itzhaki, 2017[href=https://www.wicell.org#bib17]).\nPause point: Cell pellets obtained by centrifugation (step 17a) can be stored at –20°C for several weeks. Alternatively, purified protein may be stored at –80°C. Different proteins may require different storage conditions to preserve fold and activity.\nValidate the purified protein sample.\nCalculate the protein concentration using the Pierce BCA Protein Assay Kit (ThermoFisher), Bradford assay or Tryptophan absorbance at 280 nm.\nEstimate sample purity by SDS-PAGE.\nValidate that the eluted protein matches the theoretical MW of the selected amino acid sequence by Mass Spectrometry (ESI).\nNote: If the protein has at least one Tryptophan, we recommend calculating protein concentration using absorbance at 280 nm. Otherwise, colorimetric assays (BCA and Bradford) are good alternatives for proteins lacking Trp residues, but the colorimetric signal is sometimes dependent on the protein chemistry. We have noticed that the same protein sample may give different concentration estimates depending on the assay used. Finally, absorbance at 205 nm can be an alternative for proteins with very low solubility (Anthis and Clore, 2013[href=https://www.wicell.org#bib2]).\nCritical: Small scale purifications are cleaner in our hands than large scale ones. However, if other bands besides the recombinant protein are present in the polyacrylamide gel, other purification steps, such as gel filtrations, are required.\nObtain the circular dichroism spectra to estimate the secondary structure content on a CD spectrometer.",
    "Aim to have 10–20 μM of purified protein to perform CD measurements and obtain the measurements in triplicates. Using 300 μl for a 1 mm quartz cuvette is recommended.\nThe CD spectra should be transformed to Molar ellipticity for a direct comparison between the spectra of selected amino acid sequences.\nInput the spectra into the BeStSel webserver (Micsonai et al., 2015[href=https://www.wicell.org#bib14]) in mean residue ellipticity units to obtain predicted composition of secondary structure elements.\nNote: If protein dilution is required, prepare three dilution replicates and measure the protein concentration of each dilution in triplicate.\nNote: The Molar ellipticity is sensitive to errors in protein concentration estimation. Calculate the concentration of all the CD samples in triplicate.\nNote: If the concentration is below 5 uM, using a 10 mm path cuvette can improve signal, but a low salt buffer may be required to reduce the noise level."
  ],
  "subjectAreas": [
    "Bioinformatics",
    "Structural Biology",
    "Protein Expression And Purification",
    "Circular Dichroism (Cd)",
    "Protein Biochemistry",
    "Biophysics"
  ],
  "bigAreas": [
    "Molecular Biology & Genetics",
    "Bioinformatics & Computational Biology",
    "Bioengineering & Technology"
  ]
}