{
  "id": 18195,
  "origin_website": "Jove",
  "title": "3D Ultrasound Imaging: Fast and Cost-effective Morphometry of Musculoskeletal Tissue",
  "procedures": [
    "All procedures involving human subjects have been approved by the medical ethics committee of the VU medical center, Amsterdam, the Netherlands.\n1. Instrumentation\nConnect the ultrasound device to the measurement computer. If needed, use frame-grab hardware and/or software to store the sequential ultrasound images.\n\tNOTE: A 5-cm linear-array probe (12.5 MHz) is used to generate B-mode images (25 Hz). Before each measurement, imaging depth, acoustic frequency, and power are optimized to visualize interfaces of extra- and intramuscular connective tissues. During the measurement, these settings are not changed.\nConnect the MoCap system to the measurement computer.\nRigidly connect a MoCap cluster marker to the ultrasound probe to track the position and orientation of the US probe.\nConnect the synchronization device (piezo crystal) to the trigger input of the MoCap system.\n\tNOTE: Activation of the synchronization device momentarily activates the piezo crystal, sending sound waves towards the transducer. The received soundwaves create a distinct artifact in the US image at the system initiation (Figure 1A, Arrow).\nFill the custom-made calibration frame (phantom) with water.\n2. Calibrate\nNOTE: Perform a spatial calibration to calculate a transformation matrix (toTfrom) from the US images with respect to the probe coordinate system. This calibration process has been described previously22. Please see below for a brief description.\nPlace the phantom filled with water, holding a crosswire (i.e. two submerged crossing wires) at a known position within the phantom coordinate system (Phxyz Figure 1B, arrow), on a stable surface.\nMeasure the water temperature with a thermometer.\nUse the MoCap pointer tool to record the position and orientation of the phantom in the global coordinate system (Gl).\nStart the US image sampling and activate MoCap data acquisition (described in step 3.3.3).",
    "Submerge the head of the US probe (Pr) in the water. Translate and rotate the US probe for 40 s (sampling at 25 Hz) in all directions, maintaining visibility of the crosswire in the US images (Im).\nStop data acquisition.\nSynchronize the MoCap data and US images by identifying the first US frame containing the piezo crystal-created artifact and crop the US image sequence accordingly (described in step 3.4.1.1).\nIdentify the relevant US images in which the crosswire is clearly visible and track the position of the crosswire in these US images (iImxyz), and correct the position for water temperature.\nDetermine the position of the crosswire with respect to the moving Pr by a series of transformations from Ph to Pr (Equation 1) at time instances (i = 1:n) corresponding to the crosswire identification in step 2.8.\nimgsrc://cloudfront.jove.com/files/ftp_upload/55943/55943eq1v4.jpg\nCalculate the Im to Pr transformation matrix (PrTIm) by solving Equation 2, involving all identifications of the crosswire in Im (measured in step 2.8) at the time matched (i = 1:n) coordinates of the crosswire in Pr (calculated in step 2.9). \nimgsrc://cloudfront.jove.com/files/ftp_upload/55943/55943eq2v5.jpg\nimgsrc://cloudfront.jove.com/files/ftp_upload/55943/55943fig1.jpg",
    "Figure 1: Schematic of the 3DUS algorithm. (A) Motion Capture (MoCap) system is used to track a cluster of markers rigidly connected to the ultrasound probe, within the global coordinate system (Gl). Synchronization of MoCap and ultrasound data is accomplished making use of an artifact (arrow) introduced by Optotrak triggered piezo crystal. (B) The position and orientation of the ultrasound image coordinate system (Im) is calculated relative to the probe coordinate system (Pr) by identifying a known point within the Pr and Im. For this purpose, a custom-designed phantom is used filled with water, holding a crosswire (i.e. two submerged crossing wires) at a known position within the phantom coordinate system (Ph). (C) With a series of transformations, this known point is calculated in the Pr. (D) With a complete series of known transformations, images from the Im can be transformed into any voxel array coordinate system (Va). Please click here to view a larger version of this figure.[href=https://www.jove.com//cloudfront.jove.com/files/ftp_upload/55943/55943fig1large.jpg]\n3. Experimental Protocol\nNOTE: The experimental protocol describes two commonly performed protocols involving 3DUS imaging, i.e. morphometry of GM and VL (Figure 2A).\nSubject positioning\nFor the GM experiment:\n\t\t\nAsk the subject to lie prone on an examination table with both feet overhanging the edge of the table. \nAlign the lower leg horizontally, by placing a support under the tibia. Fix the thigh to the examination table with padded lashing straps to prevent knee extension during the experimental protocol. \nFit the foot of the leg to be scanned into the custom-made footplate31. \nConnect the custom-made torque wrench with an attached goniometer to the footplate31. Find the footplate angle corresponding to an externally applied torque, e.g., 0 Nm (Figure 2A).",
    "Fix the footplate in the orientation corresponding to the 0 Nm net dorsiflexion moment, by using an extendable rod which is connected to the table (Figure 2A, arrow).\nFor the VL experiment:\n\t\t\nAsk the subjects to lie supine on an examination table. \nSet the knee flexion angle (i.e. operationalized as the angle between the lines connecting the centers of the malleolus lateralis with epicondylus lateralis and the latter with the trochanter major) to 60°, by positioning the lower legs on a support.\nPlace a triangular shaped beam underneath the buttocks to prevent hip movement. \nFix the lower leg to the support with two padded lashing straps to prevent leg movement during the experimental protocol. \nSet the hip angle (i.e. operationalized as the angle between lines connecting os coracoides with the trochanter major, and the latter with the epicondyle lateralis femoralis) to 95°, by changing the angle of the back support of the examination table. \n\t\t\tNote: This described pose has been chosen, as it resembles joint angles during optimal isometric knee extension measurements32,33. \nLocalization of bony landmarks and region of interest (ROI) \n\tNote: This is done for guidance of the 3D ultrasound examination and for post-experimental quantification of the subject’s upper leg, lower leg, and foot posture. Identify and record the positions of the anatomical bony landmarks in the global coordinate system using the MoCap pointer tool.\n\t\nFor the GM experiment:\n\t\t\nIdentify the following landmarks by palpation and mark them using a surgical skin marker: the most prominent dorsal aspects of the medial and lateral femur epicondyles, and the centers of the malleoli of the tibia and fibula.",
    "Using the US device, identify and mark using a surgical skin marker the most superficial points of the medial and lateral femur condyles (on the dorsal side of the leg) and the most proximal location of the insertion of the GM on the calcaneus. \nFor the VL measurement:\n\t\t\nIdentify the following landmarks by palpation and mark them using a surgical skin marker: the medial and lateral malleoli (as above); the most proximal insertion of the patella tendon of the tuberositas tibiae; the medial and lateral epicondyles (as above); the apex of the patella and the most medial, proximal, and lateral insertion boundaries on the patella; and os coracoides on the shoulder.\nIdentify with the US device and mark the most superficial aspect of the trochanter major and most proximal insertion of the VL on the trochanter major.\nFor all muscles, use the MoCap pointer tool to record the marked landmarks (described in sections 3.2.1 and 3.2.2) in the global coordinate system. Move the MoCap pointer tool to the identified anatomical landmarks, and use the MoCap software to record the position by pressing the “record” button. \nUse ultrasound to identify the medial and lateral muscle border; mark the medial and lateral borders on the skin using a surgical skin marker. \n3D ultrasound examination\nInstruct the subject not to move during the 3D ultrasound examination.\nApply ample ultrasound gel on the ROI to ensure proper contact between the skin and US probe. \n\t\tNote: Such application of gel allows limiting probe pressure and thus tissue deformation necessary to get a clear US image. \nOpen the frame grabber software (e.g., WinDV34) on the measurement computer and start the US image acquisition by clicking on the “Record” button.",
    "Subsequently, initiate and activate the MoCap data acquisition by pressing the “start” button on the synchronization device; this automatically activates the synchronization device (i.e. piezo crystal) located close to the US probe, creating a distinct artifact in the US image at the instance of MoCap initiation (Figure 1A, Arrow). \nWhile exerting minimal probe pressure yet ensuring image quality, move the probe at a constant speed over the ROI; this is referred to as a “sweep”. Make sure that clear anatomical cross-sectional US images of the target muscle are recorded.\nVisually check for movement of the subject during the examination; if the subject moves, abort the sweep and repeat from step 3.3.1.\nSweep protocol for the GM experiment\n\t\t\nPlace the US probe proximally to the femur condyles on the medial aspect of the thigh. Perform a sweep (as described in sections 3.3.1 - 3.3.5) in the proximo-distal direction along the medial border of the GM, ensuring visibility within the anatomical cross-sectional images of the medial border of GM and the Achilles tendon, all the way down to its insertion on the calcaneus.\nAdd additional sweeps (as described in section 3.3.3 - 3.3.5) until the entire ROI is scanned and the medial border of the muscle is imaged completely (Figure 2B). Use the trace in the gel of the previous sweep to guide the next sweep, slightly overlapping (0.5 cm) the previous swept area.\nSweep protocol for the VL experiment\n\t\t\nPlace the US probe on the lateral aspect of the tibia plateau. Start a sweep in distal-proximal direction over the lateral border of the VL, ensuring visibility of the lateral border of VL, all the way up to the origin on the trochanter major.",
    "Add additional sweeps (as described in section 3.3.3 - 3.3.5) until the entire ROI is scanned and the medial border of the VL is imaged completely (Figure 2B). Use the trace in the gel of the previous sweep to guide the next sweep, slightly overlapping (0.5 cm) the previous swept area.\n\t\t\tNote: During the sweep protocol, movement of the subject should be prevented, as movements negatively affect positioning of the 2D US images in the voxel array. The number of sweeps are determined by the width of the probe and the width of the target muscle. Typically, with a probe width of 4 cm and a muscle width of 12 or 18 cm, 5 or 7 sweeps, respectively are needed to cover the ROI including the borders. \nimgsrc://cloudfront.jove.com/files/ftp_upload/55943/55943fig2.jpg\nFigure 2: Schematic of the experimental setup and sweeps of the ultrasound probe over the target muscles (m. gastrocnemius medialis (GM) setup and m. vastus lateralis (VL) setup). (A) Specific joint configurations of the subject for the two experimental conditions. The objects displayed in green are adjustable to set the position and orientation of the limbs. Arrow indicates an extendable rod that is used to fix the footplate angle. (B) Path of multiple sweeps of the ultrasound probe over the regions of interest. The blue arrows represent single sweeps over the region of interests. Left: sweeps over the GM; Right: sweeps over the VL. Please click here to view a larger version of this figure.[href=https://www.jove.com//cloudfront.jove.com/files/ftp_upload/55943/55943fig2large.jpg]\n3D ultrasound voxel array reconstruction \nReconstruct a single 3DUS voxel array (3DUS image) from a single sweep over the skin of a specific anatomical ROI (e.g., muscle, tendon) by bin-filling and inpainting the 3DUS voxel array using a custom-script. In order to reconstruct a 3DUS voxel array, take the following post-experimental steps.",
    "Synchronize the MoCap data and US images by identifying the first US frame containing the piezo crystal-created artifact and cropping the US image sequence accordingly with VirtualDub software35. First, place the frame selection slider at the identified starting frame and press the “home” button on the keyboard. Next, move the slider to the end of the measurement (the last skin contact) and press the “end” button. Press the “F7” button to export the cropped image sequence. \nDefine a voxel array (Va) coordinate system which can be filled with US images, using a custom-script. Ensure that the Va is oriented in accordance with the scanning direction and sized to fit all the US images of a single sweep. \n\t\t\tNote: Initially, the Va consists of rectangular-shaped voxels, with the longer axes in the direction of the sweep; this shape improves filling efficiency. \nAssign the voxels in the Va with pixel grey-values from the US images, using a custom script. This process is described as forward mapping or bin-filling (Equation 3; Figure 1C)23,24. \nimgsrc://cloudfront.jove.com/files/ftp_upload/55943/55943eq3v4.jpg\n\t\t\tNote: This shows forward mapping of 2D US images in the Va according to the orientation and position of the images in the Va coordinate system. In short, the positions of all pixels of one image (Imxyz(1:n)) at time instance (i), are simultaneously mapped forward into the voxel array. The bin-filling procedure only fills the addressed voxels, leaving the non-addressed voxels empty (i.e. black).\n\t\t\tNote: imgsrc://cloudfront.jove.com/files/ftp_upload/55943/55943eq7.jpg indicates the inverse of the previously described transformation matrix (i.e. a Pr to Gl transformation matrix).\nUsing a custom script identify gaps inside the voxel array (i.e. black voxels). Take the following steps by using binary image processing:",
    "Create a bin-filled binary voxel array in which all filled voxels are labeled. Use binary image dilation and erosion, with the same size structuring-element, to label all relevant voxels (i.e. grey-valued voxels) inside the scanned region. Detect gaps by subtracting the bin-filled binary voxel array (with gaps) from the relevant voxels (no gaps).\n\t\t\t\tNote: Subsequent dilation and erosion operations are image-processing steps to complete the binary images. By performing these steps one after another, the outside boundaries remain while the gaps inside are removed. \nFill the identified gaps using an “inpaint procedure” and surround grey-valued voxels36.\n\t\t\tNote: This inpaint technique can be used to: \"fill gaps with a smooth interpolant based upon minimizing the sum of squares of the second derivative at each labeled voxel measured by finite differences on the grid\"36.\nEqualize the voxel dimensions of the Va by 'bicubic' interpolation and save the voxel array as a stacked .tiff image (3DUS image).\nMultiple sweeps reconstruction\nReconstruct all individual sweeps (described in section 3.4) covering one larger ROI according to the same Va coordinate system to merge multiple sweeps.\nCreate a new Va coordinate system, sized to accommodate all individual reconstructed sweeps.\nPlace the individual Va's step-by-step into the larger Va. If a voxel is already assigned by another Va, this voxel will only be overwritten if the new voxel has a grey value ≥10 on an 8-bit scale, otherwise the new voxel grey value is discarded.\n4. Measurement of Variables of Muscle Morphology\nUse the Medical Interaction Toolkit37 (MITK) to load the 3DUS image and retrieve the coordinates of the origin, insertion, and distal end of the muscle belly.\nAfter loading the 3D image, set the slicing to 'Coupled crosshair rotation'. Align the axes with muscle or bony structures to precisely retrieve the coordinates.",
    "NOTE: MITK is preferred over other 3D imaging analysis software for the assessment of anatomical points, because it allows fast and interactive voxel array slicing in any direction (\"Coupled crosshair rotation\"), facilitating the identification procedure.\nIn order to measure muscle volume, use MITK to identify the muscle belly boundaries between the origin and distal end of the muscle belly. Use the built-in MITK segmentation to manually segment the multiple anatomical cross-sections evenly, distributed along the muscle belly length (Figure 3A).\nOpen the 'segmentation tool' and create a 'new segmentation.' Start segmenting the muscle boundaries identified in a cross-section halfway along the muscle belly. Press 'A' on the keyboard to add a manual segmentation and draw by pressing the left mouse button and moving the cursor following the muscle boundaries. Press 'S' to remove parts of segmentation.\nPress the key corresponding to the last selected mode (i.e. 'A' or 'S') to move the crosshair to other cross-sections along the muscle belly. Repeat step 4.2.1 to segment the new selected cross-section. Repeat this step for at least 6 times, before continuing to the next step.\nSet 'Interpolation' to 'enable', review the proposed segmentations of the muscle boundaries (yellow lines) in all cross-sections along the muscle belly length.\nAdd additional segmentations in the cross-sections in which the proposed interpolated segmentation (yellow line) does not match the muscle boundary in the image. Repeat step 4.2.2.\nPress the 'Confirm for all slices' button and select the plane in which the segmentations were made.\nSave the binary volume as a nearly raw raster data (NRRD) file and calculate the labeled volume size using a custom-script.\nFind the orientation of the mid-longitudinal fascicle plane of the muscle belly, containing the full length of fascicles (Figure 3A)38.",
    "NOTE: The mid-longitudinal plane is defined by three points. The origin and distal end of the muscle belly are the first two points. The third point is found in an anatomical cross-sectional image halfway between the origin and distal end of the muscle belly. Within this anatomical cross-sectional image, the midpoint between the first two points projected onto the tangent of the distal aponeurosis yields a third point that together with the origin and distal-end of the muscle belly defines the mid-longitudinal plane.\nFrom the mid-longitudinal plane, measure the fascicle length at a pre-defined standardized position between the origin and distal end of the muscle belly (e.g., 50%). Segment the muscle boundaries. Place a line halfway and rotate this line until it matches the direction of the underlying fascicles. The intersections of this line with the muscle boundaries represents the estimate of the fascicle length (Figure 3B).\n\tNOTE: Previously, it proved necessary to take into account the, sometimes curved, orientation of the distal aponeurosis38, as seen in an anatomical cross-sectional image (Figure 3B), taken halfway between origin and distal end of the muscle belly.\nimgsrc://cloudfront.jove.com/files/ftp_upload/55943/55943fig3.jpg",
    "Figure 3: Schematic of the 3DUS analysis. (A) Identification and segmentation of the target muscle boundaries in an anatomical cross-sectional image halfway along the muscle belly. The solid green line represents the orientation of the mid-longitudinal plane (i.e. oriented perpendicular to the orientation of the distal aponeurosis (blue dotted line). (B) Measurement of the fascicle length is performed within the mid-longitudinal fascicle plane. The red transparent region is segmented by identification of muscle boundaries. A dotted yellow line is placed halfway on the muscle belly and rotated until it matches the direction of the underlying fascicles. The intersections of this line with the proximal and distal aponeuroses (connected by thick solid yellow line) represent the estimate of fascicle length. The solid green line represents the position and orientation of the anatomical cross-sectional plane. Top: GM (m. gastrocnemius medialis) and bottom: VL (m. vastus lateralis) muscle. The white squares for scale represent 1 cm x 1 cm. Please click here to view a larger version of this figure.[href=https://www.jove.com//cloudfront.jove.com/files/ftp_upload/55943/55943fig3large.jpg]"
  ],
  "subjectAreas": [
    "Medicine"
  ],
  "bigAreas": [
    "Biomedical & Clinical Research"
  ]
}