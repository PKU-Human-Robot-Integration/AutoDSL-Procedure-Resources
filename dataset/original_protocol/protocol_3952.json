{
  "id": 4156,
  "origin_website": "Cell",
  "title": "Protocol for simulating macrophage signal transduction and phenotype polarization using a large-scale mechanistic computational model",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nSimulating the effect of ligand stimulations\nTiming: about 15 mins\nIn this section, we will show how to use the model to simulate the downstream signal transduction of driving pathway stimulations.\nIn the “Current Folder” window in MATLAB, double click to open the file named “simulatemodel_samplescript.m”.\nRun the first section named “model setup and simulation” in the script. This will load the model.\nRun the second section named “simulation scenarios” in the script. This part contains two examples: hypoxia and IL-4 stimulation. The sample code will produce (e.g., plot) time-course profiles of cellular HIF1α (hypoxia inducible factor 1 alpha) in response to hypoxia, and ARG1 (arginase 1) in response to IL-4 stimulation.\nFor the simulation of hypoxia, the initial condition of oxygen (O2), as the only input, was changed. This was reflected as numerical changes in the “InitialAmount” field of species #78.\nFor the simulation of IL-4 addition, the initial condition of IL-4, as the only input, was changed. This was reflected as numerical changes in the “InitialAmount” field of species #28.\nTo perform model simulations, a simulation timespan also needs to be set. This is achieved by the command “set(cs, 'StopTime', 1500)” where 1500 is the simulation timespan 1500 min. When specifying the simulation timespan, the configuration handler should be already obtained by the command “cs = getconfigset(m, 'active')”.\nTo set the ODE solver for the model, use command “cs.SolverType='ode15s'”. MATLAB provides many different ODE solvers; ode15s is the recommended solver for our model (Troubleshooting 2[href=https://www.wicell.org#sec5.3]).\nTo perform model simulations, the command is “[t,out] = sbiosimulate(m)”. Here, “t” is the vector containing all time points, “out” is the matrix containing all model outputs (of all modeled species).",
    "To change the initial condition of specific modeled species, make sure to first identify the number of that particular species: use the “m.Species” command, and also refer to supplemental Tables S1 and S2 in (Zhao et al., 2021[href=https://www.wicell.org#bib5]) for more details regarding species naming. Then change the ‘InitialAmount’ field of that particular species to the desired value (see above examples of oxygen and IL-4).\nTo obtain the specific model output of interest, make sure to first identify the number of that particular species before getting its value. For example, ARG1 (arginase 1) is #53 in all species, so the command “a1=out(:,53);” was used here to obtain the time-course values of ARG1.\nTo simulate the effect of multiple stimulations in different combinations and orders, follow the above instructions to change the species initial conditions accordingly.\nWhen plotting the results, especially when plotting the time-course profiles of multiple species in one figure, data normalization is recommended for better visualization (e.g., species values are normalized to their respective maxima).\nCritical: Users should note that the default simulation output variable is a two-dimensional matrix, and each column in the matrix, instead of the row, is the time-course value of a species.\nGeneration of dynamic macrophage polarization maps\nTiming: about 1 h\nIn this section, we will show how to use the computational model to create a macrophage polarization map that shows diverse stimulation-induced phenotypes. Here we evaluated 28 different stimulation conditions (that are combinatorially derived from the 7 driving pathways described by the model).\nIn the “Current Folder” window in MATLAB, double click to open the file named “analysis_Fig5_polarizationmap.m”.",
    "Run the first section of the script. Here, a total number of 3x28 stimulation conditions are simulated (3 time points; 7 single stimulus plus 21 pairwise combinations). This will generate the source data for the polarization map (in lines 3456-3458, variables sum4vitro, sum24vitro and sum48vitro contain relative fold changes of a panel of macrophage markers evaluated at 4, 24 and 48 h, respectively). With these data, the polarization maps can then be created and visualized in MATLAB using the function heatmap (Troubleshooting 3[href=https://www.wicell.org#sec5.5]).\nRun the second section of the script (starting at line 3463). This will plot time-course trends (evaluated at 4, 24 and 48 h) of the relative M1/M2 scores of 7 single stimulus and 21 pairwise stimulus conditions. The results are shown in log scale for better comparison. Details of the M1/M2 score are discussed in (Zhao et al., 2021[href=https://www.wicell.org#bib5]).\nSimulating intervention experiments in silico\nTiming: about 15 mins\nIn this section, we will show how to use the computational model to simulate the effect of certain targeted interventions on macrophage phenotypes. Examples here used hypoxia (2 percent oxygen) as the control condition.\nIn the “Current Folder” window in MATLAB, double click to open the file named “analysis_Fig6_targetedintervention.m”.\nRun the first section of the script. This will load the model.\nRun the third section of the script (starting at line 94). In this example, we compared the macrophage phenotype upon SOCS1 inhibition (by accelerated degradation) in hypoxia to the phenotype in the control condition. This targeted intervention (inhibiting SOCS1 by promoting its degradation) was achieved by increasing the protein degradation rate of SOCS1 by 10 fold in the model (using the command “m.Parameters(125).Value=0.004∗10;”).",
    "Usually, different kinds of targeted interventions (e.g., protein overexpression and inhibition, inhibition of a protein-protein interaction process) can be accordingly simulated as changes in the species initial conditions or parameter values.\nCreation and analysis of model-based virtual single cells\nTiming: about 1 h\nIn this section, we will show how to use the computational model to create and analyze a population of virtual single cells (macrophages).\nIn the “Current Folder” window in MATLAB, double click to open the file named “analysis_Fig7_virtualmacs.m”.\nRun the first section of the script. This will load the model.\nRun the second section of the script. This will create a sample model-based population of 100 virtual single cells.\nHere, we selected a set of 42 parameters that control the production and degradation of 10 modeled species (5 are important intracellular regulators, 5 are cytokines) and reassigned new values to them. This procedure was done 100 times to generate 100 new cells (in terms of 100 new parameterization of the set of 42 parameters). More technical details can be found in Transparent Methods in (Zhao et al., 2021[href=https://www.wicell.org#bib5]).\nRun the third section of the script (starting at line 163). This will plot the time-dependent M1-M2 phenotypes of the 100 newly generated virtual macrophages in hypoxia, as 100 trajectories (in terms of their relative M1 scores, M2 scores, and M1/M2 scores) (Troubleshooting 5[href=https://www.wicell.org#sec5.9]).\nThe phenotype behaviors of the original reference model were also plotted (in black bolded line).\nRun the fourth section of the script (starting at line 253). This will plot the time-dependent M1-M2 phenotypes of the 100 virtual macrophages in response to hypoxia plus interventions targeting STAT3 or STAT6, as 100 trajectories (in terms of their relative M1/M2 scores).",
    "Interventions targeting STAT3 or STAT6 were simulated here as decrease in their dephosphorylation rates (by changing the corresponding parameter values).\nThe phenotype behaviors of the original reference model were also plotted here to enable comparison (in black bolded line)."
  ],
  "subjectAreas": [
    "Chromatin Immunoprecipitation (Chip)",
    "Signal Transduction",
    "Computer Sciences",
    "Systems Biology"
  ],
  "bigAreas": [
    "Molecular Biology & Genetics"
  ]
}