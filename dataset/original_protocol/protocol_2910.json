{
  "id": 3080,
  "origin_website": "Cell",
  "title": "Protocol to identify novel immunotherapy biomarkers based on transcriptomic data in human cancers",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nManual installation of required package components\nTiming: 10 min\nInstall all R packages required for the transcriptomic data analysis.\n### R packages used in this step\noptions(stringsAsFactors = F)\ninstall.packages(\"pheatmap\", repos = \"https://mirrors.tuna.tsinghua.edu.cn/CRAN/[href=https://mirrors.tuna.tsinghua.edu.cn/CRAN/]\")\ninstall.packages(\"maftools\", repos = \"https://mirrors.tuna.tsinghua.edu.cn/CRAN/[href=https://mirrors.tuna.tsinghua.edu.cn/CRAN/]\")\ninstall.packages(\"RColorBrewer\", repos = \"https://mirrors.tuna.tsinghua.edu.cn/CRAN/[href=https://mirrors.tuna.tsinghua.edu.cn/CRAN/]\")\ninstall.packages(\"corrplot \", repos = \"https://mirrors.tuna.tsinghua.edu.cn/CRAN/[href=https://mirrors.tuna.tsinghua.edu.cn/CRAN/]\")\ninstall.packages(\"tidyverse\", repos = \"https://mirrors.tuna.tsinghua.edu.cn/CRAN/[href=https://mirrors.tuna.tsinghua.edu.cn/CRAN/]\")\nif (!require(\"BiocManager\", quietly = TRUE)) install.packages(\"BiocManager\")\nBiocManager::install(\"limma\")\nAcquisition of public datasets\nTiming: 30 min\nIn this step, relative datasets should be downloaded from data storage platforms.\nAcquisition of public immunotherapy datasets.\nNote: Most datasets comprising RNA-sequencing data from patients receiving immunotherapy could be downloaded from the Gene Expression Omnibus (GEO, http://www.ncbi.nlm.nih.gov/geo/[href=http://www.ncbi.nlm.nih.gov/geo/]) or the Tumor Immune Dysfunction and Exclusion (TIDE, http://tide.dfci.harvard.edu/[href=http://tide.dfci.harvard.edu/]) databases. The expression and clinical data of the IMvigor210 cohort could be obtained from the website (http://research-pub.gene.com/IMvigor210CoreBiologies/[href=http://research-pub.gene.com/IMvigor210CoreBiologies/]). The corresponding datasets identifier could be obtained in the key resources table[href=https://www.wicell.org#key-resources-table].\nAcquisition of the TCGA dataset.\nNote: The standardized TCGA pan-cancer dataset (TCGA Pan-Cancer (PANCAN)) could be downloaded from the UCSC (https://xenabrowser.net/[href=https://xenabrowser.net/]) database. The somatic mutation data are obtained from the TCGA (http://cancergenome.nih.gov/[href=http://cancergenome.nih.gov/]) database and then used to calculate the tumor mutation burden (TMB) by R package “maftools”.\n### R packages used in this step\nlibrary (maftools)\nlaml <- read.maf(maf = \"TCGA.mutect.maf.gz\")\nx = tmb(maf = laml)\nInvestigation of predictive value in a discovery cohort\nTiming: 1 h\nIn this step, we first choose one cohort as the discovery cohort containing comprehensive clinical information, such as the PRJEB23709 cohort. The predictive value, and clinical and immune correlation of the candidate gene is defined using the discovery cohort. Here, we show SECTM1 as an example (Figure 1[href=https://www.wicell.org#fig1]).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2655-Fig1.jpg\nFigure 1. Predictive value and immunological correlations of SECTM1 in the PRJEB23709 cohort\nReproduced with permission from iScience (Mei et al.1[href=https://www.wicell.org#bib1]).",
    "(A) SECTM1 expression levels in tumors from patients with different responses. Data presented as mean ± SD. Significance was calculated with Student’s t test. ∗∗∗p < 0.001.\n(B) ORR in patients with low and high SECTM1 expression. Significance was calculated with Pearson’s χ2 test. ∗∗∗p < 0.001.\n(C) Correlations between SECTM1 expression and OS and PFS time. Significance was calculated with Pearson correlation test.\n(D and E) Prognostic values of SECTM1 in terms of OS and PFS. Median SECTM1 expression was used as the cut-off value. Significance was calculated with log-rank test.\n(F) Cox regression analysis of prognosis-related factors in melanoma patients.\n(G) Heatmap showing correlations between SECTM1 and immunomodulators expression, including chemokines, receptors, MHCs, immunoinhibitors, and immunostimulators. Significance was calculated with Pearson correlation test.\nObtain candidate gene expression and evaluate its predictive value and clinical correlation.\nNote: Usually, the discovery cohort should contain as much clinical data as possible. If users aim to select a biomarker in pan-cancer or melanoma, we recommend the PRJEB23709 cohort as the discovery cohort. Concretely speaking, the correlations between candidate biomarkers and immunotherapeutic responses as well as survival time could be assessed, and multiple statistical methods could be used, such as t test, chi-square test, log-rank test, and Cox regression analysis.\nNote: This step is usually done without any programming software, just using widely used softwares such as Office-Excel, GraphPad Prism, and SPSS.\nNote: If the gene name is not stored as the gene symbol, it first needs to be converted to the gene symbol.\nCritical: Comparing the predictive value of the candidate biomarker with those of classical markers such as PD-L1 helps to illustrate the importance of the candidate biomarker.\nAssess the correlations between candidate gene and tumor immune microenvironment features.\n### R packages used in this step",
    "# Gene expression profile with genes as the row names and samples as the column names\nexpr = readRDS('expr.rds')\n# Tumor immune microenvironment (TME) features, taking chemokine genes for example\nfeatures = readRDS('chemokine.rds') # gene vector\n# calculation the correlation between candiate gene SECTM1 and chemokine genes\ncorrelation = data.frame(do.call(rbind,lapply(intersect(features,rownames(expr)),function(x) {\ntmp = cor.test(as.numeric(expr['SECTM1',]),as.numeric(expr[x,]),method='pearson')\nreturn(c(x,tmp$estimate,tmp$p.value)) })))\ncolnames(correlation) = c('feature','correlation','pvalue')\n# plot\nanno_col = data.frame(SECTM1=as.numeric(expr['SECTM1',]),Sample=colnames(expr)) %>% arrange(SECTM1) %>% column_to_rownames('Sample')\nmat = expr[intersect(features,rownames(expr)),intersect(rownames(anno_col),colnames(expr))]\npheatmap(mat, show_rownames=T, cluster_cols=F, cluster_rows=F, annotation_col=anno_col,scale='row')\nNote: The features of the tumor immune microenvironment include immunomodulators, the activities of the cancer immunity cycle, infiltration levels of TIICs, and the expression of inhibitory immune checkpoints, tumor purity, the detail information could be found in our previous studies.17[href=https://www.wicell.org#bib17],18[href=https://www.wicell.org#bib18]\nGeneralization of results in more public cohorts\nTiming: 1 h\nIn this section, the predictive value of the candidate gene should be explored in as many clinical as possible. In general, the more datasets with expression differences of candidate genes between responders and non-responders, the more stable predictive value of candidate genes. Here, we show SECTM1 as an example, SECTM1 is dys-regulated in tumors from responders and non-responders in at least six other clinical cohorts (Figure 2[href=https://www.wicell.org#fig2]).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2655-Fig2.jpg\nFigure 2. Predictive value and immunological correlations of SECTM1 in six cohorts\nReproduced with permission from iScience (Mei et al.1[href=https://www.wicell.org#bib1]).\n(A–F) Comparison of predictive values of SECTM1, PD-L1, IFN-γ and the SECTM1/PD-L1 combination for immunotherapy responses in six cohorts. The predictive value of the combination of SECTM1 and PD-L1 was estimated by binary logistic regression using SPSS 26. Receiver-operating characteristic (ROC) analysis was plotted to assess the specificity and sensitivity of the candidate indicator, and the area under the ROC curve (AUC) was generated for diagnostic biomarkers.",
    "(G) Heatmap showing correlations between SECTM1 and immunomodulators expression, including chemokines, receptors, MHCs, immunoinhibitors, and immunostimulators. Significance was calculated with Pearson correlation test.\nObtain candidate gene expression and evaluate its predictive values in more cohorts.\nTo make it easier to load the gene list, the .rds file is used. To generate the .rds file, the function “saveRDS” is performed. The command is as follows: saveRDS(genelist, file = “genelist.rds”).\nNote: The .rds file is a document format like .txt and .xlsx.\nNote: The “genelist” is a variable storing a list of genes (Table 1[href=https://www.wicell.org#tbl1]).\nNote: This step is usually done without any programming software, just using widely used softwares such as Office-Excel, GraphPad Prism, and SPSS.\nNote: If the gene name is not stored as the gene symbol, it first needs to be converted to the gene symbol.\nCritical: Comparing the predictive value of the candidate biomarker with those of classical biomarkers such as PD-L1 helps to illustrate the importance of the candidate biomarker.\nAssess the correlations between candidate gene and tumor immune microenvironment features.\ntable:files/protocols_protocol_2655_1.csv\n### R packages used in this step\n# path for gene expression profiles\nexprPath = c('GSE100797.rds','GSE176307.rds','IMvigor210.rds','GSE173139.rds','GSE126244.rds','GSE135222.rds')\n# tumor immune microenvironment (TME) features, taking chemokine genes for example\nfeatures = readRDS('chemokine.rds') # gene vector\n# calculation the correlation between candiate gene SECTM1 and chemokine genes in each dataset\ncorrelation = data.frame(do.call(cbind,lapply(exprPath,function(path){\nexpr = readRDS(path)\nrs = sapply(intersect(features,rownames(expr)),function(x){\nreturn(cor.test(as.numeric(expr['SECTM1',]),as.numeric(expr[x,]),method='pearson')$estimate) })\nreturn(data.frame(correlation=rs, row.names=intersect(features,rownames(expr)))) })))\ncolnames(correlation) = gsub('\\\\..∗','',exprPath)\npheatmap(correlation, show_rownames=T, show_colnames=T, cluster_cols=F, cluster_rows=F)\nNote: The features of the tumor immune microenvironment include immunomodulators, the activities of the cancer immunity cycle, infiltration levels of TIICs, and the expression of inhibitory immune checkpoints, tumor purity, the detail information could be found in our previous studies.17[href=https://www.wicell.org#bib17],18[href=https://www.wicell.org#bib18]\nInvestigation of associations with established immunotherapy biomarkers\nTiming: 1 h",
    "In this section, the correlations between candidate gene and established immunotherapy biomarkers should be evaluated using available data in above cohort. Here, we show SECTM1 as an example (Figure 3[href=https://www.wicell.org#fig3]).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2655-Fig3.jpg\nFigure 3. Associations between SECTM1 expression and established immunotherapy biomarkers\nReproduced with permission from iScience (Mei et al.1[href=https://www.wicell.org#bib1]).\n(A) Expression of SECTM1 in tumors with various PD-L1 IC score. Data are presented as mean ± SD. Significance was calculated with 1-way ANOVA with Tukey’s multiple-comparison test. ∗p < 0.05; ∗∗∗p < 0.001.\n(B) Expression of SECTM1 in tumors with various PD-L1 TC score. Data are presented as mean ± SD. Significance was calculated with 1-way ANOVA with Tukey’s multiple-comparison test. ∗∗∗p < 0.001.\n(C) Expression of SECTM1 in tumors with various immuno-subtypes. Data are presented as mean ± SD. Significance was calculated with 1-way ANOVA with Tukey’s multiple-comparison test. ∗∗∗p < 0.001.\n(D) Correlation between SECTM1 expression and neoantigen burden. Significance was calculated with Pearson correlation test.\n(E) Expression of SECTM1 in tumors with various TMB levels. Data are presented as mean ± SD. Significance was calculated with 1-way ANOVA with Tukey’s multiple-comparison test. ∗p < 0.05.\n(F) Correlation between SECTM1 expression and TMB levels. Significance was calculated with Pearson correlation test.\nAcquisition of established immunotherapy biomarkers.\nNote: Well-established immunotherapy biomarkers include PD-L1 expression, tumor mutation burden (TMB) level, immune infiltration, and microsatellite instability (MSI) status.19[href=https://www.wicell.org#bib19]\nEvaluate the correlations with established immunotherapy biomarkers.\nNote: This step is usually done without any programming software, just using widely used softwares such as Office-Excel, GraphPad Prism, and SPSS.\nPan-cancer analysis of immuno-correlations\nTiming: 1 h",
    "Pan-cancer analysis of immuno-correlations of candidate gene is often necessary in this protocol. Since immunotherapy is not strictly tumor specific, pan-cancer analysis can help identify more tumor species for which candidate biomarker are potentially applicable. Here, we show SECTM1 as an example (Figure 4[href=https://www.wicell.org#fig4]).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2655-Fig4.jpg\nFigure 4. Pan-cancer analysis of immunological correlations of SECTM1\nReproduced with permission from iScience (Mei et al.1[href=https://www.wicell.org#bib1]).\n(A) Correlations between SECTM1 and immunomodulators expression in pan-cancer, including chemokine, receptor, MHC, immunoinhibitors, and immunostimulators. Significance was calculated with Pearson correlation test.\n(B) SECTM1 was negatively correlated with DNA mismatch repair genes in gastric cancer. Significance was calculated with Pearson correlation test.∗p < 0.05; ∗∗p < 0.01; ∗∗∗p < 0.001.\n(C) SECTM1 was negatively correlated with DNA mismatch repair genes in colorectal cancer. Significance was calculated with Pearson correlation test.∗∗∗p < 0.001.\nCorrelations between candidate and tumor immune microenvironment features in pan-cancer.\n### R packages used in this step\n# gene expression profile with genes as the row names and samples as the column names\nexpr = readRDS('expr_pancancer.rds')\n# data holding the tumor type of samples\ntype = readRDS('type_pancancer.rds')\n# tumor immune microenvironment (TME) features\nfeaturePath = c('chemokine.rds','receptor.rds','MHC.rds','immunoinhibitor.rds','immunostimulator.rds')\nfeatures = data.frame(do.call(rbind,lapply(featurePath,function(x){return(data.frame(feature=readRDS(x),type=gsub('\\\\..∗','',x)))})))\n# calculation the correlation between candidate gene SECTM1 and chemokine genes in each cancer type\ncorrelation = data.frame(do.call(cbind,lapply(sort(as.character(unique(type$tumor_type))),function(tumor_type){\nexpr = expr[,intersect(rownames(type)[which(type$tumor_type==tumor_type)],colnames(expr))]\nreturn(data.frame(correlation=sapply(intersect(features$feature,rownames(expr)),function(x){return(cor.test(as.numeric(expr['SECTM1',]),as.numeric(expr[x,]),method='pearson')$estimate) }), row.names=intersect(features$feature,rownames(expr)))) })))\ncolnames(correlation) = sort(as.character(unique(type$tumor_type)))\nanno_col = features %>% column_to_rownames('feature')\npheatmap(correlation, show_rownames=T, show_colnames=T, cluster_cols=F, cluster_rows=F,annotation_col=anno_col)\nNote: The features of the tumor immune microenvironment include immunomodulators, the activities of the cancer immunity cycle, infiltration levels of TIICs, and the expression of inhibitory immune checkpoints, tumor purity, the detail information could be found in our previous studies.17[href=https://www.wicell.org#bib17],18[href=https://www.wicell.org#bib18]\nAlternatives: Sangerbox,20[href=https://www.wicell.org#bib20] a user-interactive online tool, could provide R code-free pan-cancer analysis.\nCorrelations between candidate and MSI gene expression.\n### R packages used in this step",
    "# gene expression profile with genes as the row names and samples as the column names\nexpr = readRDS('expr.rds')\n# MSI genes\nmsi = readRDS('MSI_gene.rds')\n# correlation heatmap\ncor = cor(as.matrix(expr[intersect(c('SECTM1',msi),rownames(expr)),]))\np.mat = cor.mtest(as.matrix(mat))\ncorrplot(cor,col = rev(colorRampPalette(brewer.pal(10,\"RdBu\"))(20)),p.mat = p.mat, sig.level = 0.05, insig = \"blank\")\nNote: If the candidate gene could be used as a pan-cancer biomarker, the association between the candidate gene and MSI status should be validated in gastrointestinal tumors.\nValidation of immuno-correlations and predictive value in in-house cohorts\nTiming: 1–2 weeks\nCritical: Although the validation of the candidate at protein level is not necessary, it will greatly increase the reliability of the study. There is a certain degree of inconsistency between mRNA and protein.\nIn this section, the immuno-correlations and predictive value of candidate gene are validated using in-house cohorts. In general, this section usually consists of two steps to verify the immuno-correlations and predictive value of the candidate gene. As far as possible, samples unaffected by unrelated treatments need to be selected for all in-house cohorts. Here, we show SECTM1 as an example (Figures 5[href=https://www.wicell.org#fig5] and 6[href=https://www.wicell.org#fig6]).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2655-Fig5.jpg\nFigure 5. Correlation between SECTM1 expression and immuno-subtypes\nReproduced with permission from iScience (Mei et al.1[href=https://www.wicell.org#bib1]).\n(A) Schematic protocol of validation on the TMA cohort.\n(B) Representative images revealing the distribution of CD8+ T cells in tumors with different immuno-subtypes. Magnification, 200×.\n(C) Representative images revealing SECTM1 and PD-L1 expression in tumors with different immuno-subtypes in lung cancer and semi-quantitative analysis of expression levels of SECTM1 and PD-L1. Magnification, 200×. Data are presented as mean ± SD. Significance was calculated with Kruskal-Wallis test with Dunn’s multiple-comparison test. ∗p < 0.05; ∗∗p < 0.01.",
    "(D) Representative images revealing SECTM1 and PD-L1 expression in tumors with different immuno-subtypes in breast cancer and semi-quantitative analysis of expression levels of SECTM1 and PD-L1. Magnification, 200×. Data are presented as mean ± SD. Significance was calculated with Kruskal-Wallis test with Dunn’s multiple-comparison test. ∗∗p < 0.01; ∗∗∗p < 0.001.\n(E) Schematic protocol of validation on the recruited gastric cancer cohort.\n(F) Representative images revealing SECTM1 expression in tumors with different MMR status in gastric cancer and semi-quantitative analysis of expression levels of SECTM1. Magnification, 200×. Significance was calculated with Mann-Whitney test. ∗p < 0.05.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/2655-Fig6.jpg\nFigure 6. Validation of predictive value of SECTM1 for immunotherapy\nReproduced with permission from iScience (Mei et al.1[href=https://www.wicell.org#bib1]).\n(A) Diagram of involved lung cancer cohorts in this research.\n(B) Representative CT images showing patients with different therapeutic responses.\n(C) Representative images uncovering SECTM1 and PD-L1 expression in tumors from patients with different responses.\n(D) Semi-quantitative analysis of expression of SECTM1 in tumors from patients with different responses in cohort 1. Significance was calculated with Mann-Whitney test. ∗p < 0.05.\n(E) Circulating SECTM1 levels in patients with different responses in cohort 1. Significance was calculated with Student’s t test. ∗p < 0.05.\n(F) Correlation between tumor-expressed and circulating SECTM1 in cohort 1. Significance was calculated with Spearman correlation test.\n(G and H) Circulating SECTM1 levels in patients with different responses in cohort 2 and merged cohort. Significance was calculated with Student’s t test. ∗p < 0.05; ∗∗p < 0.01.\nValidate immuno-correlations in in-house cohorts.",
    "Note: The associations between candidate gene and PD-L1 expression as well as CD8+ T cell distribution generally need to be verified. Tumors are discriminated into 3 phenotypes following the spatial distribution of CD8+ T cells, including the inflamed, the excluded, and the deserted subtypes. The inflamed subtype is considered to be immuno-hot, and both excluded and deserted subtypes are considered to be immuno-cold.21[href=https://www.wicell.org#bib21]\nNote: If the candidate gene could be used as a pan-cancer biomarker, the association between the candidate gene and MSI status should be validated in gastrointestinal tumors.\nNote: This step is usually done without any programming software, just using widely used softwares such as Office-Excel, GraphPad Prism, and SPSS.\nAlternatives: Immunohistochemical (IHC) staining is the most commonly used method,1[href=https://www.wicell.org#bib1] immunofluorescence, flow cytometry, ELISA, Western blotting, etc., can also be used.\nCritical: As flow cytometry, ELISA, Western blotting could not recognize the spatial localization of CD8 expression, there is no further discrimination of immune subtypes. Thus, IHC and immunofluorescence are preferentially recommended.\nValidate predictive value in in-house cohorts.\nNote: This step is usually done without any programming software, just using widely used softwares such as Office-Excel, GraphPad Prism, and SPSS.\nNote: If the candidate protein could be secreted by tumor cells, it is recommended to check the level of the candidate protein in serum/plasma.\nAlternatives: Immunohistochemical (IHC) staining is the most commonly used method, immunofluorescence, flow cytometry, ELISA, Western blotting, etc., can also be used.\nCritical: Comparing the predictive value of the candidate marker with those of classical markers such as PD-L1 helps to illustrate the importance of the candidate biomarker."
  ],
  "subjectAreas": [
    "Rnaseq",
    "Sequence Analysis",
    "Gene Expression",
    "Immunology",
    "Bioinformatics",
    "Cancer",
    "Clinical Protocol"
  ],
  "bigAreas": [
    "Biomedical & Clinical Research",
    "Molecular Biology & Genetics",
    "Bioinformatics & Computational Biology"
  ]
}