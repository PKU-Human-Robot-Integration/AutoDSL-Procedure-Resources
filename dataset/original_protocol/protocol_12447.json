{
  "id": 14133,
  "origin_website": "Jove",
  "title": "Cortical Source Analysis of High-Density EEG Recordings in Children",
  "procedures": [
    "1. Designing EEG & Event related potential experiments for children\nNote: A simple experiment was designed for the purposes of this article that may be used to investigate face processing in young children. The following section will describe the experiment and explain how to implement it using MATLAB R2012b and Psychtoolbox V3.0.1123,24.  Pictures taken from the NimStim set of emotional facial expression25 were used for this example. This stimulus set is available for research purposes upon request (http://www.macbrain.org/resources.htm[href=http://www.macbrain.org/resources.htm]).\nTransfer the RGB pictures to grey scale to reduce differences between stimuli. See Table 1. Note: These commands require the Image Processing Toolbox (http://www.mathworks.co.uk/products/image/[href=http://www.mathworks.co.uk/products/image/]). Free alternatives may be found through the File Exchange (https://www.mathworks.co.uk/matlabcentral/fileexchange[href=https://www.mathworks.co.uk/matlabcentral/fileexchange]).\nUse experimental control software to implement the experiment with precise timing for stimulus presentation triggers using a series of commands (see Table 1 for an example).\n2. Data Acquisition\nEnsure that the child is comfortable with the testing environment. Allow younger children to sit on the lap of their caregiver or in a comfortable child’s seat. Let the child see and feel the sensor net before applying it to the child’s head.  If there is an extra net, have the parent also try one on, or place one on a doll or stuffed teddy. \nMeasure the maximum head circumference to select the correct net size for the child. Use a measuring tape and hold it to the nasion. Then measure around the head around the maximum circumference (~1 cm above the inion). Note: keep a record of the measured head circumference and the sensor net used for later analysis26. It helps if the parents head is also measured to make children more comfortable with the situation.",
    "Identify the vertex of the head at the intersection of the mid distance between nasion and inion and left and right periauricular point. Mark this point with a china pen to ensure that the vertex channel is correctly positioned when applying the net.\nApply the sensor net and make sure that key channels are aligned with the anatomical landmarks (nasion, inion, vertex and left/right mastoids). Note: For the most accurate results, the position of the channels on the head can be digitally acquired using special digitization equipment. Researchers wishing to acquire the sensor position should refer to the appropriate hardware and software manuals. Alternatively, electrode maps that assume standard placement of electrodes along anatomical landmarks can be used. These maps can be warped to age appropriate head models as described in the analysis section.\nEnsure that channels have good contact with the scalp by positioning the sensors individually; gently twist each sensor from side to side to move hair out of the way.\nMeasure channel gains and channel impedances. Click “Start” to begin the recording in NetStation EEG recording software and start gain and impedance measurement. If measurement does not automatically start, use the “Calibrate Amplifier” and the “Measure Net Impedances” button.\nCheck the recording software for channels with impedances higher than 50 kΩ which will appear red. Apply additional electrolyte solution with a pipette to lower channel impedances. Check the EEG display for channels that show high frequency activity despite low impedance or noticeably less activity than surrounding channels (flat line channels). These channels may have loose contact with the scalp and require adjustment.\nIn order to keep children comfortable during the EEG preparation, allow the child to listen to music, watch an age appropriate cartoon or distract them using another experimenter, e.g., blowing soap bubbles for toddlers.",
    "3. Analysis\nPreprocessing\n\t\nDigitally filter the data with a high pass filter with a cut off at 0.1 Hz to remove channel drifts27 (Table 1).\nFor ERP analysis, apply a low pass filter with a cut off at 30 Hz27 (Table 1).\nEpoch the continuous data according to the trigger codes set during recording. For most experiments, use a baseline of 200 msec prior to stimulus onset and a post stimulus interval of 600 msec to cover the time interval of interest (Table 1).\nRemove epochs that contain movement or blink artifacts: mark channels with a peak to peak amplitude higher than 150 mV - adjust this threshold depending on the participant group and data quality. For consistency, use the same threshold for all participants in one study. If a channel is above this threshold in more than 30% of the epochs, remove the channel (channel activity may be interpolated from surrounding channels, if these contain acceptable data). If more than 20% of the channels are marked as bad in an epoch, remove the epoch. If more than 20% of channels are rejected by the algorithm or less than 50% of epochs are retained, consider removing the dataset from further analysis (Table 1).\n\t\tNote: The percentage thresholds for epoch and channel rejection are ballpark figures that remove a sufficient amount of noise in our experience. The amount of artifact in the recording is likely to be different using other participant groups, experimental paradigms or EEG systems. The experimenters may want to adjust the percentage thresholds and check if they are satisfied with the artifact rejection. Alternatively, experimenters can reject trials that contain artifact through visual inspection.",
    "Re reference to average reference by subtracting the mean activity across channels from each channel (Table 1). Note: The vertex electrode is typically used as the recording reference in NetStation.\nArtifact Correction Using Independent Component Analysis\n\t\nImport the data into the FASTER toolbox28 and run the automatic artifact rejection algorithm on the data (Table 1).\nUse the Graphical User Interface (GUI) for FASTER; to open the GUI, type FASTER_GUI into the command line.\nDeselect the filtering options in the filtering menu as the data has already been filtered before the epoching.\nSpecify the number of channels: 126 EEG channels with 2 electrooculagram (EOG) channels.\nEnter the markers used for epoching the data as strings in a cell array. For the presented case enter: {‘face’,‘scra’} for the face and scrambled face conditions.\nSelect the channels for the independent component analysis (ICA). Typically select all recording channels, incl. external non EEG channels.\nSpecify the input and output folder in the right pane of the GUI.\nSelect the appropriate channel file for the recordings. Note: Channel files for most EEG system can either be downloaded from the manufacturer or can be downloaded from the EEGLAB website.\nClick RUN to start FASTER processing. Depending on the length of the recordings and the number of files, this processing can take several hours.\nVisually inspect the recordings, independent component maps and ERPs after the processing.\nChannel Level Analysis of Event-related Potentials Data\n\t\nCombine several channels to form a virtual channel with better signal to noise ratio (Table 1). Note: The selection of channels should be based on previous reports in the literature or a priori hypotheses. Selecting channels that show the highest amplitude within a given time window is not advised29.",
    "Obtain measures like peak amplitude, mean amplitude and peak latency to characterize the waveform and perform statistical tests (Table 1).\nCreate Boundary Element Models (BEM)\n\t\nSegment the anatomical MRI scan with FreeSurfer. Note: For the most accurate results, base the boundary element model on individual MRI scans for each participant. If this is not feasible, average MRI templates that match the participants’ age as closely as possible should be used. Please note that BEMs cannot be used for children under 24 months. Boundary element models assume that each shell (brain, skull, skin) consists of a closed shell. However, in young children the fontanelles in the skull are not closed, which violates the closed shell assumption.\n\t\t\nIn order to install FreeSurfer software, first download it from the FreeSurfer website (http://freesurfer.net/fswiki/DownloadAndInstall[href=http://freesurfer.net/fswiki/DownloadAndInstall]). Next, set up the shell environment include FreeSurfer; for .bashrc, include the following commands in the .bashrc file:\n\t\t\t\nExport FREESURFER_HOME=/Applications/freesurfer/\nSource $FREESURFER_HOME/FreeSurferEnv.sh\n\t\t\t\tNote: These commands assume that the FreeSurfer folder is in the Applications folder on a Unix system. There are more details on how to setup FreeSurfer with alternative shell environments, e.g. csh/tcsh, or operating systems on the FreeSurfer website (http://freesurfer.net/fswiki/DownloadAndInstall[href=http://freesurfer.net/fswiki/DownloadAndInstall]).\nNext, define the Subject directory, i.e. the folder that the output will be written to using the following command:\n\t\t\t\nexport SUBJECTS_DIR=/…/BEMs/\n\t\t\t\tNote: The results may be written to any folder on the system.\nNext, change the working directory to the folder that contains the MRI file for the Boundary Element Model using the following command:\n\t\t\t\ncd /Users/joebathelt/Neurodevelopmental_MRI_database/Children/Brain/\n\t\t\t\tNote: Any folder on the system may be specified using the syntax of the cd command. This is an example of the primary researchers file structure.\nFinally, start the reconstruction using the following commands:\n\t\t\t\nrecon-all -i <mri_file> -subjid <subject_id>\nrecon-all -all -subjid <subject_id>",
    "Note: <mri_file> needs to be replaced with the filename of the desired MRI scans in the current directory. <subject_id> can be replaced with any name. FreeSurfer will create a folder with this name in the subject directory. Depending on the system used, the last commands may require some time to run.\nCheck the FreeSurfer segmentation for incorrect segmentation, e.g. overlapping spheres, anatomically unlikely compartments etc. by importing the segments into BrainStorm and use the display tools in the GUI:\n\t\t\nIn BrainStorm, select the anatomy pane. Import the segmented MRI by right clicking on the subject and selecting “Import Anatomy Folder”. Ensure the folder with the FreeSurfer output is selected. Inspect the segmentation visually by right clicking and selecting “Display”. Note: Alternatively, FreeSurfer commands can be used. A detailed description can be found on the FreeSurfer website: http://surfer.nmr.mgh.harvard.edu/fswiki/RecommendedReconstruction[href=http://surfer.nmr.mgh.harvard.edu/fswiki/RecommendedReconstruction]. If region of interest analysis based on anatomical parcellation is desired, the FreeSurfer functions mris_ca_label[href=https://surfer.nmr.mgh.harvard.edu/fswiki/mris_ca_label?action=fullsearch&context=180&value=linkto%3A%22mris_ca_label%22], mri_annotation2label[href=https://surfer.nmr.mgh.harvard.edu/fswiki/mri_annotation2label?action=fullsearch&context=180&value=linkto%3A%22mri_annotation2label%22] and mri_mergelabels[href=https://surfer.nmr.mgh.harvard.edu/fswiki/mri_mergelabels?action=fullsearch&context=180&value=linkto%3A%22mri_mergelabels%22] can be used. Refer to the FreeSurfer publications and online help pages for more detailed information.\nEstimate the Source Activity in BrainStorm\n\t\nStart BrainStorm by typing “brainstorm” in the command window.\nCreate a new protocol by selecting New Protocol from the File menu.\nAdd a new subject to the protocol by selecting New Subject from the File menu.\nImport EEG data for the participant by right-clicking on the subject and selecting “Import MEG/EEG”.",
    "Import a channel file by right clicking and choosing “Import channel file”. Note: The channel file needs to be aligned to the MRI for source reconstruction. BrainStorm uses a system of 4 anatomical reference points that the user needs to mark in the MRI. Please refer to the BrainStorm tutorials for more information (http://neuroimage.usc.edu/brainstorm/CoordinateSystems[href=http://neuroimage.usc.edu/brainstorm/CoordinateSystems]). The standard position as defined by a channel file for a certain EEG system or, ideally, the head positions that were digitized prior to the EEG recording can be used.\nCheck that the BEM and the channels align as expected: Right click on the channel file for the subject and navigate to “MRI registration” and “Check”. Note: If the spheres within the model are overlapping or if the channels are within the BEM, the source reconstruction will produce incorrect results. Adjust the alignment by using the “Edit” option in the “MRI segmentation” menu.\nCalculate the noise covariance matrix from the baseline of each epoch by right clicking on the participant and choosing “Noise Covariance Matrix” and “Calculate from Recording”. Note: The authors of the BrainStorm toolbox recommend using a diagonal noise covariance matrix for short recordings (~ less time points than channels) and a full one for longer recordings. Please refer to the BrainStorm Source Estimation tutorial for more information: http://neuroimage.usc.edu/brainstorm/Tutorials/TutSourceEstimation[href=http://neuroimage.usc.edu/brainstorm/Tutorials/TutSourceEstimation] .\nCalculate the Source Model by right clicking on the subject and selecting “Compute source model”.",
    "Calculate the inverse solution using depth weighted Minimum Norm Estimation by right clicking on the subject and selecting “Compute Source” and “Minimum norm estimation”. Note: Other options (dSPM, sLORETA) are available. Each option has different advantages and drawbacks. The algorithm should be selected based on a priori considerations and previous reports in the literature. Further, some algorithms are better in resolving focal activation in certain areas, whereas others are more suitable for wide-spread activation. MNE was used for this study based on previous reports in the literature16. For consistency, the same algorithm for inverse solution should be used for all participants in one study. Researchers may also want to compare how robust findings are to the application of different inverse solution algorithms. \nRepeat Section 3 for all participants in the study. Note: Either use the graphical batching interface or scripts to repeat processing steps for participants. See the BrainStorm documentation for instructions (http://neuroimage.usc.edu/brainstorm/Tutorials/TutRawScript[href=http://neuroimage.usc.edu/brainstorm/Tutorials/TutRawScript]).\nAverage source activity over trials per participants by dragging the recordings to the Process Menu and selecting “Average” and “By condition (subject average)”.\nContrast the condition by selecting the “Processes 2” and dragging each condition in one window. Then, select “Test” and “Student’s t-test” or “Student’s t-test (paired)” depending on design. To perform multiple comparisons, set amplitude and area thresholds in the display of the resulting statistical map in the “Stat” menu. Note: Alternatively, the activation maps can be exported to SPM (http://www.fil.ion.ucl.ac.uk/spm/[href=http://www.fil.ion.ucl.ac.uk/spm/]) for more in-depth statistical analysis (http://neuroimage.usc.edu/brainstorm/ExportSpm12 HYPERLINK \"http://neuroimage.usc.edu/brainstorm/ExportSpm12\")[href=http://neuroimage.usc.edu/brainstorm/ExportSpm12%20HYPERLINK%20%22http:/neuroimage.usc.edu/brainstorm/ExportSpm12%22)].\nCalculate the event-related response for a region of interest. For parcellation based ROIs, load the FreeSurfer parcellation by right clicking on the cortex surface in the anatomy menu and select “Import labels”. Navigate the corresponding file and load it. Now, select a ROI in the “Scout” pane of the functional data menu.",
    "Obtain the ROI event related activity by dragging files to the Process 1 window and select “Extract Scout Time Series” from the Sources menu. Note: Several ROIs can be selected simultaneously and the ROI time series can be exported for further plotting and analysis by right-clicking on the scout time series data and selecting “Export to Matlab”.\nSubscription Required. Please recommend JoVE to your librarian."
  ],
  "subjectAreas": [
    "Behavior"
  ],
  "bigAreas": [
    "Ecology & Environmental Biology"
  ]
}