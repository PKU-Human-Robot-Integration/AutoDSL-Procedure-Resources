{
  "id": 4076,
  "origin_website": "Cell",
  "title": "Building predictive signaling models by perturbing yeast cells with time-varying stimulations resulting in distinct signaling responses",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nMeasure signaling activation dynamics upon time-varying cell stimulation conditions\nTiming: 1–4 days\nTiming: 3 h for step 1\nTiming: 2 h per time-lapse for step 3\nTo mimic physiological conditions, we have reported general experimental methodologies to precisely control the temporal changes of extracellular stimuli for different cell types (Thiemicke et al., 2019[href=https://www.wicell.org#bib25]). Here, we outline the steps to perturb yeast single cells with osmo-stress concentrations that change over time and to measure and quantify the HOG signaling pathway activation dynamics upon different osmostress gradients (Figure 1[href=https://www.wicell.org#fig1]). We used a strain with a yellow-fluorescent protein (YFP) tagged to the C-terminus of endogenous Hog1 in Saccharomyces cerevisiae BY4741 yeast (through homologous DNA recombination) and quantified the nuclear enrichment of Hog1 terminal kinase in single cells as a readout for the pathway activation using time-lapse fluorescent microscopy.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/786-Fig1.jpg\nFigure 1. Experimental procedure to perturb cells with stimulant concentrations that change over time and to measure and quantify signaling activation response dynamics upon different cell stimulation profiles\n(A) To mimic physiologically relevant cell environments, time-varying cell culture environments are implemented. Experimental setup to generate and perturb cells with stimulant concentrations that change over time in the laboratory is reported in Ref (Thiemicke et al., 2019[href=https://www.wicell.org#bib25]).\n(B and C) (B) Cell cultures treated with time-varying stimulations (C) are followed over time in a microfluidic flow chamber on a fluorescent microscope.\n(D) Measured bright field and fluorescent images of yeast cells (gray) are collected overtime showing nuclear localization of the yellow fluorescent protein (YFP) tagged Hog1 mitogen-activated protein kinase (MAPK, red). Scalebar is 2 μm. (see Methods video S1[href=https://www.wicell.org#mmc1] for the time-lapse microscopy images of multiple cells).",
    "(E) Image processing codes for cell segmentation and quantification of single cell data are reported in Refs (Johnson et al., 2021[href=https://www.wicell.org#bib9]; Kesler et al., 2019[href=https://www.wicell.org#bib10]). Signaling activation time-traces measured and quantified using immunoblotting such as in Ref (English et al., 2015[href=https://www.wicell.org#bib1]) or using fluorescent flow cytometry as in Ref (Thiemicke and Neuert, 2021[href=https://www.wicell.org#bib26]) could also be used to parametrize the underlaying signaling models following this protocol.\n(F) MAPK Hog1 nuclear localization dynamics upon step increases in NaCl to different final concentrations.\n(G) Hog1 dynamics upon step, linear or quadratic increases from 0 M to 0.4 M NaCl in 10 min then switch back to growth media of 0 M. Lines are means and shaded areas are the standard deviations of the means from six (control condition) or three (remaining conditions) biological replicates measured and quantified following (A) to (E). Data presented in (F and G) are from Ref (Jashnsaz et al., 2020[href=https://www.wicell.org#bib7]) with permission.\n(H) A schematic (cartoon) representative summary of experimental results showing how different extracellular time-varying stimulations (left) activate a signaling pathway (middle) and result in distinct dynamics of kinase signaling and nuclear localization (right). See also Methods video S1[href=https://www.wicell.org#mmc1].\nNote: Yeast cells are grown (200 rpm, 30°C) prior to the experiment to reach the target OD600 of 0.50 at the start of the experiment (see section before you begin[href=https://www.wicell.org#before-you-begin]).\nGenerate the pump profile.\nDownload the codes to generate the pump profiles and see Ref. (Thiemicke et al., 2019[href=https://www.wicell.org#bib25]) for the algorithm used to set up the pump profiles (codes: Jashnsaz_STARProtocols_2021/Jashnsaz_et_al_dir06_GeneratePumpProfiles).",
    "In the above directory, follow steps 1 to 5 in README.txt, to use the MATLAB codes and excel files to set up and generate the desired pump profiles and load them to the syringe pump to be used to perturb cells according to time-varying profiles (Figure 1[href=https://www.wicell.org#fig1]A) during the time-lapse experiments.\nPrepare the flow setup.\nPrepare the experimental setup of the microfluidic flow chamber on a microscope according to Figure 2[href=https://www.wicell.org#fig2]C in Ref. (Thiemicke et al., 2019[href=https://www.wicell.org#bib25]). A programmed pump (see step 1) adds a concentrated stimulus gradually to a mixing beaker at constant magnet stirring. A second pump of a constant low rate delivers the time-varying stimulus generated in the mixing beaker to the cells loaded into a flow chamber (see step 3) through tubing. A 3-way valve determines if the cells are exposed to normal media (0 M) or to a temporal gradient generated in the mixing beaker.\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/786-Fig2.jpg\nFigure 2. Model signal transduction networks as dynamic ODE system with parameters inferred from experimental signaling data\n(A) The signaling pathway is represented as a network diagram with nodes representing proteins and lines representing regulation activities. Arrow-headed lines represent positive regulations; dash-headed lines represent negative regulations; dashed lines represent basal regulations on each node; top nodes represent sensors stimulated by the input; and the final node represents the terminal kinase.\n(B) Regulation graphs are represented as square matrices with the number of rows equal to the number of network nodes, where a +1 (or -1) in the (i,j) entry denotes a positive (or negative) influence of jth input, basal regulator or enzyme on the regulation of the ith node.\n(C) The MATLAB code implementation of the matrix arrangement of the network.",
    "(D) Each regulation is modeled as a Michaelis-Menten (MM) reaction. A representative positive regulation, where the active form of node x3 converts node x4 from its inactive to its active form (orange box in B) through a Michaelis-Menten function consisting of two parameters, the catalytic rate constant (   k  c a t    ) and the Michaelis-Menten constant (   K  M M    ).\n(E) The pathway is compiled as a dynamic ordinary differential equation (ODE) system by calling the appropriate MM function (positive, negative, none) using the arranged matrices form in (B and C), with the vector of parameters   Λ =  (   λ 1  ,  λ 2  , …  )    arranged such that odd entries correspond to catalytic rate constants and even entries correspond to the MM constants.\n(F) Optimization algorithm to parametrize the model using signaling data. The algorithm consists of a customized Genetic Algorithm (GA) and the MATLAB built-in fminsearch function. The algorithm takes a model and a set of training data and returns a set of best parameters (Λ∗) that maximizes the likelihood of observing the training data. This task is done by minimizing the objective function (blue boxes) defined as the sum of squared residuals between the model and data over the time-traces of all the training datasets. Refer to section Optimization algorithm in step 2 for details.\n(G) The HOG pathway is modeled as a 4-node network of SLN1 and SHO1 branches each stimulated by the input, both regulating Pbs2, that in turn regulates Hog1 terminal kinase (see step 2 for details).",
    "(H) Ten independent fits (red) of model in (G) simultaneously to measured Hog1 nuclear localization data (black) upon steps of 0.2 M and 0.4 M NaCl (Figure 1[href=https://www.wicell.org#fig1]F). Out of multiple independent training, the parameter set resulting in best predictions for signaling activation upon new experimental conditions (Figure 1[href=https://www.wicell.org#fig1]G) are given in Table S1 (   Λ 0   ) in Ref (Jashnsaz et al., 2020[href=https://www.wicell.org#bib7]). This set (referred to as the “true parameter set”) is used to simulate synthetic data upon wider time-varying stimulation inputs (Figure 3[href=https://www.wicell.org#fig3]). Figures 2[href=https://www.wicell.org#fig2]A, 2B, 2D, 2E, and 2H are reprinted with permission from Ref (Jashnsaz et al., 2020[href=https://www.wicell.org#bib7]).\nNote: Loading cells into flow chamber according to the following protocol provides an optimal cell density under the microscope for cells of OD600 between 0.40 and 0.55.\nNote: For reproducibility, we recommend using at least three biological replicates for each cell stimulation profile condition. The ideal biological replicates are independently grown cell cultures initiated from independent pre-cultures each inoculated from different single colonies.\nAssemble the flow chambers.\nUse a razor blade to cut off all the access glue and tubing on the bottom of the acryl slide.\nGlue one side of the double sticky T-shaped spacer on the Pyrex slide with the tubing. Make sure all the tubing inlets are accessible. Use a plastic pen and move it over the T-shaped spacer to remove all the air bubbles. This helps to reduce air leaking into the flow chamber later in the experiment.\nRemove second sticky tape cover and place the ConA coated coverslip onto the fluidic channel so that the ConA stripe matches with the T-shaped space. Use again a plastic pen to remove the bubbles. The fluid cell is now ready to use. Prepare many of them for a set of experiments.",
    "Load cells to the flow chambers.\nMeasure the OD of the cells in the morning before the experiment to be OD = 0.5 at 600 nm.\nTransfer 1.5 mL of cells (OD600–0.5) into each of three 1.5 mL centrifugation tubes at 500G (rcf) for 5 min to concentrate the cells. Remove access liquid until ∼100ul are left in each tube. Centrifuge the tubes on the bench-top centrifuge for 10 s, remove supernatant (∼60ul), then re-suspend and combine the remaining 40ul pellets from all three tubes to one.\nLoad the cells to the flow chamber using a pipette and 100ul tips. After loading the cells into the flow chamber, hookup the chamber onto the microscope, and wait 5 min to allow the cells to stick to the ConA coverslip.\nImage acquisition with time-lapse microscopy.\nImage acquisition setup. An inverted microscope (Nikon Eclipse Ti) which is equipped with perfect focus (Nikon), a 100× VC DIC lens (Nikon), a fluorescent filter for YFP (Semrock), an X-cite fluorescent light source (Excelitas) and an Orca Flash 4v2 CMOS camera (Hamamatsu) was controlled with a Micro-Manager program (Figure 1[href=https://www.wicell.org#fig1]C).\nBy moving in xy-plane, select a field of view with optimal density of the cells in a single z-plane. Adjust the z-focus to see the boundary of the majority of the cells as a white ring.\nRecord time-lapse images with both bright field (e.g., every 10 s) and fluorescent (e.g., every minute) channels (Figure 1[href=https://www.wicell.org#fig1]D, Methods video S1[href=https://www.wicell.org#mmc1]).\nPerturb cells with time-varying stimuli.\nConnect the flow chamber inlet with the 3-way valve (to media and mixing beaker) and its outlet to the pump2 in the flow setup according to the step 2 (a) above.",
    "Switch the inlet valve to the media (0 M). On the outlet syringe pump, set the flow rate to 9 mL/min, turn on the pump and wash off any unbound cells with osmolyte free media. Stop pump after all the unbound cells are gone (∼ 1 min). This ensures the air bubble is pumped out of the tubing and the fluid chamber.\nReduce the outlet pump flow rate to 0.1 mL/min (see the rate for pump2 in profile setup codes in step 1).\nAfter the flow is stabilized, turn off the pump, close the valve to the media w/o osmolyte and switch the inlet tubing to the mixing beaker (osmolyte containing media). Start the data acquisition (see step 5) and turn on the pumps simultaneously. Make sure there are at least 3 YFP images taken before the cells experience osmotic stimuli.\nQuantify single cell signaling activation.\nImage processing codes for cell segmentation and quantification (Kesler et al., 2019[href=https://www.wicell.org#bib10]) are available in the public OSF repository: https://osf.io/kwbe6/[href=https://osf.io/kwbe6/]. All codes used for image processing and analysis in this study to quantify signaling activation dynamics (Figures 1[href=https://www.wicell.org#fig1]E–1H) (Johnson et al., 2021[href=https://www.wicell.org#bib9]; Munsky et al., 2018[href=https://www.wicell.org#bib17]; Neuert et al., 2013[href=https://www.wicell.org#bib19]; Thiemicke et al., 2019[href=https://www.wicell.org#bib25]) are available at https://osf.io/kwbe6/[href=https://osf.io/kwbe6/] for download and use.\n    Your browser does not support HTML5 video.\n  \nMethods video S1. Time-lapse microscopy images of yeast cells, related to step 1\nTime-lapse microscopy images of yeast cells (gray) showing nuclear localization of the yellow fluorescent protein (YFP) tagged Hog1 mitogen-activated protein kinase (MAPK, red) following a 0.2 M NaCl step stimulation at t=0 min (the 1st frame). Movie frames are shown at every minute. The Hog1 nuclear localization peaks at 4–5 min and perfectly adapts to pre-stimulus level at +12 min (see Figure 1F for quantification).",
    "Model signal transduction network as dynamic ODE system and infer parameters using signaling activation measurements\nTiming: 1–4 days\nModel signal transduction networks as a dynamic ODE system. The signal transduction network is modeled as a dynamic ordinary differential equations (ODEs) system where proteins regulate each other through biochemical reactions (Figure 2[href=https://www.wicell.org#fig2]).\nDownload the MATLAB codes at Jashnsaz_STARProtocols_2021/Jashnsaz_et_al_dir01_Models to generate the models. Figures 2[href=https://www.wicell.org#fig2]A–2E outlines the implementation of the model3 in this code; the network topology diagram (Figure 2[href=https://www.wicell.org#fig2]A), the regulation matrices (Figure 2[href=https://www.wicell.org#fig2]B), the MATLAB implementation code (Figure 2[href=https://www.wicell.org#fig2]C), and the compiled dynamic ordinary differential equations (ODEs) system (Figure 2[href=https://www.wicell.org#fig2]E). Figures 2[href=https://www.wicell.org#fig2]A–2E provide the necessary details to use the codes to convert a specific network topology (Figure 2[href=https://www.wicell.org#fig2]A) to its corresponding ODE model (Figure 2[href=https://www.wicell.org#fig2]E).\nUse the MATLAB code visualize_models.m to import the models (Models.mat that is generated by running get_models.m) and using the customized network_plot.m function to visualize the network diagrams for all the models (similar to Figure 2[href=https://www.wicell.org#fig2]A).\nNote: This framework is general to map arbitrary regulatory networks to their corresponding ODE models and it is implemented in MATLAB 2019a. The framework takes arbitrary number of regulatory nodes based on the proteins involved in the pathway (Figure 2[href=https://www.wicell.org#fig2]A). The framework allows the user to model network topologies with user-specified connections (by manually entering the elements of the regulation matrices) or to model all the possible regulation networks (by generating all the possible permutations of the elements of the regulation matrices) (Figures 2[href=https://www.wicell.org#fig2]B and 2C).",
    "Specify protein states and the type of regulation functions. The formulation of the rate equations of the model is adopted from Ref. (Ma et al., 2009[href=https://www.wicell.org#bib12]). In our model, each node representing a protein (or a group of proteins) is modeled as two-state (active and inactive) species, and it has a fixed total concentration that is interconverted between active and inactive states via regulations from the stimuli inputs, fixed basal regulators, or other nodes of the network (Figure 2[href=https://www.wicell.org#fig2]B). The total rate is the sum of all such regulations that a node receives (Figure 2[href=https://www.wicell.org#fig2]E). We implement each regulation (link) as Michaelis-Menten kinetics (Figure 2[href=https://www.wicell.org#fig2]D), however, the framework is easily generalizable to other types of regulations such as mass action, Hill functions, and any other type of function.\nNote: The total regulation that a node receives could also be combined through a multiplicative AND-gate function where two or more proteins cooperatively regulate another protein (Mangan and Alon, 2003[href=https://www.wicell.org#bib14]).\nNote: In the model, sensors receive extracellular stimulation, they relay the signal to a downstream node, which in turn regulate the final node as the pathway readout (e.g., the terminal kinase phosphorylation and/or nuclear transport). Each node receives a constant basal regulation to take into account the role of constitutively active phosphatases and autoregulation. Feedforward and feedback loop (FFL/FBL) regulations are also considered that enable dynamic behaviors like adaptation (Figure 2[href=https://www.wicell.org#fig2]A).\nReduce model complexity by grouping proteins together as nodes. Although this framework allows the user to model a network of regulations at different complexity levels, here we considered a 4-node network topology (Figure 2[href=https://www.wicell.org#fig2]A) with the proceeding argument. The signal transduction networks, despite their topological complexity, broadly could be simplified into a general 4-node topology:",
    "First, the recurrent core network topologies (“circuit motifs”) that are capable of robustly executing biological functions are well supported (Milo et al., 2002[href=https://www.wicell.org#bib16]; Shen-Orr et al., 2002[href=https://www.wicell.org#bib23]; Wagner, 2005[href=https://www.wicell.org#bib27]).\nSecond, multiple of the proteins involved in signaling networks can be grouped together and considered a virtual node in a reduced ODE model to describe pathway activation dynamics and cellular responses with sufficient accuracy (Huang et al., 2010[href=https://www.wicell.org#bib6]; Jeong et al., 2018[href=https://www.wicell.org#bib8]).\nThird, many signaling pathways are branched; two or more upstream multi-component branches (e.g., consisting of the sensors, phosphorelays, and kinases) are stimulated by extracellular changes, that converge at a common downstream component, which in turn regulates a terminal signaling protein to trigger a cellular response.\nIn this protocol, as a proof of principle, we will model the well-characterized stress sensing Hog1 MAPK signaling pathway in S. cerevisiae as a reduced 4-node topology.\nInfer model parameters using signaling data (optimization algorithm). The optimization algorithm is provided in Figure 2[href=https://www.wicell.org#fig2]F. We ran this algorithm over 21 iterations for the training conditions provided throughout the manuscript that resulted in fits converging within the standard deviation of the data. Each iteration consists of two Genetic Algorithm (GA, a MATLAB built-in function) calls each followed by the MATLAB fminsearch function (light blue boxes, Figure 2[href=https://www.wicell.org#fig2]F) through the following steps:\nDivide the timepoints of data. The first GA and its following fminsearch uses only a portion of the timepoints of each training dataset (25% selected randomly). This reduces getting stuck in local minima of the parameters space. Then the second GA and its consequent fminsearch use all timepoints of the training data.\nDefine the objective function. The objective function is defined as one half of the sum of squared residuals of the model fit to the data given in Equation 1[href=https://www.wicell.org#fd1].",
    "(Equation 1)   O B J  =    ∑   n = 1  d    ∑   k = 1  N     (   x n   (  t k  )  −  O n   (  t k  )   )  2   2  σ n    (  t k  )  2    ,     \nN is the number of timepoints (25% selected randomly for the 1st GA, 100% for the 2nd GA) in each dataset, d is the total number of datasets in the training data, Xn(t) is the model, On(t) is the data mean, and   σ  n(t) is the standard error of the mean (experimental data) or additive noise (simulated data) for the pathway activation dynamics of dataset n.\nSample parameter space. At the first 4 iterations (  i ≤ 4  ) as well as at every 4th iteration of the algorithm, the 1st GA takes 200 parameter sets sampled uniformly in [−3,+3] in the logarithmic scale base 10, and returns a parameter set, that feeds into its following fminsearch. Sampling 200 parameter sets uniformly between −3 and +3 results in an average spacing of 0.03 for each parameter. This uniform sampling of parameter space multiple times in the beginning and through each optimization process helps to sample larger parameter space and reduces getting stuck in local minima. The iteration interval (i) can be adjusted if needed. Each fminsearch takes the parameter sets that GA outputs and minimizes the objective function given in Equation 1[href=https://www.wicell.org#fd1]. During each iteration, the best parameter sets after the 2nd fminsearch are collected. These parameter sets are used to resample 200 new parameter sets for the 1nd and 2nd GA (Figure 2[href=https://www.wicell.org#fig2]F, purple boxes). These parameter sets are sampled within the range [−0.5,+0.5] so that parameter space could be searched with finer spacing (0.005).",
    "Customize the GA parameters. Each GA runs for 20 generations, passes on one parameter set that has the minimum objective value among the 200 sets at each generation. The GA implements a mutation function that uses the best parameter sets from the previous generation (parents) to guess the new parameter sets.\nNote: Objective values are updated during the 2nd fminsearch if their value is improved. In total, 168,042 (= 2  ×  21  ×  20  ×  200 + 2  ×  21) number of parameter sets are evaluated for each model fit through this optimization process.\nModel stress sensing HOG pathway as a 4-node branched network topology. As a proof of principle of our approach, in this protocol, we model the well-characterized stress sensing Hog1 MAPK signaling pathway in S. cerevisiae as a reduced 4-node topology (Figure 2[href=https://www.wicell.org#fig2]G). The HOG pathway serves as a blueprint to study eukaryotic signaling pathways (Hohmann et al., 2007[href=https://www.wicell.org#bib5]). In the context of the HOG pathway (Figure 1[href=https://www.wicell.org#fig1]G), each SLN1 or SHO1 branch is grouped into a node given their fast (millisecond) activation dynamics before they activate Pbs2 in comparison to the longer activation dynamics of the Hog1 terminal kinase (that is in the order of 5 min) (Saito and Posas, 2012[href=https://www.wicell.org#bib21]; Tatebayashi et al., 2015[href=https://www.wicell.org#bib24]) as following.\nThe node x1 (Figure 2[href=https://www.wicell.org#fig2]A) represents the SLN1 branch (Figure 2[href=https://www.wicell.org#fig2]G) (including the proteins Sln1, Ypd1, Ssk1, Ssk2/ Ssk22) that utilizes a two-component phosphorelay mechanism to transmit its signal, with b1 representing the constant deactivation of the SLN1 branch (Hohmann et al., 2007[href=https://www.wicell.org#bib5]; Maeda et al., 1994[href=https://www.wicell.org#bib13]).",
    "The node x2 describes the SHO1 branch of the HOG pathway that utilizes protein kinases to relay its information. The SHO1 branch consists of the proteins Sho1, Msb2, Hkr1, Opy2, Cdc42, Ste20/Cla4, Ste11 and Ste50, with b2 modeling the basal deactivation of the SHO1 branch (Tatebayashi et al., 2015[href=https://www.wicell.org#bib24]). The SHO1 branch is also regulated by the Hog1 kinase through a feedback loop (Hao et al., 2007[href=https://www.wicell.org#bib3]; O’Rourke and Herskowitz, 1998[href=https://www.wicell.org#bib20]; Westfall and Thorner, 2006[href=https://www.wicell.org#bib29]).\nThe node x3 represents a MAPKK such as Pbs2 that integrates information flow from two branches and has basal regulation (b3) through phosphatases such as Ptc1/2/3.\nLastly, x4 represents a terminal kinase such as Hog1 that is activated by Pbs2. Hog1 is deactivated through phosphatases Ptc1/2/3 and Ptp2/3 (Mattison and Ota, 2000[href=https://www.wicell.org#bib15]; Warmka et al., 2001[href=https://www.wicell.org#bib28]; Young et al., 2002[href=https://www.wicell.org#bib30]). Deactivation of Hog1 via constitutively active phosphatases is modeled as the act of basal deactivator b4 on x4.\nNote: The details on how a 4-node model among a class of expandable network topologies that is considered in this protocol is discussed in Ref. (Jashnsaz et al., 2020[href=https://www.wicell.org#bib7]) in the context of other HOG models from the literature (English et al., 2015[href=https://www.wicell.org#bib1]; Granados et al., 2017[href=https://www.wicell.org#bib2]; Hersen et al., 2008[href=https://www.wicell.org#bib4]; Klipp et al., 2005[href=https://www.wicell.org#bib11]; Muzzey et al., 2009[href=https://www.wicell.org#bib18]; Schaber et al., 2012[href=https://www.wicell.org#bib22]; Zi et al., 2010[href=https://www.wicell.org#bib31]).\nParametrize the HOG model with experimentally measured Hog1 nuclear localization data.\nWe parametrized the biologically-inspired HOG 4-node model (Figure 2[href=https://www.wicell.org#fig2]G) by fitting the model to a set of experimental Hog1 nuclear localization data (Figure 2[href=https://www.wicell.org#fig2]H) over multiple independent training processes.\nUsing the parameter sets inferred from each of the multiple independent training processes, we predicted the Hog1 signaling dynamics upon new cell stimulation inputs (Figure 1[href=https://www.wicell.org#fig1]G) that were held out during model training.",
    "For each condition, we evaluated the model’s ability to predict the held out experimental Hog1 dynamics.\nWe defined the parameter set (Table S1 in Ref. (Jashnsaz et al., 2020[href=https://www.wicell.org#bib7])) resulting in the smallest prediction errors (i.e., the difference between the model and the data) as the “true parameter set”.\nUsing the combination of the “true parameter set” and the 4-node model (hereafter, the “true model”), we simulate synthetic signaling data upon multiple cell stimulation conditions (see next section, step 12).\nSimulate signaling data using the parametrized model upon diverse time-varying cell stimulation conditions to validate the model inference approach\nTiming: 1 day\nDiverse cell stimulation inputs that change according to a step, linear, or quadratic function over time resulted in distinct pathway activation dynamics (Figure 1[href=https://www.wicell.org#fig1]G). To establish whether and how model prediction depends on the type of the cell stimulation inputs and the resulting pathway activation dynamics, synthetic signaling data were simulated from the “true model” under different time-varying stimulation inputs (Figure 3[href=https://www.wicell.org#fig3]A).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/786-Fig3.jpg\nFigure 3. Generate simulated signaling data over a wide range of cell stimulation types and intensities\nTemporal stimulations of signaling pathways result in distinct dynamic pathway activation responses\n(A) Diverse time-varying perturbations corresponding to step (   t 0   ), root (   t   ), linear (   t 1   ), quadratic (   t 2   ), quints (   t 5   ), and heptic (   t 7   ) changes over time (left) are applied to the true model (middle) resulting in synthetic signaling activation dynamics (right). In synthetic signaling data, gray lines are the ODE model solutions for    x 4   ( t )    and blue lines represent 10 single cells by adding Gaussian white noise to the solution for each condition (Jashnsaz et al., 2020[href=https://www.wicell.org#bib7]).",
    "(B–H) (B) A table of diverse kinetic inputs reaching different final concentrations result in 54 distinct simulated signaling datasets. (I) Red, blue, yellow, and green colors indicate each dataset belonging to traindata, testdata1, testdata2, and testdata3, respectively, to be used to train the model and to test model predictions (Figures 4[href=https://www.wicell.org#fig4] and 5[href=https://www.wicell.org#fig5]). Synthetic pathway activation data simulated from the true model upon diverse kinetic stimulations (inserts) as step (   t 0   , C), root (   t   , D), linear (   t 1   , E), quadratic (   t 2   , F), quints (   t 5   , G), and heptic (   t 7   , H) functions over time each to final concentrations of 0.050, 0.10, 0.20, 0.30, 0.50, 0.70 M. All kinetic stimulations start at 0 min, all except steps reach their final concentrations at 25 min and then keep constant from 25 min to 50 min (insets). Lines are means and shaded areas are the standard deviations of the means from five simulated biological replicates each containing 10 single cell trajectories (similar to A). 30 “synthetic replicates” of each data is simulated under independent Gaussian single-cell noise. See step 3 for details, and Ref (Jashnsaz et al., 2020[href=https://www.wicell.org#bib7]).\nCritical: Using the combination of a biologically inspired model (the “true model” as a simplified HOG pathway model) and biologically representative simulated signaling data (that recapitulate experimental observations of the HOG pathway activations) provide a ground truth to quantitatively benchmark whether different time-varying cell stimulations impact model predictability without the challenges of modeling experimental data. Simulation also allows generating signaling data over a wide range of cell stimulation conditions (Figure 3[href=https://www.wicell.org#fig3]B).",
    "Simulate signaling data. Upon numerous cell stimulation input conditions of different temporal profiles in the form of polynomial functions each to multiple different final concentrations (Figure 3[href=https://www.wicell.org#fig3]B), we simulated signaling data for the pathway activation dynamics (Figures 3[href=https://www.wicell.org#fig3]C–3H).\nUpon each cell stimulation input condition, the “true model” is solved for the activation of the terminal kinase protein (final node) for the “true parameter set” under each corresponding stimulus input s(t) profile (Figure 3[href=https://www.wicell.org#fig3]A).\nTo capture cell-to-cell variability and measurement noise, single-cell trajectories are generated by adding experimentally realistic Gaussian white noise to the model ODE solutions, and the mean and standard deviation from single-cell trajectories over time are calculated as signaling activation data for each condition.\nNote: Here, the implementation of Gaussian white noise is based on the experimental observation that the distribution of single-cell Hog1 signaling variations at the same time and same conditions is well captured by a Gaussian distribution.\nWe simulated 30 independent synthetic data sets for each condition under independent single-cell noise. We refer to these as 30 “synthetic replicates” of the same data that will be used to initiate 30 independent fits for each training condition (see next section, step 15).\nNote: The implemented cell stimulation profiles are feasible in a lab setting and are mutually independent such that each of the profiles stimulates the pathway to express a unique temporal activation dynamic.",
    "Critical: The “true parameter set” that is used for this task is determined based on the quality of generated simulated data among many parameters sets from multiple independent training processes (see step 11). This ensures that the resulting simulated signaling data (Figure 3[href=https://www.wicell.org#fig3]) qualitatively and quantitatively recapitulate the experimental Hog1 pathway activation dynamics (Figures 1[href=https://www.wicell.org#fig1]F and 1G), such as activation levels, measurement noise, onset of activation, maximum activation time and perfect adaptation time. Importantly, from step stimulation inputs to the highest polynomial inputs the peak response shifts to the right as a result of a delay in the rate and concentration of higher order polynomial stimulation inputs. The resulting simulated data allowed us to investigate which set among these signaling data is best suited to train the model such that the remaining conditions could be predicted.\nInfer signaling model parameters by training the model with simulated data\nTiming: 3 days\nAs a common practice of systems biology, the dynamics of biological processes (i.e., signaling pathways) are often modeled as ODEs and the unknown dynamics and parameters (i.e., experimentally unobserved species and the unknown parameters such as reaction rates) are inferred from the measurements of the dynamics for a few species of the system. In this section, we explored what effects different cell stimulation inputs have on signaling model parameter inference.\nWe trained the true model with independent sets of simulated data that are generated using the true model with experimentally realistic noise that is Gaussian distributed (step 12). For each condition, we quantified the fit errors, best parameter sets, and the uncertainty in the model parameters.\nNote: The extensive analysis under different training datasets conditions is performed in Ref. (Jashnsaz et al., 2020[href=https://www.wicell.org#bib7]).",
    "Here, we used two conditions that include the same amount of training data that are generated upon step cell stimulations (Figures 4[href=https://www.wicell.org#fig4]A–4C) in comparison to diverse time-varying cell stimulation inputs (Figures 4[href=https://www.wicell.org#fig4]D–4F).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/786-Fig4.jpg\nFigure 4. Model fits equally well to simulated signaling data upon six step stimulation inputs and six diverse time-varying stimulation inputs\n(A and B) (A) Upon training to six simulated step input responses at different concentrations, (B) model fits (red) of signaling activation dynamics are compared to their corresponding training data (gray). Thick lines and shaded areas in red show median and interquartile range out of 10 independent model fits, and in gray they show means and standard deviations of the synthetic data.\n(C) A box plot of model fit errors, defined as the mean absolute difference of the model fit and their corresponding simulated training data over time, is shown compared to the standard deviation of the simulated data (dashed line). Box plot is quantified out of 60 fit error values (6 training data, 10 independent fits).\n(D and E) (D) Upon training to six simulated diverse time-varying input responses of (   t 0   to   t 7   ), (E) model fits (red) of signaling activation dynamics are compared to their corresponding training data (gray).\n(F) A box plot of model fit errors is shown compared to the standard deviation of the simulated data (dashed line). Box plot is quantified out of 60 fit error values (6 training data, 10 independent fits). Figures 4[href=https://www.wicell.org#fig4]B and 4E are reprinted with permission from Ref (Jashnsaz et al., 2020[href=https://www.wicell.org#bib7]).\nThis task was repeated upon multiple independent training processes each using independent noise in simulated data and randomized optimization initialization. Beside reproducibility, this ensures that the final results are independent of the noise in the data and initial parameter guesses.",
    "Under each training condition, each model’s fit convergence is confirmed to maximize the likelihood of observing the training data and the fit errors are evaluated. Under both conditions (Figures 4[href=https://www.wicell.org#fig4]A and 4D), the model fits the simulated data equally well (Figures 4[href=https://www.wicell.org#fig4]B and 4E). The fit errors, defined as the mean absolute difference of the fit and their corresponding synthetic data over time, is within one standard deviation of the experimental noise considered for the data (Figures 4[href=https://www.wicell.org#fig4]C and 4F).\nCritical: The question is whether different training conditions that result in models with indistinguishable fit errors lead to different predictions. To answer this question, next we evaluated the model predictions from each training condition (see next section, steps 17–18).\nValidate model by predicting signaling responses for the new conditions\nTiming: 1 day\nBeing able to predict the system’s behavior upon new conditions provides a testable way to validate or invalidate whether the observations that were used to train the model have sufficiently constrained the model structure and parameters. Using simulated data allowed us to generate numerous signaling data sets (step 12), of which we use a portion to train the model (steps 13–16) and use the remaining data for testing the model predictions (next, steps 17 and 18).\nUsing the best parameter set resulting from the model fit to six step (   t 0  )   training datasets (Figures 4[href=https://www.wicell.org#fig4]A–4C), we predicted the signaling dynamics upon new cell stimulation conditions (Figures 5[href=https://www.wicell.org#fig5]A–5C).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/786-Fig5.jpg\nFigure 5. Diverse time-varying cell stimulations improve model predictions",
    "(A and B) (A) Upon training to six simulated step input responses at different concentrations (Figure 4[href=https://www.wicell.org#fig4]A–4C), (B) model predictions of signaling activation dynamics upon different concentrations of linear input stimulations (predictions1 in blue) or different concentrations of nonlinear inputs of the shape t9 (predictions3 in green) are compared to their corresponding simulated test data (gray). Thick lines and shaded areas in blue and green show median and interquartile range of predictions corresponding to the 10 independent fits from Figure 4[href=https://www.wicell.org#fig4], and in gray they show means and standard deviations of the synthetic data.\n(C) A box plot of prediction errors, defined as the mean absolute difference of the model prediction and their corresponding simulated test data over time, is shown compared to the standard deviation of the simulated data (dashed line). Box plots of PE1, PE2, and PE3 are quantified from prediction errors of testdata1 (30 data sets over 10 independent fits), testdata2 (12 data sets over 10 independent fits), and testdata3 (6 data sets over 10 independent fits), respectively, that each excludes the training data.\n(D and E) (D) Upon training to six simulated diverse time-varying input responses to    t 0   to   t 7    (Figure 4[href=https://www.wicell.org#fig4]D–4F), (E) model predictions of signaling activation dynamics upon linear (blue) and nonlinear (green) input stimulations are compared to their corresponding test data (gray).\n(F) Box plots of predictions errors are quantified similar to (C) where test data excludes the training data. Figures 5[href=https://www.wicell.org#fig5]B and 5E are reprinted with permission from Ref (Jashnsaz et al., 2020[href=https://www.wicell.org#bib7]).",
    "We compared model predictions of signaling dynamics upon different concentrations of linear cell stimulations in the form of   u  ( t )  ∝  t 1    and upon nonlinear cell stimulations of   u  ( t )  ∝  t 9    to their corresponding synthetic data (Figure 5[href=https://www.wicell.org#fig5]B, blue and green compared to gray).\nNote: An input of   u  ( t )  ∝  t 9     is comparable to a shifted step function and describes an upper limit on the polynomial functions used.\nWe calculated the model prediction errors upon different sets of test data that exclude the training step data. These resulted in uncertain parameters that gave inaccurate predictions for testing data that are collected when using a different type of cell stimulation input (Figure 5[href=https://www.wicell.org#fig5]C).\nUsing the best parameters set resulting from the model fit to signaling dynamics under diverse time-varying cell stimulation profile types (   t 0  −  t 7   ) simultaneously (Figures 4[href=https://www.wicell.org#fig4]D–4F), we predicted the signaling dynamics upon new cell stimulation conditions (Figures 5[href=https://www.wicell.org#fig5]D–5F).\nWe compared model predictions of signaling dynamics upon different concentrations of linear cell stimulations in the form of   u  ( t )  ∝  t 1    and upon nonlinear cell stimulations of   u  ( t )  ∝  t 9    to their corresponding synthetic data (Figure 5[href=https://www.wicell.org#fig5]E, blue and green compared to gray). These results indicate that the predictions are substantially improved when the model is trained with data under diverse inputs.\nWe calculated the model errors upon test datasets and the quantification indicate that model predictions for all new testing conditions are as good as the model fits (Figure 5[href=https://www.wicell.org#fig5]F).",
    "Critical: For all the conditions, we evaluate the model predictions using sets of test data upon cell stimulation conditions that are different than those of the training datasets (either in the type of input or its final concentration)."
  ],
  "subjectAreas": [
    "Systems Biology",
    "Computer Sciences",
    "Microscopy",
    "Single Cell",
    "Cell Biology",
    "Cell-Based Assays",
    "Signal Transduction",
    "Model Organisms"
  ],
  "bigAreas": [
    "Molecular Biology & Genetics",
    "Bioengineering & Technology"
  ]
}