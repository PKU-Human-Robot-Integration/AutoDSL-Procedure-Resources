{
  "id": 10301,
  "origin_website": "Jove",
  "title": "Blood Flow Imaging with Ultrafast Doppler",
  "procedures": [
    "1. Doppler phantom preparation setup (Figure 2A)\nConnect the peristaltic pump, the blood mimicking fluid reservoir, the pulse dampener and the Doppler flow phantom with the plastic tubes.\nChoose the canal with a 4 mm diameter.\nProgram the pump to eject 720 mL/min of fluid for 0.3 s and then to eject 50 mL/min for 0.7 s to respectively mimic the systole and diastole cardiac phases\nRun the pump and gently shake the pipes to expel potential air bubbles.\n\tNOTE: The operator can choose a different canal diameter and different pump rate but will have to ensure that the ultrasound sequence is fast enough to acquire the fastest flow velocities. Eq. 3 presented later can help to design the sequence.\n2. Ultrafast ultrasound scanner setup (Figure 2A)\nConnect the ultrafast-enabled research scanner to the host computer with the PCI express link.\nChange the transducer adapter on the ultrasound scanner to match the probe connector, then connect the probe.\nRun Matlab and activate the ultrasound scanner license.\n\tNOTE: This section and the following implicitly assume the use of a Verasonics Vantage system.\n3. Ultrasound sequence programming\nUsing the examples scripts, design a conventional focused “B-Mode” (i.e., echography) sequence that will be used for probe positioning.\n\t\nSet the imaging depth to 50 mm.\nSet the focal depth to 35 mm.\nUsing the examples scripts, design an ultrafast ultrasound sequence.\n\t\nSet the imaging depth to 50 mm.\nProgram 3 tilted plane-waves at [-3,0,3] degree.\nSet the pulse repetition frequency (PRF) to 12 kHz.\nUse 4 half-cycles for the ultrasound waveform, with a center frequency depending on the probe used. A center frequency of 5.2 MHz is assumed here.\nSet the total duration to 1 s.\n4. Probe positioning and data acquisition\nApply ultrasound gel on the probe’s lens.",
    "Place the probe on the phantom and launch the B-Mode ultrasound sequence.\nLocate the canal of interest. The fluid appears darker than the surrounding tissue. Place the probe in longitudinal view.\nManually maintain the probe in the position of interest.\nEnd the B-Mode sequence and launch the ultrafast sequence acquisition script.\n5. Image reconstruction (Figure 2B)\nOnce the sequence is over, save the raw data (also called Radio-Frequency data, “RF”).\nLaunch the image reconstruction script using the ultrasound system default software. At the end of the process, the IQ data matrix should be created.\n\tNOTE: The ultrasound echoes are recorded on each element of the probe and for each emission/reception, then stored in the RF data matrix. The image reconstruction applied the appropriate delay law to each channel and results in the so-called “IQ” (In-Phase/Quadrature) matrix. The complex IQ matrix has three dimensions: two for space (image depth and width) and one for time\n6. Clutter filtering (Figure 2C)\nNOTE: For steps 6-7, see the Matlab script provided in the Supplementary Material.\nReshape the 3D (space x space x time) IQ matrix into a 2D (space x time) Casorati matrix, named IQr.\nCompute the singular value decomposition15 of IQr (Eq. 1).\nimgsrc://cloudfront.jove.com/files/ftp_upload/61838/61838equ01v3.jpg Eq. 1\nCompute the Spatial Similarity Matrix C using the spatial singular vectors U as described by Baranger et al.18 (II, D), and identify the blood subspace boundaries N.\nUse this cutoff N to filter the IQ data as described in Demene et al.15 (II,C).\n7. Flow visualization and velocity measurements (Figure 2C)\nCompute power Doppler map PD by integrating the envelope of the filtered data IQt along the temporal dimension (Eq. 2). The 3D coordinates z, x and t are respectively the depth, width and temporal dimension, nt and is the number of frames acquired.",
    "imgsrc://cloudfront.jove.com/files/ftp_upload/61838/61838equ02v5.jpg Eq. 2\nDisplay the PD map in logarithm scale. To set the dynamic range, compute the mean PD in a region outside the canal and use this value in dB as the lower bound of the dynamic range. A typical dynamic range is [-30, 0] dB.\nDefine a circular region of interest (ROI) on the image, containing 1 to 30 pixels.\nAverage the IQf signal over the pixels of that ROI, to obtain a vector imgsrc://cloudfront.jove.com/files/ftp_upload/61838/61838equ03v2.jpg of nt time points.\nCompute and display the Doppler spectrogram of imgsrc://cloudfront.jove.com/files/ftp_upload/61838/61838equ04v2.jpg, using the square magnitude of the Short-Time Fourier Transform (STFT).\n\t\nSet the STFT window to a 60-samples Hann window.\nSet the STFT overlap to 90% of the window length.\nOverlay the center frequency at each time point of the spectrogram.\nConvert the frequency f values into blood axial velocities vz using the Doppler formula (Eq. 3). c0 is the speed of sound in the medium and fTW the center frequency of the transmitted ultrasound waveform (here 5.2 MHz).\nimgsrc://cloudfront.jove.com/files/ftp_upload/61838/61838equ05v4.jpg Eq. 3\nSubscription Required. Please recommend JoVE to your librarian."
  ],
  "subjectAreas": [
    "Bioengineering"
  ],
  "bigAreas": [
    "Bioengineering & Technology"
  ]
}