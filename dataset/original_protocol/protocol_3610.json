{
  "id": 3813,
  "origin_website": "Cell",
  "title": "Protocol for comprehensive RNA sequencing analysis of murine long non-coding RNAs during aging",
  "procedures": [
    "Step-by-step method details\nStep-by-step method details\nDifferential gene expression\nTiming: 2h\nNote: Differential expression analysis is performed in each tissue.\nNote: Raw counts are used in this part.\nPerform pairwise differential gene expression of the youngest group with each aged group using DESeq2 (v1.28.1) package (Anders and Huber, 2010[href=https://www.wicell.org#bib2]). (Figure 2[href=https://www.wicell.org#fig2]A)\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/535-Fig2.jpg\nFigure 2. Detection of differentially expressed genes among multiple tissues\n(A)A graphical instruction of DESeq2 package. Here is an example of countData and colData, serving as essential input of constructing a DESeqDataSet object dds. For colData, we are only interested in the effect of aging here, as starred in the figure, so we just input age for the formula of design. DESeq function performs intermediate calculations. As seen in the sample outcomes, only gene A will be identified as DEG since it fulfills the criterion of |log2FC| ≥ 0.75 and FDR ≤ 0.05, but not gene B(|log2FC|<0.75) and gene C(adjusted p-value>0.05).\n(B)Illustration of pairwise comparison for differential gene expression. DEGs in 78-week samples and 104-week samples are identified as AR-genes, as starred in the figure.\n(C)Line plot demonstrating the differentially expressed lncRNA numbers of pairwise comparison in multiple tissues.\nUse DESeqDataSetFromMatrix function to create a DESeqDataSet object dds. The input arguments include CountData, ColData and Design.\nCountData is a matrix containing the raw read counts of selected groups. Filter the read counts to keep the same genes as the processed counts after data preprocessing. Each row represents a gene. Each column represents a sample in the interested young and aged groups.\nColData is a matrix containing sample information. Each row represents a sample, in the order of columns of countData. Each column represents a type of group information, including age and other covariates such as sex.",
    "Design is a formula representing how the gene counts rely on the variables in colData. Include the interested variables or their interactions in this formula.\nNote: For example, to examine which genes are differentially expressed during aging, only need to use ∼age as the design (Figure 2[href=https://www.wicell.org#fig2]A). If other covariates such as sex and sex:age interactions are considered, ∼age + sex + age:sex(as their interaction) should be used for the formula of design.\nNote: A DESeqDataSet object is used to store the input raw counts and intermediate results during the analysis of differential gene expression. All operations are performed on the DESeqDataSet object.\nUsing DESeq function with dds to conduct the analysis of differential gene expression. Outcomes tables can be generated by results function. The tables contain log2FoldChange and adjusted p-value(FDR) of each gene.\nNote: DESeq function contains three steps for the analysis of differential gene expression (estimateSizeFactors function, estimateDispersions function, and nbinomWaldTest function). As a substitute, you can also execute the three functions step-by-step.\nFor each of the aged group, the differentially expressed genes are identified with the criteria of |log2FC| ≥ 0.75 and FDR ≤ 0.05.\nDifferentially expressed genes in the interested aged groups are identified as aging-regulated (AR) genes.\nNote: Up/Down-regulated AR-genes can be identified according to the positive/negative log2FC values.\nNote: ln most organs, the number of differentially expressed lncRNAs increases during aging (Figure 2[href=https://www.wicell.org#fig2]C). The differential expressed mRNA/lncRNA of 78 weeks or 104 weeks compared with 8 weeks are classified as aging-regulated mRNAs (AR-mRNAs)/Aging-regulated lncRNAs (AR-lncRNAs) (Figure 2[href=https://www.wicell.org#fig2]B).\nFunctional annotation\nTiming: 4h\nNote: Functional annotation is performed in each tissue.\nNote: The mean value of processed counts of different replicates are used in this part.",
    "Note: The clusterProfiler (v3.16.1) package requires the gene ID to be EntrezID for the functional annotation. If the type of gene ID is already EntrezID, please skip step 3.\nTransform gene ID to EntrezID for mRNAs using the bitr function in the clusterProfiler package (Yu et al., 2012[href=https://www.wicell.org#bib17]).\nFind genome-wide annotation package for the species of your experimental model from http://bioconductor.org/packages/release/BiocViews.html#___OrgDb[href=http://bioconductor.org/packages/release/BiocViews.html#___OrgDb].\nNote: A series of org.Xx.eg.db packages including annotation for common species are required when performing the transformation of gene ID type. For example, we chose org.Mm.eg.db as our published study was conducted on mice.\nUse bitr function to perform ID transformation. The parameters, including geneID, fromType, toType and OrgDb, are used for the essential inputs.\nInput your gene id for ‘geneID’.\nUse keytypes function to see the supported ID types for ‘fromType’ and ‘toType’.\nThe name of selected org.Xx.eg.db package is used for ‘OrgDb’.\nNote: The following GO analysis is performed for each set of co-expressed mRNAs of each AR-lncRNA.\nNote: It is recommended to execute the following steps of functional annotation based on the loop structure, since it is a great deal of work to conduct functional annotation for co-expressed mRNAs of each AR-lncRNA separately and integrate the results.\nIdentify the co-expressed mRNAs of each AR-lncRNA (Necsulea et al., 2014[href=https://www.wicell.org#bib13]) (Figure 3[href=https://www.wicell.org#fig3]A).\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/535-Fig3.jpg\nFigure 3. Functional annotation of aging-regulated lncRNAs\n(A) A graphical instruction of co-expressed mRNAs identification. Here is an example considering 3 AR-lncRNAs and 6 mRNAs. Their |correlation coefficient|(FDR) are displayed correspondly in the figure. Only mRNAs with |correlation coefficient| ≥ 0.8 and FDR ≤ 0.05 with an AR-lncRNA are selected as co-expressed mRNAs of a specific AR-lncRNA, shown as red lines. To be specific, mRNA1 is a co-expressed mRNA of AR-lncRNA2, but not of AR-lncRNA1 and AR-lncRNA3.",
    "(B) A graphical instruction of BP enrichment for AR-lncRNAs. Firstly, obtain significantly enriched BP terms of co-expressed mRNAs for each AR-lncRNA. To be specific, GO term3 is both enriched in mRNA1 and mRNA3. mRNA1 is co-expressed with AR-lncRNA1, and mRNA3 is co-expressed with AR-lncRNA1,2,3. As a result, GO term3 is associated with all of the 3 AR-lncRNAs. Secondly, rank each BP term decreasingly according to the number of enriched AR-lncRNAs.\n(C) Comparison of top BPs in adipose tissues. Most of top BPs are associated with immune response.\nPerform Pearson correlation between AR-lncRNAs and mRNAs and calculate p-value using rcorr function in Hmisc (v4.4) package. ((Harrell, 2019[href=https://www.wicell.org#bib19]); (Schaum et al., 2019[href=https://www.wicell.org#bib22])) Take the absolute value of correlation coefficient. Using p.adjust function in stat package to adjust p-value by the method ‘fdr’.\nFor each AR-lncRNA, its co-expressed mRNAs were selected with a cutoff at absolute Pearson correlation coefficient ≥ 0.8 and FDR ≤ 0.05 in each tissue.\nPerform GO analysis by clusterProfiler package (Yu et al., 2012[href=https://www.wicell.org#bib17]).\nUse enrichGO function to perform BP(biological process) enrichment in GO analysis. Set ‘ont’ as ‘BP’ and ‘qvalueCutoff’ as 0.05. This step will return enrichment GO categories, go.\nNote: The parameter ‘ont’ can be selected as ‘MF’ for molecular function, ‘BP’ for biological process and ‘CC’ for cell component, or can be selected as ‘All’ to contain all of three. BP enrichment is most widely used.\nUse data.frame function to turn go into the form of data frame, go1. Filter go1 to remain columns including ‘ID’, ‘Description’, ‘p.adjust’, ‘geneID’ and ‘Count’.\nNote: The go1 data frame for each AR-IncRNA can be combined during each loop by rbind function, which faciliates the following steps.\nAnalysis of the number of lncRNAs associated with each BP terms. (Figure 3[href=https://www.wicell.org#fig3]B)",
    "Calculate the total number of associated AR-lncRNAs for each of the significantly enriched BP terms.\nRank the BP terms according to the decreasing order of associated AR-lncRNA numbers.\nTissue specificity analysis\nTiming: 2h\nNote: Tissue specificity analysis is performed at each time point.\nNote: The mean values of processed counts of replicates are used in this part.\nDefinition of tissue specificity score (Alvarez-Dominguez et al., 2015[href=https://www.wicell.org#bib1]; Ding et al., 2018[href=https://www.wicell.org#bib6])\nIn the following equations, n represents the total number of tissues, Tij represents the average expression of a given gene i in a given tissue j. (Figure 3[href=https://www.wicell.org#fig3]A)\n  Tissue   fraction ij  =   T  i j     ∑  j = 1  n   T  i j      \n  Tissue  specificity   score i  = max  {  Tissue   fraction ij   }   \nNote: The highest tissue fraction of a lncRNA, which indicates that a given lncRNA is highest expressed in a given tissue, is used as its tissue specific score. It can be used to compare the expression of interested lncRNAs among different tissues.\nDefinition of tissue specific and control lncRNA\nRank all lncRNAs according to tissue specificity scores in a decreasing order.\nNote: Use order function with parameter ‘decreasing = T’ to sort your data decreasingly.\nDefine the top 20% lncRNAs as tissue specific lncRNAs and the bottom 20% as control lncRNAs.\nDynamic interaction network construction\nTiming: 6h\nNote: Interaction network between AR-lncRNAs and AR-mRNAs is constructed in each tissue.\nNote: Processed counts without taking the mean value of replicates are used in this part.\nIdentification of modules in dynamic interaction networks\nCalculate the Z-score for the log-transformed normalized counts of each AR-lncRNA and AR-mRNA at different age points, separately. In the following equation, μ represents the mean value, σ represents the standard deviation.\n  Z − s c o r e =   x − μ  σ",
    "Note: Processed data points after Z-score normalization follows the standard normal distribution. Here, Z-score normalization enables us to compare expression data at different age points on the same level.\nCombine the samples from the neighbor age points into 4 stages (stage1: 008w&026w, stage2: 026w&060w, stage3: 060w&078w, and stage4: 078w&104w).\nNote: We performed the analysis for the combined samples as our sample size was relatively small (n=5) and may not provide accurate outcomes. If you have ≥ 10 samples for each age points, you can skip this step.\nFor expression matrix in each stage, evaluate Pearson correlation for each AR-lncRNA and AR-mRNA using rcorr function in Hmisc package ((Harrell, 2019[href=https://www.wicell.org#bib19]); (Schaum et al., 2019[href=https://www.wicell.org#bib22])). Take the absolute value of correlation coefficient and obtain four correlation matrixes cor1, cor2, cor3, cor4. Use p.adjust function in stat package to adjust p-value by the method ‘fdr’.\nWhen a pair of AR-lncRNA and AR-mRNA has the absolute correlation coefficient ≥ 0.9 and adjusted p-value ≤ 0.05 in either or both of stage1 or stage4, keep the AR-lncRNA and AR-mRNA pair in the subsequent dynamic network construction.\nIdentify modules for dynamic network construction using igraph (v1.2.4.2) package (Csardi and Nepusz, 2006[href=https://www.wicell.org#bib4]).\nConstruct a new dataframe exp to store higher correlation coefficient in stage1 and stage4 between each pair of filtered AR-lncRNA and AR-mRNA, where each line of the first and second column represents pairs of AR-lncRNA and AR-mRNA, the third column represents their correlation coefficient. (Figure 5[href=https://www.wicell.org#fig5]A)\nimgsrc:https://prod-shared-star-protocols.s3.amazonaws.com/protocols/535-Fig5.jpg\nFigure 5. Dynamic AR-lncRNA~AR-mRNA crosstalk during aging",
    "(A) A graphical instruction of AR-genes filtering for module detection. Here is an example considering 3 AR-lncRNAs and 6 AR-mRNAs. Their |correlation coefficient|(FDR) are displayed correspondly in the figure. Firstly, pick up edges between an AR-lncRNA and an AR-mRNA with |correlation coefficient| ≥ 0.9 and FDR ≤ 0.05 in Stage1 and Stage4, separately, shown as red lines. To be specific, the edge between AR-lncRNA2 and AR-mRNA1 is taken since it fulfills both criterions. On the contrary, though AR-lncRNA3 and AR-mRNA1 has a |correlation coefficient| = 0.97 > 0.9, the edge is not selected since its FDR = 0.18 > 0.05. Secondly, if an edge is chosen in either or both of Stage1 or Stage4, include it for consequent steps. It can be clearly seen that AR-mRNA5 is not correlated with any AR-lncRNA. As a result, remove AR-mRNA5 from network construction. For the remaining edges, use the higher value of |correlation coefficient|of Stage1 and Stage4 for module detection. Take the edge between AR-lncRNA2 and AR-mRNA1 as an example. It is picked both in Stage1 and Stage4 and remains in the network. Its |correlation coefficient| in stage1(0.92) is higher than stage4(0.91), keep 0.92 rather than 0.91.\n(B) Dynamic network showing the interaction of AR-lncRNAs and AR-mRNAs during the mouse lifespan in eWAT. Each row represents an AR-lncRNA. Each column represents an AR-mRNA.\nUse graph_from_data_frame function to create an igraph graph g with the dataframe exp.\nUse cluster_walktrap function to identify modules of g with the parameter of steps=10, which will return a community object wc. Use membership function to obtain the module information for wc. Use a new dataframe mod to store these information.\nNote: The step highly depends on computing resources.\nNote: The cluster_walktrap function only keeps modules with gene number ≥ 30.\nConstruction of the AR-lncRNA∼AR-mRNA network",
    "Rearrange the rows and columns of correlation coefficient matrix in each stage, which adjusts the order of AR-lncRNAs and AR-mRNAs, in the order of module information (from module 1 to module n) of each AR-lncRNAs and AR-mRNAs in dataframe mod.\nNote: The order of AR-lncRNAs and AR-mRNAs become exactly the same in four different stages.\nUse pheatmap function in pheatmap package (v1.0.12) to plot heatmap of cor1, cor2, cor3, cor4. Set cluster_rows = F,cluster_cols = F."
  ],
  "subjectAreas": [
    "Genomics",
    "Rnaseq",
    "Sequencing"
  ],
  "bigAreas": [
    "Molecular Biology & Genetics"
  ]
}